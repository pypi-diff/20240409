# Comparing `tmp/sat-toolkit-0.4.2.tar.gz` & `tmp/sat-toolkit-0.4.3.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "sat-toolkit-0.4.2.tar", last modified: Mon Apr  8 13:49:48 2024, max compression
+gzip compressed data, was "sat-toolkit-0.4.3.tar", last modified: Tue Apr  9 12:06:12 2024, max compression
```

## Comparing `sat-toolkit-0.4.2.tar` & `sat-toolkit-0.4.3.tar`

### file list

```diff
@@ -1,25 +1,25 @@
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-08 13:49:48.233142 sat-toolkit-0.4.2/
--rw-r--r--   0 runner    (1001) docker     (127)     1071 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/LICENSE
--rw-r--r--   0 runner    (1001) docker     (127)      102 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (127)     1112 2024-04-08 13:49:48.233142 sat-toolkit-0.4.2/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)      660 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/README.md
--rw-r--r--   0 runner    (1001) docker     (127)       60 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/pyproject.toml
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-08 13:49:48.229142 sat-toolkit-0.4.2/sat_toolkit/
--rw-r--r--   0 runner    (1001) docker     (127)        0 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/sat_toolkit/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)     1327 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/sat_toolkit/fmt.h
--rw-r--r--   0 runner    (1001) docker     (127)  3085898 2024-04-08 13:49:47.000000 sat-toolkit-0.4.2/sat_toolkit/formula.cpp
--rw-r--r--   0 runner    (1001) docker     (127)    60409 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/sat_toolkit/formula.pyx
--rw-r--r--   0 runner    (1001) docker     (127)      215 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/sat_toolkit/types.pxd
--rw-r--r--   0 runner    (1001) docker     (127)     2198 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/sat_toolkit/util.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-08 13:49:48.233142 sat-toolkit-0.4.2/sat_toolkit.egg-info/
--rw-r--r--   0 runner    (1001) docker     (127)     1112 2024-04-08 13:49:48.000000 sat-toolkit-0.4.2/sat_toolkit.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)      423 2024-04-08 13:49:48.000000 sat-toolkit-0.4.2/sat_toolkit.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (127)        1 2024-04-08 13:49:48.000000 sat-toolkit-0.4.2/sat_toolkit.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (127)       12 2024-04-08 13:49:48.000000 sat-toolkit-0.4.2/sat_toolkit.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (127)       12 2024-04-08 13:49:48.000000 sat-toolkit-0.4.2/sat_toolkit.egg-info/top_level.txt
--rw-r--r--   0 runner    (1001) docker     (127)       38 2024-04-08 13:49:48.233142 sat-toolkit-0.4.2/setup.cfg
--rwxr-xr-x   0 runner    (1001) docker     (127)     1031 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-08 13:49:48.233142 sat-toolkit-0.4.2/tests/
--rw-r--r--   0 runner    (1001) docker     (127)     8136 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/tests/test_cnf.py
--rw-r--r--   0 runner    (1001) docker     (127)     4734 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/tests/test_partition.py
--rw-r--r--   0 runner    (1001) docker     (127)    10440 2024-04-08 13:49:41.000000 sat-toolkit-0.4.2/tests/test_xor_cnf.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-09 12:06:12.936013 sat-toolkit-0.4.3/
+-rw-r--r--   0 runner    (1001) docker     (127)     1071 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (127)      102 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (127)     1112 2024-04-09 12:06:12.936013 sat-toolkit-0.4.3/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)      660 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/README.md
+-rw-r--r--   0 runner    (1001) docker     (127)       60 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/pyproject.toml
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-09 12:06:12.936013 sat-toolkit-0.4.3/sat_toolkit/
+-rw-r--r--   0 runner    (1001) docker     (127)        0 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/sat_toolkit/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1327 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/sat_toolkit/fmt.h
+-rw-r--r--   0 runner    (1001) docker     (127)  3086147 2024-04-09 12:06:12.000000 sat-toolkit-0.4.3/sat_toolkit/formula.cpp
+-rw-r--r--   0 runner    (1001) docker     (127)    60474 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/sat_toolkit/formula.pyx
+-rw-r--r--   0 runner    (1001) docker     (127)      215 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/sat_toolkit/types.pxd
+-rw-r--r--   0 runner    (1001) docker     (127)     2198 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/sat_toolkit/util.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-09 12:06:12.936013 sat-toolkit-0.4.3/sat_toolkit.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (127)     1112 2024-04-09 12:06:12.000000 sat-toolkit-0.4.3/sat_toolkit.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)      423 2024-04-09 12:06:12.000000 sat-toolkit-0.4.3/sat_toolkit.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (127)        1 2024-04-09 12:06:12.000000 sat-toolkit-0.4.3/sat_toolkit.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (127)       12 2024-04-09 12:06:12.000000 sat-toolkit-0.4.3/sat_toolkit.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (127)       12 2024-04-09 12:06:12.000000 sat-toolkit-0.4.3/sat_toolkit.egg-info/top_level.txt
+-rw-r--r--   0 runner    (1001) docker     (127)       38 2024-04-09 12:06:12.936013 sat-toolkit-0.4.3/setup.cfg
+-rwxr-xr-x   0 runner    (1001) docker     (127)     1031 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-04-09 12:06:12.936013 sat-toolkit-0.4.3/tests/
+-rw-r--r--   0 runner    (1001) docker     (127)     8169 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/tests/test_cnf.py
+-rw-r--r--   0 runner    (1001) docker     (127)     4734 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/tests/test_partition.py
+-rw-r--r--   0 runner    (1001) docker     (127)    10914 2024-04-09 12:06:06.000000 sat-toolkit-0.4.3/tests/test_xor_cnf.py
```

### Comparing `sat-toolkit-0.4.2/LICENSE` & `sat-toolkit-0.4.3/LICENSE`

 * *Files identical despite different names*

### Comparing `sat-toolkit-0.4.2/PKG-INFO` & `sat-toolkit-0.4.3/PKG-INFO`

 * *Files 18% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: sat-toolkit
-Version: 0.4.2
+Version: 0.4.3
 Summary: Tool for manipulating CNF formulas
 Home-page: https://github.com/fanosta/sat_toolkit
 Author: Marcel Nageler
 Author-email: marcel.nageler@iaik.tugraz.at
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: POSIX :: Linux
```

### Comparing `sat-toolkit-0.4.2/README.md` & `sat-toolkit-0.4.3/README.md`

 * *Files identical despite different names*

### Comparing `sat-toolkit-0.4.2/sat_toolkit/fmt.h` & `sat-toolkit-0.4.3/sat_toolkit/fmt.h`

 * *Files identical despite different names*

### Comparing `sat-toolkit-0.4.2/sat_toolkit/formula.cpp` & `sat-toolkit-0.4.3/sat_toolkit/formula.cpp`

 * *Files 1% similar despite different names*

```diff
@@ -1804,15 +1804,15 @@
  */
 struct __pyx_opt_args_7cpython_11contextvars_get_value_no_default {
   int __pyx_n;
   PyObject *default_value;
 };
 struct __pyx_opt_args_11sat_toolkit_7formula_3CNF__add_xor_clause;
 
-/* "sat_toolkit/formula.pyx":818
+/* "sat_toolkit/formula.pyx":853
  *         return res
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:             # <<<<<<<<<<<<<<
  *         if rhs not in [0, 1]:
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  */
 struct __pyx_opt_args_11sat_toolkit_7formula_3CNF__add_xor_clause {
@@ -1872,54 +1872,54 @@
   std::vector<size_t>  _start_indices;
   int nvars;
   Py_ssize_t shape[1];
   Py_ssize_t view_count;
 };
 
 
-/* "sat_toolkit/formula.pyx":676
+/* "sat_toolkit/formula.pyx":711
  * 
  * 
  * cdef class CNF(_ClauseList):             # <<<<<<<<<<<<<<
  *     """
  *     Class for storing and manipulating CNF formulas.
  */
 struct __pyx_obj_11sat_toolkit_7formula_CNF {
   struct __pyx_obj_11sat_toolkit_7formula__ClauseList __pyx_base;
 };
 
 
-/* "sat_toolkit/formula.pyx":1357
+/* "sat_toolkit/formula.pyx":1358
  * 
  * 
  * cdef class XorClauseList(_ClauseList):             # <<<<<<<<<<<<<<
  *     """
  *     Class for storing and manipulating a list of xor clauses.
  */
 struct __pyx_obj_11sat_toolkit_7formula_XorClauseList {
   struct __pyx_obj_11sat_toolkit_7formula__ClauseList __pyx_base;
 };
 
 
-/* "sat_toolkit/formula.pyx":1371
+/* "sat_toolkit/formula.pyx":1372
  * 
  * 
  * cdef class XorCNF:             # <<<<<<<<<<<<<<
  *     cdef readonly CNF _clauses
  *     cdef readonly XorClauseList _xor_clauses
  */
 struct __pyx_obj_11sat_toolkit_7formula_XorCNF {
   PyObject_HEAD
   struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *__pyx_vtab;
   struct __pyx_obj_11sat_toolkit_7formula_CNF *_clauses;
   struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *_xor_clauses;
 };
 
 
-/* "sat_toolkit/formula.pyx":1664
+/* "sat_toolkit/formula.pyx":1665
  * 
  * 
  * cdef class Truthtable:             # <<<<<<<<<<<<<<
  *     """
  *     A boolean function represented as a truth table.
  */
 struct __pyx_obj_11sat_toolkit_7formula_Truthtable {
@@ -1958,29 +1958,29 @@
   PyObject_HEAD
   size_t __pyx_v_i;
   struct __pyx_obj_11sat_toolkit_7formula__BaseClause *__pyx_v_self;
   size_t __pyx_t_0;
 };
 
 
-/* "sat_toolkit/formula.pyx":519
+/* "sat_toolkit/formula.pyx":554
  *         return self._start_indices.size()
  * 
  *     def __iter__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i = 0
  *         while i < self._start_indices.size():
  */
 struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ {
   PyObject_HEAD
   size_t __pyx_v_i;
   struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self;
 };
 
 
-/* "sat_toolkit/formula.pyx":526
+/* "sat_toolkit/formula.pyx":561
  * 
  * 
  *     def __reversed__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  */
 struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ {
@@ -2132,15 +2132,15 @@
   int (*_check_clause_type)(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *, struct __pyx_obj_11sat_toolkit_7formula__BaseClause *);
   int (*_compare_clause)(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *, size_t, struct __pyx_obj_11sat_toolkit_7formula__BaseClause *);
   size_t (*_get_slice_index)(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *, Py_ssize_t);
 };
 static struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *__pyx_vtabptr_11sat_toolkit_7formula__ClauseList;
 
 
-/* "sat_toolkit/formula.pyx":676
+/* "sat_toolkit/formula.pyx":711
  * 
  * 
  * cdef class CNF(_ClauseList):             # <<<<<<<<<<<<<<
  *     """
  *     Class for storing and manipulating CNF formulas.
  */
 
@@ -2152,30 +2152,30 @@
   int (*_check_solution)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, __Pyx_memviewslice);
   int (*_check_solution_for_single_clause)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, size_t, __Pyx_memviewslice);
   struct __pyx_obj_11sat_toolkit_7formula_Clause *(*get_clause)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, Py_ssize_t);
 };
 static struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *__pyx_vtabptr_11sat_toolkit_7formula_CNF;
 
 
-/* "sat_toolkit/formula.pyx":1357
+/* "sat_toolkit/formula.pyx":1358
  * 
  * 
  * cdef class XorClauseList(_ClauseList):             # <<<<<<<<<<<<<<
  *     """
  *     Class for storing and manipulating a list of xor clauses.
  */
 
 struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList {
   struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList __pyx_base;
   struct __pyx_obj_11sat_toolkit_7formula_XorClause *(*get_clause)(struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *, Py_ssize_t);
 };
 static struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *__pyx_vtabptr_11sat_toolkit_7formula_XorClauseList;
 
 
-/* "sat_toolkit/formula.pyx":1371
+/* "sat_toolkit/formula.pyx":1372
  * 
  * 
  * cdef class XorCNF:             # <<<<<<<<<<<<<<
  *     cdef readonly CNF _clauses
  *     cdef readonly XorClauseList _xor_clauses
  */
 
@@ -3426,22 +3426,22 @@
   catch (...)
   {
     PyErr_SetString(PyExc_RuntimeError, "Unknown exception");
   }
 }
 #endif
 
+/* ObjectToMemviewSlice.proto */
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dc_int(PyObject *, int writable_flag);
+
 /* MemviewDtypeToObject.proto */
 static CYTHON_INLINE PyObject *__pyx_memview_get_int(const char *itemp);
 static CYTHON_INLINE int __pyx_memview_set_int(const char *itemp, PyObject *obj);
 
 /* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dc_int(PyObject *, int writable_flag);
-
-/* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_char__const__(PyObject *, int writable_flag);
 
 /* MemviewDtypeToObject.proto */
 static CYTHON_INLINE PyObject *__pyx_memview_get_unsigned_char__const__(const char *itemp);
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_d_dc_int__const__(PyObject *, int writable_flag);
@@ -3886,16 +3886,16 @@
 static const char __pyx_k_T_2[] = "-T";
 static const char __pyx_k__10[] = "";
 static const char __pyx_k__11[] = ":";
 static const char __pyx_k__12[] = "}";
 static const char __pyx_k__13[] = "(";
 static const char __pyx_k__14[] = ",";
 static const char __pyx_k__19[] = " < ";
-static const char __pyx_k__32[] = " ";
-static const char __pyx_k__33[] = "\n";
+static const char __pyx_k__34[] = " ";
+static const char __pyx_k__35[] = "\n";
 static const char __pyx_k__59[] = "-";
 static const char __pyx_k_abc[] = "abc";
 static const char __pyx_k_all[] = "all";
 static const char __pyx_k_and[] = " and ";
 static const char __pyx_k_any[] = "any";
 static const char __pyx_k_arg[] = "arg";
 static const char __pyx_k_buf[] = "buf";
@@ -3923,15 +3923,16 @@
 static const char __pyx_k_sys[] = "sys";
 static const char __pyx_k_tmp[] = "tmp";
 static const char __pyx_k_v_2[] = "v";
 static const char __pyx_k_val[] = "val";
 static const char __pyx_k_var[] = "var";
 static const char __pyx_k_None[] = "None";
 static const char __pyx_k_PIPE[] = "PIPE";
-static const char __pyx_k__107[] = "_";
+static const char __pyx_k_Self[] = "Self";
+static const char __pyx_k__109[] = "_";
 static const char __pyx_k__181[] = "?";
 static const char __pyx_k_args[] = "args";
 static const char __pyx_k_axis[] = "axis";
 static const char __pyx_k_base[] = "base";
 static const char __pyx_k_bits[] = "bits";
 static const char __pyx_k_bool[] = "bool";
 static const char __pyx_k_copy[] = "copy";
@@ -4173,15 +4174,14 @@
 static const char __pyx_k_staticmethod[] = "staticmethod";
 static const char __pyx_k_stringsource[] = "<stringsource>";
 static const char __pyx_k_tmp_nclauses[] = "tmp_nclauses";
 static const char __pyx_k_use_setstate[] = "use_setstate";
 static const char __pyx_k_version_info[] = "version_info";
 static const char __pyx_k_CNF_get_units[] = "CNF.get_units";
 static const char __pyx_k_CNF_to_dimacs[] = "CNF.to_dimacs";
-static const char __pyx_k_CNF_translate[] = "CNF.translate";
 static const char __pyx_k_UNSATISFIABLE[] = "UNSATISFIABLE";
 static const char __pyx_k_XorCNF_to_cnf[] = "XorCNF.to_cnf";
 static const char __pyx_k_XorClauseList[] = "XorClauseList";
 static const char __pyx_k_cannot_append[] = "cannot append ";
 static const char __pyx_k_class_getitem[] = "__class_getitem__";
 static const char __pyx_k_count_nonzero[] = "count_nonzero";
 static const char __pyx_k_echo_comments[] = "echo_comments";
@@ -4263,36 +4263,37 @@
 static const char __pyx_k_cannot_set_nvars_to[] = "cannot set nvars to ";
 static const char __pyx_k_pyx_unpickle_Clause[] = "__pyx_unpickle_Clause";
 static const char __pyx_k_sat_toolkit_formula[] = "sat_toolkit.formula";
 static const char __pyx_k_CNF__create_all_zero[] = "CNF._create_all_zero";
 static const char __pyx_k_CNF__minimize_dimacs[] = "CNF._minimize_dimacs";
 static const char __pyx_k_CNF_create_all_equal[] = "CNF.create_all_equal";
 static const char __pyx_k_ClauseList_partition[] = "_ClauseList.partition";
+static const char __pyx_k_ClauseList_translate[] = "_ClauseList.translate";
 static const char __pyx_k_strided_and_indirect[] = "<strided and indirect>";
 static const char __pyx_k_to_linear_constraint[] = "to_linear_constraint";
 static const char __pyx_k_var_must_not_be_zero[] = "var must not be zero";
 static const char __pyx_k_BaseClause___reversed[] = "_BaseClause.__reversed__";
 static const char __pyx_k_CNF__create_all_equal[] = "CNF._create_all_equal";
 static const char __pyx_k_CNF_minimize_espresso[] = "CNF.minimize_espresso";
 static const char __pyx_k_ClauseList___reversed[] = "_ClauseList.__reversed__";
 static const char __pyx_k_ClauseList_add_clause[] = "_ClauseList.add_clause";
 static const char __pyx_k_Invalid_shape_in_axis[] = "Invalid shape in axis ";
 static const char __pyx_k_contiguous_and_direct[] = "<contiguous and direct>";
-static const char __pyx_k_CNF_get_units_line_974[] = "CNF.get_units (line 974)";
 static const char __pyx_k_CNF_minimize_lingeling[] = "CNF.minimize_lingeling";
 static const char __pyx_k_Cannot_index_with_type[] = "Cannot index with type '";
 static const char __pyx_k_ClauseList_add_clauses[] = "_ClauseList.add_clauses";
 static const char __pyx_k_Clause___reduce_cython[] = "Clause.__reduce_cython__";
 static const char __pyx_k_MemoryView_of_r_object[] = "<MemoryView of %r object>";
 static const char __pyx_k_Truthtable_to_espresso[] = "Truthtable.to_espresso";
 static const char __pyx_k_XorCNF_add_xor_clauses[] = "XorCNF.add_xor_clauses";
 static const char __pyx_k_cannot_use_0_in_clause[] = "cannot use 0 in clause";
 static const char __pyx_k_pyx_unpickle_XorClause[] = "__pyx_unpickle_XorClause";
 static const char __pyx_k_too_short_for_CNF_with[] = " too short for CNF with ";
-static const char __pyx_k_CNF_logical_or_line_911[] = "CNF.logical_or (line 911)";
+static const char __pyx_k_CNF_get_units_line_1009[] = "CNF.get_units (line 1009)";
+static const char __pyx_k_CNF_logical_or_line_946[] = "CNF.logical_or (line 946)";
 static const char __pyx_k_MemoryView_of_r_at_0x_x[] = "<MemoryView of %r at 0x%x>";
 static const char __pyx_k_Truthtable_from_indices[] = "Truthtable.from_indices";
 static const char __pyx_k_contiguous_and_indirect[] = "<contiguous and indirect>";
 static const char __pyx_k_invalid_value_for_phase[] = "invalid value for `phase`";
 static const char __pyx_k_no_p_cnf_line_in_dimacs[] = "no 'p cnf ...' line in dimacs";
 static const char __pyx_k_pyx_unpickle_Truthtable[] = "__pyx_unpickle_Truthtable";
 static const char __pyx_k_sat_toolkit_formula_pyx[] = "sat_toolkit/formula.pyx";
@@ -4427,29 +4428,30 @@
 static int __pyx_pf_11sat_toolkit_7formula_11_ClauseList___init__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clauses, PyObject *__pyx_v_nvars); /* proto */
 static int __pyx_pf_11sat_toolkit_7formula_11_ClauseList_2__cinit__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_5nvars___get__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
 static int __pyx_pf_11sat_toolkit_7formula_11_ClauseList_5nvars_2__set__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, int __pyx_v_val); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_4get_vars(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_6clear(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_8partition(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_10add_clauses(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clauses); /* proto */
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_12add_clause(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clause); /* proto */
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_14__iadd__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clauses); /* proto */
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_16__add__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_other); /* proto */
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_18__getitem__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_ssize_t __pyx_v_idx); /* proto */
-static Py_ssize_t __pyx_pf_11sat_toolkit_7formula_11_ClauseList_20__len__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_22__iter__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_25__reversed__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_28__eq__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_other); /* proto */
-static int __pyx_pf_11sat_toolkit_7formula_11_ClauseList_30__contains__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle); /* proto */
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_32count(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle); /* proto */
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_34index(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle, PyObject *__pyx_v_start, PyObject *__pyx_v_end); /* proto */
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_36__reduce__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
-static int __pyx_pf_11sat_toolkit_7formula_11_ClauseList_38__getbuffer__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_buffer *__pyx_v_buffer, int __pyx_v_flags); /* proto */
-static void __pyx_pf_11sat_toolkit_7formula_11_ClauseList_40__releasebuffer__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_buffer *__pyx_v_buffer); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_10translate(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_mapping); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_12add_clauses(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clauses); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_14add_clause(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clause); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_16__iadd__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clauses); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_18__add__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_other); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_20__getitem__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_ssize_t __pyx_v_idx); /* proto */
+static Py_ssize_t __pyx_pf_11sat_toolkit_7formula_11_ClauseList_22__len__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_24__iter__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_27__reversed__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_30__eq__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_other); /* proto */
+static int __pyx_pf_11sat_toolkit_7formula_11_ClauseList_32__contains__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_34count(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_36index(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle, PyObject *__pyx_v_start, PyObject *__pyx_v_end); /* proto */
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_38__reduce__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
+static int __pyx_pf_11sat_toolkit_7formula_11_ClauseList_40__getbuffer__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_buffer *__pyx_v_buffer, int __pyx_v_flags); /* proto */
+static void __pyx_pf_11sat_toolkit_7formula_11_ClauseList_42__releasebuffer__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_buffer *__pyx_v_buffer); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_8_clauses___get__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_14_start_indices___get__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self); /* proto */
 static struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_pf_11sat_toolkit_7formula_3CNF_from_dimacs(PyObject *__pyx_v_dimacs); /* proto */
 static struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_pf_11sat_toolkit_7formula_3CNF_2from_espresso(PyObject *__pyx_v_espresso); /* proto */
 static struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_pf_11sat_toolkit_7formula_3CNF_4create_all_zero(PyObject *__pyx_v_indices); /* proto */
 static struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_pf_11sat_toolkit_7formula_3CNF_6_create_all_zero(__Pyx_memviewslice __pyx_v_indices); /* proto */
 static struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_pf_11sat_toolkit_7formula_3CNF_8create_all_equal(PyObject *__pyx_v_lhs, PyObject *__pyx_v_rhs); /* proto */
@@ -4465,15 +4467,14 @@
 static struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_pf_11sat_toolkit_7formula_3CNF_28minimize_lingeling(struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self, PyObject *__pyx_v_optlevel, PyObject *__pyx_v_timeout, PyObject *__pyx_v_extra_args); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_3CNF_30solve_dimacs(struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self, PyObject *__pyx_v_command, PyObject *__pyx_v_verbose); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_3CNF_32check_solution(struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self, __Pyx_memviewslice __pyx_v_solution); /* proto */
 static struct __pyx_obj_11sat_toolkit_7formula_Truthtable *__pyx_pf_11sat_toolkit_7formula_3CNF_34to_truthtable(struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_3CNF_36__repr__(struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_3CNF_38__str__(struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_3CNF_40equiv(struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self, struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_other); /* proto */
-static struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_pf_11sat_toolkit_7formula_3CNF_42translate(struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self, PyObject *__pyx_v_mapping); /* proto */
 static int __pyx_pf_11sat_toolkit_7formula_6XorCNF___cinit__(struct __pyx_obj_11sat_toolkit_7formula_XorCNF *__pyx_v_self); /* proto */
 static int __pyx_pf_11sat_toolkit_7formula_6XorCNF_2__init__(struct __pyx_obj_11sat_toolkit_7formula_XorCNF *__pyx_v_self, PyObject *__pyx_v_clauses, PyObject *__pyx_v_xor_clauses); /* proto */
 static struct __pyx_obj_11sat_toolkit_7formula_XorCNF *__pyx_pf_11sat_toolkit_7formula_6XorCNF_4from_dimacs(PyObject *__pyx_v_dimacs); /* proto */
 static struct __pyx_obj_11sat_toolkit_7formula_XorCNF *__pyx_pf_11sat_toolkit_7formula_6XorCNF_6create_xor(PyObject *__pyx_v_rhs, PyObject *__pyx_v_args); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_6XorCNF_8partition(struct __pyx_obj_11sat_toolkit_7formula_XorCNF *__pyx_v_self); /* proto */
 static struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_pf_11sat_toolkit_7formula_6XorCNF_10to_cnf(struct __pyx_obj_11sat_toolkit_7formula_XorCNF *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_11sat_toolkit_7formula_6XorCNF_12add_clauses(struct __pyx_obj_11sat_toolkit_7formula_XorCNF *__pyx_v_self, PyObject *__pyx_v_clauses); /* proto */
@@ -4724,27 +4725,26 @@
   PyObject *__pyx_n_s_CNF_create_all_equal;
   PyObject *__pyx_n_s_CNF_create_all_zero;
   PyObject *__pyx_n_s_CNF_create_xor;
   PyObject *__pyx_n_s_CNF_equiv;
   PyObject *__pyx_n_s_CNF_from_dimacs;
   PyObject *__pyx_n_s_CNF_from_espresso;
   PyObject *__pyx_n_s_CNF_get_units;
-  PyObject *__pyx_kp_u_CNF_get_units_line_974;
+  PyObject *__pyx_kp_u_CNF_get_units_line_1009;
   PyObject *__pyx_n_s_CNF_implied_by;
   PyObject *__pyx_n_s_CNF_logical_or;
-  PyObject *__pyx_kp_u_CNF_logical_or_line_911;
+  PyObject *__pyx_kp_u_CNF_logical_or_line_946;
   PyObject *__pyx_n_s_CNF_minimize_espresso;
   PyObject *__pyx_n_s_CNF_minimize_lingeling;
   PyObject *__pyx_kp_u_CNF_must_not_contain_xor_clauses;
   PyObject *__pyx_kp_u_CNF_over;
   PyObject *__pyx_n_s_CNF_solve_dimacs;
   PyObject *__pyx_n_s_CNF_to_dimacs;
   PyObject *__pyx_n_s_CNF_to_espresso;
   PyObject *__pyx_n_s_CNF_to_truthtable;
-  PyObject *__pyx_n_s_CNF_translate;
   PyObject *__pyx_n_s_CalledProcessError;
   PyObject *__pyx_kp_s_Can_only_create_a_buffer_that_is;
   PyObject *__pyx_kp_s_Cannot_assign_to_read_only_memor;
   PyObject *__pyx_kp_s_Cannot_create_writable_memory_vi;
   PyObject *__pyx_kp_u_Cannot_index_with_type;
   PyObject *__pyx_kp_s_Cannot_transpose_memoryview_with;
   PyObject *__pyx_n_s_Clause;
@@ -4756,14 +4756,15 @@
   PyObject *__pyx_n_s_ClauseList_add_clause;
   PyObject *__pyx_n_s_ClauseList_add_clauses;
   PyObject *__pyx_n_s_ClauseList_clear;
   PyObject *__pyx_n_s_ClauseList_count;
   PyObject *__pyx_n_s_ClauseList_get_vars;
   PyObject *__pyx_n_s_ClauseList_index;
   PyObject *__pyx_n_s_ClauseList_partition;
+  PyObject *__pyx_n_s_ClauseList_translate;
   PyObject *__pyx_n_s_Clause___reduce_cython;
   PyObject *__pyx_n_s_Clause___setstate_cython;
   PyObject *__pyx_n_s_DEVNULL;
   PyObject *__pyx_kp_s_Dimension_d_is_not_direct;
   PyObject *__pyx_kp_u_Dverify;
   PyObject *__pyx_n_s_Ellipsis;
   PyObject *__pyx_kp_s_Empty_shape_tuple_for_cython_arr;
@@ -4791,14 +4792,15 @@
   PyObject *__pyx_kp_s_Optional_np_ndarray;
   PyObject *__pyx_kp_u_Out_of_bounds_on_buffer_access_a;
   PyObject *__pyx_n_s_PIPE;
   PyObject *__pyx_n_s_PickleError;
   PyObject *__pyx_n_s_Popen;
   PyObject *__pyx_kp_u_Returns_all_unit_clauses_in_the;
   PyObject *__pyx_n_u_SATISFIABLE;
+  PyObject *__pyx_n_s_Self;
   PyObject *__pyx_n_s_Sequence;
   PyObject *__pyx_kp_s_Step_may_not_be_zero_axis_d;
   PyObject *__pyx_n_s_StringIO;
   PyObject *__pyx_kp_b_T;
   PyObject *__pyx_kp_u_T_2;
   PyObject *__pyx_n_u_Truthtable;
   PyObject *__pyx_n_s_Truthtable_2;
@@ -4831,25 +4833,25 @@
   PyObject *__pyx_n_s_XorClause;
   PyObject *__pyx_n_u_XorClause;
   PyObject *__pyx_n_s_XorClauseList;
   PyObject *__pyx_n_s_XorClause___reduce_cython;
   PyObject *__pyx_n_s_XorClause___setstate_cython;
   PyObject *__pyx_kp_b__10;
   PyObject *__pyx_kp_u__10;
-  PyObject *__pyx_n_s__107;
+  PyObject *__pyx_n_s__109;
   PyObject *__pyx_kp_b__11;
   PyObject *__pyx_kp_b__12;
   PyObject *__pyx_kp_u__13;
   PyObject *__pyx_kp_u__14;
   PyObject *__pyx_n_s__181;
   PyObject *__pyx_kp_u__19;
   PyObject *__pyx_kp_u__2;
   PyObject *__pyx_n_s__3;
-  PyObject *__pyx_kp_u__32;
-  PyObject *__pyx_kp_u__33;
+  PyObject *__pyx_kp_u__34;
+  PyObject *__pyx_kp_u__35;
   PyObject *__pyx_kp_u__59;
   PyObject *__pyx_kp_u__6;
   PyObject *__pyx_kp_u__7;
   PyObject *__pyx_kp_b__9;
   PyObject *__pyx_n_s_a;
   PyObject *__pyx_n_s_abc;
   PyObject *__pyx_n_s_add_clause;
@@ -5237,42 +5239,42 @@
   PyObject *__pyx_int_136945605;
   PyObject *__pyx_int_136983863;
   PyObject *__pyx_int_176425246;
   PyObject *__pyx_int_184977713;
   PyObject *__pyx_int_194912966;
   PyObject *__pyx_int_200065077;
   PyObject *__pyx_int_neg_1;
-  PyObject *__pyx_k__34;
   PyObject *__pyx_k__36;
+  PyObject *__pyx_k__38;
   PyObject *__pyx_k__50;
   PyObject *__pyx_k__56;
   PyObject *__pyx_k__61;
   PyObject *__pyx_slice__5;
   PyObject *__pyx_tuple__4;
   PyObject *__pyx_tuple__8;
-  PyObject *__pyx_slice__38;
+  PyObject *__pyx_slice__40;
   PyObject *__pyx_slice__46;
   PyObject *__pyx_tuple__15;
   PyObject *__pyx_tuple__16;
   PyObject *__pyx_tuple__17;
   PyObject *__pyx_tuple__20;
   PyObject *__pyx_tuple__21;
   PyObject *__pyx_tuple__22;
   PyObject *__pyx_tuple__23;
   PyObject *__pyx_tuple__24;
+  PyObject *__pyx_tuple__25;
   PyObject *__pyx_tuple__26;
-  PyObject *__pyx_tuple__27;
   PyObject *__pyx_tuple__28;
   PyObject *__pyx_tuple__29;
   PyObject *__pyx_tuple__30;
   PyObject *__pyx_tuple__31;
-  PyObject *__pyx_tuple__35;
+  PyObject *__pyx_tuple__32;
+  PyObject *__pyx_tuple__33;
   PyObject *__pyx_tuple__37;
   PyObject *__pyx_tuple__39;
-  PyObject *__pyx_tuple__40;
   PyObject *__pyx_tuple__41;
   PyObject *__pyx_tuple__42;
   PyObject *__pyx_tuple__43;
   PyObject *__pyx_tuple__44;
   PyObject *__pyx_tuple__45;
   PyObject *__pyx_tuple__47;
   PyObject *__pyx_tuple__48;
@@ -5305,33 +5307,33 @@
   PyObject *__pyx_tuple__85;
   PyObject *__pyx_tuple__91;
   PyObject *__pyx_tuple__94;
   PyObject *__pyx_tuple__96;
   PyObject *__pyx_tuple__98;
   PyObject *__pyx_tuple__100;
   PyObject *__pyx_tuple__102;
-  PyObject *__pyx_tuple__105;
-  PyObject *__pyx_tuple__108;
+  PyObject *__pyx_tuple__104;
+  PyObject *__pyx_tuple__107;
   PyObject *__pyx_tuple__110;
   PyObject *__pyx_tuple__112;
   PyObject *__pyx_tuple__114;
   PyObject *__pyx_tuple__116;
   PyObject *__pyx_tuple__118;
   PyObject *__pyx_tuple__120;
   PyObject *__pyx_tuple__122;
   PyObject *__pyx_tuple__124;
   PyObject *__pyx_tuple__126;
   PyObject *__pyx_tuple__128;
   PyObject *__pyx_tuple__130;
-  PyObject *__pyx_tuple__131;
+  PyObject *__pyx_tuple__132;
   PyObject *__pyx_tuple__133;
   PyObject *__pyx_tuple__135;
   PyObject *__pyx_tuple__137;
   PyObject *__pyx_tuple__139;
-  PyObject *__pyx_tuple__140;
+  PyObject *__pyx_tuple__141;
   PyObject *__pyx_tuple__142;
   PyObject *__pyx_tuple__144;
   PyObject *__pyx_tuple__146;
   PyObject *__pyx_tuple__148;
   PyObject *__pyx_tuple__150;
   PyObject *__pyx_tuple__153;
   PyObject *__pyx_tuple__155;
@@ -5341,15 +5343,15 @@
   PyObject *__pyx_tuple__165;
   PyObject *__pyx_tuple__167;
   PyObject *__pyx_tuple__169;
   PyObject *__pyx_tuple__170;
   PyObject *__pyx_tuple__172;
   PyObject *__pyx_tuple__173;
   PyObject *__pyx_codeobj__18;
-  PyObject *__pyx_codeobj__25;
+  PyObject *__pyx_codeobj__27;
   PyObject *__pyx_codeobj__58;
   PyObject *__pyx_codeobj__74;
   PyObject *__pyx_codeobj__76;
   PyObject *__pyx_codeobj__79;
   PyObject *__pyx_codeobj__81;
   PyObject *__pyx_codeobj__84;
   PyObject *__pyx_codeobj__86;
@@ -5360,32 +5362,32 @@
   PyObject *__pyx_codeobj__92;
   PyObject *__pyx_codeobj__93;
   PyObject *__pyx_codeobj__95;
   PyObject *__pyx_codeobj__97;
   PyObject *__pyx_codeobj__99;
   PyObject *__pyx_codeobj__101;
   PyObject *__pyx_codeobj__103;
-  PyObject *__pyx_codeobj__104;
+  PyObject *__pyx_codeobj__105;
   PyObject *__pyx_codeobj__106;
-  PyObject *__pyx_codeobj__109;
+  PyObject *__pyx_codeobj__108;
   PyObject *__pyx_codeobj__111;
   PyObject *__pyx_codeobj__113;
   PyObject *__pyx_codeobj__115;
   PyObject *__pyx_codeobj__117;
   PyObject *__pyx_codeobj__119;
   PyObject *__pyx_codeobj__121;
   PyObject *__pyx_codeobj__123;
   PyObject *__pyx_codeobj__125;
   PyObject *__pyx_codeobj__127;
   PyObject *__pyx_codeobj__129;
-  PyObject *__pyx_codeobj__132;
+  PyObject *__pyx_codeobj__131;
   PyObject *__pyx_codeobj__134;
   PyObject *__pyx_codeobj__136;
   PyObject *__pyx_codeobj__138;
-  PyObject *__pyx_codeobj__141;
+  PyObject *__pyx_codeobj__140;
   PyObject *__pyx_codeobj__143;
   PyObject *__pyx_codeobj__145;
   PyObject *__pyx_codeobj__147;
   PyObject *__pyx_codeobj__149;
   PyObject *__pyx_codeobj__151;
   PyObject *__pyx_codeobj__152;
   PyObject *__pyx_codeobj__154;
@@ -5508,27 +5510,26 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_create_all_equal);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_create_all_zero);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_create_xor);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_equiv);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_from_dimacs);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_from_espresso);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_get_units);
-  Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_get_units_line_974);
+  Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_get_units_line_1009);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_implied_by);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_logical_or);
-  Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_logical_or_line_911);
+  Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_logical_or_line_946);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_minimize_espresso);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_minimize_lingeling);
   Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_must_not_contain_xor_clauses);
   Py_CLEAR(clear_module_state->__pyx_kp_u_CNF_over);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_solve_dimacs);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_to_dimacs);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_to_espresso);
   Py_CLEAR(clear_module_state->__pyx_n_s_CNF_to_truthtable);
-  Py_CLEAR(clear_module_state->__pyx_n_s_CNF_translate);
   Py_CLEAR(clear_module_state->__pyx_n_s_CalledProcessError);
   Py_CLEAR(clear_module_state->__pyx_kp_s_Can_only_create_a_buffer_that_is);
   Py_CLEAR(clear_module_state->__pyx_kp_s_Cannot_assign_to_read_only_memor);
   Py_CLEAR(clear_module_state->__pyx_kp_s_Cannot_create_writable_memory_vi);
   Py_CLEAR(clear_module_state->__pyx_kp_u_Cannot_index_with_type);
   Py_CLEAR(clear_module_state->__pyx_kp_s_Cannot_transpose_memoryview_with);
   Py_CLEAR(clear_module_state->__pyx_n_s_Clause);
@@ -5540,14 +5541,15 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_ClauseList_add_clause);
   Py_CLEAR(clear_module_state->__pyx_n_s_ClauseList_add_clauses);
   Py_CLEAR(clear_module_state->__pyx_n_s_ClauseList_clear);
   Py_CLEAR(clear_module_state->__pyx_n_s_ClauseList_count);
   Py_CLEAR(clear_module_state->__pyx_n_s_ClauseList_get_vars);
   Py_CLEAR(clear_module_state->__pyx_n_s_ClauseList_index);
   Py_CLEAR(clear_module_state->__pyx_n_s_ClauseList_partition);
+  Py_CLEAR(clear_module_state->__pyx_n_s_ClauseList_translate);
   Py_CLEAR(clear_module_state->__pyx_n_s_Clause___reduce_cython);
   Py_CLEAR(clear_module_state->__pyx_n_s_Clause___setstate_cython);
   Py_CLEAR(clear_module_state->__pyx_n_s_DEVNULL);
   Py_CLEAR(clear_module_state->__pyx_kp_s_Dimension_d_is_not_direct);
   Py_CLEAR(clear_module_state->__pyx_kp_u_Dverify);
   Py_CLEAR(clear_module_state->__pyx_n_s_Ellipsis);
   Py_CLEAR(clear_module_state->__pyx_kp_s_Empty_shape_tuple_for_cython_arr);
@@ -5575,14 +5577,15 @@
   Py_CLEAR(clear_module_state->__pyx_kp_s_Optional_np_ndarray);
   Py_CLEAR(clear_module_state->__pyx_kp_u_Out_of_bounds_on_buffer_access_a);
   Py_CLEAR(clear_module_state->__pyx_n_s_PIPE);
   Py_CLEAR(clear_module_state->__pyx_n_s_PickleError);
   Py_CLEAR(clear_module_state->__pyx_n_s_Popen);
   Py_CLEAR(clear_module_state->__pyx_kp_u_Returns_all_unit_clauses_in_the);
   Py_CLEAR(clear_module_state->__pyx_n_u_SATISFIABLE);
+  Py_CLEAR(clear_module_state->__pyx_n_s_Self);
   Py_CLEAR(clear_module_state->__pyx_n_s_Sequence);
   Py_CLEAR(clear_module_state->__pyx_kp_s_Step_may_not_be_zero_axis_d);
   Py_CLEAR(clear_module_state->__pyx_n_s_StringIO);
   Py_CLEAR(clear_module_state->__pyx_kp_b_T);
   Py_CLEAR(clear_module_state->__pyx_kp_u_T_2);
   Py_CLEAR(clear_module_state->__pyx_n_u_Truthtable);
   Py_CLEAR(clear_module_state->__pyx_n_s_Truthtable_2);
@@ -5615,25 +5618,25 @@
   Py_CLEAR(clear_module_state->__pyx_n_s_XorClause);
   Py_CLEAR(clear_module_state->__pyx_n_u_XorClause);
   Py_CLEAR(clear_module_state->__pyx_n_s_XorClauseList);
   Py_CLEAR(clear_module_state->__pyx_n_s_XorClause___reduce_cython);
   Py_CLEAR(clear_module_state->__pyx_n_s_XorClause___setstate_cython);
   Py_CLEAR(clear_module_state->__pyx_kp_b__10);
   Py_CLEAR(clear_module_state->__pyx_kp_u__10);
-  Py_CLEAR(clear_module_state->__pyx_n_s__107);
+  Py_CLEAR(clear_module_state->__pyx_n_s__109);
   Py_CLEAR(clear_module_state->__pyx_kp_b__11);
   Py_CLEAR(clear_module_state->__pyx_kp_b__12);
   Py_CLEAR(clear_module_state->__pyx_kp_u__13);
   Py_CLEAR(clear_module_state->__pyx_kp_u__14);
   Py_CLEAR(clear_module_state->__pyx_n_s__181);
   Py_CLEAR(clear_module_state->__pyx_kp_u__19);
   Py_CLEAR(clear_module_state->__pyx_kp_u__2);
   Py_CLEAR(clear_module_state->__pyx_n_s__3);
-  Py_CLEAR(clear_module_state->__pyx_kp_u__32);
-  Py_CLEAR(clear_module_state->__pyx_kp_u__33);
+  Py_CLEAR(clear_module_state->__pyx_kp_u__34);
+  Py_CLEAR(clear_module_state->__pyx_kp_u__35);
   Py_CLEAR(clear_module_state->__pyx_kp_u__59);
   Py_CLEAR(clear_module_state->__pyx_kp_u__6);
   Py_CLEAR(clear_module_state->__pyx_kp_u__7);
   Py_CLEAR(clear_module_state->__pyx_kp_b__9);
   Py_CLEAR(clear_module_state->__pyx_n_s_a);
   Py_CLEAR(clear_module_state->__pyx_n_s_abc);
   Py_CLEAR(clear_module_state->__pyx_n_s_add_clause);
@@ -6021,42 +6024,42 @@
   Py_CLEAR(clear_module_state->__pyx_int_136945605);
   Py_CLEAR(clear_module_state->__pyx_int_136983863);
   Py_CLEAR(clear_module_state->__pyx_int_176425246);
   Py_CLEAR(clear_module_state->__pyx_int_184977713);
   Py_CLEAR(clear_module_state->__pyx_int_194912966);
   Py_CLEAR(clear_module_state->__pyx_int_200065077);
   Py_CLEAR(clear_module_state->__pyx_int_neg_1);
-  Py_CLEAR(clear_module_state->__pyx_k__34);
   Py_CLEAR(clear_module_state->__pyx_k__36);
+  Py_CLEAR(clear_module_state->__pyx_k__38);
   Py_CLEAR(clear_module_state->__pyx_k__50);
   Py_CLEAR(clear_module_state->__pyx_k__56);
   Py_CLEAR(clear_module_state->__pyx_k__61);
   Py_CLEAR(clear_module_state->__pyx_slice__5);
   Py_CLEAR(clear_module_state->__pyx_tuple__4);
   Py_CLEAR(clear_module_state->__pyx_tuple__8);
-  Py_CLEAR(clear_module_state->__pyx_slice__38);
+  Py_CLEAR(clear_module_state->__pyx_slice__40);
   Py_CLEAR(clear_module_state->__pyx_slice__46);
   Py_CLEAR(clear_module_state->__pyx_tuple__15);
   Py_CLEAR(clear_module_state->__pyx_tuple__16);
   Py_CLEAR(clear_module_state->__pyx_tuple__17);
   Py_CLEAR(clear_module_state->__pyx_tuple__20);
   Py_CLEAR(clear_module_state->__pyx_tuple__21);
   Py_CLEAR(clear_module_state->__pyx_tuple__22);
   Py_CLEAR(clear_module_state->__pyx_tuple__23);
   Py_CLEAR(clear_module_state->__pyx_tuple__24);
+  Py_CLEAR(clear_module_state->__pyx_tuple__25);
   Py_CLEAR(clear_module_state->__pyx_tuple__26);
-  Py_CLEAR(clear_module_state->__pyx_tuple__27);
   Py_CLEAR(clear_module_state->__pyx_tuple__28);
   Py_CLEAR(clear_module_state->__pyx_tuple__29);
   Py_CLEAR(clear_module_state->__pyx_tuple__30);
   Py_CLEAR(clear_module_state->__pyx_tuple__31);
-  Py_CLEAR(clear_module_state->__pyx_tuple__35);
+  Py_CLEAR(clear_module_state->__pyx_tuple__32);
+  Py_CLEAR(clear_module_state->__pyx_tuple__33);
   Py_CLEAR(clear_module_state->__pyx_tuple__37);
   Py_CLEAR(clear_module_state->__pyx_tuple__39);
-  Py_CLEAR(clear_module_state->__pyx_tuple__40);
   Py_CLEAR(clear_module_state->__pyx_tuple__41);
   Py_CLEAR(clear_module_state->__pyx_tuple__42);
   Py_CLEAR(clear_module_state->__pyx_tuple__43);
   Py_CLEAR(clear_module_state->__pyx_tuple__44);
   Py_CLEAR(clear_module_state->__pyx_tuple__45);
   Py_CLEAR(clear_module_state->__pyx_tuple__47);
   Py_CLEAR(clear_module_state->__pyx_tuple__48);
@@ -6089,33 +6092,33 @@
   Py_CLEAR(clear_module_state->__pyx_tuple__85);
   Py_CLEAR(clear_module_state->__pyx_tuple__91);
   Py_CLEAR(clear_module_state->__pyx_tuple__94);
   Py_CLEAR(clear_module_state->__pyx_tuple__96);
   Py_CLEAR(clear_module_state->__pyx_tuple__98);
   Py_CLEAR(clear_module_state->__pyx_tuple__100);
   Py_CLEAR(clear_module_state->__pyx_tuple__102);
-  Py_CLEAR(clear_module_state->__pyx_tuple__105);
-  Py_CLEAR(clear_module_state->__pyx_tuple__108);
+  Py_CLEAR(clear_module_state->__pyx_tuple__104);
+  Py_CLEAR(clear_module_state->__pyx_tuple__107);
   Py_CLEAR(clear_module_state->__pyx_tuple__110);
   Py_CLEAR(clear_module_state->__pyx_tuple__112);
   Py_CLEAR(clear_module_state->__pyx_tuple__114);
   Py_CLEAR(clear_module_state->__pyx_tuple__116);
   Py_CLEAR(clear_module_state->__pyx_tuple__118);
   Py_CLEAR(clear_module_state->__pyx_tuple__120);
   Py_CLEAR(clear_module_state->__pyx_tuple__122);
   Py_CLEAR(clear_module_state->__pyx_tuple__124);
   Py_CLEAR(clear_module_state->__pyx_tuple__126);
   Py_CLEAR(clear_module_state->__pyx_tuple__128);
   Py_CLEAR(clear_module_state->__pyx_tuple__130);
-  Py_CLEAR(clear_module_state->__pyx_tuple__131);
+  Py_CLEAR(clear_module_state->__pyx_tuple__132);
   Py_CLEAR(clear_module_state->__pyx_tuple__133);
   Py_CLEAR(clear_module_state->__pyx_tuple__135);
   Py_CLEAR(clear_module_state->__pyx_tuple__137);
   Py_CLEAR(clear_module_state->__pyx_tuple__139);
-  Py_CLEAR(clear_module_state->__pyx_tuple__140);
+  Py_CLEAR(clear_module_state->__pyx_tuple__141);
   Py_CLEAR(clear_module_state->__pyx_tuple__142);
   Py_CLEAR(clear_module_state->__pyx_tuple__144);
   Py_CLEAR(clear_module_state->__pyx_tuple__146);
   Py_CLEAR(clear_module_state->__pyx_tuple__148);
   Py_CLEAR(clear_module_state->__pyx_tuple__150);
   Py_CLEAR(clear_module_state->__pyx_tuple__153);
   Py_CLEAR(clear_module_state->__pyx_tuple__155);
@@ -6125,15 +6128,15 @@
   Py_CLEAR(clear_module_state->__pyx_tuple__165);
   Py_CLEAR(clear_module_state->__pyx_tuple__167);
   Py_CLEAR(clear_module_state->__pyx_tuple__169);
   Py_CLEAR(clear_module_state->__pyx_tuple__170);
   Py_CLEAR(clear_module_state->__pyx_tuple__172);
   Py_CLEAR(clear_module_state->__pyx_tuple__173);
   Py_CLEAR(clear_module_state->__pyx_codeobj__18);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__25);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__27);
   Py_CLEAR(clear_module_state->__pyx_codeobj__58);
   Py_CLEAR(clear_module_state->__pyx_codeobj__74);
   Py_CLEAR(clear_module_state->__pyx_codeobj__76);
   Py_CLEAR(clear_module_state->__pyx_codeobj__79);
   Py_CLEAR(clear_module_state->__pyx_codeobj__81);
   Py_CLEAR(clear_module_state->__pyx_codeobj__84);
   Py_CLEAR(clear_module_state->__pyx_codeobj__86);
@@ -6144,32 +6147,32 @@
   Py_CLEAR(clear_module_state->__pyx_codeobj__92);
   Py_CLEAR(clear_module_state->__pyx_codeobj__93);
   Py_CLEAR(clear_module_state->__pyx_codeobj__95);
   Py_CLEAR(clear_module_state->__pyx_codeobj__97);
   Py_CLEAR(clear_module_state->__pyx_codeobj__99);
   Py_CLEAR(clear_module_state->__pyx_codeobj__101);
   Py_CLEAR(clear_module_state->__pyx_codeobj__103);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__104);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__105);
   Py_CLEAR(clear_module_state->__pyx_codeobj__106);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__109);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__108);
   Py_CLEAR(clear_module_state->__pyx_codeobj__111);
   Py_CLEAR(clear_module_state->__pyx_codeobj__113);
   Py_CLEAR(clear_module_state->__pyx_codeobj__115);
   Py_CLEAR(clear_module_state->__pyx_codeobj__117);
   Py_CLEAR(clear_module_state->__pyx_codeobj__119);
   Py_CLEAR(clear_module_state->__pyx_codeobj__121);
   Py_CLEAR(clear_module_state->__pyx_codeobj__123);
   Py_CLEAR(clear_module_state->__pyx_codeobj__125);
   Py_CLEAR(clear_module_state->__pyx_codeobj__127);
   Py_CLEAR(clear_module_state->__pyx_codeobj__129);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__132);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__131);
   Py_CLEAR(clear_module_state->__pyx_codeobj__134);
   Py_CLEAR(clear_module_state->__pyx_codeobj__136);
   Py_CLEAR(clear_module_state->__pyx_codeobj__138);
-  Py_CLEAR(clear_module_state->__pyx_codeobj__141);
+  Py_CLEAR(clear_module_state->__pyx_codeobj__140);
   Py_CLEAR(clear_module_state->__pyx_codeobj__143);
   Py_CLEAR(clear_module_state->__pyx_codeobj__145);
   Py_CLEAR(clear_module_state->__pyx_codeobj__147);
   Py_CLEAR(clear_module_state->__pyx_codeobj__149);
   Py_CLEAR(clear_module_state->__pyx_codeobj__151);
   Py_CLEAR(clear_module_state->__pyx_codeobj__152);
   Py_CLEAR(clear_module_state->__pyx_codeobj__154);
@@ -6270,27 +6273,26 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_create_all_equal);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_create_all_zero);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_create_xor);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_equiv);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_from_dimacs);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_from_espresso);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_get_units);
-  Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_get_units_line_974);
+  Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_get_units_line_1009);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_implied_by);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_logical_or);
-  Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_logical_or_line_911);
+  Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_logical_or_line_946);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_minimize_espresso);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_minimize_lingeling);
   Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_must_not_contain_xor_clauses);
   Py_VISIT(traverse_module_state->__pyx_kp_u_CNF_over);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_solve_dimacs);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_to_dimacs);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_to_espresso);
   Py_VISIT(traverse_module_state->__pyx_n_s_CNF_to_truthtable);
-  Py_VISIT(traverse_module_state->__pyx_n_s_CNF_translate);
   Py_VISIT(traverse_module_state->__pyx_n_s_CalledProcessError);
   Py_VISIT(traverse_module_state->__pyx_kp_s_Can_only_create_a_buffer_that_is);
   Py_VISIT(traverse_module_state->__pyx_kp_s_Cannot_assign_to_read_only_memor);
   Py_VISIT(traverse_module_state->__pyx_kp_s_Cannot_create_writable_memory_vi);
   Py_VISIT(traverse_module_state->__pyx_kp_u_Cannot_index_with_type);
   Py_VISIT(traverse_module_state->__pyx_kp_s_Cannot_transpose_memoryview_with);
   Py_VISIT(traverse_module_state->__pyx_n_s_Clause);
@@ -6302,14 +6304,15 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_ClauseList_add_clause);
   Py_VISIT(traverse_module_state->__pyx_n_s_ClauseList_add_clauses);
   Py_VISIT(traverse_module_state->__pyx_n_s_ClauseList_clear);
   Py_VISIT(traverse_module_state->__pyx_n_s_ClauseList_count);
   Py_VISIT(traverse_module_state->__pyx_n_s_ClauseList_get_vars);
   Py_VISIT(traverse_module_state->__pyx_n_s_ClauseList_index);
   Py_VISIT(traverse_module_state->__pyx_n_s_ClauseList_partition);
+  Py_VISIT(traverse_module_state->__pyx_n_s_ClauseList_translate);
   Py_VISIT(traverse_module_state->__pyx_n_s_Clause___reduce_cython);
   Py_VISIT(traverse_module_state->__pyx_n_s_Clause___setstate_cython);
   Py_VISIT(traverse_module_state->__pyx_n_s_DEVNULL);
   Py_VISIT(traverse_module_state->__pyx_kp_s_Dimension_d_is_not_direct);
   Py_VISIT(traverse_module_state->__pyx_kp_u_Dverify);
   Py_VISIT(traverse_module_state->__pyx_n_s_Ellipsis);
   Py_VISIT(traverse_module_state->__pyx_kp_s_Empty_shape_tuple_for_cython_arr);
@@ -6337,14 +6340,15 @@
   Py_VISIT(traverse_module_state->__pyx_kp_s_Optional_np_ndarray);
   Py_VISIT(traverse_module_state->__pyx_kp_u_Out_of_bounds_on_buffer_access_a);
   Py_VISIT(traverse_module_state->__pyx_n_s_PIPE);
   Py_VISIT(traverse_module_state->__pyx_n_s_PickleError);
   Py_VISIT(traverse_module_state->__pyx_n_s_Popen);
   Py_VISIT(traverse_module_state->__pyx_kp_u_Returns_all_unit_clauses_in_the);
   Py_VISIT(traverse_module_state->__pyx_n_u_SATISFIABLE);
+  Py_VISIT(traverse_module_state->__pyx_n_s_Self);
   Py_VISIT(traverse_module_state->__pyx_n_s_Sequence);
   Py_VISIT(traverse_module_state->__pyx_kp_s_Step_may_not_be_zero_axis_d);
   Py_VISIT(traverse_module_state->__pyx_n_s_StringIO);
   Py_VISIT(traverse_module_state->__pyx_kp_b_T);
   Py_VISIT(traverse_module_state->__pyx_kp_u_T_2);
   Py_VISIT(traverse_module_state->__pyx_n_u_Truthtable);
   Py_VISIT(traverse_module_state->__pyx_n_s_Truthtable_2);
@@ -6377,25 +6381,25 @@
   Py_VISIT(traverse_module_state->__pyx_n_s_XorClause);
   Py_VISIT(traverse_module_state->__pyx_n_u_XorClause);
   Py_VISIT(traverse_module_state->__pyx_n_s_XorClauseList);
   Py_VISIT(traverse_module_state->__pyx_n_s_XorClause___reduce_cython);
   Py_VISIT(traverse_module_state->__pyx_n_s_XorClause___setstate_cython);
   Py_VISIT(traverse_module_state->__pyx_kp_b__10);
   Py_VISIT(traverse_module_state->__pyx_kp_u__10);
-  Py_VISIT(traverse_module_state->__pyx_n_s__107);
+  Py_VISIT(traverse_module_state->__pyx_n_s__109);
   Py_VISIT(traverse_module_state->__pyx_kp_b__11);
   Py_VISIT(traverse_module_state->__pyx_kp_b__12);
   Py_VISIT(traverse_module_state->__pyx_kp_u__13);
   Py_VISIT(traverse_module_state->__pyx_kp_u__14);
   Py_VISIT(traverse_module_state->__pyx_n_s__181);
   Py_VISIT(traverse_module_state->__pyx_kp_u__19);
   Py_VISIT(traverse_module_state->__pyx_kp_u__2);
   Py_VISIT(traverse_module_state->__pyx_n_s__3);
-  Py_VISIT(traverse_module_state->__pyx_kp_u__32);
-  Py_VISIT(traverse_module_state->__pyx_kp_u__33);
+  Py_VISIT(traverse_module_state->__pyx_kp_u__34);
+  Py_VISIT(traverse_module_state->__pyx_kp_u__35);
   Py_VISIT(traverse_module_state->__pyx_kp_u__59);
   Py_VISIT(traverse_module_state->__pyx_kp_u__6);
   Py_VISIT(traverse_module_state->__pyx_kp_u__7);
   Py_VISIT(traverse_module_state->__pyx_kp_b__9);
   Py_VISIT(traverse_module_state->__pyx_n_s_a);
   Py_VISIT(traverse_module_state->__pyx_n_s_abc);
   Py_VISIT(traverse_module_state->__pyx_n_s_add_clause);
@@ -6783,42 +6787,42 @@
   Py_VISIT(traverse_module_state->__pyx_int_136945605);
   Py_VISIT(traverse_module_state->__pyx_int_136983863);
   Py_VISIT(traverse_module_state->__pyx_int_176425246);
   Py_VISIT(traverse_module_state->__pyx_int_184977713);
   Py_VISIT(traverse_module_state->__pyx_int_194912966);
   Py_VISIT(traverse_module_state->__pyx_int_200065077);
   Py_VISIT(traverse_module_state->__pyx_int_neg_1);
-  Py_VISIT(traverse_module_state->__pyx_k__34);
   Py_VISIT(traverse_module_state->__pyx_k__36);
+  Py_VISIT(traverse_module_state->__pyx_k__38);
   Py_VISIT(traverse_module_state->__pyx_k__50);
   Py_VISIT(traverse_module_state->__pyx_k__56);
   Py_VISIT(traverse_module_state->__pyx_k__61);
   Py_VISIT(traverse_module_state->__pyx_slice__5);
   Py_VISIT(traverse_module_state->__pyx_tuple__4);
   Py_VISIT(traverse_module_state->__pyx_tuple__8);
-  Py_VISIT(traverse_module_state->__pyx_slice__38);
+  Py_VISIT(traverse_module_state->__pyx_slice__40);
   Py_VISIT(traverse_module_state->__pyx_slice__46);
   Py_VISIT(traverse_module_state->__pyx_tuple__15);
   Py_VISIT(traverse_module_state->__pyx_tuple__16);
   Py_VISIT(traverse_module_state->__pyx_tuple__17);
   Py_VISIT(traverse_module_state->__pyx_tuple__20);
   Py_VISIT(traverse_module_state->__pyx_tuple__21);
   Py_VISIT(traverse_module_state->__pyx_tuple__22);
   Py_VISIT(traverse_module_state->__pyx_tuple__23);
   Py_VISIT(traverse_module_state->__pyx_tuple__24);
+  Py_VISIT(traverse_module_state->__pyx_tuple__25);
   Py_VISIT(traverse_module_state->__pyx_tuple__26);
-  Py_VISIT(traverse_module_state->__pyx_tuple__27);
   Py_VISIT(traverse_module_state->__pyx_tuple__28);
   Py_VISIT(traverse_module_state->__pyx_tuple__29);
   Py_VISIT(traverse_module_state->__pyx_tuple__30);
   Py_VISIT(traverse_module_state->__pyx_tuple__31);
-  Py_VISIT(traverse_module_state->__pyx_tuple__35);
+  Py_VISIT(traverse_module_state->__pyx_tuple__32);
+  Py_VISIT(traverse_module_state->__pyx_tuple__33);
   Py_VISIT(traverse_module_state->__pyx_tuple__37);
   Py_VISIT(traverse_module_state->__pyx_tuple__39);
-  Py_VISIT(traverse_module_state->__pyx_tuple__40);
   Py_VISIT(traverse_module_state->__pyx_tuple__41);
   Py_VISIT(traverse_module_state->__pyx_tuple__42);
   Py_VISIT(traverse_module_state->__pyx_tuple__43);
   Py_VISIT(traverse_module_state->__pyx_tuple__44);
   Py_VISIT(traverse_module_state->__pyx_tuple__45);
   Py_VISIT(traverse_module_state->__pyx_tuple__47);
   Py_VISIT(traverse_module_state->__pyx_tuple__48);
@@ -6851,33 +6855,33 @@
   Py_VISIT(traverse_module_state->__pyx_tuple__85);
   Py_VISIT(traverse_module_state->__pyx_tuple__91);
   Py_VISIT(traverse_module_state->__pyx_tuple__94);
   Py_VISIT(traverse_module_state->__pyx_tuple__96);
   Py_VISIT(traverse_module_state->__pyx_tuple__98);
   Py_VISIT(traverse_module_state->__pyx_tuple__100);
   Py_VISIT(traverse_module_state->__pyx_tuple__102);
-  Py_VISIT(traverse_module_state->__pyx_tuple__105);
-  Py_VISIT(traverse_module_state->__pyx_tuple__108);
+  Py_VISIT(traverse_module_state->__pyx_tuple__104);
+  Py_VISIT(traverse_module_state->__pyx_tuple__107);
   Py_VISIT(traverse_module_state->__pyx_tuple__110);
   Py_VISIT(traverse_module_state->__pyx_tuple__112);
   Py_VISIT(traverse_module_state->__pyx_tuple__114);
   Py_VISIT(traverse_module_state->__pyx_tuple__116);
   Py_VISIT(traverse_module_state->__pyx_tuple__118);
   Py_VISIT(traverse_module_state->__pyx_tuple__120);
   Py_VISIT(traverse_module_state->__pyx_tuple__122);
   Py_VISIT(traverse_module_state->__pyx_tuple__124);
   Py_VISIT(traverse_module_state->__pyx_tuple__126);
   Py_VISIT(traverse_module_state->__pyx_tuple__128);
   Py_VISIT(traverse_module_state->__pyx_tuple__130);
-  Py_VISIT(traverse_module_state->__pyx_tuple__131);
+  Py_VISIT(traverse_module_state->__pyx_tuple__132);
   Py_VISIT(traverse_module_state->__pyx_tuple__133);
   Py_VISIT(traverse_module_state->__pyx_tuple__135);
   Py_VISIT(traverse_module_state->__pyx_tuple__137);
   Py_VISIT(traverse_module_state->__pyx_tuple__139);
-  Py_VISIT(traverse_module_state->__pyx_tuple__140);
+  Py_VISIT(traverse_module_state->__pyx_tuple__141);
   Py_VISIT(traverse_module_state->__pyx_tuple__142);
   Py_VISIT(traverse_module_state->__pyx_tuple__144);
   Py_VISIT(traverse_module_state->__pyx_tuple__146);
   Py_VISIT(traverse_module_state->__pyx_tuple__148);
   Py_VISIT(traverse_module_state->__pyx_tuple__150);
   Py_VISIT(traverse_module_state->__pyx_tuple__153);
   Py_VISIT(traverse_module_state->__pyx_tuple__155);
@@ -6887,15 +6891,15 @@
   Py_VISIT(traverse_module_state->__pyx_tuple__165);
   Py_VISIT(traverse_module_state->__pyx_tuple__167);
   Py_VISIT(traverse_module_state->__pyx_tuple__169);
   Py_VISIT(traverse_module_state->__pyx_tuple__170);
   Py_VISIT(traverse_module_state->__pyx_tuple__172);
   Py_VISIT(traverse_module_state->__pyx_tuple__173);
   Py_VISIT(traverse_module_state->__pyx_codeobj__18);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__25);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__27);
   Py_VISIT(traverse_module_state->__pyx_codeobj__58);
   Py_VISIT(traverse_module_state->__pyx_codeobj__74);
   Py_VISIT(traverse_module_state->__pyx_codeobj__76);
   Py_VISIT(traverse_module_state->__pyx_codeobj__79);
   Py_VISIT(traverse_module_state->__pyx_codeobj__81);
   Py_VISIT(traverse_module_state->__pyx_codeobj__84);
   Py_VISIT(traverse_module_state->__pyx_codeobj__86);
@@ -6906,32 +6910,32 @@
   Py_VISIT(traverse_module_state->__pyx_codeobj__92);
   Py_VISIT(traverse_module_state->__pyx_codeobj__93);
   Py_VISIT(traverse_module_state->__pyx_codeobj__95);
   Py_VISIT(traverse_module_state->__pyx_codeobj__97);
   Py_VISIT(traverse_module_state->__pyx_codeobj__99);
   Py_VISIT(traverse_module_state->__pyx_codeobj__101);
   Py_VISIT(traverse_module_state->__pyx_codeobj__103);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__104);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__105);
   Py_VISIT(traverse_module_state->__pyx_codeobj__106);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__109);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__108);
   Py_VISIT(traverse_module_state->__pyx_codeobj__111);
   Py_VISIT(traverse_module_state->__pyx_codeobj__113);
   Py_VISIT(traverse_module_state->__pyx_codeobj__115);
   Py_VISIT(traverse_module_state->__pyx_codeobj__117);
   Py_VISIT(traverse_module_state->__pyx_codeobj__119);
   Py_VISIT(traverse_module_state->__pyx_codeobj__121);
   Py_VISIT(traverse_module_state->__pyx_codeobj__123);
   Py_VISIT(traverse_module_state->__pyx_codeobj__125);
   Py_VISIT(traverse_module_state->__pyx_codeobj__127);
   Py_VISIT(traverse_module_state->__pyx_codeobj__129);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__132);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__131);
   Py_VISIT(traverse_module_state->__pyx_codeobj__134);
   Py_VISIT(traverse_module_state->__pyx_codeobj__136);
   Py_VISIT(traverse_module_state->__pyx_codeobj__138);
-  Py_VISIT(traverse_module_state->__pyx_codeobj__141);
+  Py_VISIT(traverse_module_state->__pyx_codeobj__140);
   Py_VISIT(traverse_module_state->__pyx_codeobj__143);
   Py_VISIT(traverse_module_state->__pyx_codeobj__145);
   Py_VISIT(traverse_module_state->__pyx_codeobj__147);
   Py_VISIT(traverse_module_state->__pyx_codeobj__149);
   Py_VISIT(traverse_module_state->__pyx_codeobj__151);
   Py_VISIT(traverse_module_state->__pyx_codeobj__152);
   Py_VISIT(traverse_module_state->__pyx_codeobj__154);
@@ -7144,27 +7148,26 @@
 #define __pyx_n_s_CNF_create_all_equal __pyx_mstate_global->__pyx_n_s_CNF_create_all_equal
 #define __pyx_n_s_CNF_create_all_zero __pyx_mstate_global->__pyx_n_s_CNF_create_all_zero
 #define __pyx_n_s_CNF_create_xor __pyx_mstate_global->__pyx_n_s_CNF_create_xor
 #define __pyx_n_s_CNF_equiv __pyx_mstate_global->__pyx_n_s_CNF_equiv
 #define __pyx_n_s_CNF_from_dimacs __pyx_mstate_global->__pyx_n_s_CNF_from_dimacs
 #define __pyx_n_s_CNF_from_espresso __pyx_mstate_global->__pyx_n_s_CNF_from_espresso
 #define __pyx_n_s_CNF_get_units __pyx_mstate_global->__pyx_n_s_CNF_get_units
-#define __pyx_kp_u_CNF_get_units_line_974 __pyx_mstate_global->__pyx_kp_u_CNF_get_units_line_974
+#define __pyx_kp_u_CNF_get_units_line_1009 __pyx_mstate_global->__pyx_kp_u_CNF_get_units_line_1009
 #define __pyx_n_s_CNF_implied_by __pyx_mstate_global->__pyx_n_s_CNF_implied_by
 #define __pyx_n_s_CNF_logical_or __pyx_mstate_global->__pyx_n_s_CNF_logical_or
-#define __pyx_kp_u_CNF_logical_or_line_911 __pyx_mstate_global->__pyx_kp_u_CNF_logical_or_line_911
+#define __pyx_kp_u_CNF_logical_or_line_946 __pyx_mstate_global->__pyx_kp_u_CNF_logical_or_line_946
 #define __pyx_n_s_CNF_minimize_espresso __pyx_mstate_global->__pyx_n_s_CNF_minimize_espresso
 #define __pyx_n_s_CNF_minimize_lingeling __pyx_mstate_global->__pyx_n_s_CNF_minimize_lingeling
 #define __pyx_kp_u_CNF_must_not_contain_xor_clauses __pyx_mstate_global->__pyx_kp_u_CNF_must_not_contain_xor_clauses
 #define __pyx_kp_u_CNF_over __pyx_mstate_global->__pyx_kp_u_CNF_over
 #define __pyx_n_s_CNF_solve_dimacs __pyx_mstate_global->__pyx_n_s_CNF_solve_dimacs
 #define __pyx_n_s_CNF_to_dimacs __pyx_mstate_global->__pyx_n_s_CNF_to_dimacs
 #define __pyx_n_s_CNF_to_espresso __pyx_mstate_global->__pyx_n_s_CNF_to_espresso
 #define __pyx_n_s_CNF_to_truthtable __pyx_mstate_global->__pyx_n_s_CNF_to_truthtable
-#define __pyx_n_s_CNF_translate __pyx_mstate_global->__pyx_n_s_CNF_translate
 #define __pyx_n_s_CalledProcessError __pyx_mstate_global->__pyx_n_s_CalledProcessError
 #define __pyx_kp_s_Can_only_create_a_buffer_that_is __pyx_mstate_global->__pyx_kp_s_Can_only_create_a_buffer_that_is
 #define __pyx_kp_s_Cannot_assign_to_read_only_memor __pyx_mstate_global->__pyx_kp_s_Cannot_assign_to_read_only_memor
 #define __pyx_kp_s_Cannot_create_writable_memory_vi __pyx_mstate_global->__pyx_kp_s_Cannot_create_writable_memory_vi
 #define __pyx_kp_u_Cannot_index_with_type __pyx_mstate_global->__pyx_kp_u_Cannot_index_with_type
 #define __pyx_kp_s_Cannot_transpose_memoryview_with __pyx_mstate_global->__pyx_kp_s_Cannot_transpose_memoryview_with
 #define __pyx_n_s_Clause __pyx_mstate_global->__pyx_n_s_Clause
@@ -7176,14 +7179,15 @@
 #define __pyx_n_s_ClauseList_add_clause __pyx_mstate_global->__pyx_n_s_ClauseList_add_clause
 #define __pyx_n_s_ClauseList_add_clauses __pyx_mstate_global->__pyx_n_s_ClauseList_add_clauses
 #define __pyx_n_s_ClauseList_clear __pyx_mstate_global->__pyx_n_s_ClauseList_clear
 #define __pyx_n_s_ClauseList_count __pyx_mstate_global->__pyx_n_s_ClauseList_count
 #define __pyx_n_s_ClauseList_get_vars __pyx_mstate_global->__pyx_n_s_ClauseList_get_vars
 #define __pyx_n_s_ClauseList_index __pyx_mstate_global->__pyx_n_s_ClauseList_index
 #define __pyx_n_s_ClauseList_partition __pyx_mstate_global->__pyx_n_s_ClauseList_partition
+#define __pyx_n_s_ClauseList_translate __pyx_mstate_global->__pyx_n_s_ClauseList_translate
 #define __pyx_n_s_Clause___reduce_cython __pyx_mstate_global->__pyx_n_s_Clause___reduce_cython
 #define __pyx_n_s_Clause___setstate_cython __pyx_mstate_global->__pyx_n_s_Clause___setstate_cython
 #define __pyx_n_s_DEVNULL __pyx_mstate_global->__pyx_n_s_DEVNULL
 #define __pyx_kp_s_Dimension_d_is_not_direct __pyx_mstate_global->__pyx_kp_s_Dimension_d_is_not_direct
 #define __pyx_kp_u_Dverify __pyx_mstate_global->__pyx_kp_u_Dverify
 #define __pyx_n_s_Ellipsis __pyx_mstate_global->__pyx_n_s_Ellipsis
 #define __pyx_kp_s_Empty_shape_tuple_for_cython_arr __pyx_mstate_global->__pyx_kp_s_Empty_shape_tuple_for_cython_arr
@@ -7211,14 +7215,15 @@
 #define __pyx_kp_s_Optional_np_ndarray __pyx_mstate_global->__pyx_kp_s_Optional_np_ndarray
 #define __pyx_kp_u_Out_of_bounds_on_buffer_access_a __pyx_mstate_global->__pyx_kp_u_Out_of_bounds_on_buffer_access_a
 #define __pyx_n_s_PIPE __pyx_mstate_global->__pyx_n_s_PIPE
 #define __pyx_n_s_PickleError __pyx_mstate_global->__pyx_n_s_PickleError
 #define __pyx_n_s_Popen __pyx_mstate_global->__pyx_n_s_Popen
 #define __pyx_kp_u_Returns_all_unit_clauses_in_the __pyx_mstate_global->__pyx_kp_u_Returns_all_unit_clauses_in_the
 #define __pyx_n_u_SATISFIABLE __pyx_mstate_global->__pyx_n_u_SATISFIABLE
+#define __pyx_n_s_Self __pyx_mstate_global->__pyx_n_s_Self
 #define __pyx_n_s_Sequence __pyx_mstate_global->__pyx_n_s_Sequence
 #define __pyx_kp_s_Step_may_not_be_zero_axis_d __pyx_mstate_global->__pyx_kp_s_Step_may_not_be_zero_axis_d
 #define __pyx_n_s_StringIO __pyx_mstate_global->__pyx_n_s_StringIO
 #define __pyx_kp_b_T __pyx_mstate_global->__pyx_kp_b_T
 #define __pyx_kp_u_T_2 __pyx_mstate_global->__pyx_kp_u_T_2
 #define __pyx_n_u_Truthtable __pyx_mstate_global->__pyx_n_u_Truthtable
 #define __pyx_n_s_Truthtable_2 __pyx_mstate_global->__pyx_n_s_Truthtable_2
@@ -7251,25 +7256,25 @@
 #define __pyx_n_s_XorClause __pyx_mstate_global->__pyx_n_s_XorClause
 #define __pyx_n_u_XorClause __pyx_mstate_global->__pyx_n_u_XorClause
 #define __pyx_n_s_XorClauseList __pyx_mstate_global->__pyx_n_s_XorClauseList
 #define __pyx_n_s_XorClause___reduce_cython __pyx_mstate_global->__pyx_n_s_XorClause___reduce_cython
 #define __pyx_n_s_XorClause___setstate_cython __pyx_mstate_global->__pyx_n_s_XorClause___setstate_cython
 #define __pyx_kp_b__10 __pyx_mstate_global->__pyx_kp_b__10
 #define __pyx_kp_u__10 __pyx_mstate_global->__pyx_kp_u__10
-#define __pyx_n_s__107 __pyx_mstate_global->__pyx_n_s__107
+#define __pyx_n_s__109 __pyx_mstate_global->__pyx_n_s__109
 #define __pyx_kp_b__11 __pyx_mstate_global->__pyx_kp_b__11
 #define __pyx_kp_b__12 __pyx_mstate_global->__pyx_kp_b__12
 #define __pyx_kp_u__13 __pyx_mstate_global->__pyx_kp_u__13
 #define __pyx_kp_u__14 __pyx_mstate_global->__pyx_kp_u__14
 #define __pyx_n_s__181 __pyx_mstate_global->__pyx_n_s__181
 #define __pyx_kp_u__19 __pyx_mstate_global->__pyx_kp_u__19
 #define __pyx_kp_u__2 __pyx_mstate_global->__pyx_kp_u__2
 #define __pyx_n_s__3 __pyx_mstate_global->__pyx_n_s__3
-#define __pyx_kp_u__32 __pyx_mstate_global->__pyx_kp_u__32
-#define __pyx_kp_u__33 __pyx_mstate_global->__pyx_kp_u__33
+#define __pyx_kp_u__34 __pyx_mstate_global->__pyx_kp_u__34
+#define __pyx_kp_u__35 __pyx_mstate_global->__pyx_kp_u__35
 #define __pyx_kp_u__59 __pyx_mstate_global->__pyx_kp_u__59
 #define __pyx_kp_u__6 __pyx_mstate_global->__pyx_kp_u__6
 #define __pyx_kp_u__7 __pyx_mstate_global->__pyx_kp_u__7
 #define __pyx_kp_b__9 __pyx_mstate_global->__pyx_kp_b__9
 #define __pyx_n_s_a __pyx_mstate_global->__pyx_n_s_a
 #define __pyx_n_s_abc __pyx_mstate_global->__pyx_n_s_abc
 #define __pyx_n_s_add_clause __pyx_mstate_global->__pyx_n_s_add_clause
@@ -7657,42 +7662,42 @@
 #define __pyx_int_136945605 __pyx_mstate_global->__pyx_int_136945605
 #define __pyx_int_136983863 __pyx_mstate_global->__pyx_int_136983863
 #define __pyx_int_176425246 __pyx_mstate_global->__pyx_int_176425246
 #define __pyx_int_184977713 __pyx_mstate_global->__pyx_int_184977713
 #define __pyx_int_194912966 __pyx_mstate_global->__pyx_int_194912966
 #define __pyx_int_200065077 __pyx_mstate_global->__pyx_int_200065077
 #define __pyx_int_neg_1 __pyx_mstate_global->__pyx_int_neg_1
-#define __pyx_k__34 __pyx_mstate_global->__pyx_k__34
 #define __pyx_k__36 __pyx_mstate_global->__pyx_k__36
+#define __pyx_k__38 __pyx_mstate_global->__pyx_k__38
 #define __pyx_k__50 __pyx_mstate_global->__pyx_k__50
 #define __pyx_k__56 __pyx_mstate_global->__pyx_k__56
 #define __pyx_k__61 __pyx_mstate_global->__pyx_k__61
 #define __pyx_slice__5 __pyx_mstate_global->__pyx_slice__5
 #define __pyx_tuple__4 __pyx_mstate_global->__pyx_tuple__4
 #define __pyx_tuple__8 __pyx_mstate_global->__pyx_tuple__8
-#define __pyx_slice__38 __pyx_mstate_global->__pyx_slice__38
+#define __pyx_slice__40 __pyx_mstate_global->__pyx_slice__40
 #define __pyx_slice__46 __pyx_mstate_global->__pyx_slice__46
 #define __pyx_tuple__15 __pyx_mstate_global->__pyx_tuple__15
 #define __pyx_tuple__16 __pyx_mstate_global->__pyx_tuple__16
 #define __pyx_tuple__17 __pyx_mstate_global->__pyx_tuple__17
 #define __pyx_tuple__20 __pyx_mstate_global->__pyx_tuple__20
 #define __pyx_tuple__21 __pyx_mstate_global->__pyx_tuple__21
 #define __pyx_tuple__22 __pyx_mstate_global->__pyx_tuple__22
 #define __pyx_tuple__23 __pyx_mstate_global->__pyx_tuple__23
 #define __pyx_tuple__24 __pyx_mstate_global->__pyx_tuple__24
+#define __pyx_tuple__25 __pyx_mstate_global->__pyx_tuple__25
 #define __pyx_tuple__26 __pyx_mstate_global->__pyx_tuple__26
-#define __pyx_tuple__27 __pyx_mstate_global->__pyx_tuple__27
 #define __pyx_tuple__28 __pyx_mstate_global->__pyx_tuple__28
 #define __pyx_tuple__29 __pyx_mstate_global->__pyx_tuple__29
 #define __pyx_tuple__30 __pyx_mstate_global->__pyx_tuple__30
 #define __pyx_tuple__31 __pyx_mstate_global->__pyx_tuple__31
-#define __pyx_tuple__35 __pyx_mstate_global->__pyx_tuple__35
+#define __pyx_tuple__32 __pyx_mstate_global->__pyx_tuple__32
+#define __pyx_tuple__33 __pyx_mstate_global->__pyx_tuple__33
 #define __pyx_tuple__37 __pyx_mstate_global->__pyx_tuple__37
 #define __pyx_tuple__39 __pyx_mstate_global->__pyx_tuple__39
-#define __pyx_tuple__40 __pyx_mstate_global->__pyx_tuple__40
 #define __pyx_tuple__41 __pyx_mstate_global->__pyx_tuple__41
 #define __pyx_tuple__42 __pyx_mstate_global->__pyx_tuple__42
 #define __pyx_tuple__43 __pyx_mstate_global->__pyx_tuple__43
 #define __pyx_tuple__44 __pyx_mstate_global->__pyx_tuple__44
 #define __pyx_tuple__45 __pyx_mstate_global->__pyx_tuple__45
 #define __pyx_tuple__47 __pyx_mstate_global->__pyx_tuple__47
 #define __pyx_tuple__48 __pyx_mstate_global->__pyx_tuple__48
@@ -7725,33 +7730,33 @@
 #define __pyx_tuple__85 __pyx_mstate_global->__pyx_tuple__85
 #define __pyx_tuple__91 __pyx_mstate_global->__pyx_tuple__91
 #define __pyx_tuple__94 __pyx_mstate_global->__pyx_tuple__94
 #define __pyx_tuple__96 __pyx_mstate_global->__pyx_tuple__96
 #define __pyx_tuple__98 __pyx_mstate_global->__pyx_tuple__98
 #define __pyx_tuple__100 __pyx_mstate_global->__pyx_tuple__100
 #define __pyx_tuple__102 __pyx_mstate_global->__pyx_tuple__102
-#define __pyx_tuple__105 __pyx_mstate_global->__pyx_tuple__105
-#define __pyx_tuple__108 __pyx_mstate_global->__pyx_tuple__108
+#define __pyx_tuple__104 __pyx_mstate_global->__pyx_tuple__104
+#define __pyx_tuple__107 __pyx_mstate_global->__pyx_tuple__107
 #define __pyx_tuple__110 __pyx_mstate_global->__pyx_tuple__110
 #define __pyx_tuple__112 __pyx_mstate_global->__pyx_tuple__112
 #define __pyx_tuple__114 __pyx_mstate_global->__pyx_tuple__114
 #define __pyx_tuple__116 __pyx_mstate_global->__pyx_tuple__116
 #define __pyx_tuple__118 __pyx_mstate_global->__pyx_tuple__118
 #define __pyx_tuple__120 __pyx_mstate_global->__pyx_tuple__120
 #define __pyx_tuple__122 __pyx_mstate_global->__pyx_tuple__122
 #define __pyx_tuple__124 __pyx_mstate_global->__pyx_tuple__124
 #define __pyx_tuple__126 __pyx_mstate_global->__pyx_tuple__126
 #define __pyx_tuple__128 __pyx_mstate_global->__pyx_tuple__128
 #define __pyx_tuple__130 __pyx_mstate_global->__pyx_tuple__130
-#define __pyx_tuple__131 __pyx_mstate_global->__pyx_tuple__131
+#define __pyx_tuple__132 __pyx_mstate_global->__pyx_tuple__132
 #define __pyx_tuple__133 __pyx_mstate_global->__pyx_tuple__133
 #define __pyx_tuple__135 __pyx_mstate_global->__pyx_tuple__135
 #define __pyx_tuple__137 __pyx_mstate_global->__pyx_tuple__137
 #define __pyx_tuple__139 __pyx_mstate_global->__pyx_tuple__139
-#define __pyx_tuple__140 __pyx_mstate_global->__pyx_tuple__140
+#define __pyx_tuple__141 __pyx_mstate_global->__pyx_tuple__141
 #define __pyx_tuple__142 __pyx_mstate_global->__pyx_tuple__142
 #define __pyx_tuple__144 __pyx_mstate_global->__pyx_tuple__144
 #define __pyx_tuple__146 __pyx_mstate_global->__pyx_tuple__146
 #define __pyx_tuple__148 __pyx_mstate_global->__pyx_tuple__148
 #define __pyx_tuple__150 __pyx_mstate_global->__pyx_tuple__150
 #define __pyx_tuple__153 __pyx_mstate_global->__pyx_tuple__153
 #define __pyx_tuple__155 __pyx_mstate_global->__pyx_tuple__155
@@ -7761,15 +7766,15 @@
 #define __pyx_tuple__165 __pyx_mstate_global->__pyx_tuple__165
 #define __pyx_tuple__167 __pyx_mstate_global->__pyx_tuple__167
 #define __pyx_tuple__169 __pyx_mstate_global->__pyx_tuple__169
 #define __pyx_tuple__170 __pyx_mstate_global->__pyx_tuple__170
 #define __pyx_tuple__172 __pyx_mstate_global->__pyx_tuple__172
 #define __pyx_tuple__173 __pyx_mstate_global->__pyx_tuple__173
 #define __pyx_codeobj__18 __pyx_mstate_global->__pyx_codeobj__18
-#define __pyx_codeobj__25 __pyx_mstate_global->__pyx_codeobj__25
+#define __pyx_codeobj__27 __pyx_mstate_global->__pyx_codeobj__27
 #define __pyx_codeobj__58 __pyx_mstate_global->__pyx_codeobj__58
 #define __pyx_codeobj__74 __pyx_mstate_global->__pyx_codeobj__74
 #define __pyx_codeobj__76 __pyx_mstate_global->__pyx_codeobj__76
 #define __pyx_codeobj__79 __pyx_mstate_global->__pyx_codeobj__79
 #define __pyx_codeobj__81 __pyx_mstate_global->__pyx_codeobj__81
 #define __pyx_codeobj__84 __pyx_mstate_global->__pyx_codeobj__84
 #define __pyx_codeobj__86 __pyx_mstate_global->__pyx_codeobj__86
@@ -7780,32 +7785,32 @@
 #define __pyx_codeobj__92 __pyx_mstate_global->__pyx_codeobj__92
 #define __pyx_codeobj__93 __pyx_mstate_global->__pyx_codeobj__93
 #define __pyx_codeobj__95 __pyx_mstate_global->__pyx_codeobj__95
 #define __pyx_codeobj__97 __pyx_mstate_global->__pyx_codeobj__97
 #define __pyx_codeobj__99 __pyx_mstate_global->__pyx_codeobj__99
 #define __pyx_codeobj__101 __pyx_mstate_global->__pyx_codeobj__101
 #define __pyx_codeobj__103 __pyx_mstate_global->__pyx_codeobj__103
-#define __pyx_codeobj__104 __pyx_mstate_global->__pyx_codeobj__104
+#define __pyx_codeobj__105 __pyx_mstate_global->__pyx_codeobj__105
 #define __pyx_codeobj__106 __pyx_mstate_global->__pyx_codeobj__106
-#define __pyx_codeobj__109 __pyx_mstate_global->__pyx_codeobj__109
+#define __pyx_codeobj__108 __pyx_mstate_global->__pyx_codeobj__108
 #define __pyx_codeobj__111 __pyx_mstate_global->__pyx_codeobj__111
 #define __pyx_codeobj__113 __pyx_mstate_global->__pyx_codeobj__113
 #define __pyx_codeobj__115 __pyx_mstate_global->__pyx_codeobj__115
 #define __pyx_codeobj__117 __pyx_mstate_global->__pyx_codeobj__117
 #define __pyx_codeobj__119 __pyx_mstate_global->__pyx_codeobj__119
 #define __pyx_codeobj__121 __pyx_mstate_global->__pyx_codeobj__121
 #define __pyx_codeobj__123 __pyx_mstate_global->__pyx_codeobj__123
 #define __pyx_codeobj__125 __pyx_mstate_global->__pyx_codeobj__125
 #define __pyx_codeobj__127 __pyx_mstate_global->__pyx_codeobj__127
 #define __pyx_codeobj__129 __pyx_mstate_global->__pyx_codeobj__129
-#define __pyx_codeobj__132 __pyx_mstate_global->__pyx_codeobj__132
+#define __pyx_codeobj__131 __pyx_mstate_global->__pyx_codeobj__131
 #define __pyx_codeobj__134 __pyx_mstate_global->__pyx_codeobj__134
 #define __pyx_codeobj__136 __pyx_mstate_global->__pyx_codeobj__136
 #define __pyx_codeobj__138 __pyx_mstate_global->__pyx_codeobj__138
-#define __pyx_codeobj__141 __pyx_mstate_global->__pyx_codeobj__141
+#define __pyx_codeobj__140 __pyx_mstate_global->__pyx_codeobj__140
 #define __pyx_codeobj__143 __pyx_mstate_global->__pyx_codeobj__143
 #define __pyx_codeobj__145 __pyx_mstate_global->__pyx_codeobj__145
 #define __pyx_codeobj__147 __pyx_mstate_global->__pyx_codeobj__147
 #define __pyx_codeobj__149 __pyx_mstate_global->__pyx_codeobj__149
 #define __pyx_codeobj__151 __pyx_mstate_global->__pyx_codeobj__151
 #define __pyx_codeobj__152 __pyx_mstate_global->__pyx_codeobj__152
 #define __pyx_codeobj__154 __pyx_mstate_global->__pyx_codeobj__154
@@ -28581,15 +28586,15 @@
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "sat_toolkit/formula.pyx":376
  *                 result_list.append(val)
  * 
  *         return result_list             # <<<<<<<<<<<<<<
  * 
- *     cdef int _add_clauses_raw(self, const int *clauses, size_t length) except -1 nogil:
+ *     def translate(self, mapping) -> Self:
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_result_list);
   __pyx_r = __pyx_v_result_list;
   goto __pyx_L0;
 
   /* "sat_toolkit/formula.pyx":309
@@ -28621,14 +28626,476 @@
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "sat_toolkit/formula.pyx":378
  *         return result_list
  * 
+ *     def translate(self, mapping) -> Self:             # <<<<<<<<<<<<<<
+ *         """
+ *         Translate all variables in the CNF/XorClauseList to a new index.
+ */
+
+/* Python wrapper */
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_11translate(PyObject *__pyx_v_self, 
+#if CYTHON_METH_FASTCALL
+PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
+#else
+PyObject *__pyx_args, PyObject *__pyx_kwds
+#endif
+); /*proto*/
+PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_10translate, "_ClauseList.translate(self, mapping) -> Self\n\n        Translate all variables in the CNF/XorClauseList to a new index.\n        The translation mapping is given by the mapping paramter.\n\n        Index 0 must always map to index 0 again.\n\n        :return: a new CNF with variables changed according to mapping parameter\n        ");
+static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_11translate = {"translate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_11translate, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_10translate};
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_11translate(PyObject *__pyx_v_self, 
+#if CYTHON_METH_FASTCALL
+PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
+#else
+PyObject *__pyx_args, PyObject *__pyx_kwds
+#endif
+) {
+  PyObject *__pyx_v_mapping = 0;
+  #if !CYTHON_METH_FASTCALL
+  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
+  #endif
+  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
+  PyObject* values[1] = {0};
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("translate (wrapper)", 0);
+  #if !CYTHON_METH_FASTCALL
+  #if CYTHON_ASSUME_SAFE_MACROS
+  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
+  #else
+  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
+  #endif
+  #endif
+  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
+  {
+    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_mapping,0};
+    if (__pyx_kwds) {
+      Py_ssize_t kw_args;
+      switch (__pyx_nargs) {
+        case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
+        CYTHON_FALLTHROUGH;
+        case  0: break;
+        default: goto __pyx_L5_argtuple_error;
+      }
+      kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
+      switch (__pyx_nargs) {
+        case  0:
+        if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_mapping)) != 0)) {
+          (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
+          kw_args--;
+        }
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 378, __pyx_L3_error)
+        else goto __pyx_L5_argtuple_error;
+      }
+      if (unlikely(kw_args > 0)) {
+        const Py_ssize_t kwd_pos_args = __pyx_nargs;
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "translate") < 0)) __PYX_ERR(0, 378, __pyx_L3_error)
+      }
+    } else if (unlikely(__pyx_nargs != 1)) {
+      goto __pyx_L5_argtuple_error;
+    } else {
+      values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
+    }
+    __pyx_v_mapping = values[0];
+  }
+  goto __pyx_L6_skip;
+  __pyx_L5_argtuple_error:;
+  __Pyx_RaiseArgtupleInvalid("translate", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 378, __pyx_L3_error)
+  __pyx_L6_skip:;
+  goto __pyx_L4_argument_unpacking_done;
+  __pyx_L3_error:;
+  {
+    Py_ssize_t __pyx_temp;
+    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
+      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
+    }
+  }
+  __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_RefNannyFinishContext();
+  return NULL;
+  __pyx_L4_argument_unpacking_done:;
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_10translate(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_mapping);
+
+  /* function exit code */
+  {
+    Py_ssize_t __pyx_temp;
+    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
+      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
+    }
+  }
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_10translate(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_mapping) {
+  PyObject *__pyx_v_np_vars = 0;
+  __Pyx_memviewslice __pyx_v_var_view = { 0, 0, { 0 }, { 0 }, { 0 } };
+  size_t __pyx_v_i;
+  std::vector<int>  __pyx_v_new_clauses;
+  int __pyx_v_var;
+  struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_res = 0;
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_5 = NULL;
+  __Pyx_memviewslice __pyx_t_6 = { 0, 0, { 0 }, { 0 }, { 0 } };
+  int __pyx_t_7;
+  Py_ssize_t __pyx_t_8;
+  Py_UCS4 __pyx_t_9;
+  Py_ssize_t __pyx_t_10;
+  size_t __pyx_t_11;
+  size_t __pyx_t_12;
+  size_t __pyx_t_13;
+  size_t __pyx_t_14;
+  std::vector<int> ::size_type __pyx_t_15;
+  std::vector<int> ::size_type __pyx_t_16;
+  long __pyx_t_17;
+  int __pyx_t_18;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("translate", 1);
+
+  /* "sat_toolkit/formula.pyx":387
+ *         :return: a new CNF with variables changed according to mapping parameter
+ *         """
+ *         cdef np_vars = np.array(mapping, copy=False, dtype=np.int32)             # <<<<<<<<<<<<<<
+ *         cdef int [::1] var_view = np_vars
+ *         cdef size_t i
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 387, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 387, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 387, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_INCREF(__pyx_v_mapping);
+  __Pyx_GIVEREF(__pyx_v_mapping);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_mapping)) __PYX_ERR(0, 387, __pyx_L1_error);
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 387, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 387, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 387, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 387, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 387, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 387, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_np_vars = __pyx_t_5;
+  __pyx_t_5 = 0;
+
+  /* "sat_toolkit/formula.pyx":388
+ *         """
+ *         cdef np_vars = np.array(mapping, copy=False, dtype=np.int32)
+ *         cdef int [::1] var_view = np_vars             # <<<<<<<<<<<<<<
+ *         cdef size_t i
+ * 
+ */
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_np_vars, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 388, __pyx_L1_error)
+  __pyx_v_var_view = __pyx_t_6;
+  __pyx_t_6.memview = NULL;
+  __pyx_t_6.data = NULL;
+
+  /* "sat_toolkit/formula.pyx":391
+ *         cdef size_t i
+ * 
+ *         if var_view.shape[0] != self.nvars + 1:             # <<<<<<<<<<<<<<
+ *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
+ *         if var_view[0] != 0:
+ */
+  __pyx_t_7 = ((__pyx_v_var_view.shape[0]) != (__pyx_v_self->nvars + 1));
+  if (unlikely(__pyx_t_7)) {
+
+    /* "sat_toolkit/formula.pyx":392
+ * 
+ *         if var_view.shape[0] != self.nvars + 1:
+ *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')             # <<<<<<<<<<<<<<
+ *         if var_view[0] != 0:
+ *             raise ValueError('variable 0 must map to 0 again')
+ */
+    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_8 = 0;
+    __pyx_t_9 = 127;
+    __Pyx_INCREF(__pyx_kp_u_need_to_provide_translation_for);
+    __pyx_t_8 += 38;
+    __Pyx_GIVEREF(__pyx_kp_u_need_to_provide_translation_for);
+    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_kp_u_need_to_provide_translation_for);
+    __pyx_t_3 = __Pyx_PyUnicode_From_int(__pyx_v_self->nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_8 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_3);
+    __Pyx_GIVEREF(__pyx_t_3);
+    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_3);
+    __pyx_t_3 = 0;
+    __Pyx_INCREF(__pyx_kp_u_variables_2);
+    __pyx_t_8 += 10;
+    __Pyx_GIVEREF(__pyx_kp_u_variables_2);
+    PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_kp_u_variables_2);
+    __pyx_t_3 = __Pyx_PyUnicode_Join(__pyx_t_5, 3, __pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __PYX_ERR(0, 392, __pyx_L1_error)
+
+    /* "sat_toolkit/formula.pyx":391
+ *         cdef size_t i
+ * 
+ *         if var_view.shape[0] != self.nvars + 1:             # <<<<<<<<<<<<<<
+ *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
+ *         if var_view[0] != 0:
+ */
+  }
+
+  /* "sat_toolkit/formula.pyx":393
+ *         if var_view.shape[0] != self.nvars + 1:
+ *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
+ *         if var_view[0] != 0:             # <<<<<<<<<<<<<<
+ *             raise ValueError('variable 0 must map to 0 again')
+ * 
+ */
+  __pyx_t_10 = 0;
+  __pyx_t_7 = ((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_var_view.data) + __pyx_t_10)) ))) != 0);
+  if (unlikely(__pyx_t_7)) {
+
+    /* "sat_toolkit/formula.pyx":394
+ *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
+ *         if var_view[0] != 0:
+ *             raise ValueError('variable 0 must map to 0 again')             # <<<<<<<<<<<<<<
+ * 
+ *         for i in range(1, <size_t> var_view.shape[0]):
+ */
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __PYX_ERR(0, 394, __pyx_L1_error)
+
+    /* "sat_toolkit/formula.pyx":393
+ *         if var_view.shape[0] != self.nvars + 1:
+ *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
+ *         if var_view[0] != 0:             # <<<<<<<<<<<<<<
+ *             raise ValueError('variable 0 must map to 0 again')
+ * 
+ */
+  }
+
+  /* "sat_toolkit/formula.pyx":396
+ *             raise ValueError('variable 0 must map to 0 again')
+ * 
+ *         for i in range(1, <size_t> var_view.shape[0]):             # <<<<<<<<<<<<<<
+ *             if var_view[i] == 0:
+ *                 raise ValueError('variable must not be mapped to 0')
+ */
+  __pyx_t_11 = ((size_t)(__pyx_v_var_view.shape[0]));
+  __pyx_t_12 = __pyx_t_11;
+  for (__pyx_t_13 = 1; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
+    __pyx_v_i = __pyx_t_13;
+
+    /* "sat_toolkit/formula.pyx":397
+ * 
+ *         for i in range(1, <size_t> var_view.shape[0]):
+ *             if var_view[i] == 0:             # <<<<<<<<<<<<<<
+ *                 raise ValueError('variable must not be mapped to 0')
+ * 
+ */
+    __pyx_t_14 = __pyx_v_i;
+    __pyx_t_7 = ((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_var_view.data) + __pyx_t_14)) ))) == 0);
+    if (unlikely(__pyx_t_7)) {
+
+      /* "sat_toolkit/formula.pyx":398
+ *         for i in range(1, <size_t> var_view.shape[0]):
+ *             if var_view[i] == 0:
+ *                 raise ValueError('variable must not be mapped to 0')             # <<<<<<<<<<<<<<
+ * 
+ *         cdef vector[int] new_clauses
+ */
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 398, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
+      __Pyx_Raise(__pyx_t_5, 0, 0, 0);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __PYX_ERR(0, 398, __pyx_L1_error)
+
+      /* "sat_toolkit/formula.pyx":397
+ * 
+ *         for i in range(1, <size_t> var_view.shape[0]):
+ *             if var_view[i] == 0:             # <<<<<<<<<<<<<<
+ *                 raise ValueError('variable must not be mapped to 0')
+ * 
+ */
+    }
+  }
+
+  /* "sat_toolkit/formula.pyx":401
+ * 
+ *         cdef vector[int] new_clauses
+ *         new_clauses.resize(self._clauses.size())             # <<<<<<<<<<<<<<
+ * 
+ *         cdef int var
+ */
+  try {
+    __pyx_v_new_clauses.resize(__pyx_v_self->_clauses.size());
+  } catch(...) {
+    __Pyx_CppExn2PyErr();
+    __PYX_ERR(0, 401, __pyx_L1_error)
+  }
+
+  /* "sat_toolkit/formula.pyx":404
+ * 
+ *         cdef int var
+ *         for i in range(self._clauses.size()):             # <<<<<<<<<<<<<<
+ *             var = self._clauses[i]
+ *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)
+ */
+  __pyx_t_15 = __pyx_v_self->_clauses.size();
+  __pyx_t_16 = __pyx_t_15;
+  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_16; __pyx_t_11+=1) {
+    __pyx_v_i = __pyx_t_11;
+
+    /* "sat_toolkit/formula.pyx":405
+ *         cdef int var
+ *         for i in range(self._clauses.size()):
+ *             var = self._clauses[i]             # <<<<<<<<<<<<<<
+ *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)
+ * 
+ */
+    __pyx_v_var = (__pyx_v_self->_clauses[__pyx_v_i]);
+
+    /* "sat_toolkit/formula.pyx":406
+ *         for i in range(self._clauses.size()):
+ *             var = self._clauses[i]
+ *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)             # <<<<<<<<<<<<<<
+ * 
+ *         cdef _ClauseList res = type(self).__new__(type(self))
+ */
+    __pyx_t_10 = __pyx_f_11sat_toolkit_7formula_abs(__pyx_v_var);
+    __pyx_t_7 = (__pyx_v_var > 0);
+    if (__pyx_t_7) {
+      __pyx_t_17 = 1;
+    } else {
+      __pyx_t_17 = -1L;
+    }
+    (__pyx_v_new_clauses[__pyx_v_i]) = ((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_var_view.data) + __pyx_t_10)) ))) * __pyx_t_17);
+  }
+
+  /* "sat_toolkit/formula.pyx":408
+ *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)
+ * 
+ *         cdef _ClauseList res = type(self).__new__(type(self))             # <<<<<<<<<<<<<<
+ *         res.nvars = self.nvars
+ *         res._add_clauses_raw(new_clauses.data(), new_clauses.size())
+ */
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 408, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = NULL;
+  __pyx_t_18 = 0;
+  #if CYTHON_UNPACK_METHODS
+  if (likely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_1)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_1);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
+      __pyx_t_18 = 1;
+    }
+  }
+  #endif
+  {
+    PyObject *__pyx_callargs[2] = {__pyx_t_1, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))};
+    __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_18, 1+__pyx_t_18);
+    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 408, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  }
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 408, __pyx_L1_error)
+  __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "sat_toolkit/formula.pyx":409
+ * 
+ *         cdef _ClauseList res = type(self).__new__(type(self))
+ *         res.nvars = self.nvars             # <<<<<<<<<<<<<<
+ *         res._add_clauses_raw(new_clauses.data(), new_clauses.size())
+ *         return res
+ */
+  __pyx_t_18 = __pyx_v_self->nvars;
+  __pyx_v_res->nvars = __pyx_t_18;
+
+  /* "sat_toolkit/formula.pyx":410
+ *         cdef _ClauseList res = type(self).__new__(type(self))
+ *         res.nvars = self.nvars
+ *         res._add_clauses_raw(new_clauses.data(), new_clauses.size())             # <<<<<<<<<<<<<<
+ *         return res
+ * 
+ */
+  __pyx_t_18 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->__pyx_vtab)->_add_clauses_raw(__pyx_v_res, __pyx_v_new_clauses.data(), __pyx_v_new_clauses.size()); if (unlikely(__pyx_t_18 == ((int)-1))) __PYX_ERR(0, 410, __pyx_L1_error)
+
+  /* "sat_toolkit/formula.pyx":411
+ *         res.nvars = self.nvars
+ *         res._add_clauses_raw(new_clauses.data(), new_clauses.size())
+ *         return res             # <<<<<<<<<<<<<<
+ * 
+ *     cdef int _add_clauses_raw(self, const int *clauses, size_t length) except -1 nogil:
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __Pyx_INCREF((PyObject *)__pyx_v_res);
+  __pyx_r = ((PyObject *)__pyx_v_res);
+  goto __pyx_L0;
+
+  /* "sat_toolkit/formula.pyx":378
+ *         return result_list
+ * 
+ *     def translate(self, mapping) -> Self:             # <<<<<<<<<<<<<<
+ *         """
+ *         Translate all variables in the CNF/XorClauseList to a new index.
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_3);
+  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_t_6, 1);
+  __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_np_vars);
+  __PYX_XCLEAR_MEMVIEW(&__pyx_v_var_view, 1);
+  __Pyx_XDECREF((PyObject *)__pyx_v_res);
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "sat_toolkit/formula.pyx":413
+ *         return res
+ * 
  *     cdef int _add_clauses_raw(self, const int *clauses, size_t length) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t old_len, i
  * 
  */
 
 static int __pyx_f_11sat_toolkit_7formula_11_ClauseList__add_clauses_raw(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, int const *__pyx_v_clauses, size_t __pyx_v_length) {
   size_t __pyx_v_old_len;
@@ -28645,62 +29112,62 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save;
   #endif
   __Pyx_RefNannySetupContext("_add_clauses_raw", 1);
 
-  /* "sat_toolkit/formula.pyx":381
+  /* "sat_toolkit/formula.pyx":416
  *         cdef size_t old_len, i
  * 
  *         if self.view_count > 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot alter while referenced by buffer')
  * 
  */
   __pyx_t_1 = (__pyx_v_self->view_count > 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":382
+    /* "sat_toolkit/formula.pyx":417
  * 
  *         if self.view_count > 0:
  *             raise ValueError('cannot alter while referenced by buffer')             # <<<<<<<<<<<<<<
  * 
  *         if length > 0 and clauses[length - 1] != 0:
  */
     {
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         /*try:*/ {
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 382, __pyx_L5_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_Raise(__pyx_t_2, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __PYX_ERR(0, 382, __pyx_L5_error)
+          __PYX_ERR(0, 417, __pyx_L5_error)
         }
         /*finally:*/ {
           __pyx_L5_error: {
             #ifdef WITH_THREAD
             __Pyx_PyGILState_Release(__pyx_gilstate_save);
             #endif
             goto __pyx_L1_error;
           }
         }
     }
 
-    /* "sat_toolkit/formula.pyx":381
+    /* "sat_toolkit/formula.pyx":416
  *         cdef size_t old_len, i
  * 
  *         if self.view_count > 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot alter while referenced by buffer')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":384
+  /* "sat_toolkit/formula.pyx":419
  *             raise ValueError('cannot alter while referenced by buffer')
  * 
  *         if length > 0 and clauses[length - 1] != 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('last clause not terminated with 0')
  * 
  */
   __pyx_t_3 = (__pyx_v_length > 0);
@@ -28710,61 +29177,61 @@
     goto __pyx_L8_bool_binop_done;
   }
   __pyx_t_3 = ((__pyx_v_clauses[(__pyx_v_length - 1)]) != 0);
   __pyx_t_1 = __pyx_t_3;
   __pyx_L8_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":385
+    /* "sat_toolkit/formula.pyx":420
  * 
  *         if length > 0 and clauses[length - 1] != 0:
  *             raise ValueError('last clause not terminated with 0')             # <<<<<<<<<<<<<<
  * 
  *         old_len = self._clauses.size()
  */
     {
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         /*try:*/ {
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 385, __pyx_L11_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 420, __pyx_L11_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_Raise(__pyx_t_2, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __PYX_ERR(0, 385, __pyx_L11_error)
+          __PYX_ERR(0, 420, __pyx_L11_error)
         }
         /*finally:*/ {
           __pyx_L11_error: {
             #ifdef WITH_THREAD
             __Pyx_PyGILState_Release(__pyx_gilstate_save);
             #endif
             goto __pyx_L1_error;
           }
         }
     }
 
-    /* "sat_toolkit/formula.pyx":384
+    /* "sat_toolkit/formula.pyx":419
  *             raise ValueError('cannot alter while referenced by buffer')
  * 
  *         if length > 0 and clauses[length - 1] != 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('last clause not terminated with 0')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":387
+  /* "sat_toolkit/formula.pyx":422
  *             raise ValueError('last clause not terminated with 0')
  * 
  *         old_len = self._clauses.size()             # <<<<<<<<<<<<<<
  *         self._clauses.resize(self._clauses.size() + length)
  * 
  */
   __pyx_v_old_len = __pyx_v_self->_clauses.size();
 
-  /* "sat_toolkit/formula.pyx":388
+  /* "sat_toolkit/formula.pyx":423
  * 
  *         old_len = self._clauses.size()
  *         self._clauses.resize(self._clauses.size() + length)             # <<<<<<<<<<<<<<
  * 
  *         if length > 0:
  */
   try {
@@ -28773,28 +29240,28 @@
     #ifdef WITH_THREAD
     PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
     #endif
     __Pyx_CppExn2PyErr();
     #ifdef WITH_THREAD
     __Pyx_PyGILState_Release(__pyx_gilstate_save);
     #endif
-    __PYX_ERR(0, 388, __pyx_L1_error)
+    __PYX_ERR(0, 423, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":390
+  /* "sat_toolkit/formula.pyx":425
  *         self._clauses.resize(self._clauses.size() + length)
  * 
  *         if length > 0:             # <<<<<<<<<<<<<<
  *             self._start_indices.push_back(old_len)
  * 
  */
   __pyx_t_1 = (__pyx_v_length > 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":391
+    /* "sat_toolkit/formula.pyx":426
  * 
  *         if length > 0:
  *             self._start_indices.push_back(old_len)             # <<<<<<<<<<<<<<
  * 
  *         for i in range(length):
  */
     try {
@@ -28803,76 +29270,76 @@
       #ifdef WITH_THREAD
       PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
       #endif
       __Pyx_CppExn2PyErr();
       #ifdef WITH_THREAD
       __Pyx_PyGILState_Release(__pyx_gilstate_save);
       #endif
-      __PYX_ERR(0, 391, __pyx_L1_error)
+      __PYX_ERR(0, 426, __pyx_L1_error)
     }
 
-    /* "sat_toolkit/formula.pyx":390
+    /* "sat_toolkit/formula.pyx":425
  *         self._clauses.resize(self._clauses.size() + length)
  * 
  *         if length > 0:             # <<<<<<<<<<<<<<
  *             self._start_indices.push_back(old_len)
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":393
+  /* "sat_toolkit/formula.pyx":428
  *             self._start_indices.push_back(old_len)
  * 
  *         for i in range(length):             # <<<<<<<<<<<<<<
  *             self._clauses[old_len + i] = clauses[i]
  *             if abs(clauses[i]) > self.nvars:
  */
   __pyx_t_4 = __pyx_v_length;
   __pyx_t_5 = __pyx_t_4;
   for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
     __pyx_v_i = __pyx_t_6;
 
-    /* "sat_toolkit/formula.pyx":394
+    /* "sat_toolkit/formula.pyx":429
  * 
  *         for i in range(length):
  *             self._clauses[old_len + i] = clauses[i]             # <<<<<<<<<<<<<<
  *             if abs(clauses[i]) > self.nvars:
  *                 self.nvars = abs(clauses[i])
  */
     (__pyx_v_self->_clauses[(__pyx_v_old_len + __pyx_v_i)]) = (__pyx_v_clauses[__pyx_v_i]);
 
-    /* "sat_toolkit/formula.pyx":395
+    /* "sat_toolkit/formula.pyx":430
  *         for i in range(length):
  *             self._clauses[old_len + i] = clauses[i]
  *             if abs(clauses[i]) > self.nvars:             # <<<<<<<<<<<<<<
  *                 self.nvars = abs(clauses[i])
  * 
  */
     __pyx_t_1 = (__pyx_f_11sat_toolkit_7formula_abs((__pyx_v_clauses[__pyx_v_i])) > __pyx_v_self->nvars);
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":396
+      /* "sat_toolkit/formula.pyx":431
  *             self._clauses[old_len + i] = clauses[i]
  *             if abs(clauses[i]) > self.nvars:
  *                 self.nvars = abs(clauses[i])             # <<<<<<<<<<<<<<
  * 
  *             if clauses[i] == 0 and i + 1 < length:
  */
       __pyx_v_self->nvars = __pyx_f_11sat_toolkit_7formula_abs((__pyx_v_clauses[__pyx_v_i]));
 
-      /* "sat_toolkit/formula.pyx":395
+      /* "sat_toolkit/formula.pyx":430
  *         for i in range(length):
  *             self._clauses[old_len + i] = clauses[i]
  *             if abs(clauses[i]) > self.nvars:             # <<<<<<<<<<<<<<
  *                 self.nvars = abs(clauses[i])
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":398
+    /* "sat_toolkit/formula.pyx":433
  *                 self.nvars = abs(clauses[i])
  * 
  *             if clauses[i] == 0 and i + 1 < length:             # <<<<<<<<<<<<<<
  *                 self._start_indices.push_back(old_len + i + 1)
  * 
  */
     __pyx_t_3 = ((__pyx_v_clauses[__pyx_v_i]) == 0);
@@ -28882,15 +29349,15 @@
       goto __pyx_L18_bool_binop_done;
     }
     __pyx_t_3 = ((__pyx_v_i + 1) < __pyx_v_length);
     __pyx_t_1 = __pyx_t_3;
     __pyx_L18_bool_binop_done:;
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":399
+      /* "sat_toolkit/formula.pyx":434
  * 
  *             if clauses[i] == 0 and i + 1 < length:
  *                 self._start_indices.push_back(old_len + i + 1)             # <<<<<<<<<<<<<<
  * 
  *         return 0
  */
       try {
@@ -28899,39 +29366,39 @@
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         __Pyx_CppExn2PyErr();
         #ifdef WITH_THREAD
         __Pyx_PyGILState_Release(__pyx_gilstate_save);
         #endif
-        __PYX_ERR(0, 399, __pyx_L1_error)
+        __PYX_ERR(0, 434, __pyx_L1_error)
       }
 
-      /* "sat_toolkit/formula.pyx":398
+      /* "sat_toolkit/formula.pyx":433
  *                 self.nvars = abs(clauses[i])
  * 
  *             if clauses[i] == 0 and i + 1 < length:             # <<<<<<<<<<<<<<
  *                 self._start_indices.push_back(old_len + i + 1)
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":401
+  /* "sat_toolkit/formula.pyx":436
  *                 self._start_indices.push_back(old_len + i + 1)
  * 
  *         return 0             # <<<<<<<<<<<<<<
  * 
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":378
- *         return result_list
+  /* "sat_toolkit/formula.pyx":413
+ *         return res
  * 
  *     cdef int _add_clauses_raw(self, const int *clauses, size_t length) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t old_len, i
  * 
  */
 
   /* function exit code */
@@ -28946,15 +29413,15 @@
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   __pyx_L0:;
   __Pyx_RefNannyFinishContextNogil()
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":403
+/* "sat_toolkit/formula.pyx":438
  *         return 0
  * 
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:             # <<<<<<<<<<<<<<
  *         if clauses.shape[0] == 0:
  *             return 0
  */
 
@@ -28966,56 +29433,56 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save;
   #endif
 
-  /* "sat_toolkit/formula.pyx":404
+  /* "sat_toolkit/formula.pyx":439
  * 
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:
  *         if clauses.shape[0] == 0:             # <<<<<<<<<<<<<<
  *             return 0
  *         return self._add_clauses_raw(&clauses[0], clauses.shape[0])
  */
   __pyx_t_1 = ((__pyx_v_clauses.shape[0]) == 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":405
+    /* "sat_toolkit/formula.pyx":440
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:
  *         if clauses.shape[0] == 0:
  *             return 0             # <<<<<<<<<<<<<<
  *         return self._add_clauses_raw(&clauses[0], clauses.shape[0])
  * 
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":404
+    /* "sat_toolkit/formula.pyx":439
  * 
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:
  *         if clauses.shape[0] == 0:             # <<<<<<<<<<<<<<
  *             return 0
  *         return self._add_clauses_raw(&clauses[0], clauses.shape[0])
  */
   }
 
-  /* "sat_toolkit/formula.pyx":406
+  /* "sat_toolkit/formula.pyx":441
  *         if clauses.shape[0] == 0:
  *             return 0
  *         return self._add_clauses_raw(&clauses[0], clauses.shape[0])             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_2 = 0;
-  __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses_raw(__pyx_v_self, (&(*((int const  *) ( /* dim=0 */ (__pyx_v_clauses.data + __pyx_t_2 * __pyx_v_clauses.strides[0]) )))), (__pyx_v_clauses.shape[0])); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 406, __pyx_L1_error)
+  __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses_raw(__pyx_v_self, (&(*((int const  *) ( /* dim=0 */ (__pyx_v_clauses.data + __pyx_t_2 * __pyx_v_clauses.strides[0]) )))), (__pyx_v_clauses.shape[0])); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 441, __pyx_L1_error)
   __pyx_r = __pyx_t_3;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":403
+  /* "sat_toolkit/formula.pyx":438
  *         return 0
  * 
  *     cdef int _add_clauses(self, const int[:] clauses) except -1 nogil:             # <<<<<<<<<<<<<<
  *         if clauses.shape[0] == 0:
  *             return 0
  */
 
@@ -29029,15 +29496,15 @@
   #ifdef WITH_THREAD
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":409
+/* "sat_toolkit/formula.pyx":444
  * 
  * 
  *     cdef str _to_dimacs(self, const char* clause_prefix):             # <<<<<<<<<<<<<<
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()
  */
 
@@ -29060,73 +29527,73 @@
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_to_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":410
+  /* "sat_toolkit/formula.pyx":445
  * 
  *     cdef str _to_dimacs(self, const char* clause_prefix):
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)             # <<<<<<<<<<<<<<
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2) + nclauses * len(clause_prefix)
  */
   __pyx_v_max_len = snprintf(NULL, 0, ((char const *)"%d"), (-__pyx_v_self->nvars));
 
-  /* "sat_toolkit/formula.pyx":411
+  /* "sat_toolkit/formula.pyx":446
  *     cdef str _to_dimacs(self, const char* clause_prefix):
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()             # <<<<<<<<<<<<<<
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2) + nclauses * len(clause_prefix)
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  */
   __pyx_v_nclauses = __pyx_v_self->_start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":412
+  /* "sat_toolkit/formula.pyx":447
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2) + nclauses * len(clause_prefix)             # <<<<<<<<<<<<<<
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  *         cdef ssize_t buf_idx = 0, written
  */
-  __pyx_t_1 = __Pyx_ssize_strlen(__pyx_v_clause_prefix); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 412, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_ssize_strlen(__pyx_v_clause_prefix); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 447, __pyx_L1_error)
   __pyx_v_buf_size = ((((__pyx_v_self->_clauses.size() - __pyx_v_nclauses) * (__pyx_v_max_len + 1)) + (__pyx_v_nclauses * 2)) + (__pyx_v_nclauses * __pyx_t_1));
 
-  /* "sat_toolkit/formula.pyx":413
+  /* "sat_toolkit/formula.pyx":448
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2) + nclauses * len(clause_prefix)
  *         cdef char *buf = <char *> malloc(buf_size + 1)             # <<<<<<<<<<<<<<
  *         cdef ssize_t buf_idx = 0, written
  *         cdef size_t i
  */
   __pyx_v_buf = ((char *)malloc((__pyx_v_buf_size + 1)));
 
-  /* "sat_toolkit/formula.pyx":414
+  /* "sat_toolkit/formula.pyx":449
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2) + nclauses * len(clause_prefix)
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  *         cdef ssize_t buf_idx = 0, written             # <<<<<<<<<<<<<<
  *         cdef size_t i
  * 
  */
   __pyx_v_buf_idx = 0;
 
-  /* "sat_toolkit/formula.pyx":417
+  /* "sat_toolkit/formula.pyx":452
  *         cdef size_t i
  * 
  *         for i in range(self._clauses.size()):             # <<<<<<<<<<<<<<
  *             if i == 0 or self._clauses[i - 1] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  */
   __pyx_t_2 = __pyx_v_self->_clauses.size();
   __pyx_t_3 = __pyx_t_2;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_i = __pyx_t_4;
 
-    /* "sat_toolkit/formula.pyx":418
+    /* "sat_toolkit/formula.pyx":453
  * 
  *         for i in range(self._clauses.size()):
  *             if i == 0 or self._clauses[i - 1] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  *                 if written < 0:
  */
     __pyx_t_6 = (__pyx_v_i == 0);
@@ -29136,294 +29603,294 @@
       goto __pyx_L6_bool_binop_done;
     }
     __pyx_t_6 = ((__pyx_v_self->_clauses[(__pyx_v_i - 1)]) == 0);
     __pyx_t_5 = __pyx_t_6;
     __pyx_L6_bool_binop_done:;
     if (__pyx_t_5) {
 
-      /* "sat_toolkit/formula.pyx":419
+      /* "sat_toolkit/formula.pyx":454
  *         for i in range(self._clauses.size()):
  *             if i == 0 or self._clauses[i - 1] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)             # <<<<<<<<<<<<<<
  *                 if written < 0:
  *                     assert 0
  */
       __pyx_v_written = snprintf((&(__pyx_v_buf[__pyx_v_buf_idx])), __pyx_v_buf_size, ((char const *)"%s"), __pyx_v_clause_prefix);
 
-      /* "sat_toolkit/formula.pyx":420
+      /* "sat_toolkit/formula.pyx":455
  *             if i == 0 or self._clauses[i - 1] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       __pyx_t_5 = (__pyx_v_written < 0);
       if (__pyx_t_5) {
 
-        /* "sat_toolkit/formula.pyx":421
+        /* "sat_toolkit/formula.pyx":456
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  *                 if written < 0:
  *                     assert 0             # <<<<<<<<<<<<<<
  *                 buf_idx += written
  *                 buf_size -= written
  */
         #ifndef CYTHON_WITHOUT_ASSERTIONS
         if (unlikely(__pyx_assertions_enabled())) {
           if (unlikely(!0)) {
             __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-            __PYX_ERR(0, 421, __pyx_L1_error)
+            __PYX_ERR(0, 456, __pyx_L1_error)
           }
         }
         #else
-        if ((1)); else __PYX_ERR(0, 421, __pyx_L1_error)
+        if ((1)); else __PYX_ERR(0, 456, __pyx_L1_error)
         #endif
 
-        /* "sat_toolkit/formula.pyx":420
+        /* "sat_toolkit/formula.pyx":455
  *             if i == 0 or self._clauses[i - 1] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       }
 
-      /* "sat_toolkit/formula.pyx":422
+      /* "sat_toolkit/formula.pyx":457
  *                 if written < 0:
  *                     assert 0
  *                 buf_idx += written             # <<<<<<<<<<<<<<
  *                 buf_size -= written
  * 
  */
       __pyx_v_buf_idx = (__pyx_v_buf_idx + __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":423
+      /* "sat_toolkit/formula.pyx":458
  *                     assert 0
  *                 buf_idx += written
  *                 buf_size -= written             # <<<<<<<<<<<<<<
  * 
  *             if self._clauses[i] == 0:
  */
       __pyx_v_buf_size = (__pyx_v_buf_size - __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":418
+      /* "sat_toolkit/formula.pyx":453
  * 
  *         for i in range(self._clauses.size()):
  *             if i == 0 or self._clauses[i - 1] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "%s", clause_prefix)
  *                 if written < 0:
  */
     }
 
-    /* "sat_toolkit/formula.pyx":425
+    /* "sat_toolkit/formula.pyx":460
  *                 buf_size -= written
  * 
  *             if self._clauses[i] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  */
     __pyx_t_5 = ((__pyx_v_self->_clauses[__pyx_v_i]) == 0);
     if (__pyx_t_5) {
 
-      /* "sat_toolkit/formula.pyx":426
+      /* "sat_toolkit/formula.pyx":461
  * 
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")             # <<<<<<<<<<<<<<
  *                 if written < 0:
  *                     assert 0
  */
       __pyx_v_written = snprintf((&(__pyx_v_buf[__pyx_v_buf_idx])), __pyx_v_buf_size, ((char const *)"0\n"));
 
-      /* "sat_toolkit/formula.pyx":427
+      /* "sat_toolkit/formula.pyx":462
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       __pyx_t_5 = (__pyx_v_written < 0);
       if (__pyx_t_5) {
 
-        /* "sat_toolkit/formula.pyx":428
+        /* "sat_toolkit/formula.pyx":463
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  *                     assert 0             # <<<<<<<<<<<<<<
  *                 buf_idx += written
  *                 buf_size -= written
  */
         #ifndef CYTHON_WITHOUT_ASSERTIONS
         if (unlikely(__pyx_assertions_enabled())) {
           if (unlikely(!0)) {
             __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-            __PYX_ERR(0, 428, __pyx_L1_error)
+            __PYX_ERR(0, 463, __pyx_L1_error)
           }
         }
         #else
-        if ((1)); else __PYX_ERR(0, 428, __pyx_L1_error)
+        if ((1)); else __PYX_ERR(0, 463, __pyx_L1_error)
         #endif
 
-        /* "sat_toolkit/formula.pyx":427
+        /* "sat_toolkit/formula.pyx":462
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       }
 
-      /* "sat_toolkit/formula.pyx":429
+      /* "sat_toolkit/formula.pyx":464
  *                 if written < 0:
  *                     assert 0
  *                 buf_idx += written             # <<<<<<<<<<<<<<
  *                 buf_size -= written
  *             else:
  */
       __pyx_v_buf_idx = (__pyx_v_buf_idx + __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":430
+      /* "sat_toolkit/formula.pyx":465
  *                     assert 0
  *                 buf_idx += written
  *                 buf_size -= written             # <<<<<<<<<<<<<<
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  */
       __pyx_v_buf_size = (__pyx_v_buf_size - __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":425
+      /* "sat_toolkit/formula.pyx":460
  *                 buf_size -= written
  * 
  *             if self._clauses[i] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  */
       goto __pyx_L9;
     }
 
-    /* "sat_toolkit/formula.pyx":432
+    /* "sat_toolkit/formula.pyx":467
  *                 buf_size -= written
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])             # <<<<<<<<<<<<<<
  *                 if written < 0:
  *                     assert 0
  */
     /*else*/ {
       __pyx_v_written = snprintf((&(__pyx_v_buf[__pyx_v_buf_idx])), __pyx_v_buf_size, ((char const *)"%d "), (__pyx_v_self->_clauses[__pyx_v_i]));
 
-      /* "sat_toolkit/formula.pyx":433
+      /* "sat_toolkit/formula.pyx":468
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       __pyx_t_5 = (__pyx_v_written < 0);
       if (__pyx_t_5) {
 
-        /* "sat_toolkit/formula.pyx":434
+        /* "sat_toolkit/formula.pyx":469
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:
  *                     assert 0             # <<<<<<<<<<<<<<
  *                 buf_idx += written
  *                 buf_size -= written
  */
         #ifndef CYTHON_WITHOUT_ASSERTIONS
         if (unlikely(__pyx_assertions_enabled())) {
           if (unlikely(!0)) {
             __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-            __PYX_ERR(0, 434, __pyx_L1_error)
+            __PYX_ERR(0, 469, __pyx_L1_error)
           }
         }
         #else
-        if ((1)); else __PYX_ERR(0, 434, __pyx_L1_error)
+        if ((1)); else __PYX_ERR(0, 469, __pyx_L1_error)
         #endif
 
-        /* "sat_toolkit/formula.pyx":433
+        /* "sat_toolkit/formula.pyx":468
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       }
 
-      /* "sat_toolkit/formula.pyx":435
+      /* "sat_toolkit/formula.pyx":470
  *                 if written < 0:
  *                     assert 0
  *                 buf_idx += written             # <<<<<<<<<<<<<<
  *                 buf_size -= written
  * 
  */
       __pyx_v_buf_idx = (__pyx_v_buf_idx + __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":436
+      /* "sat_toolkit/formula.pyx":471
  *                     assert 0
  *                 buf_idx += written
  *                 buf_size -= written             # <<<<<<<<<<<<<<
  * 
  *         assert buf_size >= 0
  */
       __pyx_v_buf_size = (__pyx_v_buf_size - __pyx_v_written);
     }
     __pyx_L9:;
   }
 
-  /* "sat_toolkit/formula.pyx":438
+  /* "sat_toolkit/formula.pyx":473
  *                 buf_size -= written
  * 
  *         assert buf_size >= 0             # <<<<<<<<<<<<<<
  *         py_str = buf[:buf_idx]
  *         free(buf)
  */
   #ifndef CYTHON_WITHOUT_ASSERTIONS
   if (unlikely(__pyx_assertions_enabled())) {
     __pyx_t_5 = (__pyx_v_buf_size >= 0);
     if (unlikely(!__pyx_t_5)) {
       __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-      __PYX_ERR(0, 438, __pyx_L1_error)
+      __PYX_ERR(0, 473, __pyx_L1_error)
     }
   }
   #else
-  if ((1)); else __PYX_ERR(0, 438, __pyx_L1_error)
+  if ((1)); else __PYX_ERR(0, 473, __pyx_L1_error)
   #endif
 
-  /* "sat_toolkit/formula.pyx":439
+  /* "sat_toolkit/formula.pyx":474
  * 
  *         assert buf_size >= 0
  *         py_str = buf[:buf_idx]             # <<<<<<<<<<<<<<
  *         free(buf)
  * 
  */
-  __pyx_t_7 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf + 0, __pyx_v_buf_idx - 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 439, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf + 0, __pyx_v_buf_idx - 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 474, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_v_py_str = ((PyObject*)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "sat_toolkit/formula.pyx":440
+  /* "sat_toolkit/formula.pyx":475
  *         assert buf_size >= 0
  *         py_str = buf[:buf_idx]
  *         free(buf)             # <<<<<<<<<<<<<<
  * 
  *         return py_str.decode()
  */
   free(__pyx_v_buf);
 
-  /* "sat_toolkit/formula.pyx":442
+  /* "sat_toolkit/formula.pyx":477
  *         free(buf)
  * 
  *         return py_str.decode()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_7 = __Pyx_decode_bytes(__pyx_v_py_str, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_decode_bytes(__pyx_v_py_str, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_r = ((PyObject*)__pyx_t_7);
   __pyx_t_7 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":409
+  /* "sat_toolkit/formula.pyx":444
  * 
  * 
  *     cdef str _to_dimacs(self, const char* clause_prefix):             # <<<<<<<<<<<<<<
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()
  */
 
@@ -29435,33 +29902,33 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_py_str);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":445
+/* "sat_toolkit/formula.pyx":480
  * 
  * 
  *     def add_clauses(self, clauses) -> None:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList c_clauses = None
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_11add_clauses(PyObject *__pyx_v_self, 
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_13add_clauses(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_10add_clauses, "_ClauseList.add_clauses(self, clauses) -> None");
-static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_11add_clauses = {"add_clauses", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_11add_clauses, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_10add_clauses};
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_11add_clauses(PyObject *__pyx_v_self, 
+PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_12add_clauses, "_ClauseList.add_clauses(self, clauses) -> None");
+static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_13add_clauses = {"add_clauses", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_13add_clauses, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_12add_clauses};
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_13add_clauses(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
   PyObject *__pyx_v_clauses = 0;
@@ -29497,58 +29964,58 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_clauses)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 445, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 480, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clauses") < 0)) __PYX_ERR(0, 445, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clauses") < 0)) __PYX_ERR(0, 480, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_clauses = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("add_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 445, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("add_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 480, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.add_clauses", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_10add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_clauses);
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_12add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_clauses);
 
   /* function exit code */
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_10add_clauses(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clauses) {
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_12add_clauses(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clauses) {
   struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_c_clauses = 0;
   __Pyx_memviewslice __pyx_v_clauses_view = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_v_np_clauses = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
@@ -29569,25 +30036,25 @@
   PyObject *__pyx_t_17 = NULL;
   PyObject *__pyx_t_18 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("add_clauses", 1);
 
-  /* "sat_toolkit/formula.pyx":446
+  /* "sat_toolkit/formula.pyx":481
  * 
  *     def add_clauses(self, clauses) -> None:
  *         cdef _ClauseList c_clauses = None             # <<<<<<<<<<<<<<
  * 
  *         try:
  */
   __Pyx_INCREF(Py_None);
   __pyx_v_c_clauses = ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)Py_None);
 
-  /* "sat_toolkit/formula.pyx":448
+  /* "sat_toolkit/formula.pyx":483
  *         cdef _ClauseList c_clauses = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_clauses = clauses
  *         except TypeError:
  */
   {
@@ -29595,57 +30062,57 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "sat_toolkit/formula.pyx":449
+      /* "sat_toolkit/formula.pyx":484
  * 
  *         try:
  *             c_clauses = clauses             # <<<<<<<<<<<<<<
  *         except TypeError:
  *             pass
  */
-      if (!(likely(((__pyx_v_clauses) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_clauses, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 449, __pyx_L3_error)
+      if (!(likely(((__pyx_v_clauses) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_clauses, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 484, __pyx_L3_error)
       __pyx_t_4 = __pyx_v_clauses;
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_DECREF_SET(__pyx_v_c_clauses, ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_4));
       __pyx_t_4 = 0;
 
-      /* "sat_toolkit/formula.pyx":448
+      /* "sat_toolkit/formula.pyx":483
  *         cdef _ClauseList c_clauses = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_clauses = clauses
  *         except TypeError:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":450
+    /* "sat_toolkit/formula.pyx":485
  *         try:
  *             c_clauses = clauses
  *         except TypeError:             # <<<<<<<<<<<<<<
  *             pass
  * 
  */
     __pyx_t_5 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_TypeError);
     if (__pyx_t_5) {
       __Pyx_ErrRestore(0,0,0);
       goto __pyx_L4_exception_handled;
     }
     goto __pyx_L5_except_error;
 
-    /* "sat_toolkit/formula.pyx":448
+    /* "sat_toolkit/formula.pyx":483
  *         cdef _ClauseList c_clauses = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_clauses = clauses
  *         except TypeError:
  */
     __pyx_L5_except_error:;
@@ -29658,104 +30125,104 @@
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     __pyx_L8_try_end:;
   }
 
-  /* "sat_toolkit/formula.pyx":453
+  /* "sat_toolkit/formula.pyx":488
  *             pass
  * 
  *         if c_clauses is not None and not isinstance(c_clauses, type(self)):             # <<<<<<<<<<<<<<
  *             raise TypeError(f'cannot append {type(clauses).__name__} to {type(self).__name__}')
  * 
  */
   __pyx_t_7 = (((PyObject *)__pyx_v_c_clauses) != Py_None);
   if (__pyx_t_7) {
   } else {
     __pyx_t_6 = __pyx_t_7;
     goto __pyx_L10_bool_binop_done;
   }
-  __pyx_t_7 = PyObject_IsInstance(((PyObject *)__pyx_v_c_clauses), ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 453, __pyx_L1_error)
+  __pyx_t_7 = PyObject_IsInstance(((PyObject *)__pyx_v_c_clauses), ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 488, __pyx_L1_error)
   __pyx_t_8 = (!__pyx_t_7);
   __pyx_t_6 = __pyx_t_8;
   __pyx_L10_bool_binop_done:;
   if (unlikely(__pyx_t_6)) {
 
-    /* "sat_toolkit/formula.pyx":454
+    /* "sat_toolkit/formula.pyx":489
  * 
  *         if c_clauses is not None and not isinstance(c_clauses, type(self)):
  *             raise TypeError(f'cannot append {type(clauses).__name__} to {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *         cdef const int[:] clauses_view = None
  */
-    __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 454, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_9 = 0;
     __pyx_t_10 = 127;
     __Pyx_INCREF(__pyx_kp_u_cannot_append);
     __pyx_t_9 += 14;
     __Pyx_GIVEREF(__pyx_kp_u_cannot_append);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_kp_u_cannot_append);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_clauses)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 454, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_clauses)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_12 = __Pyx_PyObject_FormatSimple(__pyx_t_11, __pyx_empty_unicode); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 454, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_FormatSimple(__pyx_t_11, __pyx_empty_unicode); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __pyx_t_10 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_12) > __pyx_t_10) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_12) : __pyx_t_10;
     __pyx_t_9 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_12);
     __Pyx_GIVEREF(__pyx_t_12);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_12);
     __pyx_t_12 = 0;
     __Pyx_INCREF(__pyx_kp_u_to);
     __pyx_t_9 += 4;
     __Pyx_GIVEREF(__pyx_kp_u_to);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_kp_u_to);
-    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 454, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_11 = __Pyx_PyObject_FormatSimple(__pyx_t_12, __pyx_empty_unicode); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 454, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_FormatSimple(__pyx_t_12, __pyx_empty_unicode); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __pyx_t_10 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_11) > __pyx_t_10) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_11) : __pyx_t_10;
     __pyx_t_9 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_11);
     __Pyx_GIVEREF(__pyx_t_11);
     PyTuple_SET_ITEM(__pyx_t_4, 3, __pyx_t_11);
     __pyx_t_11 = 0;
-    __pyx_t_11 = __Pyx_PyUnicode_Join(__pyx_t_4, 4, __pyx_t_9, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 454, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyUnicode_Join(__pyx_t_4, 4, __pyx_t_9, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 454, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_Raise(__pyx_t_4, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __PYX_ERR(0, 454, __pyx_L1_error)
+    __PYX_ERR(0, 489, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":453
+    /* "sat_toolkit/formula.pyx":488
  *             pass
  * 
  *         if c_clauses is not None and not isinstance(c_clauses, type(self)):             # <<<<<<<<<<<<<<
  *             raise TypeError(f'cannot append {type(clauses).__name__} to {type(self).__name__}')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":456
+  /* "sat_toolkit/formula.pyx":491
  *             raise TypeError(f'cannot append {type(clauses).__name__} to {type(self).__name__}')
  * 
  *         cdef const int[:] clauses_view = None             # <<<<<<<<<<<<<<
  * 
  *         try:
  */
-  __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(Py_None, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 456, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(Py_None, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 491, __pyx_L1_error)
   __pyx_v_clauses_view = __pyx_t_13;
   __pyx_t_13.memview = NULL;
   __pyx_t_13.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":458
+  /* "sat_toolkit/formula.pyx":493
  *         cdef const int[:] clauses_view = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             clauses_view = clauses
  *         except (TypeError, ValueError):
  */
   {
@@ -29763,28 +30230,28 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_3, &__pyx_t_2, &__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_1);
     /*try:*/ {
 
-      /* "sat_toolkit/formula.pyx":459
+      /* "sat_toolkit/formula.pyx":494
  * 
  *         try:
  *             clauses_view = clauses             # <<<<<<<<<<<<<<
  *         except (TypeError, ValueError):
  *             np_clauses = np.array(clauses, copy=False, dtype=np.int32)
  */
-      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_clauses, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 459, __pyx_L12_error)
+      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_clauses, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 494, __pyx_L12_error)
       __PYX_XCLEAR_MEMVIEW(&__pyx_v_clauses_view, 1);
       __pyx_v_clauses_view = __pyx_t_13;
       __pyx_t_13.memview = NULL;
       __pyx_t_13.data = NULL;
 
-      /* "sat_toolkit/formula.pyx":458
+      /* "sat_toolkit/formula.pyx":493
  *         cdef const int[:] clauses_view = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             clauses_view = clauses
  *         except (TypeError, ValueError):
  */
     }
@@ -29795,84 +30262,84 @@
     __pyx_L12_error:;
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
     __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":460
+    /* "sat_toolkit/formula.pyx":495
  *         try:
  *             clauses_view = clauses
  *         except (TypeError, ValueError):             # <<<<<<<<<<<<<<
  *             np_clauses = np.array(clauses, copy=False, dtype=np.int32)
  *             clauses_view = np_clauses
  */
     __pyx_t_5 = __Pyx_PyErr_ExceptionMatches2(__pyx_builtin_TypeError, __pyx_builtin_ValueError);
     if (__pyx_t_5) {
       __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.add_clauses", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_11, &__pyx_t_12) < 0) __PYX_ERR(0, 460, __pyx_L14_except_error)
+      if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_11, &__pyx_t_12) < 0) __PYX_ERR(0, 495, __pyx_L14_except_error)
       __Pyx_XGOTREF(__pyx_t_4);
       __Pyx_XGOTREF(__pyx_t_11);
       __Pyx_XGOTREF(__pyx_t_12);
 
-      /* "sat_toolkit/formula.pyx":461
+      /* "sat_toolkit/formula.pyx":496
  *             clauses_view = clauses
  *         except (TypeError, ValueError):
  *             np_clauses = np.array(clauses, copy=False, dtype=np.int32)             # <<<<<<<<<<<<<<
  *             clauses_view = np_clauses
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 461, __pyx_L14_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 496, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_14);
-      __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_array); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 461, __pyx_L14_except_error)
+      __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_array); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 496, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_15);
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-      __pyx_t_14 = PyTuple_New(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 461, __pyx_L14_except_error)
+      __pyx_t_14 = PyTuple_New(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 496, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_INCREF(__pyx_v_clauses);
       __Pyx_GIVEREF(__pyx_v_clauses);
-      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_v_clauses)) __PYX_ERR(0, 461, __pyx_L14_except_error);
-      __pyx_t_16 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 461, __pyx_L14_except_error)
+      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_v_clauses)) __PYX_ERR(0, 496, __pyx_L14_except_error);
+      __pyx_t_16 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 496, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_16);
-      if (PyDict_SetItem(__pyx_t_16, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 461, __pyx_L14_except_error)
-      __Pyx_GetModuleGlobalName(__pyx_t_17, __pyx_n_s_np); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 461, __pyx_L14_except_error)
+      if (PyDict_SetItem(__pyx_t_16, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 496, __pyx_L14_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_17, __pyx_n_s_np); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 496, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_17);
-      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_17, __pyx_n_s_int32); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 461, __pyx_L14_except_error)
+      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_17, __pyx_n_s_int32); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 496, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_18);
       __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
-      if (PyDict_SetItem(__pyx_t_16, __pyx_n_s_dtype, __pyx_t_18) < 0) __PYX_ERR(0, 461, __pyx_L14_except_error)
+      if (PyDict_SetItem(__pyx_t_16, __pyx_n_s_dtype, __pyx_t_18) < 0) __PYX_ERR(0, 496, __pyx_L14_except_error)
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_14, __pyx_t_16); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 461, __pyx_L14_except_error)
+      __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_14, __pyx_t_16); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 496, __pyx_L14_except_error)
       __Pyx_GOTREF(__pyx_t_18);
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
       __pyx_v_np_clauses = __pyx_t_18;
       __pyx_t_18 = 0;
 
-      /* "sat_toolkit/formula.pyx":462
+      /* "sat_toolkit/formula.pyx":497
  *         except (TypeError, ValueError):
  *             np_clauses = np.array(clauses, copy=False, dtype=np.int32)
  *             clauses_view = np_clauses             # <<<<<<<<<<<<<<
  * 
  *         self._add_clauses(clauses_view)
  */
-      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_np_clauses, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 462, __pyx_L14_except_error)
+      __pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_np_clauses, 0); if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 497, __pyx_L14_except_error)
       __PYX_XCLEAR_MEMVIEW(&__pyx_v_clauses_view, 1);
       __pyx_v_clauses_view = __pyx_t_13;
       __pyx_t_13.memview = NULL;
       __pyx_t_13.data = NULL;
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
       goto __pyx_L13_exception_handled;
     }
     goto __pyx_L14_except_error;
 
-    /* "sat_toolkit/formula.pyx":458
+    /* "sat_toolkit/formula.pyx":493
  *         cdef const int[:] clauses_view = None
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             clauses_view = clauses
  *         except (TypeError, ValueError):
  */
     __pyx_L14_except_error:;
@@ -29885,72 +30352,72 @@
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_ExceptionReset(__pyx_t_3, __pyx_t_2, __pyx_t_1);
     __pyx_L17_try_end:;
   }
 
-  /* "sat_toolkit/formula.pyx":464
+  /* "sat_toolkit/formula.pyx":499
  *             clauses_view = np_clauses
  * 
  *         self._add_clauses(clauses_view)             # <<<<<<<<<<<<<<
  * 
  *         if c_clauses is not None:
  */
-  __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses(__pyx_v_self, __pyx_v_clauses_view); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 464, __pyx_L1_error)
+  __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses(__pyx_v_self, __pyx_v_clauses_view); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 499, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":466
+  /* "sat_toolkit/formula.pyx":501
  *         self._add_clauses(clauses_view)
  * 
  *         if c_clauses is not None:             # <<<<<<<<<<<<<<
  *             if c_clauses.nvars > self.nvars:
  *                 self.nvars = c_clauses.nvars
  */
   __pyx_t_6 = (((PyObject *)__pyx_v_c_clauses) != Py_None);
   if (__pyx_t_6) {
 
-    /* "sat_toolkit/formula.pyx":467
+    /* "sat_toolkit/formula.pyx":502
  * 
  *         if c_clauses is not None:
  *             if c_clauses.nvars > self.nvars:             # <<<<<<<<<<<<<<
  *                 self.nvars = c_clauses.nvars
  * 
  */
     __pyx_t_6 = (__pyx_v_c_clauses->nvars > __pyx_v_self->nvars);
     if (__pyx_t_6) {
 
-      /* "sat_toolkit/formula.pyx":468
+      /* "sat_toolkit/formula.pyx":503
  *         if c_clauses is not None:
  *             if c_clauses.nvars > self.nvars:
  *                 self.nvars = c_clauses.nvars             # <<<<<<<<<<<<<<
  * 
  *     def add_clause(self, clause) -> None:
  */
       __pyx_t_5 = __pyx_v_c_clauses->nvars;
       __pyx_v_self->nvars = __pyx_t_5;
 
-      /* "sat_toolkit/formula.pyx":467
+      /* "sat_toolkit/formula.pyx":502
  * 
  *         if c_clauses is not None:
  *             if c_clauses.nvars > self.nvars:             # <<<<<<<<<<<<<<
  *                 self.nvars = c_clauses.nvars
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":466
+    /* "sat_toolkit/formula.pyx":501
  *         self._add_clauses(clauses_view)
  * 
  *         if c_clauses is not None:             # <<<<<<<<<<<<<<
  *             if c_clauses.nvars > self.nvars:
  *                 self.nvars = c_clauses.nvars
  */
   }
 
-  /* "sat_toolkit/formula.pyx":445
+  /* "sat_toolkit/formula.pyx":480
  * 
  * 
  *     def add_clauses(self, clauses) -> None:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList c_clauses = None
  * 
  */
 
@@ -29974,33 +30441,33 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_clauses_view, 1);
   __Pyx_XDECREF(__pyx_v_np_clauses);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":470
+/* "sat_toolkit/formula.pyx":505
  *                 self.nvars = c_clauses.nvars
  * 
  *     def add_clause(self, clause) -> None:             # <<<<<<<<<<<<<<
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_13add_clause(PyObject *__pyx_v_self, 
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_15add_clause(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_12add_clause, "_ClauseList.add_clause(self, clause) -> None\nAdd a single clause to CNF formula. Specify the clause without trailing 0.");
-static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_13add_clause = {"add_clause", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_13add_clause, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_12add_clause};
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_13add_clause(PyObject *__pyx_v_self, 
+PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_14add_clause, "_ClauseList.add_clause(self, clause) -> None\nAdd a single clause to CNF formula. Specify the clause without trailing 0.");
+static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_15add_clause = {"add_clause", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_15add_clause, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_14add_clause};
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_15add_clause(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
   PyObject *__pyx_v_clause = 0;
@@ -30036,58 +30503,58 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_clause)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 470, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 505, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clause") < 0)) __PYX_ERR(0, 470, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clause") < 0)) __PYX_ERR(0, 505, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_clause = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("add_clause", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 470, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("add_clause", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 505, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.add_clause", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_12add_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_clause);
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_14add_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_clause);
 
   /* function exit code */
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_12add_clause(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clause) {
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_14add_clause(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clause) {
   Py_ssize_t __pyx_v_clause_len;
   PyObject *__pyx_v_np_clause = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
@@ -30100,156 +30567,156 @@
   int __pyx_t_10;
   __Pyx_memviewslice __pyx_t_11 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("add_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":473
+  /* "sat_toolkit/formula.pyx":508
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  *         if isinstance(clause, _BaseClause) and not self._check_clause_type(clause):             # <<<<<<<<<<<<<<
  *             raise TypeError(f'cannot append {type(clause).__name__} to {type(self).__name__}')
  * 
  */
   __pyx_t_2 = __Pyx_TypeCheck(__pyx_v_clause, __pyx_ptype_11sat_toolkit_7formula__BaseClause); 
   if (__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L4_bool_binop_done;
   }
-  if (!(likely(((__pyx_v_clause) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_clause, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 473, __pyx_L1_error)
+  if (!(likely(((__pyx_v_clause) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_clause, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 508, __pyx_L1_error)
   __pyx_t_2 = (!(((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_check_clause_type(__pyx_v_self, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_clause)) != 0));
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":474
+    /* "sat_toolkit/formula.pyx":509
  * 
  *         if isinstance(clause, _BaseClause) and not self._check_clause_type(clause):
  *             raise TypeError(f'cannot append {type(clause).__name__} to {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *         cdef ssize_t clause_len = len(clause)
  */
-    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 474, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = 0;
     __pyx_t_5 = 127;
     __Pyx_INCREF(__pyx_kp_u_cannot_append);
     __pyx_t_4 += 14;
     __Pyx_GIVEREF(__pyx_kp_u_cannot_append);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_kp_u_cannot_append);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_clause)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 474, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_clause)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 509, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_6, __pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 474, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_6, __pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 509, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_5 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) > __pyx_t_5) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) : __pyx_t_5;
     __pyx_t_4 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_7);
     __pyx_t_7 = 0;
     __Pyx_INCREF(__pyx_kp_u_to);
     __pyx_t_4 += 4;
     __Pyx_GIVEREF(__pyx_kp_u_to);
     PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_kp_u_to);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 474, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 509, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_t_7, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 474, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_t_7, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 509, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_5 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) > __pyx_t_5) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) : __pyx_t_5;
     __pyx_t_4 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_t_6);
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Join(__pyx_t_3, 4, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 474, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Join(__pyx_t_3, 4, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 509, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 474, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 474, __pyx_L1_error)
+    __PYX_ERR(0, 509, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":473
+    /* "sat_toolkit/formula.pyx":508
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  *         if isinstance(clause, _BaseClause) and not self._check_clause_type(clause):             # <<<<<<<<<<<<<<
  *             raise TypeError(f'cannot append {type(clause).__name__} to {type(self).__name__}')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":476
+  /* "sat_toolkit/formula.pyx":511
  *             raise TypeError(f'cannot append {type(clause).__name__} to {type(self).__name__}')
  * 
  *         cdef ssize_t clause_len = len(clause)             # <<<<<<<<<<<<<<
  *         np_clause = np.zeros(clause_len + 1, dtype=np.int32)
  *         np_clause[:clause_len] = clause
  */
-  __pyx_t_4 = PyObject_Length(__pyx_v_clause); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 476, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_clause); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 511, __pyx_L1_error)
   __pyx_v_clause_len = __pyx_t_4;
 
-  /* "sat_toolkit/formula.pyx":477
+  /* "sat_toolkit/formula.pyx":512
  * 
  *         cdef ssize_t clause_len = len(clause)
  *         np_clause = np.zeros(clause_len + 1, dtype=np.int32)             # <<<<<<<<<<<<<<
  *         np_clause[:clause_len] = clause
  *         if np.count_nonzero(np_clause) != clause_len:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 512, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 512, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyInt_FromSsize_t((__pyx_v_clause_len + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t((__pyx_v_clause_len + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 512, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 512, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3)) __PYX_ERR(0, 512, __pyx_L1_error);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 512, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 512, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_int32); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 512, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) < 0) __PYX_ERR(0, 477, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) < 0) __PYX_ERR(0, 512, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 512, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_np_clause = __pyx_t_9;
   __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":478
+  /* "sat_toolkit/formula.pyx":513
  *         cdef ssize_t clause_len = len(clause)
  *         np_clause = np.zeros(clause_len + 1, dtype=np.int32)
  *         np_clause[:clause_len] = clause             # <<<<<<<<<<<<<<
  *         if np.count_nonzero(np_clause) != clause_len:
  *             raise ValueError('cannot use 0 in clause')
  */
-  if (__Pyx_PyObject_SetSlice(__pyx_v_np_clause, __pyx_v_clause, 0, __pyx_v_clause_len, NULL, NULL, NULL, 0, 1, 0) < 0) __PYX_ERR(0, 478, __pyx_L1_error)
+  if (__Pyx_PyObject_SetSlice(__pyx_v_np_clause, __pyx_v_clause, 0, __pyx_v_clause_len, NULL, NULL, NULL, 0, 1, 0) < 0) __PYX_ERR(0, 513, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":479
+  /* "sat_toolkit/formula.pyx":514
  *         np_clause = np.zeros(clause_len + 1, dtype=np.int32)
  *         np_clause[:clause_len] = clause
  *         if np.count_nonzero(np_clause) != clause_len:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot use 0 in clause')
  *         self._add_clauses(np_clause)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 479, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 514, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_count_nonzero); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 479, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_count_nonzero); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 514, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   __pyx_t_10 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
@@ -30262,62 +30729,62 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_np_clause};
     __pyx_t_9 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 479, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 514, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
-  __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_clause_len); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 479, __pyx_L1_error)
+  __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_clause_len); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 514, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_9, __pyx_t_7, Py_NE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 479, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_9, __pyx_t_7, Py_NE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 514, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_1 < 0))) __PYX_ERR(0, 479, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_1 < 0))) __PYX_ERR(0, 514, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":480
+    /* "sat_toolkit/formula.pyx":515
  *         np_clause[:clause_len] = clause
  *         if np.count_nonzero(np_clause) != clause_len:
  *             raise ValueError('cannot use 0 in clause')             # <<<<<<<<<<<<<<
  *         self._add_clauses(np_clause)
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 515, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 480, __pyx_L1_error)
+    __PYX_ERR(0, 515, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":479
+    /* "sat_toolkit/formula.pyx":514
  *         np_clause = np.zeros(clause_len + 1, dtype=np.int32)
  *         np_clause[:clause_len] = clause
  *         if np.count_nonzero(np_clause) != clause_len:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot use 0 in clause')
  *         self._add_clauses(np_clause)
  */
   }
 
-  /* "sat_toolkit/formula.pyx":481
+  /* "sat_toolkit/formula.pyx":516
  *         if np.count_nonzero(np_clause) != clause_len:
  *             raise ValueError('cannot use 0 in clause')
  *         self._add_clauses(np_clause)             # <<<<<<<<<<<<<<
  * 
  *     append = add_clause
  */
-  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_np_clause, 0); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 481, __pyx_L1_error)
-  __pyx_t_10 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses(__pyx_v_self, __pyx_t_11); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 481, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_np_clause, 0); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 516, __pyx_L1_error)
+  __pyx_t_10 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_add_clauses(__pyx_v_self, __pyx_t_11); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 516, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
   __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":470
+  /* "sat_toolkit/formula.pyx":505
  *                 self.nvars = c_clauses.nvars
  * 
  *     def add_clause(self, clause) -> None:             # <<<<<<<<<<<<<<
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  */
 
@@ -30336,57 +30803,57 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_np_clause);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":485
+/* "sat_toolkit/formula.pyx":520
  *     append = add_clause
  * 
  *     def __iadd__(self, clauses) -> Self:             # <<<<<<<<<<<<<<
  *         self.add_clauses(clauses)
  *         return self
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_15__iadd__(PyObject *__pyx_v_self, PyObject *__pyx_v_clauses); /*proto*/
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_15__iadd__(PyObject *__pyx_v_self, PyObject *__pyx_v_clauses) {
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_17__iadd__(PyObject *__pyx_v_self, PyObject *__pyx_v_clauses); /*proto*/
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_17__iadd__(PyObject *__pyx_v_self, PyObject *__pyx_v_clauses) {
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__iadd__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_14__iadd__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((PyObject *)__pyx_v_clauses));
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_16__iadd__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((PyObject *)__pyx_v_clauses));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_14__iadd__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clauses) {
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_16__iadd__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_clauses) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__iadd__", 1);
 
-  /* "sat_toolkit/formula.pyx":486
+  /* "sat_toolkit/formula.pyx":521
  * 
  *     def __iadd__(self, clauses) -> Self:
  *         self.add_clauses(clauses)             # <<<<<<<<<<<<<<
  *         return self
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 486, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 521, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -30398,33 +30865,33 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_clauses};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 521, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":487
+  /* "sat_toolkit/formula.pyx":522
  *     def __iadd__(self, clauses) -> Self:
  *         self.add_clauses(clauses)
  *         return self             # <<<<<<<<<<<<<<
  * 
  *     def __add__(self, _ClauseList other) -> Self:
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_self);
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":485
+  /* "sat_toolkit/formula.pyx":520
  *     append = add_clause
  * 
  *     def __iadd__(self, clauses) -> Self:             # <<<<<<<<<<<<<<
  *         self.add_clauses(clauses)
  *         return self
  */
 
@@ -30437,46 +30904,46 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":489
+/* "sat_toolkit/formula.pyx":524
  *         return self
  * 
  *     def __add__(self, _ClauseList other) -> Self:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList res
  *         res = type(self).__new__(type(self))
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_17__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_17__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_19__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_19__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__add__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_other), __pyx_ptype_11sat_toolkit_7formula__ClauseList, 1, "other", 0))) __PYX_ERR(0, 489, __pyx_L1_error)
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_16__add__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_other));
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_other), __pyx_ptype_11sat_toolkit_7formula__ClauseList, 1, "other", 0))) __PYX_ERR(0, 524, __pyx_L1_error)
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_18__add__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_other));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_16__add__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_other) {
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_18__add__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_other) {
   struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_res = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
@@ -30485,22 +30952,22 @@
   int __pyx_t_7;
   __Pyx_memviewslice __pyx_t_8 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__add__", 1);
 
-  /* "sat_toolkit/formula.pyx":491
+  /* "sat_toolkit/formula.pyx":526
  *     def __add__(self, _ClauseList other) -> Self:
  *         cdef _ClauseList res
  *         res = type(self).__new__(type(self))             # <<<<<<<<<<<<<<
  *         res.nvars = max(self.nvars, other.nvars)
  *         res._add_clauses(self)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 491, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 526, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -30512,23 +30979,23 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 526, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 491, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula__ClauseList))))) __PYX_ERR(0, 526, __pyx_L1_error)
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":492
+  /* "sat_toolkit/formula.pyx":527
  *         cdef _ClauseList res
  *         res = type(self).__new__(type(self))
  *         res.nvars = max(self.nvars, other.nvars)             # <<<<<<<<<<<<<<
  *         res._add_clauses(self)
  *         res._add_clauses(other)
  */
   __pyx_t_4 = __pyx_v_other->nvars;
@@ -30537,51 +31004,51 @@
   if (__pyx_t_7) {
     __pyx_t_6 = __pyx_t_4;
   } else {
     __pyx_t_6 = __pyx_t_5;
   }
   __pyx_v_res->nvars = __pyx_t_6;
 
-  /* "sat_toolkit/formula.pyx":493
+  /* "sat_toolkit/formula.pyx":528
  *         res = type(self).__new__(type(self))
  *         res.nvars = max(self.nvars, other.nvars)
  *         res._add_clauses(self)             # <<<<<<<<<<<<<<
  *         res._add_clauses(other)
  *         return res
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_self), 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 493, __pyx_L1_error)
-  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->__pyx_vtab)->_add_clauses(__pyx_v_res, __pyx_t_8); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 493, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_self), 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 528, __pyx_L1_error)
+  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->__pyx_vtab)->_add_clauses(__pyx_v_res, __pyx_t_8); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 528, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
   __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":494
+  /* "sat_toolkit/formula.pyx":529
  *         res.nvars = max(self.nvars, other.nvars)
  *         res._add_clauses(self)
  *         res._add_clauses(other)             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_other), 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 494, __pyx_L1_error)
-  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->__pyx_vtab)->_add_clauses(__pyx_v_res, __pyx_t_8); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 494, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_other), 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->__pyx_vtab)->_add_clauses(__pyx_v_res, __pyx_t_8); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 529, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
   __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":495
+  /* "sat_toolkit/formula.pyx":530
  *         res._add_clauses(self)
  *         res._add_clauses(other)
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     cdef int[::1] _get_clause(self, ssize_t idx):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = ((PyObject *)__pyx_v_res);
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":489
+  /* "sat_toolkit/formula.pyx":524
  *         return self
  * 
  *     def __add__(self, _ClauseList other) -> Self:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList res
  *         res = type(self).__new__(type(self))
  */
 
@@ -30596,15 +31063,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":497
+/* "sat_toolkit/formula.pyx":532
  *         return res
  * 
  *     cdef int[::1] _get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()
  */
 
@@ -30623,52 +31090,52 @@
   PyObject *__pyx_t_7 = NULL;
   __Pyx_memviewslice __pyx_t_8 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_get_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":499
+  /* "sat_toolkit/formula.pyx":534
  *     cdef int[::1] _get_clause(self, ssize_t idx):
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()             # <<<<<<<<<<<<<<
  * 
  *         if idx < 0:
  */
   __pyx_v_numclauses = __pyx_v_self->_start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":501
+  /* "sat_toolkit/formula.pyx":536
  *         cdef size_t numclauses = self._start_indices.size()
  * 
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             idx += numclauses
  *         if idx < 0 or <size_t> idx >= numclauses:
  */
   __pyx_t_1 = (__pyx_v_idx < 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":502
+    /* "sat_toolkit/formula.pyx":537
  * 
  *         if idx < 0:
  *             idx += numclauses             # <<<<<<<<<<<<<<
  *         if idx < 0 or <size_t> idx >= numclauses:
  *             raise IndexError('index out of range')
  */
     __pyx_v_idx = (__pyx_v_idx + __pyx_v_numclauses);
 
-    /* "sat_toolkit/formula.pyx":501
+    /* "sat_toolkit/formula.pyx":536
  *         cdef size_t numclauses = self._start_indices.size()
  * 
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             idx += numclauses
  *         if idx < 0 or <size_t> idx >= numclauses:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":503
+  /* "sat_toolkit/formula.pyx":538
  *         if idx < 0:
  *             idx += numclauses
  *         if idx < 0 or <size_t> idx >= numclauses:             # <<<<<<<<<<<<<<
  *             raise IndexError('index out of range')
  * 
  */
   __pyx_t_2 = (__pyx_v_idx < 0);
@@ -30678,91 +31145,91 @@
     goto __pyx_L5_bool_binop_done;
   }
   __pyx_t_2 = (((size_t)__pyx_v_idx) >= __pyx_v_numclauses);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L5_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":504
+    /* "sat_toolkit/formula.pyx":539
  *             idx += numclauses
  *         if idx < 0 or <size_t> idx >= numclauses:
  *             raise IndexError('index out of range')             # <<<<<<<<<<<<<<
  * 
  *         begin = self._start_indices[idx]
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 504, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 539, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 504, __pyx_L1_error)
+    __PYX_ERR(0, 539, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":503
+    /* "sat_toolkit/formula.pyx":538
  *         if idx < 0:
  *             idx += numclauses
  *         if idx < 0 or <size_t> idx >= numclauses:             # <<<<<<<<<<<<<<
  *             raise IndexError('index out of range')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":506
+  /* "sat_toolkit/formula.pyx":541
  *             raise IndexError('index out of range')
  * 
  *         begin = self._start_indices[idx]             # <<<<<<<<<<<<<<
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  *         return (<int[:self._clauses.size()]> self._clauses.data())[begin:end - 1]
  */
   __pyx_v_begin = (__pyx_v_self->_start_indices[__pyx_v_idx]);
 
-  /* "sat_toolkit/formula.pyx":507
+  /* "sat_toolkit/formula.pyx":542
  * 
  *         begin = self._start_indices[idx]
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()             # <<<<<<<<<<<<<<
  *         return (<int[:self._clauses.size()]> self._clauses.data())[begin:end - 1]
  * 
  */
   __pyx_t_1 = ((((size_t)__pyx_v_idx) + 1) < __pyx_v_numclauses);
   if (__pyx_t_1) {
     __pyx_t_4 = (__pyx_v_self->_start_indices[(__pyx_v_idx + 1)]);
   } else {
     __pyx_t_4 = __pyx_v_self->_clauses.size();
   }
   __pyx_v_end = __pyx_t_4;
 
-  /* "sat_toolkit/formula.pyx":508
+  /* "sat_toolkit/formula.pyx":543
  *         begin = self._start_indices[idx]
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  *         return (<int[:self._clauses.size()]> self._clauses.data())[begin:end - 1]             # <<<<<<<<<<<<<<
  * 
  *     cdef _BaseClause get_clause(self, ssize_t idx):
  */
   __pyx_t_5 = __pyx_v_self->_clauses.data();
   if (!__pyx_t_5) {
     PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-    __PYX_ERR(0, 508, __pyx_L1_error)
+    __PYX_ERR(0, 543, __pyx_L1_error)
   }
-  __pyx_t_7 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_7 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_3 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_self->_clauses.size())); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_3 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_self->_clauses.size())); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __pyx_array_new(__pyx_t_3, sizeof(int), PyBytes_AS_STRING(__pyx_t_7), (char *) "c", (char *) __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_6 = __pyx_array_new(__pyx_t_3, sizeof(int), PyBytes_AS_STRING(__pyx_t_7), (char *) "c", (char *) __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetSlice(((PyObject *)__pyx_t_6), __pyx_v_begin, (__pyx_v_end - 1), NULL, NULL, NULL, 1, 1, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetSlice(((PyObject *)__pyx_t_6), __pyx_v_begin, (__pyx_v_end - 1), NULL, NULL, NULL, 1, 1, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF((PyObject *)__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 508, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_r = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":497
+  /* "sat_toolkit/formula.pyx":532
  *         return res
  * 
  *     cdef int[::1] _get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()
  */
 
@@ -30781,15 +31248,15 @@
     PyErr_SetString(PyExc_TypeError, "Memoryview return value is not initialized");
   }
   __pyx_L2:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":510
+/* "sat_toolkit/formula.pyx":545
  *         return (<int[:self._clauses.size()]> self._clauses.data())[begin:end - 1]
  * 
  *     cdef _BaseClause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError('should be implemented by subclass')
  * 
  */
 
@@ -30798,28 +31265,28 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":511
+  /* "sat_toolkit/formula.pyx":546
  * 
  *     cdef _BaseClause get_clause(self, ssize_t idx):
  *         raise NotImplementedError('should be implemented by subclass')             # <<<<<<<<<<<<<<
  * 
  *     def __getitem__(self, ssize_t idx) -> Clause:
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_NotImplementedError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 546, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __PYX_ERR(0, 511, __pyx_L1_error)
+  __PYX_ERR(0, 546, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":510
+  /* "sat_toolkit/formula.pyx":545
  *         return (<int[:self._clauses.size()]> self._clauses.data())[begin:end - 1]
  * 
  *     cdef _BaseClause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         raise NotImplementedError('should be implemented by subclass')
  * 
  */
 
@@ -30829,74 +31296,74 @@
   __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.get_clause", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":513
+/* "sat_toolkit/formula.pyx":548
  *         raise NotImplementedError('should be implemented by subclass')
  * 
  *     def __getitem__(self, ssize_t idx) -> Clause:             # <<<<<<<<<<<<<<
  *         return self.get_clause(idx)
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_19__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_idx); /*proto*/
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_19__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_idx) {
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_21__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_idx); /*proto*/
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_21__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_arg_idx) {
   Py_ssize_t __pyx_v_idx;
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__getitem__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
   assert(__pyx_arg_idx); {
-    __pyx_v_idx = PyInt_AsSsize_t(__pyx_arg_idx); if (unlikely((__pyx_v_idx == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 513, __pyx_L3_error)
+    __pyx_v_idx = PyInt_AsSsize_t(__pyx_arg_idx); if (unlikely((__pyx_v_idx == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 548, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_18__getitem__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((Py_ssize_t)__pyx_v_idx));
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_20__getitem__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((Py_ssize_t)__pyx_v_idx));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_18__getitem__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_ssize_t __pyx_v_idx) {
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_20__getitem__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_ssize_t __pyx_v_idx) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__getitem__", 1);
 
-  /* "sat_toolkit/formula.pyx":514
+  /* "sat_toolkit/formula.pyx":549
  * 
  *     def __getitem__(self, ssize_t idx) -> Clause:
  *         return self.get_clause(idx)             # <<<<<<<<<<<<<<
  * 
  *     def __len__(self) -> int:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->get_clause(__pyx_v_self, __pyx_v_idx)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->get_clause(__pyx_v_self, __pyx_v_idx)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 549, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":513
+  /* "sat_toolkit/formula.pyx":548
  *         raise NotImplementedError('should be implemented by subclass')
  * 
  *     def __getitem__(self, ssize_t idx) -> Clause:             # <<<<<<<<<<<<<<
  *         return self.get_clause(idx)
  * 
  */
 
@@ -30907,108 +31374,108 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":516
+/* "sat_toolkit/formula.pyx":551
  *         return self.get_clause(idx)
  * 
  *     def __len__(self) -> int:             # <<<<<<<<<<<<<<
  *         return self._start_indices.size()
  * 
  */
 
 /* Python wrapper */
-static Py_ssize_t __pyx_pw_11sat_toolkit_7formula_11_ClauseList_21__len__(PyObject *__pyx_v_self); /*proto*/
-static Py_ssize_t __pyx_pw_11sat_toolkit_7formula_11_ClauseList_21__len__(PyObject *__pyx_v_self) {
+static Py_ssize_t __pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__len__(PyObject *__pyx_v_self); /*proto*/
+static Py_ssize_t __pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__len__(PyObject *__pyx_v_self) {
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
   Py_ssize_t __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__len__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_20__len__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self));
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_22__len__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static Py_ssize_t __pyx_pf_11sat_toolkit_7formula_11_ClauseList_20__len__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self) {
+static Py_ssize_t __pyx_pf_11sat_toolkit_7formula_11_ClauseList_22__len__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self) {
   Py_ssize_t __pyx_r;
 
-  /* "sat_toolkit/formula.pyx":517
+  /* "sat_toolkit/formula.pyx":552
  * 
  *     def __len__(self) -> int:
  *         return self._start_indices.size()             # <<<<<<<<<<<<<<
  * 
  *     def __iter__(self) -> Iterable[Clause]:
  */
   __pyx_r = __pyx_v_self->_start_indices.size();
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":516
+  /* "sat_toolkit/formula.pyx":551
  *         return self.get_clause(idx)
  * 
  *     def __len__(self) -> int:             # <<<<<<<<<<<<<<
  *         return self._start_indices.size()
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
-static PyObject *__pyx_gb_11sat_toolkit_7formula_11_ClauseList_24generator2(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+static PyObject *__pyx_gb_11sat_toolkit_7formula_11_ClauseList_26generator2(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "sat_toolkit/formula.pyx":519
+/* "sat_toolkit/formula.pyx":554
  *         return self._start_indices.size()
  * 
  *     def __iter__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i = 0
  *         while i < self._start_indices.size():
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__iter__(PyObject *__pyx_v_self); /*proto*/
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__iter__(PyObject *__pyx_v_self) {
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_25__iter__(PyObject *__pyx_v_self); /*proto*/
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_25__iter__(PyObject *__pyx_v_self) {
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__iter__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_22__iter__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self));
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_24__iter__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_22__iter__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self) {
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_24__iter__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self) {
   struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__iter__", 0);
   __pyx_cur_scope = (struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ *)__pyx_tp_new_11sat_toolkit_7formula___pyx_scope_struct_2___iter__(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 519, __pyx_L1_error)
+    __PYX_ERR(0, 554, __pyx_L1_error)
   } else {
     __Pyx_GOTREF((PyObject *)__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF((PyObject *)__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF((PyObject *)__pyx_cur_scope->__pyx_v_self);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11sat_toolkit_7formula_11_ClauseList_24generator2, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter, __pyx_n_s_ClauseList___iter, __pyx_n_s_sat_toolkit_formula); if (unlikely(!gen)) __PYX_ERR(0, 519, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11sat_toolkit_7formula_11_ClauseList_26generator2, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter, __pyx_n_s_ClauseList___iter, __pyx_n_s_sat_toolkit_formula); if (unlikely(!gen)) __PYX_ERR(0, 554, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -31016,15 +31483,15 @@
   __pyx_r = NULL;
   __Pyx_DECREF((PyObject *)__pyx_cur_scope);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_gb_11sat_toolkit_7formula_11_ClauseList_24generator2(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+static PyObject *__pyx_gb_11sat_toolkit_7formula_11_ClauseList_26generator2(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
   struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ *__pyx_cur_scope = ((struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -31035,68 +31502,68 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L6_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 519, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 554, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":520
+  /* "sat_toolkit/formula.pyx":555
  * 
  *     def __iter__(self) -> Iterable[Clause]:
  *         cdef size_t i = 0             # <<<<<<<<<<<<<<
  *         while i < self._start_indices.size():
  *             yield self.get_clause(i)
  */
   __pyx_cur_scope->__pyx_v_i = 0;
 
-  /* "sat_toolkit/formula.pyx":521
+  /* "sat_toolkit/formula.pyx":556
  *     def __iter__(self) -> Iterable[Clause]:
  *         cdef size_t i = 0
  *         while i < self._start_indices.size():             # <<<<<<<<<<<<<<
  *             yield self.get_clause(i)
  *             i += 1
  */
   while (1) {
     __pyx_t_1 = (__pyx_cur_scope->__pyx_v_i < __pyx_cur_scope->__pyx_v_self->_start_indices.size());
     if (!__pyx_t_1) break;
 
-    /* "sat_toolkit/formula.pyx":522
+    /* "sat_toolkit/formula.pyx":557
  *         cdef size_t i = 0
  *         while i < self._start_indices.size():
  *             yield self.get_clause(i)             # <<<<<<<<<<<<<<
  *             i += 1
  * 
  */
-    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_cur_scope->__pyx_v_self->__pyx_vtab)->get_clause(__pyx_cur_scope->__pyx_v_self, __pyx_cur_scope->__pyx_v_i)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)
+    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_cur_scope->__pyx_v_self->__pyx_vtab)->get_clause(__pyx_cur_scope->__pyx_v_self, __pyx_cur_scope->__pyx_v_i)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 557, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     __Pyx_XGIVEREF(__pyx_r);
     __Pyx_RefNannyFinishContext();
     __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
     /* return from generator, yielding value */
     __pyx_generator->resume_label = 1;
     return __pyx_r;
     __pyx_L6_resume_from_yield:;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 522, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 557, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":523
+    /* "sat_toolkit/formula.pyx":558
  *         while i < self._start_indices.size():
  *             yield self.get_clause(i)
  *             i += 1             # <<<<<<<<<<<<<<
  * 
  * 
  */
     __pyx_cur_scope->__pyx_v_i = (__pyx_cur_scope->__pyx_v_i + 1);
   }
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "sat_toolkit/formula.pyx":519
+  /* "sat_toolkit/formula.pyx":554
  *         return self._start_indices.size()
  * 
  *     def __iter__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i = 0
  *         while i < self._start_indices.size():
  */
 
@@ -31113,35 +31580,35 @@
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-static PyObject *__pyx_gb_11sat_toolkit_7formula_11_ClauseList_27generator3(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+static PyObject *__pyx_gb_11sat_toolkit_7formula_11_ClauseList_29generator3(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "sat_toolkit/formula.pyx":526
+/* "sat_toolkit/formula.pyx":561
  * 
  * 
  *     def __reversed__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_26__reversed__(PyObject *__pyx_v_self, 
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_28__reversed__(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_25__reversed__, "_ClauseList.__reversed__(self) -> Iterable[Clause]");
-static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_26__reversed__ = {"__reversed__", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_26__reversed__, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_25__reversed__};
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_26__reversed__(PyObject *__pyx_v_self, 
+PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_27__reversed__, "_ClauseList.__reversed__(self) -> Iterable[Clause]");
+static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_28__reversed__ = {"__reversed__", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_28__reversed__, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_27__reversed__};
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_28__reversed__(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
   #if !CYTHON_METH_FASTCALL
@@ -31158,42 +31625,42 @@
   __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
   #endif
   #endif
   __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
   if (unlikely(__pyx_nargs > 0)) {
     __Pyx_RaiseArgtupleInvalid("__reversed__", 1, 0, 0, __pyx_nargs); return NULL;}
   if (unlikely(__pyx_kwds) && __Pyx_NumKwargs_FASTCALL(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__reversed__", 0))) return NULL;
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_25__reversed__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self));
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_27__reversed__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_25__reversed__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self) {
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_27__reversed__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self) {
   struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reversed__", 0);
   __pyx_cur_scope = (struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ *)__pyx_tp_new_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 526, __pyx_L1_error)
+    __PYX_ERR(0, 561, __pyx_L1_error)
   } else {
     __Pyx_GOTREF((PyObject *)__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF((PyObject *)__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF((PyObject *)__pyx_cur_scope->__pyx_v_self);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11sat_toolkit_7formula_11_ClauseList_27generator3, __pyx_codeobj__25, (PyObject *) __pyx_cur_scope, __pyx_n_s_reversed_2, __pyx_n_s_ClauseList___reversed, __pyx_n_s_sat_toolkit_formula); if (unlikely(!gen)) __PYX_ERR(0, 526, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_11sat_toolkit_7formula_11_ClauseList_29generator3, __pyx_codeobj__27, (PyObject *) __pyx_cur_scope, __pyx_n_s_reversed_2, __pyx_n_s_ClauseList___reversed, __pyx_n_s_sat_toolkit_formula); if (unlikely(!gen)) __PYX_ERR(0, 561, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -31201,15 +31668,15 @@
   __pyx_r = NULL;
   __Pyx_DECREF((PyObject *)__pyx_cur_scope);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_gb_11sat_toolkit_7formula_11_ClauseList_27generator3(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+static PyObject *__pyx_gb_11sat_toolkit_7formula_11_ClauseList_29generator3(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
   struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ *__pyx_cur_scope = ((struct __pyx_obj_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   size_t __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -31220,51 +31687,51 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L6_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 526, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 561, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":528
+  /* "sat_toolkit/formula.pyx":563
  *     def __reversed__(self) -> Iterable[Clause]:
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):             # <<<<<<<<<<<<<<
  *             yield self.get_clause(i)
  * 
  */
   for (__pyx_t_1 = __pyx_cur_scope->__pyx_v_self->_start_indices.size()-1 + 1; __pyx_t_1 >= 0 + 1; ) { __pyx_t_1-=1;
     __pyx_cur_scope->__pyx_v_i = __pyx_t_1;
 
-    /* "sat_toolkit/formula.pyx":529
+    /* "sat_toolkit/formula.pyx":564
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  *             yield self.get_clause(i)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_cur_scope->__pyx_v_self->__pyx_vtab)->get_clause(__pyx_cur_scope->__pyx_v_self, __pyx_cur_scope->__pyx_v_i)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 529, __pyx_L1_error)
+    __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_cur_scope->__pyx_v_self->__pyx_vtab)->get_clause(__pyx_cur_scope->__pyx_v_self, __pyx_cur_scope->__pyx_v_i)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 564, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     __pyx_cur_scope->__pyx_t_0 = __pyx_t_1;
     __Pyx_XGIVEREF(__pyx_r);
     __Pyx_RefNannyFinishContext();
     __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
     /* return from generator, yielding value */
     __pyx_generator->resume_label = 1;
     return __pyx_r;
     __pyx_L6_resume_from_yield:;
     __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 529, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 564, __pyx_L1_error)
   }
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "sat_toolkit/formula.pyx":526
+  /* "sat_toolkit/formula.pyx":561
  * 
  * 
  *     def __reversed__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  */
 
@@ -31282,199 +31749,199 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":532
+/* "sat_toolkit/formula.pyx":567
  * 
  * 
  *     def __eq__(self, other) -> bool:             # <<<<<<<<<<<<<<
  *         if not isinstance(other, type(self)):
  *             return False
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_29__eq__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_29__eq__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_31__eq__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_31__eq__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__eq__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_28__eq__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((PyObject *)__pyx_v_other));
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_30__eq__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((PyObject *)__pyx_v_other));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_28__eq__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_other) {
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_30__eq__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_other) {
   struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_c_other = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__eq__", 1);
 
-  /* "sat_toolkit/formula.pyx":533
+  /* "sat_toolkit/formula.pyx":568
  * 
  *     def __eq__(self, other) -> bool:
  *         if not isinstance(other, type(self)):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
-  __pyx_t_1 = PyObject_IsInstance(__pyx_v_other, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 533, __pyx_L1_error)
+  __pyx_t_1 = PyObject_IsInstance(__pyx_v_other, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))); if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 568, __pyx_L1_error)
   __pyx_t_2 = (!__pyx_t_1);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":534
+    /* "sat_toolkit/formula.pyx":569
  *     def __eq__(self, other) -> bool:
  *         if not isinstance(other, type(self)):
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         cdef _ClauseList c_other = <_ClauseList> other
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":533
+    /* "sat_toolkit/formula.pyx":568
  * 
  *     def __eq__(self, other) -> bool:
  *         if not isinstance(other, type(self)):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":536
+  /* "sat_toolkit/formula.pyx":571
  *             return False
  * 
  *         cdef _ClauseList c_other = <_ClauseList> other             # <<<<<<<<<<<<<<
  * 
  *         if self.nvars != c_other.nvars:
  */
   __pyx_t_3 = __pyx_v_other;
   __Pyx_INCREF(__pyx_t_3);
   __pyx_v_c_other = ((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "sat_toolkit/formula.pyx":538
+  /* "sat_toolkit/formula.pyx":573
  *         cdef _ClauseList c_other = <_ClauseList> other
  * 
  *         if self.nvars != c_other.nvars:             # <<<<<<<<<<<<<<
  *             return False
  *         if self._start_indices != c_other._start_indices:
  */
   __pyx_t_2 = (__pyx_v_self->nvars != __pyx_v_c_other->nvars);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":539
+    /* "sat_toolkit/formula.pyx":574
  * 
  *         if self.nvars != c_other.nvars:
  *             return False             # <<<<<<<<<<<<<<
  *         if self._start_indices != c_other._start_indices:
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":538
+    /* "sat_toolkit/formula.pyx":573
  *         cdef _ClauseList c_other = <_ClauseList> other
  * 
  *         if self.nvars != c_other.nvars:             # <<<<<<<<<<<<<<
  *             return False
  *         if self._start_indices != c_other._start_indices:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":540
+  /* "sat_toolkit/formula.pyx":575
  *         if self.nvars != c_other.nvars:
  *             return False
  *         if self._start_indices != c_other._start_indices:             # <<<<<<<<<<<<<<
  *             return False
  *         if self._clauses != c_other._clauses:
  */
   __pyx_t_2 = (__pyx_v_self->_start_indices != __pyx_v_c_other->_start_indices);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":541
+    /* "sat_toolkit/formula.pyx":576
  *             return False
  *         if self._start_indices != c_other._start_indices:
  *             return False             # <<<<<<<<<<<<<<
  *         if self._clauses != c_other._clauses:
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":540
+    /* "sat_toolkit/formula.pyx":575
  *         if self.nvars != c_other.nvars:
  *             return False
  *         if self._start_indices != c_other._start_indices:             # <<<<<<<<<<<<<<
  *             return False
  *         if self._clauses != c_other._clauses:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":542
+  /* "sat_toolkit/formula.pyx":577
  *         if self._start_indices != c_other._start_indices:
  *             return False
  *         if self._clauses != c_other._clauses:             # <<<<<<<<<<<<<<
  *             return False
  *         return True
  */
   __pyx_t_2 = (__pyx_v_self->_clauses != __pyx_v_c_other->_clauses);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":543
+    /* "sat_toolkit/formula.pyx":578
  *             return False
  *         if self._clauses != c_other._clauses:
  *             return False             # <<<<<<<<<<<<<<
  *         return True
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":542
+    /* "sat_toolkit/formula.pyx":577
  *         if self._start_indices != c_other._start_indices:
  *             return False
  *         if self._clauses != c_other._clauses:             # <<<<<<<<<<<<<<
  *             return False
  *         return True
  */
   }
 
-  /* "sat_toolkit/formula.pyx":544
+  /* "sat_toolkit/formula.pyx":579
  *         if self._clauses != c_other._clauses:
  *             return False
  *         return True             # <<<<<<<<<<<<<<
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(Py_True);
   __pyx_r = Py_True;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":532
+  /* "sat_toolkit/formula.pyx":567
  * 
  * 
  *     def __eq__(self, other) -> bool:             # <<<<<<<<<<<<<<
  *         if not isinstance(other, type(self)):
  *             return False
  */
 
@@ -31486,48 +31953,48 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_c_other);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":546
+/* "sat_toolkit/formula.pyx":581
  *         return True
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         abort()
  * 
  */
 
 static int __pyx_f_11sat_toolkit_7formula_11_ClauseList__check_clause_type(CYTHON_UNUSED struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, CYTHON_UNUSED struct __pyx_obj_11sat_toolkit_7formula__BaseClause *__pyx_v_clause) {
   int __pyx_r;
 
-  /* "sat_toolkit/formula.pyx":547
+  /* "sat_toolkit/formula.pyx":582
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:
  *         abort()             # <<<<<<<<<<<<<<
  * 
  *     cdef int _compare_clause(self, size_t idx, _BaseClause other) except -1 nogil:
  */
   abort();
 
-  /* "sat_toolkit/formula.pyx":546
+  /* "sat_toolkit/formula.pyx":581
  *         return True
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         abort()
  * 
  */
 
   /* function exit code */
   __pyx_r = 0;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":549
+/* "sat_toolkit/formula.pyx":584
  *         abort()
  * 
  *     cdef int _compare_clause(self, size_t idx, _BaseClause other) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()
  */
 
@@ -31547,61 +32014,61 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save;
   #endif
   __Pyx_RefNannySetupContext("_compare_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":551
+  /* "sat_toolkit/formula.pyx":586
  *     cdef int _compare_clause(self, size_t idx, _BaseClause other) except -1 nogil:
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()             # <<<<<<<<<<<<<<
  * 
  *         if idx >= numclauses:
  */
   __pyx_v_numclauses = __pyx_v_self->_start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":553
+  /* "sat_toolkit/formula.pyx":588
  *         cdef size_t numclauses = self._start_indices.size()
  * 
  *         if idx >= numclauses:             # <<<<<<<<<<<<<<
  *             with gil:
  *                 raise IndexError('index out of range')
  */
   __pyx_t_1 = (__pyx_v_idx >= __pyx_v_numclauses);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":554
+    /* "sat_toolkit/formula.pyx":589
  * 
  *         if idx >= numclauses:
  *             with gil:             # <<<<<<<<<<<<<<
  *                 raise IndexError('index out of range')
  * 
  */
     {
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         /*try:*/ {
 
-          /* "sat_toolkit/formula.pyx":555
+          /* "sat_toolkit/formula.pyx":590
  *         if idx >= numclauses:
  *             with gil:
  *                 raise IndexError('index out of range')             # <<<<<<<<<<<<<<
  * 
  *         begin = self._start_indices[idx]
  */
-          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 555, __pyx_L5_error)
+          __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 590, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_Raise(__pyx_t_2, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __PYX_ERR(0, 555, __pyx_L5_error)
+          __PYX_ERR(0, 590, __pyx_L5_error)
         }
 
-        /* "sat_toolkit/formula.pyx":554
+        /* "sat_toolkit/formula.pyx":589
  * 
  *         if idx >= numclauses:
  *             with gil:             # <<<<<<<<<<<<<<
  *                 raise IndexError('index out of range')
  * 
  */
         /*finally:*/ {
@@ -31610,129 +32077,129 @@
             __Pyx_PyGILState_Release(__pyx_gilstate_save);
             #endif
             goto __pyx_L1_error;
           }
         }
     }
 
-    /* "sat_toolkit/formula.pyx":553
+    /* "sat_toolkit/formula.pyx":588
  *         cdef size_t numclauses = self._start_indices.size()
  * 
  *         if idx >= numclauses:             # <<<<<<<<<<<<<<
  *             with gil:
  *                 raise IndexError('index out of range')
  */
   }
 
-  /* "sat_toolkit/formula.pyx":557
+  /* "sat_toolkit/formula.pyx":592
  *                 raise IndexError('index out of range')
  * 
  *         begin = self._start_indices[idx]             # <<<<<<<<<<<<<<
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  */
   __pyx_v_begin = (__pyx_v_self->_start_indices[__pyx_v_idx]);
 
-  /* "sat_toolkit/formula.pyx":558
+  /* "sat_toolkit/formula.pyx":593
  * 
  *         begin = self._start_indices[idx]
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()             # <<<<<<<<<<<<<<
  * 
  *         if end - 1 - begin != other._clause.size():
  */
   __pyx_t_1 = ((((size_t)__pyx_v_idx) + 1) < __pyx_v_numclauses);
   if (__pyx_t_1) {
     __pyx_t_3 = (__pyx_v_self->_start_indices[(__pyx_v_idx + 1)]);
   } else {
     __pyx_t_3 = __pyx_v_self->_clauses.size();
   }
   __pyx_v_end = __pyx_t_3;
 
-  /* "sat_toolkit/formula.pyx":560
+  /* "sat_toolkit/formula.pyx":595
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  *         if end - 1 - begin != other._clause.size():             # <<<<<<<<<<<<<<
  *             return 0
  * 
  */
   __pyx_t_1 = (((__pyx_v_end - 1) - __pyx_v_begin) != __pyx_v_other->_clause.size());
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":561
+    /* "sat_toolkit/formula.pyx":596
  * 
  *         if end - 1 - begin != other._clause.size():
  *             return 0             # <<<<<<<<<<<<<<
  * 
  *         for i in range(end - 1 - begin):
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":560
+    /* "sat_toolkit/formula.pyx":595
  *         end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  *         if end - 1 - begin != other._clause.size():             # <<<<<<<<<<<<<<
  *             return 0
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":563
+  /* "sat_toolkit/formula.pyx":598
  *             return 0
  * 
  *         for i in range(end - 1 - begin):             # <<<<<<<<<<<<<<
  *             if self._clauses[begin + i] != other._clause[i]:
  *                 return 0
  */
   __pyx_t_3 = ((__pyx_v_end - 1) - __pyx_v_begin);
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_i = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":564
+    /* "sat_toolkit/formula.pyx":599
  * 
  *         for i in range(end - 1 - begin):
  *             if self._clauses[begin + i] != other._clause[i]:             # <<<<<<<<<<<<<<
  *                 return 0
  * 
  */
     __pyx_t_1 = ((__pyx_v_self->_clauses[(__pyx_v_begin + __pyx_v_i)]) != (__pyx_v_other->_clause[__pyx_v_i]));
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":565
+      /* "sat_toolkit/formula.pyx":600
  *         for i in range(end - 1 - begin):
  *             if self._clauses[begin + i] != other._clause[i]:
  *                 return 0             # <<<<<<<<<<<<<<
  * 
  *         return 1
  */
       __pyx_r = 0;
       goto __pyx_L0;
 
-      /* "sat_toolkit/formula.pyx":564
+      /* "sat_toolkit/formula.pyx":599
  * 
  *         for i in range(end - 1 - begin):
  *             if self._clauses[begin + i] != other._clause[i]:             # <<<<<<<<<<<<<<
  *                 return 0
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":567
+  /* "sat_toolkit/formula.pyx":602
  *                 return 0
  * 
  *         return 1             # <<<<<<<<<<<<<<
  * 
  *     def __contains__(self, needle) -> bool:
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":549
+  /* "sat_toolkit/formula.pyx":584
  *         abort()
  * 
  *     cdef int _compare_clause(self, size_t idx, _BaseClause other) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t begin, end, i
  *         cdef size_t numclauses = self._start_indices.size()
  */
 
@@ -31748,38 +32215,38 @@
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   __pyx_L0:;
   __Pyx_RefNannyFinishContextNogil()
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":569
+/* "sat_toolkit/formula.pyx":604
  *         return 1
  * 
  *     def __contains__(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
 
 /* Python wrapper */
-static int __pyx_pw_11sat_toolkit_7formula_11_ClauseList_31__contains__(PyObject *__pyx_v_self, PyObject *__pyx_v_needle); /*proto*/
-static int __pyx_pw_11sat_toolkit_7formula_11_ClauseList_31__contains__(PyObject *__pyx_v_self, PyObject *__pyx_v_needle) {
+static int __pyx_pw_11sat_toolkit_7formula_11_ClauseList_33__contains__(PyObject *__pyx_v_self, PyObject *__pyx_v_needle); /*proto*/
+static int __pyx_pw_11sat_toolkit_7formula_11_ClauseList_33__contains__(PyObject *__pyx_v_self, PyObject *__pyx_v_needle) {
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__contains__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_30__contains__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((PyObject *)__pyx_v_needle));
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_32__contains__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((PyObject *)__pyx_v_needle));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static int __pyx_pf_11sat_toolkit_7formula_11_ClauseList_30__contains__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle) {
+static int __pyx_pf_11sat_toolkit_7formula_11_ClauseList_32__contains__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle) {
   size_t __pyx_v_i;
   struct __pyx_obj_11sat_toolkit_7formula__BaseClause *__pyx_v_c_needle = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   std::vector<size_t> ::size_type __pyx_t_3;
@@ -31787,58 +32254,58 @@
   size_t __pyx_t_5;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__contains__", 1);
 
-  /* "sat_toolkit/formula.pyx":570
+  /* "sat_toolkit/formula.pyx":605
  * 
  *     def __contains__(self, needle) -> bool:
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
-  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 570, __pyx_L1_error)
+  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 605, __pyx_L1_error)
   __pyx_t_1 = (!(((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_check_clause_type(__pyx_v_self, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_needle)) != 0));
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":571
+    /* "sat_toolkit/formula.pyx":606
  *     def __contains__(self, needle) -> bool:
  *         if not self._check_clause_type(needle):
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t i
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":570
+    /* "sat_toolkit/formula.pyx":605
  * 
  *     def __contains__(self, needle) -> bool:
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":576
+  /* "sat_toolkit/formula.pyx":611
  *         cdef _BaseClause c_needle
  * 
  *         c_needle = needle             # <<<<<<<<<<<<<<
  * 
  *         with nogil:
  */
-  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 576, __pyx_L1_error)
+  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 611, __pyx_L1_error)
   __pyx_t_2 = __pyx_v_needle;
   __Pyx_INCREF(__pyx_t_2);
   __pyx_v_c_needle = ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":578
+  /* "sat_toolkit/formula.pyx":613
  *         c_needle = needle
  * 
  *         with nogil:             # <<<<<<<<<<<<<<
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  */
   {
@@ -31846,59 +32313,59 @@
       PyThreadState *_save;
       _save = NULL;
       Py_UNBLOCK_THREADS
       __Pyx_FastGIL_Remember();
       #endif
       /*try:*/ {
 
-        /* "sat_toolkit/formula.pyx":579
+        /* "sat_toolkit/formula.pyx":614
  * 
  *         with nogil:
  *             for i in range(self._start_indices.size()):             # <<<<<<<<<<<<<<
  *                 if self._compare_clause(i, c_needle):
  *                     return True
  */
         __pyx_t_3 = __pyx_v_self->_start_indices.size();
         __pyx_t_4 = __pyx_t_3;
         for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
           __pyx_v_i = __pyx_t_5;
 
-          /* "sat_toolkit/formula.pyx":580
+          /* "sat_toolkit/formula.pyx":615
  *         with nogil:
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):             # <<<<<<<<<<<<<<
  *                     return True
  * 
  */
-          __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, __pyx_v_c_needle); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 580, __pyx_L5_error)
+          __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, __pyx_v_c_needle); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 615, __pyx_L5_error)
           __pyx_t_1 = (__pyx_t_6 != 0);
           if (__pyx_t_1) {
 
-            /* "sat_toolkit/formula.pyx":581
+            /* "sat_toolkit/formula.pyx":616
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  *                     return True             # <<<<<<<<<<<<<<
  * 
  *     def count(self, needle) -> bool:
  */
             __pyx_r = 1;
             goto __pyx_L4_return;
 
-            /* "sat_toolkit/formula.pyx":580
+            /* "sat_toolkit/formula.pyx":615
  *         with nogil:
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):             # <<<<<<<<<<<<<<
  *                     return True
  * 
  */
           }
         }
       }
 
-      /* "sat_toolkit/formula.pyx":578
+      /* "sat_toolkit/formula.pyx":613
  *         c_needle = needle
  * 
  *         with nogil:             # <<<<<<<<<<<<<<
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  */
       /*finally:*/ {
@@ -31923,15 +32390,15 @@
           #endif
           goto __pyx_L1_error;
         }
         __pyx_L6:;
       }
   }
 
-  /* "sat_toolkit/formula.pyx":569
+  /* "sat_toolkit/formula.pyx":604
  *         return 1
  * 
  *     def __contains__(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
 
@@ -31944,33 +32411,33 @@
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_c_needle);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":583
+/* "sat_toolkit/formula.pyx":618
  *                     return True
  * 
  *     def count(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_33count(PyObject *__pyx_v_self, 
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_35count(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_32count, "_ClauseList.count(self, needle) -> bool");
-static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_33count = {"count", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_33count, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_32count};
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_33count(PyObject *__pyx_v_self, 
+PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_34count, "_ClauseList.count(self, needle) -> bool");
+static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_35count = {"count", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_35count, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_34count};
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_35count(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
   PyObject *__pyx_v_needle = 0;
@@ -32006,58 +32473,58 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_needle)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 583, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 618, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "count") < 0)) __PYX_ERR(0, 583, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "count") < 0)) __PYX_ERR(0, 618, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_needle = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("count", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 583, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("count", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 618, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.count", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_32count(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_needle);
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_34count(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_needle);
 
   /* function exit code */
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_32count(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle) {
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_34count(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle) {
   size_t __pyx_v_i;
   size_t __pyx_v_count;
   struct __pyx_obj_11sat_toolkit_7formula__BaseClause *__pyx_v_c_needle = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
@@ -32066,69 +32533,69 @@
   size_t __pyx_t_5;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("count", 1);
 
-  /* "sat_toolkit/formula.pyx":584
+  /* "sat_toolkit/formula.pyx":619
  * 
  *     def count(self, needle) -> bool:
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
-  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 584, __pyx_L1_error)
+  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 619, __pyx_L1_error)
   __pyx_t_1 = (!(((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_check_clause_type(__pyx_v_self, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_needle)) != 0));
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":585
+    /* "sat_toolkit/formula.pyx":620
  *     def count(self, needle) -> bool:
  *         if not self._check_clause_type(needle):
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t i, count = 0
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":584
+    /* "sat_toolkit/formula.pyx":619
  * 
  *     def count(self, needle) -> bool:
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":587
+  /* "sat_toolkit/formula.pyx":622
  *             return False
  * 
  *         cdef size_t i, count = 0             # <<<<<<<<<<<<<<
  *         cdef _BaseClause c_needle
  * 
  */
   __pyx_v_count = 0;
 
-  /* "sat_toolkit/formula.pyx":590
+  /* "sat_toolkit/formula.pyx":625
  *         cdef _BaseClause c_needle
  * 
  *         c_needle = needle             # <<<<<<<<<<<<<<
  * 
  *         with nogil:
  */
-  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 590, __pyx_L1_error)
+  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 625, __pyx_L1_error)
   __pyx_t_2 = __pyx_v_needle;
   __Pyx_INCREF(__pyx_t_2);
   __pyx_v_c_needle = ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":592
+  /* "sat_toolkit/formula.pyx":627
  *         c_needle = needle
  * 
  *         with nogil:             # <<<<<<<<<<<<<<
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  */
   {
@@ -32136,58 +32603,58 @@
       PyThreadState *_save;
       _save = NULL;
       Py_UNBLOCK_THREADS
       __Pyx_FastGIL_Remember();
       #endif
       /*try:*/ {
 
-        /* "sat_toolkit/formula.pyx":593
+        /* "sat_toolkit/formula.pyx":628
  * 
  *         with nogil:
  *             for i in range(self._start_indices.size()):             # <<<<<<<<<<<<<<
  *                 if self._compare_clause(i, c_needle):
  *                     count += 1
  */
         __pyx_t_3 = __pyx_v_self->_start_indices.size();
         __pyx_t_4 = __pyx_t_3;
         for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
           __pyx_v_i = __pyx_t_5;
 
-          /* "sat_toolkit/formula.pyx":594
+          /* "sat_toolkit/formula.pyx":629
  *         with nogil:
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):             # <<<<<<<<<<<<<<
  *                     count += 1
  *         return count
  */
-          __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, __pyx_v_c_needle); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 594, __pyx_L5_error)
+          __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, __pyx_v_c_needle); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 629, __pyx_L5_error)
           __pyx_t_1 = (__pyx_t_6 != 0);
           if (__pyx_t_1) {
 
-            /* "sat_toolkit/formula.pyx":595
+            /* "sat_toolkit/formula.pyx":630
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  *                     count += 1             # <<<<<<<<<<<<<<
  *         return count
  * 
  */
             __pyx_v_count = (__pyx_v_count + 1);
 
-            /* "sat_toolkit/formula.pyx":594
+            /* "sat_toolkit/formula.pyx":629
  *         with nogil:
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):             # <<<<<<<<<<<<<<
  *                     count += 1
  *         return count
  */
           }
         }
       }
 
-      /* "sat_toolkit/formula.pyx":592
+      /* "sat_toolkit/formula.pyx":627
  *         c_needle = needle
  * 
  *         with nogil:             # <<<<<<<<<<<<<<
  *             for i in range(self._start_indices.size()):
  *                 if self._compare_clause(i, c_needle):
  */
       /*finally:*/ {
@@ -32205,29 +32672,29 @@
           #endif
           goto __pyx_L1_error;
         }
         __pyx_L6:;
       }
   }
 
-  /* "sat_toolkit/formula.pyx":596
+  /* "sat_toolkit/formula.pyx":631
  *                 if self._compare_clause(i, c_needle):
  *                     count += 1
  *         return count             # <<<<<<<<<<<<<<
  * 
  *     cdef size_t _get_slice_index(self, ssize_t idx):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 596, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_count); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 631, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":583
+  /* "sat_toolkit/formula.pyx":618
  *                     return True
  * 
  *     def count(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
 
@@ -32239,154 +32706,154 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_c_needle);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":598
+/* "sat_toolkit/formula.pyx":633
  *         return count
  * 
  *     cdef size_t _get_slice_index(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         if idx < 0:
  *             idx += self._start_indices.size()
  */
 
 static size_t __pyx_f_11sat_toolkit_7formula_11_ClauseList__get_slice_index(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_ssize_t __pyx_v_idx) {
   size_t __pyx_r;
   int __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":599
+  /* "sat_toolkit/formula.pyx":634
  * 
  *     cdef size_t _get_slice_index(self, ssize_t idx):
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             idx += self._start_indices.size()
  *         if idx < 0:
  */
   __pyx_t_1 = (__pyx_v_idx < 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":600
+    /* "sat_toolkit/formula.pyx":635
  *     cdef size_t _get_slice_index(self, ssize_t idx):
  *         if idx < 0:
  *             idx += self._start_indices.size()             # <<<<<<<<<<<<<<
  *         if idx < 0:
  *             return 0
  */
     __pyx_v_idx = (__pyx_v_idx + __pyx_v_self->_start_indices.size());
 
-    /* "sat_toolkit/formula.pyx":599
+    /* "sat_toolkit/formula.pyx":634
  * 
  *     cdef size_t _get_slice_index(self, ssize_t idx):
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             idx += self._start_indices.size()
  *         if idx < 0:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":601
+  /* "sat_toolkit/formula.pyx":636
  *         if idx < 0:
  *             idx += self._start_indices.size()
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             return 0
  *         if <size_t> idx >= self._start_indices.size():
  */
   __pyx_t_1 = (__pyx_v_idx < 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":602
+    /* "sat_toolkit/formula.pyx":637
  *             idx += self._start_indices.size()
  *         if idx < 0:
  *             return 0             # <<<<<<<<<<<<<<
  *         if <size_t> idx >= self._start_indices.size():
  *             return self._start_indices.size()
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":601
+    /* "sat_toolkit/formula.pyx":636
  *         if idx < 0:
  *             idx += self._start_indices.size()
  *         if idx < 0:             # <<<<<<<<<<<<<<
  *             return 0
  *         if <size_t> idx >= self._start_indices.size():
  */
   }
 
-  /* "sat_toolkit/formula.pyx":603
+  /* "sat_toolkit/formula.pyx":638
  *         if idx < 0:
  *             return 0
  *         if <size_t> idx >= self._start_indices.size():             # <<<<<<<<<<<<<<
  *             return self._start_indices.size()
  *         return <size_t> idx
  */
   __pyx_t_1 = (((size_t)__pyx_v_idx) >= __pyx_v_self->_start_indices.size());
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":604
+    /* "sat_toolkit/formula.pyx":639
  *             return 0
  *         if <size_t> idx >= self._start_indices.size():
  *             return self._start_indices.size()             # <<<<<<<<<<<<<<
  *         return <size_t> idx
  * 
  */
     __pyx_r = __pyx_v_self->_start_indices.size();
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":603
+    /* "sat_toolkit/formula.pyx":638
  *         if idx < 0:
  *             return 0
  *         if <size_t> idx >= self._start_indices.size():             # <<<<<<<<<<<<<<
  *             return self._start_indices.size()
  *         return <size_t> idx
  */
   }
 
-  /* "sat_toolkit/formula.pyx":605
+  /* "sat_toolkit/formula.pyx":640
  *         if <size_t> idx >= self._start_indices.size():
  *             return self._start_indices.size()
  *         return <size_t> idx             # <<<<<<<<<<<<<<
  * 
  *     def index(self, needle, start=None, end=None) -> int:
  */
   __pyx_r = ((size_t)__pyx_v_idx);
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":598
+  /* "sat_toolkit/formula.pyx":633
  *         return count
  * 
  *     cdef size_t _get_slice_index(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         if idx < 0:
  *             idx += self._start_indices.size()
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":607
+/* "sat_toolkit/formula.pyx":642
  *         return <size_t> idx
  * 
  *     def index(self, needle, start=None, end=None) -> int:             # <<<<<<<<<<<<<<
  *         """
  *         Return zero-based index in the list of the first item whose value is
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_35index(PyObject *__pyx_v_self, 
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_37index(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_34index, "_ClauseList.index(self, needle, start=None, end=None) -> int\n\n        Return zero-based index in the list of the first item whose value is\n        equal to needle. Raises a ValueError if there is no such item.\n\n        The optional arguments start and end are interpreted as in the slice\n        notation and are used to limit the search to a particular subsequence\n        of the list. The returned index is computed relative to the beginning\n        of the full sequence rather than the start argument.\n        ");
-static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_35index = {"index", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_35index, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_34index};
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_35index(PyObject *__pyx_v_self, 
+PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_36index, "_ClauseList.index(self, needle, start=None, end=None) -> int\n\n        Return zero-based index in the list of the first item whose value is\n        equal to needle. Raises a ValueError if there is no such item.\n\n        The optional arguments start and end are interpreted as in the slice\n        notation and are used to limit the search to a particular subsequence\n        of the list. The returned index is computed relative to the beginning\n        of the full sequence rather than the start argument.\n        ");
+static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_37index = {"index", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_37index, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_36index};
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_37index(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
   PyObject *__pyx_v_needle = 0;
@@ -32430,34 +32897,34 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_needle)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 607, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 642, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_start);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 607, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 642, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_end);
           if (value) { values[2] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 607, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 642, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "index") < 0)) __PYX_ERR(0, 607, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "index") < 0)) __PYX_ERR(0, 642, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
@@ -32468,42 +32935,42 @@
     }
     __pyx_v_needle = values[0];
     __pyx_v_start = values[1];
     __pyx_v_end = values[2];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("index", 0, 1, 3, __pyx_nargs); __PYX_ERR(0, 607, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("index", 0, 1, 3, __pyx_nargs); __PYX_ERR(0, 642, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula._ClauseList.index", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_34index(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_needle, __pyx_v_start, __pyx_v_end);
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_36index(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_needle, __pyx_v_start, __pyx_v_end);
 
   /* function exit code */
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_34index(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle, PyObject *__pyx_v_start, PyObject *__pyx_v_end) {
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_36index(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, PyObject *__pyx_v_needle, PyObject *__pyx_v_start, PyObject *__pyx_v_end) {
   size_t __pyx_v_i;
   size_t __pyx_v_start_idx;
   size_t __pyx_v_end_idx;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
@@ -32517,238 +32984,238 @@
   size_t __pyx_t_10;
   int __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("index", 1);
 
-  /* "sat_toolkit/formula.pyx":617
+  /* "sat_toolkit/formula.pyx":652
  *         of the full sequence rather than the start argument.
  *         """
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             raise ValueError(f'{needle} is of wrong tpe to be contained in {type(self).__name__}')
  * 
  */
-  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 617, __pyx_L1_error)
+  if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 652, __pyx_L1_error)
   __pyx_t_1 = (!(((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_check_clause_type(__pyx_v_self, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_needle)) != 0));
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":618
+    /* "sat_toolkit/formula.pyx":653
  *         """
  *         if not self._check_clause_type(needle):
  *             raise ValueError(f'{needle} is of wrong tpe to be contained in {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t i, start_idx = 0, end_idx = self._start_indices.size()
  */
-    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 653, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_3 = 0;
     __pyx_t_4 = 127;
-    __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_v_needle, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 618, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_v_needle, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 653, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_4 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) > __pyx_t_4) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) : __pyx_t_4;
     __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
     __pyx_t_5 = 0;
     __Pyx_INCREF(__pyx_kp_u_is_of_wrong_tpe_to_be_contained);
     __pyx_t_3 += 36;
     __Pyx_GIVEREF(__pyx_kp_u_is_of_wrong_tpe_to_be_contained);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_kp_u_is_of_wrong_tpe_to_be_contained);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 618, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 653, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_t_5, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 618, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_t_5, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 653, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_4 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) > __pyx_t_4) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) : __pyx_t_4;
     __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_6);
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 618, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 653, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 653, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 618, __pyx_L1_error)
+    __PYX_ERR(0, 653, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":617
+    /* "sat_toolkit/formula.pyx":652
  *         of the full sequence rather than the start argument.
  *         """
  *         if not self._check_clause_type(needle):             # <<<<<<<<<<<<<<
  *             raise ValueError(f'{needle} is of wrong tpe to be contained in {type(self).__name__}')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":620
+  /* "sat_toolkit/formula.pyx":655
  *             raise ValueError(f'{needle} is of wrong tpe to be contained in {type(self).__name__}')
  * 
  *         cdef size_t i, start_idx = 0, end_idx = self._start_indices.size()             # <<<<<<<<<<<<<<
  *         cdef _BaseClause c_needle
  * 
  */
   __pyx_v_start_idx = 0;
   __pyx_v_end_idx = __pyx_v_self->_start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":623
+  /* "sat_toolkit/formula.pyx":658
  *         cdef _BaseClause c_needle
  * 
  *         if start is not None:             # <<<<<<<<<<<<<<
  *             start_idx = self._get_slice_index(start)
  *         if end is not None:
  */
   __pyx_t_1 = (__pyx_v_start != Py_None);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":624
+    /* "sat_toolkit/formula.pyx":659
  * 
  *         if start is not None:
  *             start_idx = self._get_slice_index(start)             # <<<<<<<<<<<<<<
  *         if end is not None:
  *             end_idx = self._get_slice_index(end)
  */
-    __pyx_t_7 = PyInt_AsSsize_t(__pyx_v_start); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 624, __pyx_L1_error)
-    __pyx_t_8 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_get_slice_index(__pyx_v_self, __pyx_t_7); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 624, __pyx_L1_error)
+    __pyx_t_7 = PyInt_AsSsize_t(__pyx_v_start); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 659, __pyx_L1_error)
+    __pyx_t_8 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_get_slice_index(__pyx_v_self, __pyx_t_7); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 659, __pyx_L1_error)
     __pyx_v_start_idx = __pyx_t_8;
 
-    /* "sat_toolkit/formula.pyx":623
+    /* "sat_toolkit/formula.pyx":658
  *         cdef _BaseClause c_needle
  * 
  *         if start is not None:             # <<<<<<<<<<<<<<
  *             start_idx = self._get_slice_index(start)
  *         if end is not None:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":625
+  /* "sat_toolkit/formula.pyx":660
  *         if start is not None:
  *             start_idx = self._get_slice_index(start)
  *         if end is not None:             # <<<<<<<<<<<<<<
  *             end_idx = self._get_slice_index(end)
  * 
  */
   __pyx_t_1 = (__pyx_v_end != Py_None);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":626
+    /* "sat_toolkit/formula.pyx":661
  *             start_idx = self._get_slice_index(start)
  *         if end is not None:
  *             end_idx = self._get_slice_index(end)             # <<<<<<<<<<<<<<
  * 
  *         for i in range(start_idx, end_idx):
  */
-    __pyx_t_7 = PyInt_AsSsize_t(__pyx_v_end); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 626, __pyx_L1_error)
-    __pyx_t_8 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_get_slice_index(__pyx_v_self, __pyx_t_7); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 626, __pyx_L1_error)
+    __pyx_t_7 = PyInt_AsSsize_t(__pyx_v_end); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 661, __pyx_L1_error)
+    __pyx_t_8 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_get_slice_index(__pyx_v_self, __pyx_t_7); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 661, __pyx_L1_error)
     __pyx_v_end_idx = __pyx_t_8;
 
-    /* "sat_toolkit/formula.pyx":625
+    /* "sat_toolkit/formula.pyx":660
  *         if start is not None:
  *             start_idx = self._get_slice_index(start)
  *         if end is not None:             # <<<<<<<<<<<<<<
  *             end_idx = self._get_slice_index(end)
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":628
+  /* "sat_toolkit/formula.pyx":663
  *             end_idx = self._get_slice_index(end)
  * 
  *         for i in range(start_idx, end_idx):             # <<<<<<<<<<<<<<
  *             if self._compare_clause(i, needle):
  *                 return i
  */
   __pyx_t_8 = __pyx_v_end_idx;
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = __pyx_v_start_idx; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_i = __pyx_t_10;
 
-    /* "sat_toolkit/formula.pyx":629
+    /* "sat_toolkit/formula.pyx":664
  * 
  *         for i in range(start_idx, end_idx):
  *             if self._compare_clause(i, needle):             # <<<<<<<<<<<<<<
  *                 return i
  * 
  */
-    if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 629, __pyx_L1_error)
-    __pyx_t_11 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_needle)); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 629, __pyx_L1_error)
+    if (!(likely(((__pyx_v_needle) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_needle, __pyx_ptype_11sat_toolkit_7formula__BaseClause))))) __PYX_ERR(0, 664, __pyx_L1_error)
+    __pyx_t_11 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->__pyx_vtab)->_compare_clause(__pyx_v_self, __pyx_v_i, ((struct __pyx_obj_11sat_toolkit_7formula__BaseClause *)__pyx_v_needle)); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 664, __pyx_L1_error)
     __pyx_t_1 = (__pyx_t_11 != 0);
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":630
+      /* "sat_toolkit/formula.pyx":665
  *         for i in range(start_idx, end_idx):
  *             if self._compare_clause(i, needle):
  *                 return i             # <<<<<<<<<<<<<<
  * 
  *         raise ValueError(f'{needle} is not in {type(self).__name__}')
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 630, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 665, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_t_2)) || __Pyx_RaiseUnexpectedTypeError("int", __pyx_t_2))) __PYX_ERR(0, 630, __pyx_L1_error)
+      if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_t_2)) || __Pyx_RaiseUnexpectedTypeError("int", __pyx_t_2))) __PYX_ERR(0, 665, __pyx_L1_error)
       __pyx_r = ((PyObject*)__pyx_t_2);
       __pyx_t_2 = 0;
       goto __pyx_L0;
 
-      /* "sat_toolkit/formula.pyx":629
+      /* "sat_toolkit/formula.pyx":664
  * 
  *         for i in range(start_idx, end_idx):
  *             if self._compare_clause(i, needle):             # <<<<<<<<<<<<<<
  *                 return i
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":632
+  /* "sat_toolkit/formula.pyx":667
  *                 return i
  * 
  *         raise ValueError(f'{needle} is not in {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *     # pickle support
  */
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 667, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = 0;
   __pyx_t_4 = 127;
-  __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_v_needle, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_v_needle, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 667, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_4 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) > __pyx_t_4) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) : __pyx_t_4;
   __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
   __pyx_t_6 = 0;
   __Pyx_INCREF(__pyx_kp_u_is_not_in);
   __pyx_t_3 += 11;
   __Pyx_GIVEREF(__pyx_kp_u_is_not_in);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_kp_u_is_not_in);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 667, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_6, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_6, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 667, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_4 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) > __pyx_t_4) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) : __pyx_t_4;
   __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 667, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 667, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_Raise(__pyx_t_2, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __PYX_ERR(0, 632, __pyx_L1_error)
+  __PYX_ERR(0, 667, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":607
+  /* "sat_toolkit/formula.pyx":642
  *         return <size_t> idx
  * 
  *     def index(self, needle, start=None, end=None) -> int:             # <<<<<<<<<<<<<<
  *         """
  *         Return zero-based index in the list of the first item whose value is
  */
 
@@ -32761,33 +33228,33 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":635
+/* "sat_toolkit/formula.pyx":670
  * 
  *     # pickle support
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (np.array(self), self.nvars)
  * 
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_37__reduce__(PyObject *__pyx_v_self, 
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_39__reduce__(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ); /*proto*/
-PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_36__reduce__, "_ClauseList.__reduce__(self)");
-static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_37__reduce__ = {"__reduce__", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_37__reduce__, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_36__reduce__};
-static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_37__reduce__(PyObject *__pyx_v_self, 
+PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_11_ClauseList_38__reduce__, "_ClauseList.__reduce__(self)");
+static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_11_ClauseList_39__reduce__ = {"__reduce__", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_39__reduce__, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_38__reduce__};
+static PyObject *__pyx_pw_11sat_toolkit_7formula_11_ClauseList_39__reduce__(PyObject *__pyx_v_self, 
 #if CYTHON_METH_FASTCALL
 PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
 #else
 PyObject *__pyx_args, PyObject *__pyx_kwds
 #endif
 ) {
   #if !CYTHON_METH_FASTCALL
@@ -32804,44 +33271,44 @@
   __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
   #endif
   #endif
   __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
   if (unlikely(__pyx_nargs > 0)) {
     __Pyx_RaiseArgtupleInvalid("__reduce__", 1, 0, 0, __pyx_nargs); return NULL;}
   if (unlikely(__pyx_kwds) && __Pyx_NumKwargs_FASTCALL(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__reduce__", 0))) return NULL;
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_36__reduce__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self));
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_38__reduce__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_36__reduce__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self) {
+static PyObject *__pyx_pf_11sat_toolkit_7formula_11_ClauseList_38__reduce__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reduce__", 1);
 
-  /* "sat_toolkit/formula.pyx":636
+  /* "sat_toolkit/formula.pyx":671
  *     # pickle support
  *     def __reduce__(self):
  *         return type(self), (np.array(self), self.nvars)             # <<<<<<<<<<<<<<
  * 
  *     # buffer support
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 671, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 671, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -32854,41 +33321,41 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, ((PyObject *)__pyx_v_self)};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 671, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_self->nvars); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_self->nvars); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 671, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 671, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1)) __PYX_ERR(0, 671, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3)) __PYX_ERR(0, 671, __pyx_L1_error);
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 671, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
   __Pyx_GIVEREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))))) __PYX_ERR(0, 636, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))))) __PYX_ERR(0, 671, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_2);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2)) __PYX_ERR(0, 671, __pyx_L1_error);
   __pyx_t_2 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":635
+  /* "sat_toolkit/formula.pyx":670
  * 
  *     # pickle support
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (np.array(self), self.nvars)
  * 
  */
 
@@ -32901,38 +33368,38 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":639
+/* "sat_toolkit/formula.pyx":674
  * 
  *     # buffer support
  *     def __getbuffer__(self, cython.Py_buffer *buffer, int flags):             # <<<<<<<<<<<<<<
  *         if flags & PyBUF_WRITABLE:
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')
  */
 
 /* Python wrapper */
-CYTHON_UNUSED static int __pyx_pw_11sat_toolkit_7formula_11_ClauseList_39__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_buffer, int __pyx_v_flags); /*proto*/
-CYTHON_UNUSED static int __pyx_pw_11sat_toolkit_7formula_11_ClauseList_39__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_buffer, int __pyx_v_flags) {
+CYTHON_UNUSED static int __pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_buffer, int __pyx_v_flags); /*proto*/
+CYTHON_UNUSED static int __pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_buffer, int __pyx_v_flags) {
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__getbuffer__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_38__getbuffer__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((Py_buffer *)__pyx_v_buffer), ((int)__pyx_v_flags));
+  __pyx_r = __pyx_pf_11sat_toolkit_7formula_11_ClauseList_40__getbuffer__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((Py_buffer *)__pyx_v_buffer), ((int)__pyx_v_flags));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static int __pyx_pf_11sat_toolkit_7formula_11_ClauseList_38__getbuffer__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_buffer *__pyx_v_buffer, int __pyx_v_flags) {
+static int __pyx_pf_11sat_toolkit_7formula_11_ClauseList_40__getbuffer__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_buffer *__pyx_v_buffer, int __pyx_v_flags) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -32941,282 +33408,282 @@
     PyErr_SetString(PyExc_BufferError, "PyObject_GetBuffer: view==NULL argument is obsolete");
     return -1;
   }
   __Pyx_RefNannySetupContext("__getbuffer__", 0);
   __pyx_v_buffer->obj = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(__pyx_v_buffer->obj);
 
-  /* "sat_toolkit/formula.pyx":640
+  /* "sat_toolkit/formula.pyx":675
  *     # buffer support
  *     def __getbuffer__(self, cython.Py_buffer *buffer, int flags):
  *         if flags & PyBUF_WRITABLE:             # <<<<<<<<<<<<<<
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')
  * 
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_WRITABLE) != 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":641
+    /* "sat_toolkit/formula.pyx":676
  *     def __getbuffer__(self, cython.Py_buffer *buffer, int flags):
  *         if flags & PyBUF_WRITABLE:
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *         self.shape[0] = self._clauses.size()
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_t_2, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_t_2, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_cannot_provide_a_writable_buffer, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyUnicode_Concat(__pyx_kp_u_cannot_provide_a_writable_buffer, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 676, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 641, __pyx_L1_error)
+    __PYX_ERR(0, 676, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":640
+    /* "sat_toolkit/formula.pyx":675
  *     # buffer support
  *     def __getbuffer__(self, cython.Py_buffer *buffer, int flags):
  *         if flags & PyBUF_WRITABLE:             # <<<<<<<<<<<<<<
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":643
+  /* "sat_toolkit/formula.pyx":678
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')
  * 
  *         self.shape[0] = self._clauses.size()             # <<<<<<<<<<<<<<
  *         self.view_count += 1
  * 
  */
   (__pyx_v_self->shape[0]) = __pyx_v_self->_clauses.size();
 
-  /* "sat_toolkit/formula.pyx":644
+  /* "sat_toolkit/formula.pyx":679
  * 
  *         self.shape[0] = self._clauses.size()
  *         self.view_count += 1             # <<<<<<<<<<<<<<
  * 
  *         buffer.buf = <char *>&(self._clauses[0])
  */
   __pyx_v_self->view_count = (__pyx_v_self->view_count + 1);
 
-  /* "sat_toolkit/formula.pyx":646
+  /* "sat_toolkit/formula.pyx":681
  *         self.view_count += 1
  * 
  *         buffer.buf = <char *>&(self._clauses[0])             # <<<<<<<<<<<<<<
  * 
  *         if (flags & PyBUF_FORMAT) == PyBUF_FORMAT:
  */
   __pyx_v_buffer->buf = ((char *)(&(__pyx_v_self->_clauses[0])));
 
-  /* "sat_toolkit/formula.pyx":648
+  /* "sat_toolkit/formula.pyx":683
  *         buffer.buf = <char *>&(self._clauses[0])
  * 
  *         if (flags & PyBUF_FORMAT) == PyBUF_FORMAT:             # <<<<<<<<<<<<<<
  *             buffer.format = 'i'                     # int
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_FORMAT) == PyBUF_FORMAT);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":649
+    /* "sat_toolkit/formula.pyx":684
  * 
  *         if (flags & PyBUF_FORMAT) == PyBUF_FORMAT:
  *             buffer.format = 'i'                     # int             # <<<<<<<<<<<<<<
  *         else:
  *             buffer.format = NULL
  */
     __pyx_v_buffer->format = ((char *)"i");
 
-    /* "sat_toolkit/formula.pyx":648
+    /* "sat_toolkit/formula.pyx":683
  *         buffer.buf = <char *>&(self._clauses[0])
  * 
  *         if (flags & PyBUF_FORMAT) == PyBUF_FORMAT:             # <<<<<<<<<<<<<<
  *             buffer.format = 'i'                     # int
  *         else:
  */
     goto __pyx_L4;
   }
 
-  /* "sat_toolkit/formula.pyx":651
+  /* "sat_toolkit/formula.pyx":686
  *             buffer.format = 'i'                     # int
  *         else:
  *             buffer.format = NULL             # <<<<<<<<<<<<<<
  *         buffer.internal = NULL
  *         buffer.itemsize = sizeof(int)
  */
   /*else*/ {
     __pyx_v_buffer->format = NULL;
   }
   __pyx_L4:;
 
-  /* "sat_toolkit/formula.pyx":652
+  /* "sat_toolkit/formula.pyx":687
  *         else:
  *             buffer.format = NULL
  *         buffer.internal = NULL             # <<<<<<<<<<<<<<
  *         buffer.itemsize = sizeof(int)
  *         buffer.len = self.shape[0] * sizeof(int)
  */
   __pyx_v_buffer->internal = NULL;
 
-  /* "sat_toolkit/formula.pyx":653
+  /* "sat_toolkit/formula.pyx":688
  *             buffer.format = NULL
  *         buffer.internal = NULL
  *         buffer.itemsize = sizeof(int)             # <<<<<<<<<<<<<<
  *         buffer.len = self.shape[0] * sizeof(int)
  *         buffer.obj = self
  */
   __pyx_v_buffer->itemsize = (sizeof(int));
 
-  /* "sat_toolkit/formula.pyx":654
+  /* "sat_toolkit/formula.pyx":689
  *         buffer.internal = NULL
  *         buffer.itemsize = sizeof(int)
  *         buffer.len = self.shape[0] * sizeof(int)             # <<<<<<<<<<<<<<
  *         buffer.obj = self
  *         buffer.readonly = 1
  */
   __pyx_v_buffer->len = ((__pyx_v_self->shape[0]) * (sizeof(int)));
 
-  /* "sat_toolkit/formula.pyx":655
+  /* "sat_toolkit/formula.pyx":690
  *         buffer.itemsize = sizeof(int)
  *         buffer.len = self.shape[0] * sizeof(int)
  *         buffer.obj = self             # <<<<<<<<<<<<<<
  *         buffer.readonly = 1
  *         if (flags & PyBUF_ND) == PyBUF_ND:
  */
   __Pyx_INCREF((PyObject *)__pyx_v_self);
   __Pyx_GIVEREF((PyObject *)__pyx_v_self);
   __Pyx_GOTREF(__pyx_v_buffer->obj);
   __Pyx_DECREF(__pyx_v_buffer->obj);
   __pyx_v_buffer->obj = ((PyObject *)__pyx_v_self);
 
-  /* "sat_toolkit/formula.pyx":656
+  /* "sat_toolkit/formula.pyx":691
  *         buffer.len = self.shape[0] * sizeof(int)
  *         buffer.obj = self
  *         buffer.readonly = 1             # <<<<<<<<<<<<<<
  *         if (flags & PyBUF_ND) == PyBUF_ND:
  *             buffer.ndim = 1
  */
   __pyx_v_buffer->readonly = 1;
 
-  /* "sat_toolkit/formula.pyx":657
+  /* "sat_toolkit/formula.pyx":692
  *         buffer.obj = self
  *         buffer.readonly = 1
  *         if (flags & PyBUF_ND) == PyBUF_ND:             # <<<<<<<<<<<<<<
  *             buffer.ndim = 1
  *             buffer.shape = &self.shape[0]
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_ND) == PyBUF_ND);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":658
+    /* "sat_toolkit/formula.pyx":693
  *         buffer.readonly = 1
  *         if (flags & PyBUF_ND) == PyBUF_ND:
  *             buffer.ndim = 1             # <<<<<<<<<<<<<<
  *             buffer.shape = &self.shape[0]
  *         else:
  */
     __pyx_v_buffer->ndim = 1;
 
-    /* "sat_toolkit/formula.pyx":659
+    /* "sat_toolkit/formula.pyx":694
  *         if (flags & PyBUF_ND) == PyBUF_ND:
  *             buffer.ndim = 1
  *             buffer.shape = &self.shape[0]             # <<<<<<<<<<<<<<
  *         else:
  *             buffer.ndim = 0
  */
     __pyx_v_buffer->shape = ((Py_ssize_t *)(&(__pyx_v_self->shape[0])));
 
-    /* "sat_toolkit/formula.pyx":657
+    /* "sat_toolkit/formula.pyx":692
  *         buffer.obj = self
  *         buffer.readonly = 1
  *         if (flags & PyBUF_ND) == PyBUF_ND:             # <<<<<<<<<<<<<<
  *             buffer.ndim = 1
  *             buffer.shape = &self.shape[0]
  */
     goto __pyx_L5;
   }
 
-  /* "sat_toolkit/formula.pyx":661
+  /* "sat_toolkit/formula.pyx":696
  *             buffer.shape = &self.shape[0]
  *         else:
  *             buffer.ndim = 0             # <<<<<<<<<<<<<<
  *             buffer.shape = NULL
  * 
  */
   /*else*/ {
     __pyx_v_buffer->ndim = 0;
 
-    /* "sat_toolkit/formula.pyx":662
+    /* "sat_toolkit/formula.pyx":697
  *         else:
  *             buffer.ndim = 0
  *             buffer.shape = NULL             # <<<<<<<<<<<<<<
  * 
  *         if (flags & PyBUF_STRIDES) == PyBUF_STRIDES:
  */
     __pyx_v_buffer->shape = NULL;
   }
   __pyx_L5:;
 
-  /* "sat_toolkit/formula.pyx":664
+  /* "sat_toolkit/formula.pyx":699
  *             buffer.shape = NULL
  * 
  *         if (flags & PyBUF_STRIDES) == PyBUF_STRIDES:             # <<<<<<<<<<<<<<
  *             buffer.strides = &buffer.itemsize
  *         else:
  */
   __pyx_t_1 = ((__pyx_v_flags & PyBUF_STRIDES) == PyBUF_STRIDES);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":665
+    /* "sat_toolkit/formula.pyx":700
  * 
  *         if (flags & PyBUF_STRIDES) == PyBUF_STRIDES:
  *             buffer.strides = &buffer.itemsize             # <<<<<<<<<<<<<<
  *         else:
  *             buffer.strides = NULL
  */
     __pyx_v_buffer->strides = (&__pyx_v_buffer->itemsize);
 
-    /* "sat_toolkit/formula.pyx":664
+    /* "sat_toolkit/formula.pyx":699
  *             buffer.shape = NULL
  * 
  *         if (flags & PyBUF_STRIDES) == PyBUF_STRIDES:             # <<<<<<<<<<<<<<
  *             buffer.strides = &buffer.itemsize
  *         else:
  */
     goto __pyx_L6;
   }
 
-  /* "sat_toolkit/formula.pyx":667
+  /* "sat_toolkit/formula.pyx":702
  *             buffer.strides = &buffer.itemsize
  *         else:
  *             buffer.strides = NULL             # <<<<<<<<<<<<<<
  * 
  *         buffer.suboffsets = NULL                # for pointer arrays only
  */
   /*else*/ {
     __pyx_v_buffer->strides = NULL;
   }
   __pyx_L6:;
 
-  /* "sat_toolkit/formula.pyx":669
+  /* "sat_toolkit/formula.pyx":704
  *             buffer.strides = NULL
  * 
  *         buffer.suboffsets = NULL                # for pointer arrays only             # <<<<<<<<<<<<<<
  * 
  *     def __releasebuffer__(self, Py_buffer *buffer):
  */
   __pyx_v_buffer->suboffsets = NULL;
 
-  /* "sat_toolkit/formula.pyx":639
+  /* "sat_toolkit/formula.pyx":674
  * 
  *     # buffer support
  *     def __getbuffer__(self, cython.Py_buffer *buffer, int flags):             # <<<<<<<<<<<<<<
  *         if flags & PyBUF_WRITABLE:
  *             raise ValueError(f'cannot provide a writable buffer for {type(self).__name__}')
  */
 
@@ -33239,56 +33706,56 @@
     __Pyx_DECREF(__pyx_v_buffer->obj); __pyx_v_buffer->obj = 0;
   }
   __pyx_L2:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":671
+/* "sat_toolkit/formula.pyx":706
  *         buffer.suboffsets = NULL                # for pointer arrays only
  * 
  *     def __releasebuffer__(self, Py_buffer *buffer):             # <<<<<<<<<<<<<<
  *         buffer.buf = NULL;
  *         self.view_count -= 1
  */
 
 /* Python wrapper */
-CYTHON_UNUSED static void __pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_buffer); /*proto*/
-CYTHON_UNUSED static void __pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_buffer) {
+CYTHON_UNUSED static void __pyx_pw_11sat_toolkit_7formula_11_ClauseList_43__releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_buffer); /*proto*/
+CYTHON_UNUSED static void __pyx_pw_11sat_toolkit_7formula_11_ClauseList_43__releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_buffer) {
   CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__releasebuffer__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
-  __pyx_pf_11sat_toolkit_7formula_11_ClauseList_40__releasebuffer__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((Py_buffer *)__pyx_v_buffer));
+  __pyx_pf_11sat_toolkit_7formula_11_ClauseList_42__releasebuffer__(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), ((Py_buffer *)__pyx_v_buffer));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-static void __pyx_pf_11sat_toolkit_7formula_11_ClauseList_40__releasebuffer__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_buffer *__pyx_v_buffer) {
+static void __pyx_pf_11sat_toolkit_7formula_11_ClauseList_42__releasebuffer__(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *__pyx_v_self, Py_buffer *__pyx_v_buffer) {
 
-  /* "sat_toolkit/formula.pyx":672
+  /* "sat_toolkit/formula.pyx":707
  * 
  *     def __releasebuffer__(self, Py_buffer *buffer):
  *         buffer.buf = NULL;             # <<<<<<<<<<<<<<
  *         self.view_count -= 1
  * 
  */
   __pyx_v_buffer->buf = NULL;
 
-  /* "sat_toolkit/formula.pyx":673
+  /* "sat_toolkit/formula.pyx":708
  *     def __releasebuffer__(self, Py_buffer *buffer):
  *         buffer.buf = NULL;
  *         self.view_count -= 1             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_v_self->view_count = (__pyx_v_self->view_count - 1);
 
-  /* "sat_toolkit/formula.pyx":671
+  /* "sat_toolkit/formula.pyx":706
  *         buffer.suboffsets = NULL                # for pointer arrays only
  * 
  *     def __releasebuffer__(self, Py_buffer *buffer):             # <<<<<<<<<<<<<<
  *         buffer.buf = NULL;
  *         self.view_count -= 1
  */
 
@@ -33389,15 +33856,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":691
+/* "sat_toolkit/formula.pyx":726
  *     """
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  */
 
@@ -33451,45 +33918,45 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dimacs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 691, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 726, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_dimacs") < 0)) __PYX_ERR(0, 691, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_dimacs") < 0)) __PYX_ERR(0, 726, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_dimacs = ((PyObject*)values[0]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("from_dimacs", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 691, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("from_dimacs", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 726, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.CNF.from_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dimacs), (&PyUnicode_Type), 0, "dimacs", 1))) __PYX_ERR(0, 692, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dimacs), (&PyUnicode_Type), 0, "dimacs", 1))) __PYX_ERR(0, 727, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_from_dimacs(__pyx_v_dimacs);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -33514,22 +33981,22 @@
   Py_ssize_t __pyx_t_5;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("from_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":693
+  /* "sat_toolkit/formula.pyx":728
  *     @staticmethod
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)             # <<<<<<<<<<<<<<
  *         if len(tmp._xor_clauses) > 0:
  *             raise ValueError('CNF must not contain xor clauses')
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 693, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 728, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -33541,71 +34008,71 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_dimacs};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 693, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 728, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 693, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 728, __pyx_L1_error)
   __pyx_v_tmp = ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":694
+  /* "sat_toolkit/formula.pyx":729
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  *         if len(tmp._xor_clauses) > 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('CNF must not contain xor clauses')
  * 
  */
   __pyx_t_1 = ((PyObject *)__pyx_v_tmp->_xor_clauses);
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_5 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 694, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 729, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_6 = (__pyx_t_5 > 0);
   if (unlikely(__pyx_t_6)) {
 
-    /* "sat_toolkit/formula.pyx":695
+    /* "sat_toolkit/formula.pyx":730
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  *         if len(tmp._xor_clauses) > 0:
  *             raise ValueError('CNF must not contain xor clauses')             # <<<<<<<<<<<<<<
  * 
  *         return tmp._clauses
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 695, __pyx_L1_error)
+    __PYX_ERR(0, 730, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":694
+    /* "sat_toolkit/formula.pyx":729
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  *         if len(tmp._xor_clauses) > 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('CNF must not contain xor clauses')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":697
+  /* "sat_toolkit/formula.pyx":732
  *             raise ValueError('CNF must not contain xor clauses')
  * 
  *         return tmp._clauses             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_tmp->_clauses);
   __pyx_r = __pyx_v_tmp->_clauses;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":691
+  /* "sat_toolkit/formula.pyx":726
  *     """
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  */
 
@@ -33619,15 +34086,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_tmp);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":699
+/* "sat_toolkit/formula.pyx":734
  *         return tmp._clauses
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_espresso(espresso: str) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -33681,45 +34148,45 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_espresso)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 699, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 734, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_espresso") < 0)) __PYX_ERR(0, 699, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_espresso") < 0)) __PYX_ERR(0, 734, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_espresso = ((PyObject*)values[0]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("from_espresso", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 699, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("from_espresso", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 734, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.CNF.from_espresso", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_espresso), (&PyUnicode_Type), 0, "espresso", 1))) __PYX_ERR(0, 700, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_espresso), (&PyUnicode_Type), 0, "espresso", 1))) __PYX_ERR(0, 735, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_2from_espresso(__pyx_v_espresso);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -33769,36 +34236,36 @@
   struct __pyx_array_obj *__pyx_t_21 = NULL;
   __Pyx_memviewslice __pyx_t_22 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("from_espresso", 1);
 
-  /* "sat_toolkit/formula.pyx":706
+  /* "sat_toolkit/formula.pyx":741
  *         cdef char val
  *         cdef uint64_t mask, sign
  *         cdef unsigned int numbits = 0             # <<<<<<<<<<<<<<
  *         cdef size_t i
  * 
  */
   __pyx_v_numbits = 0;
 
-  /* "sat_toolkit/formula.pyx":709
+  /* "sat_toolkit/formula.pyx":744
  *         cdef size_t i
  * 
  *         f = io.BytesIO(espresso.encode())             # <<<<<<<<<<<<<<
  * 
  *         for line_py in f:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 709, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 709, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyUnicode_AsEncodedString(__pyx_v_espresso, NULL, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 709, __pyx_L1_error)
+  __pyx_t_2 = PyUnicode_AsEncodedString(__pyx_v_espresso, NULL, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
@@ -33811,91 +34278,91 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 709, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_v_f = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":711
+  /* "sat_toolkit/formula.pyx":746
  *         f = io.BytesIO(espresso.encode())
  * 
  *         for line_py in f:             # <<<<<<<<<<<<<<
  *             line = line_py.rstrip()
  *             if startswith(line, b'.i '):
  */
   if (likely(PyList_CheckExact(__pyx_v_f)) || PyTuple_CheckExact(__pyx_v_f)) {
     __pyx_t_1 = __pyx_v_f; __Pyx_INCREF(__pyx_t_1);
     __pyx_t_6 = 0;
     __pyx_t_7 = NULL;
   } else {
-    __pyx_t_6 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_f); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 711, __pyx_L1_error)
+    __pyx_t_6 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_f); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 746, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 711, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 746, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_7)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_1);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 711, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 746, __pyx_L1_error)
           #endif
           if (__pyx_t_6 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely((0 < 0))) __PYX_ERR(0, 711, __pyx_L1_error)
+        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely((0 < 0))) __PYX_ERR(0, 746, __pyx_L1_error)
         #else
-        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 746, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       } else {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_1);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 711, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 746, __pyx_L1_error)
           #endif
           if (__pyx_t_6 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely((0 < 0))) __PYX_ERR(0, 711, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++; if (unlikely((0 < 0))) __PYX_ERR(0, 746, __pyx_L1_error)
         #else
-        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 746, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       }
     } else {
       __pyx_t_3 = __pyx_t_7(__pyx_t_1);
       if (unlikely(!__pyx_t_3)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 711, __pyx_L1_error)
+          else __PYX_ERR(0, 746, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_3);
     }
     __Pyx_XDECREF_SET(__pyx_v_line_py, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "sat_toolkit/formula.pyx":712
+    /* "sat_toolkit/formula.pyx":747
  * 
  *         for line_py in f:
  *             line = line_py.rstrip()             # <<<<<<<<<<<<<<
  *             if startswith(line, b'.i '):
  *                 _, bits = line_py.split()
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line_py, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line_py, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_4 = NULL;
     __pyx_t_5 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_4)) {
@@ -33907,43 +34374,43 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 712, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 747, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_char__const__(__pyx_t_3, 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_char__const__(__pyx_t_3, 0); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 747, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_XCLEAR_MEMVIEW(&__pyx_v_line, 1);
     __pyx_v_line = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":713
+    /* "sat_toolkit/formula.pyx":748
  *         for line_py in f:
  *             line = line_py.rstrip()
  *             if startswith(line, b'.i '):             # <<<<<<<<<<<<<<
  *                 _, bits = line_py.split()
  *                 numbits = int(bits)
  */
     __pyx_t_9 = (__pyx_f_11sat_toolkit_7formula_startswith(__pyx_v_line, ((char const *)".i ")) != 0);
     if (__pyx_t_9) {
 
-      /* "sat_toolkit/formula.pyx":714
+      /* "sat_toolkit/formula.pyx":749
  *             line = line_py.rstrip()
  *             if startswith(line, b'.i '):
  *                 _, bits = line_py.split()             # <<<<<<<<<<<<<<
  *                 numbits = int(bits)
  *             if startswith(line, b'.p '):
  */
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line_py, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line_py, __pyx_n_s_split); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 749, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_4 = NULL;
       __pyx_t_5 = 0;
       #if CYTHON_UNPACK_METHODS
       if (likely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_4)) {
@@ -33955,103 +34422,103 @@
         }
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
       if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
         PyObject* sequence = __pyx_t_3;
         Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
         if (unlikely(size != 2)) {
           if (size > 2) __Pyx_RaiseTooManyValuesError(2);
           else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 714, __pyx_L1_error)
+          __PYX_ERR(0, 749, __pyx_L1_error)
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
         if (likely(PyTuple_CheckExact(sequence))) {
           __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
           __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
         } else {
           __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
           __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
         }
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_4);
         #else
-        __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 749, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+        __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 749, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         #endif
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else {
         Py_ssize_t index = -1;
-        __pyx_t_10 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 714, __pyx_L1_error)
+        __pyx_t_10 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 749, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_11 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_10);
         index = 0; __pyx_t_2 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_2)) goto __pyx_L6_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_2);
         index = 1; __pyx_t_4 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_4)) goto __pyx_L6_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_4);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_11(__pyx_t_10), 2) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
+        if (__Pyx_IternextUnpackEndCheck(__pyx_t_11(__pyx_t_10), 2) < 0) __PYX_ERR(0, 749, __pyx_L1_error)
         __pyx_t_11 = NULL;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         goto __pyx_L7_unpacking_done;
         __pyx_L6_unpacking_failed:;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __pyx_t_11 = NULL;
         if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 714, __pyx_L1_error)
+        __PYX_ERR(0, 749, __pyx_L1_error)
         __pyx_L7_unpacking_done:;
       }
       __Pyx_XDECREF_SET(__pyx_v__, __pyx_t_2);
       __pyx_t_2 = 0;
       __Pyx_XDECREF_SET(__pyx_v_bits, __pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "sat_toolkit/formula.pyx":715
+      /* "sat_toolkit/formula.pyx":750
  *             if startswith(line, b'.i '):
  *                 _, bits = line_py.split()
  *                 numbits = int(bits)             # <<<<<<<<<<<<<<
  *             if startswith(line, b'.p '):
  *                 ...
  */
-      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_bits); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_bits); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_12 = __Pyx_PyInt_As_unsigned_int(__pyx_t_3); if (unlikely((__pyx_t_12 == (unsigned int)-1) && PyErr_Occurred())) __PYX_ERR(0, 715, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyInt_As_unsigned_int(__pyx_t_3); if (unlikely((__pyx_t_12 == (unsigned int)-1) && PyErr_Occurred())) __PYX_ERR(0, 750, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_v_numbits = __pyx_t_12;
 
-      /* "sat_toolkit/formula.pyx":713
+      /* "sat_toolkit/formula.pyx":748
  *         for line_py in f:
  *             line = line_py.rstrip()
  *             if startswith(line, b'.i '):             # <<<<<<<<<<<<<<
  *                 _, bits = line_py.split()
  *                 numbits = int(bits)
  */
     }
 
-    /* "sat_toolkit/formula.pyx":716
+    /* "sat_toolkit/formula.pyx":751
  *                 _, bits = line_py.split()
  *                 numbits = int(bits)
  *             if startswith(line, b'.p '):             # <<<<<<<<<<<<<<
  *                 ...
  *             if startswith(line, b'#') or startswith(line, b'.'):
  */
     __pyx_t_9 = (__pyx_f_11sat_toolkit_7formula_startswith(__pyx_v_line, ((char const *)".p ")) != 0);
     if (__pyx_t_9) {
     }
 
-    /* "sat_toolkit/formula.pyx":718
+    /* "sat_toolkit/formula.pyx":753
  *             if startswith(line, b'.p '):
  *                 ...
  *             if startswith(line, b'#') or startswith(line, b'.'):             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
     __pyx_t_13 = (__pyx_f_11sat_toolkit_7formula_startswith(__pyx_v_line, ((char const *)"#")) != 0);
@@ -34061,43 +34528,43 @@
       goto __pyx_L10_bool_binop_done;
     }
     __pyx_t_13 = (__pyx_f_11sat_toolkit_7formula_startswith(__pyx_v_line, ((char const *)".")) != 0);
     __pyx_t_9 = __pyx_t_13;
     __pyx_L10_bool_binop_done:;
     if (__pyx_t_9) {
 
-      /* "sat_toolkit/formula.pyx":719
+      /* "sat_toolkit/formula.pyx":754
  *                 ...
  *             if startswith(line, b'#') or startswith(line, b'.'):
  *                 continue             # <<<<<<<<<<<<<<
  * 
  *             val = line[line.shape[0] - 1]
  */
       goto __pyx_L3_continue;
 
-      /* "sat_toolkit/formula.pyx":718
+      /* "sat_toolkit/formula.pyx":753
  *             if startswith(line, b'.p '):
  *                 ...
  *             if startswith(line, b'#') or startswith(line, b'.'):             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":721
+    /* "sat_toolkit/formula.pyx":756
  *                 continue
  * 
  *             val = line[line.shape[0] - 1]             # <<<<<<<<<<<<<<
  *             if line.shape[0] != numbits + 2 or line[line.shape[0] - 2] != b' ':
  *                 raise ValueError('file format error')
  */
     __pyx_t_14 = ((__pyx_v_line.shape[0]) - 1);
     __pyx_v_val = (*((unsigned char const  *) ( /* dim=0 */ (__pyx_v_line.data + __pyx_t_14 * __pyx_v_line.strides[0]) )));
 
-    /* "sat_toolkit/formula.pyx":722
+    /* "sat_toolkit/formula.pyx":757
  * 
  *             val = line[line.shape[0] - 1]
  *             if line.shape[0] != numbits + 2 or line[line.shape[0] - 2] != b' ':             # <<<<<<<<<<<<<<
  *                 raise ValueError('file format error')
  * 
  */
     __pyx_t_13 = ((__pyx_v_line.shape[0]) != (__pyx_v_numbits + 2));
@@ -34108,374 +34575,374 @@
     }
     __pyx_t_14 = ((__pyx_v_line.shape[0]) - 2);
     __pyx_t_13 = ((*((unsigned char const  *) ( /* dim=0 */ (__pyx_v_line.data + __pyx_t_14 * __pyx_v_line.strides[0]) ))) != ' ');
     __pyx_t_9 = __pyx_t_13;
     __pyx_L13_bool_binop_done:;
     if (unlikely(__pyx_t_9)) {
 
-      /* "sat_toolkit/formula.pyx":723
+      /* "sat_toolkit/formula.pyx":758
  *             val = line[line.shape[0] - 1]
  *             if line.shape[0] != numbits + 2 or line[line.shape[0] - 2] != b' ':
  *                 raise ValueError('file format error')             # <<<<<<<<<<<<<<
  * 
  *             #espresso_mask, val = line.split()
  */
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 723, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 758, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_Raise(__pyx_t_3, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __PYX_ERR(0, 723, __pyx_L1_error)
+      __PYX_ERR(0, 758, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":722
+      /* "sat_toolkit/formula.pyx":757
  * 
  *             val = line[line.shape[0] - 1]
  *             if line.shape[0] != numbits + 2 or line[line.shape[0] - 2] != b' ':             # <<<<<<<<<<<<<<
  *                 raise ValueError('file format error')
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":727
+    /* "sat_toolkit/formula.pyx":762
  *             #espresso_mask, val = line.split()
  * 
  *             if val != b'1':             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'got unexpected value for product term: {val!r} expected \'1\'.')
  * 
  */
     __pyx_t_9 = (__pyx_v_val != '1');
     if (unlikely(__pyx_t_9)) {
 
-      /* "sat_toolkit/formula.pyx":728
+      /* "sat_toolkit/formula.pyx":763
  * 
  *             if val != b'1':
  *                 raise ValueError(f'got unexpected value for product term: {val!r} expected \'1\'.')             # <<<<<<<<<<<<<<
  * 
  *             for i in range(numbits):
  */
-      __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 728, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 763, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_15 = 0;
       __pyx_t_16 = 127;
       __Pyx_INCREF(__pyx_kp_u_got_unexpected_value_for_product);
       __pyx_t_15 += 39;
       __Pyx_GIVEREF(__pyx_kp_u_got_unexpected_value_for_product);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_kp_u_got_unexpected_value_for_product);
-      __pyx_t_4 = __Pyx_PyUnicode_From_char(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 728, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_From_char(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 763, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_15 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
       __pyx_t_4 = 0;
       __Pyx_INCREF(__pyx_kp_u_expected_1);
       __pyx_t_15 += 14;
       __Pyx_GIVEREF(__pyx_kp_u_expected_1);
       PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_kp_u_expected_1);
-      __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_3, 3, __pyx_t_15, __pyx_t_16); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 728, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_3, 3, __pyx_t_15, __pyx_t_16); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 763, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 728, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 763, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_Raise(__pyx_t_3, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __PYX_ERR(0, 728, __pyx_L1_error)
+      __PYX_ERR(0, 763, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":727
+      /* "sat_toolkit/formula.pyx":762
  *             #espresso_mask, val = line.split()
  * 
  *             if val != b'1':             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'got unexpected value for product term: {val!r} expected \'1\'.')
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":730
+    /* "sat_toolkit/formula.pyx":765
  *                 raise ValueError(f'got unexpected value for product term: {val!r} expected \'1\'.')
  * 
  *             for i in range(numbits):             # <<<<<<<<<<<<<<
  *                 val = line[numbits - 1 - i]
  *                 if val == b'-':
  */
     __pyx_t_12 = __pyx_v_numbits;
     __pyx_t_17 = __pyx_t_12;
     for (__pyx_t_18 = 0; __pyx_t_18 < __pyx_t_17; __pyx_t_18+=1) {
       __pyx_v_i = __pyx_t_18;
 
-      /* "sat_toolkit/formula.pyx":731
+      /* "sat_toolkit/formula.pyx":766
  * 
  *             for i in range(numbits):
  *                 val = line[numbits - 1 - i]             # <<<<<<<<<<<<<<
  *                 if val == b'-':
  *                     continue
  */
       __pyx_t_19 = ((__pyx_v_numbits - 1) - __pyx_v_i);
       __pyx_v_val = (*((unsigned char const  *) ( /* dim=0 */ (__pyx_v_line.data + __pyx_t_19 * __pyx_v_line.strides[0]) )));
 
-      /* "sat_toolkit/formula.pyx":732
+      /* "sat_toolkit/formula.pyx":767
  *             for i in range(numbits):
  *                 val = line[numbits - 1 - i]
  *                 if val == b'-':             # <<<<<<<<<<<<<<
  *                     continue
  *                 # 0/1 swapped according to De Morgan's law
  */
       __pyx_t_9 = (__pyx_v_val == '-');
       if (__pyx_t_9) {
 
-        /* "sat_toolkit/formula.pyx":733
+        /* "sat_toolkit/formula.pyx":768
  *                 val = line[numbits - 1 - i]
  *                 if val == b'-':
  *                     continue             # <<<<<<<<<<<<<<
  *                 # 0/1 swapped according to De Morgan's law
  *                 if val == b'0':
  */
         goto __pyx_L16_continue;
 
-        /* "sat_toolkit/formula.pyx":732
+        /* "sat_toolkit/formula.pyx":767
  *             for i in range(numbits):
  *                 val = line[numbits - 1 - i]
  *                 if val == b'-':             # <<<<<<<<<<<<<<
  *                     continue
  *                 # 0/1 swapped according to De Morgan's law
  */
       }
 
-      /* "sat_toolkit/formula.pyx":735
+      /* "sat_toolkit/formula.pyx":770
  *                     continue
  *                 # 0/1 swapped according to De Morgan's law
  *                 if val == b'0':             # <<<<<<<<<<<<<<
  *                     clauses.push_back((i + 1))
  *                     continue
  */
       __pyx_t_9 = (__pyx_v_val == '0');
       if (__pyx_t_9) {
 
-        /* "sat_toolkit/formula.pyx":736
+        /* "sat_toolkit/formula.pyx":771
  *                 # 0/1 swapped according to De Morgan's law
  *                 if val == b'0':
  *                     clauses.push_back((i + 1))             # <<<<<<<<<<<<<<
  *                     continue
  *                 if val == b'1':
  */
         try {
           __pyx_v_clauses.push_back((__pyx_v_i + 1));
         } catch(...) {
           __Pyx_CppExn2PyErr();
-          __PYX_ERR(0, 736, __pyx_L1_error)
+          __PYX_ERR(0, 771, __pyx_L1_error)
         }
 
-        /* "sat_toolkit/formula.pyx":737
+        /* "sat_toolkit/formula.pyx":772
  *                 if val == b'0':
  *                     clauses.push_back((i + 1))
  *                     continue             # <<<<<<<<<<<<<<
  *                 if val == b'1':
  *                     clauses.push_back(-(i + 1))
  */
         goto __pyx_L16_continue;
 
-        /* "sat_toolkit/formula.pyx":735
+        /* "sat_toolkit/formula.pyx":770
  *                     continue
  *                 # 0/1 swapped according to De Morgan's law
  *                 if val == b'0':             # <<<<<<<<<<<<<<
  *                     clauses.push_back((i + 1))
  *                     continue
  */
       }
 
-      /* "sat_toolkit/formula.pyx":738
+      /* "sat_toolkit/formula.pyx":773
  *                     clauses.push_back((i + 1))
  *                     continue
  *                 if val == b'1':             # <<<<<<<<<<<<<<
  *                     clauses.push_back(-(i + 1))
  *                     continue
  */
       __pyx_t_9 = (__pyx_v_val == '1');
       if (__pyx_t_9) {
 
-        /* "sat_toolkit/formula.pyx":739
+        /* "sat_toolkit/formula.pyx":774
  *                     continue
  *                 if val == b'1':
  *                     clauses.push_back(-(i + 1))             # <<<<<<<<<<<<<<
  *                     continue
  *                 raise ValueError(f'file format error in line {bytes(line)}')
  */
         try {
           __pyx_v_clauses.push_back((-(__pyx_v_i + 1)));
         } catch(...) {
           __Pyx_CppExn2PyErr();
-          __PYX_ERR(0, 739, __pyx_L1_error)
+          __PYX_ERR(0, 774, __pyx_L1_error)
         }
 
-        /* "sat_toolkit/formula.pyx":740
+        /* "sat_toolkit/formula.pyx":775
  *                 if val == b'1':
  *                     clauses.push_back(-(i + 1))
  *                     continue             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'file format error in line {bytes(line)}')
  *             clauses.push_back(0)
  */
         goto __pyx_L16_continue;
 
-        /* "sat_toolkit/formula.pyx":738
+        /* "sat_toolkit/formula.pyx":773
  *                     clauses.push_back((i + 1))
  *                     continue
  *                 if val == b'1':             # <<<<<<<<<<<<<<
  *                     clauses.push_back(-(i + 1))
  *                     continue
  */
       }
 
-      /* "sat_toolkit/formula.pyx":741
+      /* "sat_toolkit/formula.pyx":776
  *                     clauses.push_back(-(i + 1))
  *                     continue
  *                 raise ValueError(f'file format error in line {bytes(line)}')             # <<<<<<<<<<<<<<
  *             clauses.push_back(0)
  * 
  */
-      __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_line, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_char__const__, (int (*)(char *, PyObject *)) NULL, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)
+      __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_line, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_char__const__, (int (*)(char *, PyObject *)) NULL, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 776, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyBytes_Type)), __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyBytes_Type)), __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 776, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 776, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_file_format_error_in_line, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_file_format_error_in_line, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 776, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 776, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_Raise(__pyx_t_3, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __PYX_ERR(0, 741, __pyx_L1_error)
+      __PYX_ERR(0, 776, __pyx_L1_error)
       __pyx_L16_continue:;
     }
 
-    /* "sat_toolkit/formula.pyx":742
+    /* "sat_toolkit/formula.pyx":777
  *                     continue
  *                 raise ValueError(f'file format error in line {bytes(line)}')
  *             clauses.push_back(0)             # <<<<<<<<<<<<<<
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  */
     try {
       __pyx_v_clauses.push_back(0);
     } catch(...) {
       __Pyx_CppExn2PyErr();
-      __PYX_ERR(0, 742, __pyx_L1_error)
+      __PYX_ERR(0, 777, __pyx_L1_error)
     }
 
-    /* "sat_toolkit/formula.pyx":711
+    /* "sat_toolkit/formula.pyx":746
  *         f = io.BytesIO(espresso.encode())
  * 
  *         for line_py in f:             # <<<<<<<<<<<<<<
  *             line = line_py.rstrip()
  *             if startswith(line, b'.i '):
  */
     __pyx_L3_continue:;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":744
+  /* "sat_toolkit/formula.pyx":779
  *             clauses.push_back(0)
  * 
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":745
+  /* "sat_toolkit/formula.pyx":780
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         assert numbits >= <unsigned int> res.nvars
  */
   __pyx_t_9 = (__pyx_v_clauses.size() > 0);
   if (__pyx_t_9) {
 
-    /* "sat_toolkit/formula.pyx":746
+    /* "sat_toolkit/formula.pyx":781
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())             # <<<<<<<<<<<<<<
  *         assert numbits >= <unsigned int> res.nvars
  *         res.nvars = numbits
  */
     __pyx_t_20 = __pyx_v_clauses.data();
     if (!__pyx_t_20) {
       PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-      __PYX_ERR(0, 746, __pyx_L1_error)
+      __PYX_ERR(0, 781, __pyx_L1_error)
     }
-    __pyx_t_3 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 746, __pyx_L1_error)
+    __pyx_t_3 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 781, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 746, __pyx_L1_error)
+    __pyx_t_1 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_21 = __pyx_array_new(__pyx_t_1, sizeof(int), PyBytes_AS_STRING(__pyx_t_3), (char *) "c", (char *) __pyx_t_20); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 746, __pyx_L1_error)
+    __pyx_t_21 = __pyx_array_new(__pyx_t_1, sizeof(int), PyBytes_AS_STRING(__pyx_t_3), (char *) "c", (char *) __pyx_t_20); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 781, __pyx_L1_error)
     __Pyx_GOTREF((PyObject *)__pyx_t_21);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_22 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_21), 0); if (unlikely(!__pyx_t_22.memview)) __PYX_ERR(0, 746, __pyx_L1_error)
+    __pyx_t_22 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_21), 0); if (unlikely(!__pyx_t_22.memview)) __PYX_ERR(0, 781, __pyx_L1_error)
     __Pyx_DECREF((PyObject *)__pyx_t_21); __pyx_t_21 = 0;
-    __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_22); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 746, __pyx_L1_error)
+    __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_22); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 781, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_22, 1);
     __pyx_t_22.memview = NULL; __pyx_t_22.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":745
+    /* "sat_toolkit/formula.pyx":780
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         assert numbits >= <unsigned int> res.nvars
  */
   }
 
-  /* "sat_toolkit/formula.pyx":747
+  /* "sat_toolkit/formula.pyx":782
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         assert numbits >= <unsigned int> res.nvars             # <<<<<<<<<<<<<<
  *         res.nvars = numbits
  *         return res
  */
   #ifndef CYTHON_WITHOUT_ASSERTIONS
   if (unlikely(__pyx_assertions_enabled())) {
     __pyx_t_9 = (__pyx_v_numbits >= ((unsigned int)__pyx_v_res->__pyx_base.nvars));
     if (unlikely(!__pyx_t_9)) {
       __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-      __PYX_ERR(0, 747, __pyx_L1_error)
+      __PYX_ERR(0, 782, __pyx_L1_error)
     }
   }
   #else
-  if ((1)); else __PYX_ERR(0, 747, __pyx_L1_error)
+  if ((1)); else __PYX_ERR(0, 782, __pyx_L1_error)
   #endif
 
-  /* "sat_toolkit/formula.pyx":748
+  /* "sat_toolkit/formula.pyx":783
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         assert numbits >= <unsigned int> res.nvars
  *         res.nvars = numbits             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
   __pyx_v_res->__pyx_base.nvars = __pyx_v_numbits;
 
-  /* "sat_toolkit/formula.pyx":749
+  /* "sat_toolkit/formula.pyx":784
  *         assert numbits >= <unsigned int> res.nvars
  *         res.nvars = numbits
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":699
+  /* "sat_toolkit/formula.pyx":734
  *         return tmp._clauses
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_espresso(espresso: str) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -34499,15 +34966,15 @@
   __Pyx_XDECREF(__pyx_v_bits);
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":751
+/* "sat_toolkit/formula.pyx":786
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_zero(indices) -> CNF:
  *         """
  */
 
@@ -34561,31 +35028,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_indices)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 751, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 786, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "create_all_zero") < 0)) __PYX_ERR(0, 751, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "create_all_zero") < 0)) __PYX_ERR(0, 786, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_indices = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("create_all_zero", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 751, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("create_all_zero", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 786, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -34619,58 +35086,58 @@
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("create_all_zero", 0);
   __Pyx_INCREF(__pyx_v_indices);
 
-  /* "sat_toolkit/formula.pyx":757
+  /* "sat_toolkit/formula.pyx":792
  *         are zero.
  *         """
  *         indices = np.array(indices, dtype=np.int32, copy=False)             # <<<<<<<<<<<<<<
  *         return CNF._create_all_zero(indices)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 792, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 757, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 792, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 792, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_indices);
   __Pyx_GIVEREF(__pyx_v_indices);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_indices)) __PYX_ERR(0, 757, __pyx_L1_error);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 757, __pyx_L1_error)
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_indices)) __PYX_ERR(0, 792, __pyx_L1_error);
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 792, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 792, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 757, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 792, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 792, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 757, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 792, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 792, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_indices, __pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":758
+  /* "sat_toolkit/formula.pyx":793
  *         """
  *         indices = np.array(indices, dtype=np.int32, copy=False)
  *         return CNF._create_all_zero(indices)             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_create_all_zero); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 758, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_create_all_zero); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_1 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_1)) {
@@ -34682,24 +35149,24 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_indices};
     __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 758, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 793, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 758, __pyx_L1_error)
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 793, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_5);
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":751
+  /* "sat_toolkit/formula.pyx":786
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_zero(indices) -> CNF:
  *         """
  */
 
@@ -34715,15 +35182,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_indices);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":760
+/* "sat_toolkit/formula.pyx":795
  *         return CNF._create_all_zero(indices)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_zero(const int[:] indices not None) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -34777,31 +35244,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_indices)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 760, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 795, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_create_all_zero") < 0)) __PYX_ERR(0, 760, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_create_all_zero") < 0)) __PYX_ERR(0, 795, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
-    __pyx_v_indices = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[0], 0); if (unlikely(!__pyx_v_indices.memview)) __PYX_ERR(0, 761, __pyx_L3_error)
+    __pyx_v_indices = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[0], 0); if (unlikely(!__pyx_v_indices.memview)) __PYX_ERR(0, 796, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_create_all_zero", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 760, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_create_all_zero", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 795, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -34809,15 +35276,15 @@
   }
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_indices, 1);
   __Pyx_AddTraceback("sat_toolkit.formula.CNF._create_all_zero", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   if (unlikely(((PyObject *)__pyx_v_indices.memview) == Py_None)) {
-    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "indices"); __PYX_ERR(0, 761, __pyx_L1_error)
+    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "indices"); __PYX_ERR(0, 796, __pyx_L1_error)
   }
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_6_create_all_zero(__pyx_v_indices);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
@@ -34853,171 +35320,171 @@
   __Pyx_memviewslice __pyx_t_10 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_create_all_zero", 1);
 
-  /* "sat_toolkit/formula.pyx":766
+  /* "sat_toolkit/formula.pyx":801
  *         cdef int val
  * 
  *         l = indices.shape[0]             # <<<<<<<<<<<<<<
  * 
  *         clauses.resize(l * 2)
  */
   __pyx_v_l = (__pyx_v_indices.shape[0]);
 
-  /* "sat_toolkit/formula.pyx":768
+  /* "sat_toolkit/formula.pyx":803
  *         l = indices.shape[0]
  * 
  *         clauses.resize(l * 2)             # <<<<<<<<<<<<<<
  *         for i in range(l):
  *             val = indices[i]
  */
   try {
     __pyx_v_clauses.resize((__pyx_v_l * 2));
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 768, __pyx_L1_error)
+    __PYX_ERR(0, 803, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":769
+  /* "sat_toolkit/formula.pyx":804
  * 
  *         clauses.resize(l * 2)
  *         for i in range(l):             # <<<<<<<<<<<<<<
  *             val = indices[i]
  *             if val == 0:
  */
   __pyx_t_1 = __pyx_v_l;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "sat_toolkit/formula.pyx":770
+    /* "sat_toolkit/formula.pyx":805
  *         clauses.resize(l * 2)
  *         for i in range(l):
  *             val = indices[i]             # <<<<<<<<<<<<<<
  *             if val == 0:
  *                 raise ValueError('all indices must be nonzero')
  */
     __pyx_t_4 = __pyx_v_i;
     __pyx_v_val = (*((int const  *) ( /* dim=0 */ (__pyx_v_indices.data + __pyx_t_4 * __pyx_v_indices.strides[0]) )));
 
-    /* "sat_toolkit/formula.pyx":771
+    /* "sat_toolkit/formula.pyx":806
  *         for i in range(l):
  *             val = indices[i]
  *             if val == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  *             clauses[2*i] = -val
  */
     __pyx_t_5 = (__pyx_v_val == 0);
     if (unlikely(__pyx_t_5)) {
 
-      /* "sat_toolkit/formula.pyx":772
+      /* "sat_toolkit/formula.pyx":807
  *             val = indices[i]
  *             if val == 0:
  *                 raise ValueError('all indices must be nonzero')             # <<<<<<<<<<<<<<
  *             clauses[2*i] = -val
  * 
  */
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 772, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 807, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __PYX_ERR(0, 772, __pyx_L1_error)
+      __PYX_ERR(0, 807, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":771
+      /* "sat_toolkit/formula.pyx":806
  *         for i in range(l):
  *             val = indices[i]
  *             if val == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  *             clauses[2*i] = -val
  */
     }
 
-    /* "sat_toolkit/formula.pyx":773
+    /* "sat_toolkit/formula.pyx":808
  *             if val == 0:
  *                 raise ValueError('all indices must be nonzero')
  *             clauses[2*i] = -val             # <<<<<<<<<<<<<<
  * 
  * 
  */
     (__pyx_v_clauses[(2 * __pyx_v_i)]) = (-__pyx_v_val);
   }
 
-  /* "sat_toolkit/formula.pyx":776
+  /* "sat_toolkit/formula.pyx":811
  * 
  * 
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  */
-  __pyx_t_6 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 776, __pyx_L1_error)
+  __pyx_t_6 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 811, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_6);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_6);
   __pyx_t_6 = 0;
 
-  /* "sat_toolkit/formula.pyx":777
+  /* "sat_toolkit/formula.pyx":812
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res
  */
   __pyx_t_5 = (__pyx_v_clauses.size() > 0);
   if (__pyx_t_5) {
 
-    /* "sat_toolkit/formula.pyx":778
+    /* "sat_toolkit/formula.pyx":813
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
     __pyx_t_7 = __pyx_v_clauses.data();
     if (!__pyx_t_7) {
       PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-      __PYX_ERR(0, 778, __pyx_L1_error)
+      __PYX_ERR(0, 813, __pyx_L1_error)
     }
-    __pyx_t_9 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_9 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_6 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_6 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __pyx_array_new(__pyx_t_6, sizeof(int), PyBytes_AS_STRING(__pyx_t_9), (char *) "c", (char *) __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_8 = __pyx_array_new(__pyx_t_6, sizeof(int), PyBytes_AS_STRING(__pyx_t_9), (char *) "c", (char *) __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_GOTREF((PyObject *)__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_8), 0); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_8), 0); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_DECREF((PyObject *)__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_11 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_10); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_11 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_10); if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 813, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":777
+    /* "sat_toolkit/formula.pyx":812
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res
  */
   }
 
-  /* "sat_toolkit/formula.pyx":779
+  /* "sat_toolkit/formula.pyx":814
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":760
+  /* "sat_toolkit/formula.pyx":795
  *         return CNF._create_all_zero(indices)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_zero(const int[:] indices not None) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -35032,15 +35499,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":781
+/* "sat_toolkit/formula.pyx":816
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_equal(lhs, rhs) -> CNF:
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  */
 
@@ -35097,43 +35564,43 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_lhs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 781, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 816, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rhs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 781, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 816, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("create_all_equal", 1, 2, 2, 1); __PYX_ERR(0, 781, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("create_all_equal", 1, 2, 2, 1); __PYX_ERR(0, 816, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "create_all_equal") < 0)) __PYX_ERR(0, 781, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "create_all_equal") < 0)) __PYX_ERR(0, 816, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 2)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
     }
     __pyx_v_lhs = values[0];
     __pyx_v_rhs = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("create_all_equal", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 781, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("create_all_equal", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 816, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -35168,93 +35635,93 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("create_all_equal", 0);
   __Pyx_INCREF(__pyx_v_lhs);
   __Pyx_INCREF(__pyx_v_rhs);
 
-  /* "sat_toolkit/formula.pyx":784
+  /* "sat_toolkit/formula.pyx":819
  *     def create_all_equal(lhs, rhs) -> CNF:
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  *         lhs = np.array(lhs, dtype=np.int32, copy=False)             # <<<<<<<<<<<<<<
  *         rhs = np.array(rhs, dtype=np.int32, copy=False)
  *         return CNF._create_all_equal(lhs, rhs)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 784, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 784, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 784, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_lhs);
   __Pyx_GIVEREF(__pyx_v_lhs);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_lhs)) __PYX_ERR(0, 784, __pyx_L1_error);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 784, __pyx_L1_error)
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_lhs)) __PYX_ERR(0, 819, __pyx_L1_error);
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 784, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 784, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 784, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 784, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 784, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 819, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_lhs, __pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":785
+  /* "sat_toolkit/formula.pyx":820
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  *         lhs = np.array(lhs, dtype=np.int32, copy=False)
  *         rhs = np.array(rhs, dtype=np.int32, copy=False)             # <<<<<<<<<<<<<<
  *         return CNF._create_all_equal(lhs, rhs)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 785, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 785, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 785, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(__pyx_v_rhs);
   __Pyx_GIVEREF(__pyx_v_rhs);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_rhs)) __PYX_ERR(0, 785, __pyx_L1_error);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 785, __pyx_L1_error)
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_rhs)) __PYX_ERR(0, 820, __pyx_L1_error);
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 785, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 785, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 785, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 785, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 820, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF_SET(__pyx_v_rhs, __pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "sat_toolkit/formula.pyx":786
+  /* "sat_toolkit/formula.pyx":821
  *         lhs = np.array(lhs, dtype=np.int32, copy=False)
  *         rhs = np.array(rhs, dtype=np.int32, copy=False)
  *         return CNF._create_all_equal(lhs, rhs)             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_create_all_equal); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_create_all_equal); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_5 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_5)) {
@@ -35266,24 +35733,24 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_v_lhs, __pyx_v_rhs};
     __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 786, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 821, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
-  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 786, __pyx_L1_error)
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 821, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_4);
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":781
+  /* "sat_toolkit/formula.pyx":816
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_equal(lhs, rhs) -> CNF:
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  */
 
@@ -35300,15 +35767,15 @@
   __Pyx_XDECREF(__pyx_v_lhs);
   __Pyx_XDECREF(__pyx_v_rhs);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":788
+/* "sat_toolkit/formula.pyx":823
  *         return CNF._create_all_equal(lhs, rhs)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_equal(const int[:] lhs not None, const int[:] rhs not None) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -35365,43 +35832,43 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_lhs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 788, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 823, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_rhs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 788, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 823, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("_create_all_equal", 1, 2, 2, 1); __PYX_ERR(0, 788, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_create_all_equal", 1, 2, 2, 1); __PYX_ERR(0, 823, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_create_all_equal") < 0)) __PYX_ERR(0, 788, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_create_all_equal") < 0)) __PYX_ERR(0, 823, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 2)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
     }
-    __pyx_v_lhs = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[0], 0); if (unlikely(!__pyx_v_lhs.memview)) __PYX_ERR(0, 789, __pyx_L3_error)
-    __pyx_v_rhs = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[1], 0); if (unlikely(!__pyx_v_rhs.memview)) __PYX_ERR(0, 789, __pyx_L3_error)
+    __pyx_v_lhs = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[0], 0); if (unlikely(!__pyx_v_lhs.memview)) __PYX_ERR(0, 824, __pyx_L3_error)
+    __pyx_v_rhs = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(values[1], 0); if (unlikely(!__pyx_v_rhs.memview)) __PYX_ERR(0, 824, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_create_all_equal", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 788, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_create_all_equal", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 823, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -35410,18 +35877,18 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_lhs, 1);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_rhs, 1);
   __Pyx_AddTraceback("sat_toolkit.formula.CNF._create_all_equal", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   if (unlikely(((PyObject *)__pyx_v_lhs.memview) == Py_None)) {
-    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "lhs"); __PYX_ERR(0, 789, __pyx_L1_error)
+    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "lhs"); __PYX_ERR(0, 824, __pyx_L1_error)
   }
   if (unlikely(((PyObject *)__pyx_v_rhs.memview) == Py_None)) {
-    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "rhs"); __PYX_ERR(0, 789, __pyx_L1_error)
+    PyErr_Format(PyExc_TypeError, "Argument '%.200s' must not be None", "rhs"); __PYX_ERR(0, 824, __pyx_L1_error)
   }
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_10_create_all_equal(__pyx_v_lhs, __pyx_v_rhs);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
@@ -35460,102 +35927,102 @@
   __Pyx_memviewslice __pyx_t_11 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_create_all_equal", 1);
 
-  /* "sat_toolkit/formula.pyx":794
+  /* "sat_toolkit/formula.pyx":829
  *         cdef int l, r
  * 
  *         length = lhs.shape[0]             # <<<<<<<<<<<<<<
  *         if rhs.shape[0] != length:
  *             raise ValueError('lhs and rhs must have the same length')
  */
   __pyx_v_length = (__pyx_v_lhs.shape[0]);
 
-  /* "sat_toolkit/formula.pyx":795
+  /* "sat_toolkit/formula.pyx":830
  * 
  *         length = lhs.shape[0]
  *         if rhs.shape[0] != length:             # <<<<<<<<<<<<<<
  *             raise ValueError('lhs and rhs must have the same length')
  * 
  */
   __pyx_t_1 = ((__pyx_v_rhs.shape[0]) != __pyx_v_length);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":796
+    /* "sat_toolkit/formula.pyx":831
  *         length = lhs.shape[0]
  *         if rhs.shape[0] != length:
  *             raise ValueError('lhs and rhs must have the same length')             # <<<<<<<<<<<<<<
  * 
  *         clauses.resize(length * 6)
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 796, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 796, __pyx_L1_error)
+    __PYX_ERR(0, 831, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":795
+    /* "sat_toolkit/formula.pyx":830
  * 
  *         length = lhs.shape[0]
  *         if rhs.shape[0] != length:             # <<<<<<<<<<<<<<
  *             raise ValueError('lhs and rhs must have the same length')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":798
+  /* "sat_toolkit/formula.pyx":833
  *             raise ValueError('lhs and rhs must have the same length')
  * 
  *         clauses.resize(length * 6)             # <<<<<<<<<<<<<<
  *         for i in range(length):
  *             l = lhs[i]
  */
   try {
     __pyx_v_clauses.resize((__pyx_v_length * 6));
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 798, __pyx_L1_error)
+    __PYX_ERR(0, 833, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":799
+  /* "sat_toolkit/formula.pyx":834
  * 
  *         clauses.resize(length * 6)
  *         for i in range(length):             # <<<<<<<<<<<<<<
  *             l = lhs[i]
  *             r = rhs[i]
  */
   __pyx_t_3 = __pyx_v_length;
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_i = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":800
+    /* "sat_toolkit/formula.pyx":835
  *         clauses.resize(length * 6)
  *         for i in range(length):
  *             l = lhs[i]             # <<<<<<<<<<<<<<
  *             r = rhs[i]
  *             if l == 0 or r == 0:
  */
     __pyx_t_6 = __pyx_v_i;
     __pyx_v_l = (*((int const  *) ( /* dim=0 */ (__pyx_v_lhs.data + __pyx_t_6 * __pyx_v_lhs.strides[0]) )));
 
-    /* "sat_toolkit/formula.pyx":801
+    /* "sat_toolkit/formula.pyx":836
  *         for i in range(length):
  *             l = lhs[i]
  *             r = rhs[i]             # <<<<<<<<<<<<<<
  *             if l == 0 or r == 0:
  *                 raise ValueError('all indices must be nonzero')
  */
     __pyx_t_6 = __pyx_v_i;
     __pyx_v_r = (*((int const  *) ( /* dim=0 */ (__pyx_v_rhs.data + __pyx_t_6 * __pyx_v_rhs.strides[0]) )));
 
-    /* "sat_toolkit/formula.pyx":802
+    /* "sat_toolkit/formula.pyx":837
  *             l = lhs[i]
  *             r = rhs[i]
  *             if l == 0 or r == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  * 
  */
     __pyx_t_7 = (__pyx_v_l == 0);
@@ -35565,161 +36032,161 @@
       goto __pyx_L7_bool_binop_done;
     }
     __pyx_t_7 = (__pyx_v_r == 0);
     __pyx_t_1 = __pyx_t_7;
     __pyx_L7_bool_binop_done:;
     if (unlikely(__pyx_t_1)) {
 
-      /* "sat_toolkit/formula.pyx":803
+      /* "sat_toolkit/formula.pyx":838
  *             r = rhs[i]
  *             if l == 0 or r == 0:
  *                 raise ValueError('all indices must be nonzero')             # <<<<<<<<<<<<<<
  * 
  *             clauses[6 * i + 0] = -l
  */
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 803, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 838, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 803, __pyx_L1_error)
+      __PYX_ERR(0, 838, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":802
+      /* "sat_toolkit/formula.pyx":837
  *             l = lhs[i]
  *             r = rhs[i]
  *             if l == 0 or r == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":805
+    /* "sat_toolkit/formula.pyx":840
  *                 raise ValueError('all indices must be nonzero')
  * 
  *             clauses[6 * i + 0] = -l             # <<<<<<<<<<<<<<
  *             clauses[6 * i + 1] = r
  *             clauses[6 * i + 2] = 0
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 0)]) = (-__pyx_v_l);
 
-    /* "sat_toolkit/formula.pyx":806
+    /* "sat_toolkit/formula.pyx":841
  * 
  *             clauses[6 * i + 0] = -l
  *             clauses[6 * i + 1] = r             # <<<<<<<<<<<<<<
  *             clauses[6 * i + 2] = 0
  * 
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 1)]) = __pyx_v_r;
 
-    /* "sat_toolkit/formula.pyx":807
+    /* "sat_toolkit/formula.pyx":842
  *             clauses[6 * i + 0] = -l
  *             clauses[6 * i + 1] = r
  *             clauses[6 * i + 2] = 0             # <<<<<<<<<<<<<<
  * 
  *             clauses[6 * i + 3] = l
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 2)]) = 0;
 
-    /* "sat_toolkit/formula.pyx":809
+    /* "sat_toolkit/formula.pyx":844
  *             clauses[6 * i + 2] = 0
  * 
  *             clauses[6 * i + 3] = l             # <<<<<<<<<<<<<<
  *             clauses[6 * i + 4] = -r
  *             clauses[6 * i + 5] = 0
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 3)]) = __pyx_v_l;
 
-    /* "sat_toolkit/formula.pyx":810
+    /* "sat_toolkit/formula.pyx":845
  * 
  *             clauses[6 * i + 3] = l
  *             clauses[6 * i + 4] = -r             # <<<<<<<<<<<<<<
  *             clauses[6 * i + 5] = 0
  * 
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 4)]) = (-__pyx_v_r);
 
-    /* "sat_toolkit/formula.pyx":811
+    /* "sat_toolkit/formula.pyx":846
  *             clauses[6 * i + 3] = l
  *             clauses[6 * i + 4] = -r
  *             clauses[6 * i + 5] = 0             # <<<<<<<<<<<<<<
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  */
     (__pyx_v_clauses[((6 * __pyx_v_i) + 5)]) = 0;
   }
 
-  /* "sat_toolkit/formula.pyx":813
+  /* "sat_toolkit/formula.pyx":848
  *             clauses[6 * i + 5] = 0
  * 
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  */
-  __pyx_t_2 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 813, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 848, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_2);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":814
+  /* "sat_toolkit/formula.pyx":849
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res
  */
   __pyx_t_1 = (__pyx_v_clauses.size() > 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":815
+    /* "sat_toolkit/formula.pyx":850
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
     __pyx_t_8 = __pyx_v_clauses.data();
     if (!__pyx_t_8) {
       PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-      __PYX_ERR(0, 815, __pyx_L1_error)
+      __PYX_ERR(0, 850, __pyx_L1_error)
     }
-    __pyx_t_10 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 815, __pyx_L1_error)
+    __pyx_t_10 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 850, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_2 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 815, __pyx_L1_error)
+    __pyx_t_2 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_clauses.size())); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 850, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_9 = __pyx_array_new(__pyx_t_2, sizeof(int), PyBytes_AS_STRING(__pyx_t_10), (char *) "c", (char *) __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 815, __pyx_L1_error)
+    __pyx_t_9 = __pyx_array_new(__pyx_t_2, sizeof(int), PyBytes_AS_STRING(__pyx_t_10), (char *) "c", (char *) __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 850, __pyx_L1_error)
     __Pyx_GOTREF((PyObject *)__pyx_t_9);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_9), 0); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 815, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_9), 0); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 850, __pyx_L1_error)
     __Pyx_DECREF((PyObject *)__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_12 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_11); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 815, __pyx_L1_error)
+    __pyx_t_12 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_11); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 850, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_11, 1);
     __pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":814
+    /* "sat_toolkit/formula.pyx":849
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         if clauses.size() > 0:             # <<<<<<<<<<<<<<
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res
  */
   }
 
-  /* "sat_toolkit/formula.pyx":816
+  /* "sat_toolkit/formula.pyx":851
  *         if clauses.size() > 0:
  *             res._add_clauses(<int[:clauses.size()]> clauses.data())
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":788
+  /* "sat_toolkit/formula.pyx":823
  *         return CNF._create_all_equal(lhs, rhs)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_equal(const int[:] lhs not None, const int[:] rhs not None) -> CNF:
  *         cdef vector[int] clauses
  */
 
@@ -35734,15 +36201,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":818
+/* "sat_toolkit/formula.pyx":853
  *         return res
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:             # <<<<<<<<<<<<<<
  *         if rhs not in [0, 1]:
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  */
 
@@ -35787,15 +36254,15 @@
   __Pyx_RefNannySetupContext("_add_xor_clause", 1);
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_rhs = __pyx_optional_args->rhs;
     }
   }
 
-  /* "sat_toolkit/formula.pyx":819
+  /* "sat_toolkit/formula.pyx":854
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:
  *         if rhs not in [0, 1]:             # <<<<<<<<<<<<<<
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  * 
  */
   switch (__pyx_v_rhs) {
@@ -35806,235 +36273,235 @@
     default:
     __pyx_t_1 = 1;
     break;
   }
   __pyx_t_2 = __pyx_t_1;
   if (unlikely(__pyx_t_2)) {
 
-    /* "sat_toolkit/formula.pyx":820
+    /* "sat_toolkit/formula.pyx":855
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:
  *         if rhs not in [0, 1]:
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t num_inputs = xor_clause.shape[0]
  */
     {
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         /*try:*/ {
-          __pyx_t_3 = __Pyx_PyUnicode_From_int(__pyx_v_rhs, 0, ' ', 'd'); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 820, __pyx_L5_error)
+          __pyx_t_3 = __Pyx_PyUnicode_From_int(__pyx_v_rhs, 0, ' ', 'd'); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_right_hand_side_must_be_0_or_1_n, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L5_error)
+          __pyx_t_4 = __Pyx_PyUnicode_Concat(__pyx_kp_u_right_hand_side_must_be_0_or_1_n, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 855, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 820, __pyx_L5_error)
+          __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_Raise(__pyx_t_3, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __PYX_ERR(0, 820, __pyx_L5_error)
+          __PYX_ERR(0, 855, __pyx_L5_error)
         }
         /*finally:*/ {
           __pyx_L5_error: {
             #ifdef WITH_THREAD
             __Pyx_PyGILState_Release(__pyx_gilstate_save);
             #endif
             goto __pyx_L1_error;
           }
         }
     }
 
-    /* "sat_toolkit/formula.pyx":819
+    /* "sat_toolkit/formula.pyx":854
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:
  *         if rhs not in [0, 1]:             # <<<<<<<<<<<<<<
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":822
+  /* "sat_toolkit/formula.pyx":857
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  * 
  *         cdef size_t num_inputs = xor_clause.shape[0]             # <<<<<<<<<<<<<<
  *         cdef size_t num_clauses = 1 << (num_inputs - 1)
  *         cdef size_t mask, col
  */
   __pyx_v_num_inputs = (__pyx_v_xor_clause.shape[0]);
 
-  /* "sat_toolkit/formula.pyx":823
+  /* "sat_toolkit/formula.pyx":858
  * 
  *         cdef size_t num_inputs = xor_clause.shape[0]
  *         cdef size_t num_clauses = 1 << (num_inputs - 1)             # <<<<<<<<<<<<<<
  *         cdef size_t mask, col
  *         cdef int var_idx
  */
   __pyx_v_num_clauses = (1 << (__pyx_v_num_inputs - 1));
 
-  /* "sat_toolkit/formula.pyx":827
+  /* "sat_toolkit/formula.pyx":862
  *         cdef int var_idx
  * 
  *         cdef size_t buffer_elements = (num_clauses) * (num_inputs + 1)             # <<<<<<<<<<<<<<
  *         cdef int *buffer = <int *> malloc(buffer_elements * sizeof(int))
  *         cdef size_t buffer_offset = 0
  */
   __pyx_v_buffer_elements = (__pyx_v_num_clauses * (__pyx_v_num_inputs + 1));
 
-  /* "sat_toolkit/formula.pyx":828
+  /* "sat_toolkit/formula.pyx":863
  * 
  *         cdef size_t buffer_elements = (num_clauses) * (num_inputs + 1)
  *         cdef int *buffer = <int *> malloc(buffer_elements * sizeof(int))             # <<<<<<<<<<<<<<
  *         cdef size_t buffer_offset = 0
  * 
  */
   __pyx_v_buffer = ((int *)malloc((__pyx_v_buffer_elements * (sizeof(int)))));
 
-  /* "sat_toolkit/formula.pyx":829
+  /* "sat_toolkit/formula.pyx":864
  *         cdef size_t buffer_elements = (num_clauses) * (num_inputs + 1)
  *         cdef int *buffer = <int *> malloc(buffer_elements * sizeof(int))
  *         cdef size_t buffer_offset = 0             # <<<<<<<<<<<<<<
  * 
  *         for col in range(num_inputs):
  */
   __pyx_v_buffer_offset = 0;
 
-  /* "sat_toolkit/formula.pyx":831
+  /* "sat_toolkit/formula.pyx":866
  *         cdef size_t buffer_offset = 0
  * 
  *         for col in range(num_inputs):             # <<<<<<<<<<<<<<
  *             if xor_clause[col] == 0:
  *                 raise ValueError('all indices must be nonzero')
  */
   __pyx_t_5 = __pyx_v_num_inputs;
   __pyx_t_6 = __pyx_t_5;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
     __pyx_v_col = __pyx_t_7;
 
-    /* "sat_toolkit/formula.pyx":832
+    /* "sat_toolkit/formula.pyx":867
  * 
  *         for col in range(num_inputs):
  *             if xor_clause[col] == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  * 
  */
     __pyx_t_8 = __pyx_v_col;
     __pyx_t_2 = ((*((int const  *) ( /* dim=0 */ ((char *) (((int const  *) __pyx_v_xor_clause.data) + __pyx_t_8)) ))) == 0);
     if (unlikely(__pyx_t_2)) {
 
-      /* "sat_toolkit/formula.pyx":833
+      /* "sat_toolkit/formula.pyx":868
  *         for col in range(num_inputs):
  *             if xor_clause[col] == 0:
  *                 raise ValueError('all indices must be nonzero')             # <<<<<<<<<<<<<<
  * 
  *         try:
  */
       {
           #ifdef WITH_THREAD
           PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
           #endif
           /*try:*/ {
-            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 833, __pyx_L13_error)
+            __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L13_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_Raise(__pyx_t_3, 0, 0, 0);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            __PYX_ERR(0, 833, __pyx_L13_error)
+            __PYX_ERR(0, 868, __pyx_L13_error)
           }
           /*finally:*/ {
             __pyx_L13_error: {
               #ifdef WITH_THREAD
               __Pyx_PyGILState_Release(__pyx_gilstate_save);
               #endif
               goto __pyx_L1_error;
             }
           }
       }
 
-      /* "sat_toolkit/formula.pyx":832
+      /* "sat_toolkit/formula.pyx":867
  * 
  *         for col in range(num_inputs):
  *             if xor_clause[col] == 0:             # <<<<<<<<<<<<<<
  *                 raise ValueError('all indices must be nonzero')
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":835
+  /* "sat_toolkit/formula.pyx":870
  *                 raise ValueError('all indices must be nonzero')
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             for mask in range(1 << num_inputs):
  *                 if popcount(mask) % 2 == rhs:
  */
   /*try:*/ {
 
-    /* "sat_toolkit/formula.pyx":836
+    /* "sat_toolkit/formula.pyx":871
  * 
  *         try:
  *             for mask in range(1 << num_inputs):             # <<<<<<<<<<<<<<
  *                 if popcount(mask) % 2 == rhs:
  *                     continue
  */
     __pyx_t_5 = (1 << __pyx_v_num_inputs);
     __pyx_t_6 = __pyx_t_5;
     for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
       __pyx_v_mask = __pyx_t_7;
 
-      /* "sat_toolkit/formula.pyx":837
+      /* "sat_toolkit/formula.pyx":872
  *         try:
  *             for mask in range(1 << num_inputs):
  *                 if popcount(mask) % 2 == rhs:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
       __pyx_t_2 = ((popcount(__pyx_v_mask) % 2) == __pyx_v_rhs);
       if (__pyx_t_2) {
 
-        /* "sat_toolkit/formula.pyx":838
+        /* "sat_toolkit/formula.pyx":873
  *             for mask in range(1 << num_inputs):
  *                 if popcount(mask) % 2 == rhs:
  *                     continue             # <<<<<<<<<<<<<<
  * 
  *                 for col in range(num_inputs):
  */
         goto __pyx_L18_continue;
 
-        /* "sat_toolkit/formula.pyx":837
+        /* "sat_toolkit/formula.pyx":872
  *         try:
  *             for mask in range(1 << num_inputs):
  *                 if popcount(mask) % 2 == rhs:             # <<<<<<<<<<<<<<
  *                     continue
  * 
  */
       }
 
-      /* "sat_toolkit/formula.pyx":840
+      /* "sat_toolkit/formula.pyx":875
  *                     continue
  * 
  *                 for col in range(num_inputs):             # <<<<<<<<<<<<<<
  *                     var_idx = xor_clause[col]
  * 
  */
       __pyx_t_8 = __pyx_v_num_inputs;
       __pyx_t_9 = __pyx_t_8;
       for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
         __pyx_v_col = __pyx_t_10;
 
-        /* "sat_toolkit/formula.pyx":841
+        /* "sat_toolkit/formula.pyx":876
  * 
  *                 for col in range(num_inputs):
  *                     var_idx = xor_clause[col]             # <<<<<<<<<<<<<<
  * 
  *                     # FIXME row offset
  */
         __pyx_t_11 = __pyx_v_col;
         __pyx_v_var_idx = (*((int const  *) ( /* dim=0 */ ((char *) (((int const  *) __pyx_v_xor_clause.data) + __pyx_t_11)) )));
 
-        /* "sat_toolkit/formula.pyx":844
+        /* "sat_toolkit/formula.pyx":879
  * 
  *                     # FIXME row offset
  *                     buffer[buffer_offset + col] = -var_idx if (mask >> col) & 1 else var_idx             # <<<<<<<<<<<<<<
  * 
  *                 buffer[buffer_offset + num_inputs] = 0
  */
         __pyx_t_2 = (((__pyx_v_mask >> __pyx_v_col) & 1) != 0);
@@ -36042,35 +36509,35 @@
           __pyx_t_12 = (-__pyx_v_var_idx);
         } else {
           __pyx_t_12 = __pyx_v_var_idx;
         }
         (__pyx_v_buffer[(__pyx_v_buffer_offset + __pyx_v_col)]) = __pyx_t_12;
       }
 
-      /* "sat_toolkit/formula.pyx":846
+      /* "sat_toolkit/formula.pyx":881
  *                     buffer[buffer_offset + col] = -var_idx if (mask >> col) & 1 else var_idx
  * 
  *                 buffer[buffer_offset + num_inputs] = 0             # <<<<<<<<<<<<<<
  * 
  *                 buffer_offset += num_inputs + 1
  */
       (__pyx_v_buffer[(__pyx_v_buffer_offset + __pyx_v_num_inputs)]) = 0;
 
-      /* "sat_toolkit/formula.pyx":848
+      /* "sat_toolkit/formula.pyx":883
  *                 buffer[buffer_offset + num_inputs] = 0
  * 
  *                 buffer_offset += num_inputs + 1             # <<<<<<<<<<<<<<
  * 
  *             assert buffer_offset == buffer_elements
  */
       __pyx_v_buffer_offset = (__pyx_v_buffer_offset + (__pyx_v_num_inputs + 1));
       __pyx_L18_continue:;
     }
 
-    /* "sat_toolkit/formula.pyx":850
+    /* "sat_toolkit/formula.pyx":885
  *                 buffer_offset += num_inputs + 1
  * 
  *             assert buffer_offset == buffer_elements             # <<<<<<<<<<<<<<
  *             self._add_clauses_raw(buffer, buffer_elements)
  *         finally:
  */
     #ifndef CYTHON_WITHOUT_ASSERTIONS
@@ -36079,42 +36546,42 @@
       if (unlikely(!__pyx_t_2)) {
         {
             #ifdef WITH_THREAD
             PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
             #endif
             /*try:*/ {
               __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-              __PYX_ERR(0, 850, __pyx_L24_error)
+              __PYX_ERR(0, 885, __pyx_L24_error)
             }
             /*finally:*/ {
               __pyx_L24_error: {
                 #ifdef WITH_THREAD
                 __Pyx_PyGILState_Release(__pyx_gilstate_save);
                 #endif
                 goto __pyx_L16_error;
               }
             }
         }
       }
     }
     #else
-    if ((1)); else __PYX_ERR(0, 850, __pyx_L16_error)
+    if ((1)); else __PYX_ERR(0, 885, __pyx_L16_error)
     #endif
 
-    /* "sat_toolkit/formula.pyx":851
+    /* "sat_toolkit/formula.pyx":886
  * 
  *             assert buffer_offset == buffer_elements
  *             self._add_clauses_raw(buffer, buffer_elements)             # <<<<<<<<<<<<<<
  *         finally:
  *             free(&buffer[0])
  */
-    __pyx_t_12 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses_raw(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_buffer, __pyx_v_buffer_elements); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 851, __pyx_L16_error)
+    __pyx_t_12 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses_raw(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_buffer, __pyx_v_buffer_elements); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 886, __pyx_L16_error)
   }
 
-  /* "sat_toolkit/formula.pyx":853
+  /* "sat_toolkit/formula.pyx":888
  *             self._add_clauses_raw(buffer, buffer_elements)
  *         finally:
  *             free(&buffer[0])             # <<<<<<<<<<<<<<
  * 
  *         return 0
  */
   /*finally:*/ {
@@ -36170,25 +36637,25 @@
       __pyx_t_15 = 0; __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0;
       __pyx_lineno = __pyx_t_12; __pyx_clineno = __pyx_t_13; __pyx_filename = __pyx_t_14;
       goto __pyx_L1_error;
     }
     __pyx_L17:;
   }
 
-  /* "sat_toolkit/formula.pyx":855
+  /* "sat_toolkit/formula.pyx":890
  *             free(&buffer[0])
  * 
  *         return 0             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":818
+  /* "sat_toolkit/formula.pyx":853
  *         return res
  * 
  *     cdef int _add_xor_clause(self, const int[::1] xor_clause, int rhs=0) except -1 nogil:             # <<<<<<<<<<<<<<
  *         if rhs not in [0, 1]:
  *             raise ValueError(f"right hand side must be 0 or 1, not {rhs}")
  */
 
@@ -36205,15 +36672,15 @@
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   __pyx_L0:;
   __Pyx_RefNannyFinishContextNogil()
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":858
+/* "sat_toolkit/formula.pyx":893
  * 
  *     @staticmethod
  *     cdef CNF _create_xor(const int[:, ::1] packed_args):             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  * 
  */
 
@@ -36242,70 +36709,70 @@
   __Pyx_memviewslice __pyx_t_13 = { 0, 0, { 0 }, { 0 }, { 0 } };
   struct __pyx_opt_args_11sat_toolkit_7formula_3CNF__add_xor_clause __pyx_t_14;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_create_xor", 1);
 
-  /* "sat_toolkit/formula.pyx":859
+  /* "sat_toolkit/formula.pyx":894
  *     @staticmethod
  *     cdef CNF _create_xor(const int[:, ::1] packed_args):
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t num_inputs, num_xors
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 859, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 894, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":866
+  /* "sat_toolkit/formula.pyx":901
  *         cdef int rhs, var_idx
  * 
  *         num_xors = packed_args.shape[0]             # <<<<<<<<<<<<<<
  *         num_inputs = packed_args.shape[1] - 1
  * 
  */
   __pyx_v_num_xors = (__pyx_v_packed_args.shape[0]);
 
-  /* "sat_toolkit/formula.pyx":867
+  /* "sat_toolkit/formula.pyx":902
  * 
  *         num_xors = packed_args.shape[0]
  *         num_inputs = packed_args.shape[1] - 1             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t needed_space = num_inputs * ((1 << (num_inputs - 1)) + 1)
  */
   __pyx_v_num_inputs = ((__pyx_v_packed_args.shape[1]) - 1);
 
-  /* "sat_toolkit/formula.pyx":869
+  /* "sat_toolkit/formula.pyx":904
  *         num_inputs = packed_args.shape[1] - 1
  * 
  *         cdef size_t needed_space = num_inputs * ((1 << (num_inputs - 1)) + 1)             # <<<<<<<<<<<<<<
  *         cdef int[::1] tmp_clause = np.empty(num_inputs + 1, np.int32)
  *         tmp_clause[num_inputs] = 0
  */
   __pyx_v_needed_space = (__pyx_v_num_inputs * ((1 << (__pyx_v_num_inputs - 1)) + 1));
 
-  /* "sat_toolkit/formula.pyx":870
+  /* "sat_toolkit/formula.pyx":905
  * 
  *         cdef size_t needed_space = num_inputs * ((1 << (num_inputs - 1)) + 1)
  *         cdef int[::1] tmp_clause = np.empty(num_inputs + 1, np.int32)             # <<<<<<<<<<<<<<
  *         tmp_clause[num_inputs] = 0
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 870, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 870, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_FromSize_t((__pyx_v_num_inputs + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 870, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t((__pyx_v_num_inputs + 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 870, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 870, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -36320,58 +36787,58 @@
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_2, __pyx_t_5};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 870, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 905, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 870, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 905, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_tmp_clause = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":871
+  /* "sat_toolkit/formula.pyx":906
  *         cdef size_t needed_space = num_inputs * ((1 << (num_inputs - 1)) + 1)
  *         cdef int[::1] tmp_clause = np.empty(num_inputs + 1, np.int32)
  *         tmp_clause[num_inputs] = 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_8 = __pyx_v_num_inputs;
   *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_tmp_clause.data) + __pyx_t_8)) )) = 0;
 
-  /* "sat_toolkit/formula.pyx":874
+  /* "sat_toolkit/formula.pyx":909
  * 
  * 
  *         for row in range(num_xors):             # <<<<<<<<<<<<<<
  *             rhs = packed_args[row, num_inputs]
  *             res._add_xor_clause(packed_args[row, :num_inputs], rhs)
  */
   __pyx_t_8 = __pyx_v_num_xors;
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_row = __pyx_t_10;
 
-    /* "sat_toolkit/formula.pyx":875
+    /* "sat_toolkit/formula.pyx":910
  * 
  *         for row in range(num_xors):
  *             rhs = packed_args[row, num_inputs]             # <<<<<<<<<<<<<<
  *             res._add_xor_clause(packed_args[row, :num_inputs], rhs)
  * 
  */
     __pyx_t_11 = __pyx_v_row;
     __pyx_t_12 = __pyx_v_num_inputs;
     __pyx_v_rhs = (*((int const  *) ( /* dim=1 */ ((char *) (((int const  *) ( /* dim=0 */ (__pyx_v_packed_args.data + __pyx_t_11 * __pyx_v_packed_args.strides[0]) )) + __pyx_t_12)) )));
 
-    /* "sat_toolkit/formula.pyx":876
+    /* "sat_toolkit/formula.pyx":911
  *         for row in range(num_xors):
  *             rhs = packed_args[row, num_inputs]
  *             res._add_xor_clause(packed_args[row, :num_inputs], rhs)             # <<<<<<<<<<<<<<
  * 
  *         return res
  */
     __pyx_t_13.data = __pyx_v_packed_args.data;
@@ -36394,37 +36861,37 @@
     __pyx_v_num_inputs,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 876, __pyx_L1_error)
+    __PYX_ERR(0, 911, __pyx_L1_error)
 }
 
 __pyx_t_14.__pyx_n = 1;
     __pyx_t_14.rhs = __pyx_v_rhs;
-    __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->_add_xor_clause(__pyx_v_res, __pyx_t_13, &__pyx_t_14); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 876, __pyx_L1_error)
+    __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->_add_xor_clause(__pyx_v_res, __pyx_t_13, &__pyx_t_14); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 911, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_13, 1);
     __pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;
   }
 
-  /* "sat_toolkit/formula.pyx":878
+  /* "sat_toolkit/formula.pyx":913
  *             res._add_xor_clause(packed_args[row, :num_inputs], rhs)
  * 
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":858
+  /* "sat_toolkit/formula.pyx":893
  * 
  *     @staticmethod
  *     cdef CNF _create_xor(const int[:, ::1] packed_args):             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  * 
  */
 
@@ -36443,15 +36910,15 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_tmp_clause, 1);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":880
+/* "sat_toolkit/formula.pyx":915
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
 
@@ -36478,15 +36945,15 @@
   #endif
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
   __Pyx_INCREF(__pyx_args);
   __pyx_v_args = __pyx_args;
   {
     PyObject **__pyx_pyargnames[] = {&__pyx_n_s_rhs,0};
 
-    /* "sat_toolkit/formula.pyx":881
+    /* "sat_toolkit/formula.pyx":916
  * 
  *     @staticmethod
  *     def create_xor(*args, rhs=None) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         creates a CNF specifying the xor of the arguments is equal to the right
  */
     values[0] = __Pyx_Arg_NewRef_VARARGS(((PyObject *)Py_None));
@@ -36497,28 +36964,28 @@
         case  0: break;
       }
       kw_args = __Pyx_NumKwargs_VARARGS(__pyx_kwds);
       if (kw_args == 1) {
         const Py_ssize_t index = 0;
         PyObject* value = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
         if (value) { values[index] = __Pyx_Arg_NewRef_VARARGS(value); kw_args--; }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 880, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 915, __pyx_L3_error)
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "create_xor") < 0)) __PYX_ERR(0, 880, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "create_xor") < 0)) __PYX_ERR(0, 915, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs < 0)) {
       goto __pyx_L5_argtuple_error;
     } else {
     }
     __pyx_v_rhs = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("create_xor", 0, 0, 0, __pyx_nargs); __PYX_ERR(0, 880, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("create_xor", 0, 0, 0, __pyx_nargs); __PYX_ERR(0, 915, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_VARARGS(values[__pyx_temp]);
@@ -36527,15 +36994,15 @@
   __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
   __Pyx_AddTraceback("sat_toolkit.formula.CNF.create_xor", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_12create_xor(__pyx_v_rhs, __pyx_v_args);
 
-  /* "sat_toolkit/formula.pyx":880
+  /* "sat_toolkit/formula.pyx":915
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
 
@@ -36570,105 +37037,105 @@
   size_t __pyx_t_9;
   __Pyx_memviewslice __pyx_t_10 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("create_xor", 1);
 
-  /* "sat_toolkit/formula.pyx":890
+  /* "sat_toolkit/formula.pyx":925
  *         Each argument is a 1-D array. The xors are computed elementwise.
  *         """
  *         cdef size_t num_args = len(args)             # <<<<<<<<<<<<<<
  *         cdef size_t num_xors = -1
  *         cdef size_t i
  */
-  __pyx_t_1 = __Pyx_PyTuple_GET_SIZE(__pyx_v_args); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 890, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyTuple_GET_SIZE(__pyx_v_args); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 925, __pyx_L1_error)
   __pyx_v_num_args = __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":891
+  /* "sat_toolkit/formula.pyx":926
  *         """
  *         cdef size_t num_args = len(args)
  *         cdef size_t num_xors = -1             # <<<<<<<<<<<<<<
  *         cdef size_t i
  * 
  */
   __pyx_v_num_xors = -1L;
 
-  /* "sat_toolkit/formula.pyx":895
+  /* "sat_toolkit/formula.pyx":930
  * 
  * 
  *         if num_args < 1:             # <<<<<<<<<<<<<<
  *             raise ValueError('must provide at least one argument')
  * 
  */
   __pyx_t_2 = (__pyx_v_num_args < 1);
   if (unlikely(__pyx_t_2)) {
 
-    /* "sat_toolkit/formula.pyx":896
+    /* "sat_toolkit/formula.pyx":931
  * 
  *         if num_args < 1:
  *             raise ValueError('must provide at least one argument')             # <<<<<<<<<<<<<<
  * 
  *         num_xors = len(args[0])
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 896, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__32, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 931, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 896, __pyx_L1_error)
+    __PYX_ERR(0, 931, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":895
+    /* "sat_toolkit/formula.pyx":930
  * 
  * 
  *         if num_args < 1:             # <<<<<<<<<<<<<<
  *             raise ValueError('must provide at least one argument')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":898
+  /* "sat_toolkit/formula.pyx":933
  *             raise ValueError('must provide at least one argument')
  * 
  *         num_xors = len(args[0])             # <<<<<<<<<<<<<<
  * 
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  */
   __pyx_t_3 = PyTuple_GET_ITEM(__pyx_v_args, 0);
   __Pyx_INCREF(__pyx_t_3);
-  __pyx_t_1 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 898, __pyx_L1_error)
+  __pyx_t_1 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 933, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_num_xors = __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":900
+  /* "sat_toolkit/formula.pyx":935
  *         num_xors = len(args[0])
  * 
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)             # <<<<<<<<<<<<<<
  * 
  *         for i, arg in enumerate(args):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_FromSize_t(__pyx_v_num_xors); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_FromSize_t(__pyx_v_num_xors); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_PyInt_FromSize_t((__pyx_v_num_args + 1)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_FromSize_t((__pyx_v_num_args + 1)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4)) __PYX_ERR(0, 935, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_6);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_6)) __PYX_ERR(0, 900, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_6)) __PYX_ERR(0, 935, __pyx_L1_error);
   __pyx_t_4 = 0;
   __pyx_t_6 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 935, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   __pyx_t_8 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
@@ -36683,137 +37150,137 @@
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_6, __pyx_t_7, __pyx_t_4};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 900, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __pyx_v_packed_args = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "sat_toolkit/formula.pyx":902
+  /* "sat_toolkit/formula.pyx":937
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  * 
  *         for i, arg in enumerate(args):             # <<<<<<<<<<<<<<
  *             packed_args[:, i] = arg
  * 
  */
   __pyx_t_9 = 0;
   __pyx_t_3 = __pyx_v_args; __Pyx_INCREF(__pyx_t_3);
   __pyx_t_1 = 0;
   for (;;) {
     {
       Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_3);
       #if !CYTHON_ASSUME_SAFE_MACROS
-      if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 902, __pyx_L1_error)
+      if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 937, __pyx_L1_error)
       #endif
       if (__pyx_t_1 >= __pyx_temp) break;
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_5); __pyx_t_1++; if (unlikely((0 < 0))) __PYX_ERR(0, 902, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_1); __Pyx_INCREF(__pyx_t_5); __pyx_t_1++; if (unlikely((0 < 0))) __PYX_ERR(0, 937, __pyx_L1_error)
     #else
-    __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_3, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 902, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_3, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 937, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     #endif
     __Pyx_XDECREF_SET(__pyx_v_arg, __pyx_t_5);
     __pyx_t_5 = 0;
     __pyx_v_i = __pyx_t_9;
     __pyx_t_9 = (__pyx_t_9 + 1);
 
-    /* "sat_toolkit/formula.pyx":903
+    /* "sat_toolkit/formula.pyx":938
  * 
  *         for i, arg in enumerate(args):
  *             packed_args[:, i] = arg             # <<<<<<<<<<<<<<
  * 
  *         if rhs is not None:
  */
-    __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 903, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 938, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 903, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 938, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_slice__5)) __PYX_ERR(0, 903, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_slice__5)) __PYX_ERR(0, 938, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_5);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5)) __PYX_ERR(0, 903, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5)) __PYX_ERR(0, 938, __pyx_L1_error);
     __pyx_t_5 = 0;
-    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_4, __pyx_v_arg) < 0))) __PYX_ERR(0, 903, __pyx_L1_error)
+    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_4, __pyx_v_arg) < 0))) __PYX_ERR(0, 938, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":902
+    /* "sat_toolkit/formula.pyx":937
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  * 
  *         for i, arg in enumerate(args):             # <<<<<<<<<<<<<<
  *             packed_args[:, i] = arg
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "sat_toolkit/formula.pyx":905
+  /* "sat_toolkit/formula.pyx":940
  *             packed_args[:, i] = arg
  * 
  *         if rhs is not None:             # <<<<<<<<<<<<<<
  *             packed_args[:, num_args] = rhs
  * 
  */
   __pyx_t_2 = (__pyx_v_rhs != Py_None);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":906
+    /* "sat_toolkit/formula.pyx":941
  * 
  *         if rhs is not None:
  *             packed_args[:, num_args] = rhs             # <<<<<<<<<<<<<<
  * 
  *         return CNF._create_xor(packed_args)
  */
-    __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_num_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 906, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_num_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 941, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 906, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 941, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_slice__5)) __PYX_ERR(0, 906, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_slice__5)) __PYX_ERR(0, 941, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 906, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 941, __pyx_L1_error);
     __pyx_t_3 = 0;
-    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_4, __pyx_v_rhs) < 0))) __PYX_ERR(0, 906, __pyx_L1_error)
+    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_4, __pyx_v_rhs) < 0))) __PYX_ERR(0, 941, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":905
+    /* "sat_toolkit/formula.pyx":940
  *             packed_args[:, i] = arg
  * 
  *         if rhs is not None:             # <<<<<<<<<<<<<<
  *             packed_args[:, num_args] = rhs
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":908
+  /* "sat_toolkit/formula.pyx":943
  *             packed_args[:, num_args] = rhs
  * 
  *         return CNF._create_xor(packed_args)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_int__const__(__pyx_v_packed_args, 0); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 908, __pyx_L1_error)
-  __pyx_t_4 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_3CNF__create_xor(__pyx_t_10)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_int__const__(__pyx_v_packed_args, 0); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __pyx_t_4 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_3CNF__create_xor(__pyx_t_10)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 943, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_10, 1);
   __pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_4);
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":880
+  /* "sat_toolkit/formula.pyx":915
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
 
@@ -36831,15 +37298,15 @@
   __Pyx_XDECREF(__pyx_v_packed_args);
   __Pyx_XDECREF(__pyx_v_arg);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":911
+/* "sat_toolkit/formula.pyx":946
  * 
  * 
  *     def logical_or(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var or self). I.e., the new CNF is
  */
 
@@ -36893,31 +37360,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_var)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 911, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 946, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "logical_or") < 0)) __PYX_ERR(0, 911, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "logical_or") < 0)) __PYX_ERR(0, 946, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
-    __pyx_v_var = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_var == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 911, __pyx_L3_error)
+    __pyx_v_var = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_var == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 946, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("logical_or", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 911, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("logical_or", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 946, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -36958,189 +37425,189 @@
   __Pyx_memviewslice __pyx_t_9 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("logical_or", 1);
 
-  /* "sat_toolkit/formula.pyx":929
+  /* "sat_toolkit/formula.pyx":964
  *         -1 -2 -5 0
  *         """
  *         if var == 0:             # <<<<<<<<<<<<<<
  *             raise ValueError("var must not be zero")
  * 
  */
   __pyx_t_1 = (__pyx_v_var == 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":930
+    /* "sat_toolkit/formula.pyx":965
  *         """
  *         if var == 0:
  *             raise ValueError("var must not be zero")             # <<<<<<<<<<<<<<
  * 
  *         cdef vector[int] new_clauses
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 930, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__33, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 965, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 930, __pyx_L1_error)
+    __PYX_ERR(0, 965, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":929
+    /* "sat_toolkit/formula.pyx":964
  *         -1 -2 -5 0
  *         """
  *         if var == 0:             # <<<<<<<<<<<<<<
  *             raise ValueError("var must not be zero")
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":933
+  /* "sat_toolkit/formula.pyx":968
  * 
  *         cdef vector[int] new_clauses
  *         cdef ssize_t src = 0, dst = 0             # <<<<<<<<<<<<<<
  *         new_clauses.resize(self._clauses.size() + self._start_indices.size())
  * 
  */
   __pyx_v_src = 0;
   __pyx_v_dst = 0;
 
-  /* "sat_toolkit/formula.pyx":934
+  /* "sat_toolkit/formula.pyx":969
  *         cdef vector[int] new_clauses
  *         cdef ssize_t src = 0, dst = 0
  *         new_clauses.resize(self._clauses.size() + self._start_indices.size())             # <<<<<<<<<<<<<<
  * 
  *         for src in range(<ssize_t> self._clauses.size()):
  */
   try {
     __pyx_v_new_clauses.resize((__pyx_v_self->__pyx_base._clauses.size() + __pyx_v_self->__pyx_base._start_indices.size()));
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 934, __pyx_L1_error)
+    __PYX_ERR(0, 969, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":936
+  /* "sat_toolkit/formula.pyx":971
  *         new_clauses.resize(self._clauses.size() + self._start_indices.size())
  * 
  *         for src in range(<ssize_t> self._clauses.size()):             # <<<<<<<<<<<<<<
  *             if self._clauses[src] == 0:
  *                 new_clauses[dst] = var
  */
   __pyx_t_3 = ((Py_ssize_t)__pyx_v_self->__pyx_base._clauses.size());
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_src = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":937
+    /* "sat_toolkit/formula.pyx":972
  * 
  *         for src in range(<ssize_t> self._clauses.size()):
  *             if self._clauses[src] == 0:             # <<<<<<<<<<<<<<
  *                 new_clauses[dst] = var
  *                 dst += 1
  */
     __pyx_t_1 = ((__pyx_v_self->__pyx_base._clauses[__pyx_v_src]) == 0);
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":938
+      /* "sat_toolkit/formula.pyx":973
  *         for src in range(<ssize_t> self._clauses.size()):
  *             if self._clauses[src] == 0:
  *                 new_clauses[dst] = var             # <<<<<<<<<<<<<<
  *                 dst += 1
  *             new_clauses[dst] = self._clauses[src]
  */
       (__pyx_v_new_clauses[__pyx_v_dst]) = __pyx_v_var;
 
-      /* "sat_toolkit/formula.pyx":939
+      /* "sat_toolkit/formula.pyx":974
  *             if self._clauses[src] == 0:
  *                 new_clauses[dst] = var
  *                 dst += 1             # <<<<<<<<<<<<<<
  *             new_clauses[dst] = self._clauses[src]
  *             dst += 1
  */
       __pyx_v_dst = (__pyx_v_dst + 1);
 
-      /* "sat_toolkit/formula.pyx":937
+      /* "sat_toolkit/formula.pyx":972
  * 
  *         for src in range(<ssize_t> self._clauses.size()):
  *             if self._clauses[src] == 0:             # <<<<<<<<<<<<<<
  *                 new_clauses[dst] = var
  *                 dst += 1
  */
     }
 
-    /* "sat_toolkit/formula.pyx":940
+    /* "sat_toolkit/formula.pyx":975
  *                 new_clauses[dst] = var
  *                 dst += 1
  *             new_clauses[dst] = self._clauses[src]             # <<<<<<<<<<<<<<
  *             dst += 1
  * 
  */
     (__pyx_v_new_clauses[__pyx_v_dst]) = (__pyx_v_self->__pyx_base._clauses[__pyx_v_src]);
 
-    /* "sat_toolkit/formula.pyx":941
+    /* "sat_toolkit/formula.pyx":976
  *                 dst += 1
  *             new_clauses[dst] = self._clauses[src]
  *             dst += 1             # <<<<<<<<<<<<<<
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  */
     __pyx_v_dst = (__pyx_v_dst + 1);
   }
 
-  /* "sat_toolkit/formula.pyx":943
+  /* "sat_toolkit/formula.pyx":978
  *             dst += 1
  * 
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())
  *         return res
  */
-  __pyx_t_2 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 978, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_2);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":944
+  /* "sat_toolkit/formula.pyx":979
  * 
  *         cdef CNF res = CNF.__new__(CNF)
  *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
   __pyx_t_6 = __pyx_v_new_clauses.data();
   if (!__pyx_t_6) {
     PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-    __PYX_ERR(0, 944, __pyx_L1_error)
+    __PYX_ERR(0, 979, __pyx_L1_error)
   }
-  __pyx_t_8 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_8 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 979, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_2 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_new_clauses.size())); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_new_clauses.size())); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 979, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __pyx_array_new(__pyx_t_2, sizeof(int), PyBytes_AS_STRING(__pyx_t_8), (char *) "c", (char *) __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_7 = __pyx_array_new(__pyx_t_2, sizeof(int), PyBytes_AS_STRING(__pyx_t_8), (char *) "c", (char *) __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 979, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_7), 0); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_7), 0); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 979, __pyx_L1_error)
   __Pyx_DECREF((PyObject *)__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_10 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_9); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_10 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_9); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 979, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_9, 1);
   __pyx_t_9.memview = NULL; __pyx_t_9.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":945
+  /* "sat_toolkit/formula.pyx":980
  *         cdef CNF res = CNF.__new__(CNF)
  *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     def implied_by(self, int var) -> CNF:
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":911
+  /* "sat_toolkit/formula.pyx":946
  * 
  * 
  *     def logical_or(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var or self). I.e., the new CNF is
  */
 
@@ -37155,15 +37622,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":947
+/* "sat_toolkit/formula.pyx":982
  *         return res
  * 
  *     def implied_by(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var -> self). I.e., the new CNF is
  */
 
@@ -37217,31 +37684,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_var)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 982, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "implied_by") < 0)) __PYX_ERR(0, 947, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "implied_by") < 0)) __PYX_ERR(0, 982, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
-    __pyx_v_var = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_var == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L3_error)
+    __pyx_v_var = __Pyx_PyInt_As_int(values[0]); if (unlikely((__pyx_v_var == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 982, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("implied_by", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 947, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("implied_by", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 982, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -37273,25 +37740,25 @@
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("implied_by", 1);
 
-  /* "sat_toolkit/formula.pyx":952
+  /* "sat_toolkit/formula.pyx":987
  *         build by appending ~var to each clause
  *         """
  *         return self.logical_or(-var)             # <<<<<<<<<<<<<<
  * 
  *     cdef vector[int] _get_units(CNF self):
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_logical_or); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 952, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_logical_or); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 987, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyInt_From_int((-__pyx_v_var)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 952, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int((-__pyx_v_var)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 987, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
@@ -37304,24 +37771,24 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 952, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 987, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 952, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 987, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":947
+  /* "sat_toolkit/formula.pyx":982
  *         return res
  * 
  *     def implied_by(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var -> self). I.e., the new CNF is
  */
 
@@ -37335,15 +37802,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":954
+/* "sat_toolkit/formula.pyx":989
  *         return self.logical_or(-var)
  * 
  *     cdef vector[int] _get_units(CNF self):             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
 
@@ -37359,118 +37826,118 @@
   Py_ssize_t __pyx_t_3;
   size_t __pyx_t_4;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
 
-  /* "sat_toolkit/formula.pyx":961
+  /* "sat_toolkit/formula.pyx":996
  *         cdef vector[int] units
  *         cdef ssize_t idx, begin, end
  *         cdef size_t numclauses = self._start_indices.size()             # <<<<<<<<<<<<<<
  * 
  *         for idx in range(numclauses):
  */
   __pyx_v_numclauses = __pyx_v_self->__pyx_base._start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":963
+  /* "sat_toolkit/formula.pyx":998
  *         cdef size_t numclauses = self._start_indices.size()
  * 
  *         for idx in range(numclauses):             # <<<<<<<<<<<<<<
  *             begin = self._start_indices[idx]
  *             end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  */
   __pyx_t_1 = __pyx_v_numclauses;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_idx = __pyx_t_3;
 
-    /* "sat_toolkit/formula.pyx":964
+    /* "sat_toolkit/formula.pyx":999
  * 
  *         for idx in range(numclauses):
  *             begin = self._start_indices[idx]             # <<<<<<<<<<<<<<
  *             end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  */
     __pyx_v_begin = (__pyx_v_self->__pyx_base._start_indices[__pyx_v_idx]);
 
-    /* "sat_toolkit/formula.pyx":965
+    /* "sat_toolkit/formula.pyx":1000
  *         for idx in range(numclauses):
  *             begin = self._start_indices[idx]
  *             end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()             # <<<<<<<<<<<<<<
  * 
  *             if end == begin + 2:
  */
     __pyx_t_5 = ((((size_t)__pyx_v_idx) + 1) < __pyx_v_numclauses);
     if (__pyx_t_5) {
       __pyx_t_4 = (__pyx_v_self->__pyx_base._start_indices[(__pyx_v_idx + 1)]);
     } else {
       __pyx_t_4 = __pyx_v_self->__pyx_base._clauses.size();
     }
     __pyx_v_end = __pyx_t_4;
 
-    /* "sat_toolkit/formula.pyx":967
+    /* "sat_toolkit/formula.pyx":1002
  *             end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  *             if end == begin + 2:             # <<<<<<<<<<<<<<
  *                 units.push_back(self._clauses[begin])
  * 
  */
     __pyx_t_5 = (__pyx_v_end == (__pyx_v_begin + 2));
     if (__pyx_t_5) {
 
-      /* "sat_toolkit/formula.pyx":968
+      /* "sat_toolkit/formula.pyx":1003
  * 
  *             if end == begin + 2:
  *                 units.push_back(self._clauses[begin])             # <<<<<<<<<<<<<<
  * 
  *         units.shrink_to_fit()
  */
       try {
         __pyx_v_units.push_back((__pyx_v_self->__pyx_base._clauses[__pyx_v_begin]));
       } catch(...) {
         __Pyx_CppExn2PyErr();
-        __PYX_ERR(0, 968, __pyx_L1_error)
+        __PYX_ERR(0, 1003, __pyx_L1_error)
       }
 
-      /* "sat_toolkit/formula.pyx":967
+      /* "sat_toolkit/formula.pyx":1002
  *             end = self._start_indices[idx + 1] if <size_t> idx + 1 < numclauses else self._clauses.size()
  * 
  *             if end == begin + 2:             # <<<<<<<<<<<<<<
  *                 units.push_back(self._clauses[begin])
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":970
+  /* "sat_toolkit/formula.pyx":1005
  *                 units.push_back(self._clauses[begin])
  * 
  *         units.shrink_to_fit()             # <<<<<<<<<<<<<<
  * 
  *         return units
  */
   try {
     __pyx_v_units.shrink_to_fit();
   } catch(...) {
     __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 970, __pyx_L1_error)
+    __PYX_ERR(0, 1005, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":972
+  /* "sat_toolkit/formula.pyx":1007
  *         units.shrink_to_fit()
  * 
  *         return units             # <<<<<<<<<<<<<<
  * 
  *     def get_units(self) -> np.ndarray:
  */
   __pyx_r = __pyx_v_units;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":954
+  /* "sat_toolkit/formula.pyx":989
  *         return self.logical_or(-var)
  * 
  *     cdef vector[int] _get_units(CNF self):             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
 
@@ -37478,15 +37945,15 @@
   __pyx_L1_error:;
   __Pyx_AddTraceback("sat_toolkit.formula.CNF._get_units", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_pretend_to_initialize(&__pyx_r);
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":974
+/* "sat_toolkit/formula.pyx":1009
  *         return units
  * 
  *     def get_units(self) -> np.ndarray:             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
 
@@ -37551,108 +38018,108 @@
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_units", 1);
 
-  /* "sat_toolkit/formula.pyx":987
+  /* "sat_toolkit/formula.pyx":1022
  *         cdef ssize_t idx
  * 
  *         vec_result = self._get_units()             # <<<<<<<<<<<<<<
  *         result = np.empty(vec_result.size(), dtype=np.int32)
  *         result_view = result
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_get_units(__pyx_v_self); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 987, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_get_units(__pyx_v_self); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1022, __pyx_L1_error)
   __pyx_v_vec_result = __PYX_STD_MOVE_IF_SUPPORTED(__pyx_t_1);
 
-  /* "sat_toolkit/formula.pyx":988
+  /* "sat_toolkit/formula.pyx":1023
  * 
  *         vec_result = self._get_units()
  *         result = np.empty(vec_result.size(), dtype=np.int32)             # <<<<<<<<<<<<<<
  *         result_view = result
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 988, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_vec_result.size()); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_vec_result.size()); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 988, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 1023, __pyx_L1_error);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 988, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 988, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 988, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 988, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_result = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "sat_toolkit/formula.pyx":989
+  /* "sat_toolkit/formula.pyx":1024
  *         vec_result = self._get_units()
  *         result = np.empty(vec_result.size(), dtype=np.int32)
  *         result_view = result             # <<<<<<<<<<<<<<
  * 
  *         for idx in range(vec_result.size()):
  */
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 989, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1024, __pyx_L1_error)
   __pyx_v_result_view = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":991
+  /* "sat_toolkit/formula.pyx":1026
  *         result_view = result
  * 
  *         for idx in range(vec_result.size()):             # <<<<<<<<<<<<<<
  *             result_view[idx] = vec_result[idx]
  * 
  */
   __pyx_t_8 = __pyx_v_vec_result.size();
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_idx = __pyx_t_10;
 
-    /* "sat_toolkit/formula.pyx":992
+    /* "sat_toolkit/formula.pyx":1027
  * 
  *         for idx in range(vec_result.size()):
  *             result_view[idx] = vec_result[idx]             # <<<<<<<<<<<<<<
  * 
  *         return result
  */
     __pyx_t_11 = __pyx_v_idx;
     *((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_result_view.data) + __pyx_t_11)) )) = (__pyx_v_vec_result[__pyx_v_idx]);
   }
 
-  /* "sat_toolkit/formula.pyx":994
+  /* "sat_toolkit/formula.pyx":1029
  *             result_view[idx] = vec_result[idx]
  * 
  *         return result             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_result);
   __pyx_r = __pyx_v_result;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":974
+  /* "sat_toolkit/formula.pyx":1009
  *         return units
  * 
  *     def get_units(self) -> np.ndarray:             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
 
@@ -37670,15 +38137,15 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_result_view, 1);
   __Pyx_XDECREF(__pyx_v_result);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":997
+/* "sat_toolkit/formula.pyx":1032
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the DIMACS file format
  */
 
@@ -37743,306 +38210,306 @@
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":1001
+  /* "sat_toolkit/formula.pyx":1036
  *         return the CNF formatted in the DIMACS file format
  *         '''
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)             # <<<<<<<<<<<<<<
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2)
  */
   __pyx_v_max_len = snprintf(NULL, 0, ((char const *)"%d"), (-__pyx_v_self->__pyx_base.nvars));
 
-  /* "sat_toolkit/formula.pyx":1002
+  /* "sat_toolkit/formula.pyx":1037
  *         '''
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()             # <<<<<<<<<<<<<<
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2)
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  */
   __pyx_v_nclauses = __pyx_v_self->__pyx_base._start_indices.size();
 
-  /* "sat_toolkit/formula.pyx":1003
+  /* "sat_toolkit/formula.pyx":1038
  *         cdef size_t max_len = snprintf(NULL, 0, "%d", -self.nvars)
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2)             # <<<<<<<<<<<<<<
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  *         cdef ssize_t buf_idx = 0, written
  */
   __pyx_v_buf_size = (((__pyx_v_self->__pyx_base._clauses.size() - __pyx_v_nclauses) * (__pyx_v_max_len + 1)) + (__pyx_v_nclauses * 2));
 
-  /* "sat_toolkit/formula.pyx":1004
+  /* "sat_toolkit/formula.pyx":1039
  *         cdef size_t nclauses = self._start_indices.size()
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2)
  *         cdef char *buf = <char *> malloc(buf_size + 1)             # <<<<<<<<<<<<<<
  *         cdef ssize_t buf_idx = 0, written
  *         cdef size_t i
  */
   __pyx_v_buf = ((char *)malloc((__pyx_v_buf_size + 1)));
 
-  /* "sat_toolkit/formula.pyx":1005
+  /* "sat_toolkit/formula.pyx":1040
  *         cdef ssize_t buf_size = (self._clauses.size() - nclauses) * (max_len + 1) + nclauses * (2)
  *         cdef char *buf = <char *> malloc(buf_size + 1)
  *         cdef ssize_t buf_idx = 0, written             # <<<<<<<<<<<<<<
  *         cdef size_t i
  * 
  */
   __pyx_v_buf_idx = 0;
 
-  /* "sat_toolkit/formula.pyx":1008
+  /* "sat_toolkit/formula.pyx":1043
  *         cdef size_t i
  * 
  *         for i in range(self._clauses.size()):             # <<<<<<<<<<<<<<
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  */
   __pyx_t_1 = __pyx_v_self->__pyx_base._clauses.size();
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "sat_toolkit/formula.pyx":1009
+    /* "sat_toolkit/formula.pyx":1044
  * 
  *         for i in range(self._clauses.size()):
  *             if self._clauses[i] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  */
     __pyx_t_4 = ((__pyx_v_self->__pyx_base._clauses[__pyx_v_i]) == 0);
     if (__pyx_t_4) {
 
-      /* "sat_toolkit/formula.pyx":1010
+      /* "sat_toolkit/formula.pyx":1045
  *         for i in range(self._clauses.size()):
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")             # <<<<<<<<<<<<<<
  *                 if written < 0:
  *                     assert 0
  */
       __pyx_v_written = snprintf((&(__pyx_v_buf[__pyx_v_buf_idx])), __pyx_v_buf_size, ((char const *)"0\n"));
 
-      /* "sat_toolkit/formula.pyx":1011
+      /* "sat_toolkit/formula.pyx":1046
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       __pyx_t_4 = (__pyx_v_written < 0);
       if (__pyx_t_4) {
 
-        /* "sat_toolkit/formula.pyx":1012
+        /* "sat_toolkit/formula.pyx":1047
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  *                     assert 0             # <<<<<<<<<<<<<<
  *                 buf_idx += written
  *                 buf_size -= written
  */
         #ifndef CYTHON_WITHOUT_ASSERTIONS
         if (unlikely(__pyx_assertions_enabled())) {
           if (unlikely(!0)) {
             __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-            __PYX_ERR(0, 1012, __pyx_L1_error)
+            __PYX_ERR(0, 1047, __pyx_L1_error)
           }
         }
         #else
-        if ((1)); else __PYX_ERR(0, 1012, __pyx_L1_error)
+        if ((1)); else __PYX_ERR(0, 1047, __pyx_L1_error)
         #endif
 
-        /* "sat_toolkit/formula.pyx":1011
+        /* "sat_toolkit/formula.pyx":1046
  *             if self._clauses[i] == 0:
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       }
 
-      /* "sat_toolkit/formula.pyx":1013
+      /* "sat_toolkit/formula.pyx":1048
  *                 if written < 0:
  *                     assert 0
  *                 buf_idx += written             # <<<<<<<<<<<<<<
  *                 buf_size -= written
  *             else:
  */
       __pyx_v_buf_idx = (__pyx_v_buf_idx + __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":1014
+      /* "sat_toolkit/formula.pyx":1049
  *                     assert 0
  *                 buf_idx += written
  *                 buf_size -= written             # <<<<<<<<<<<<<<
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  */
       __pyx_v_buf_size = (__pyx_v_buf_size - __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":1009
+      /* "sat_toolkit/formula.pyx":1044
  * 
  *         for i in range(self._clauses.size()):
  *             if self._clauses[i] == 0:             # <<<<<<<<<<<<<<
  *                 written = snprintf(&buf[buf_idx], buf_size, "0\n")
  *                 if written < 0:
  */
       goto __pyx_L5;
     }
 
-    /* "sat_toolkit/formula.pyx":1016
+    /* "sat_toolkit/formula.pyx":1051
  *                 buf_size -= written
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])             # <<<<<<<<<<<<<<
  *                 if written < 0:
  *                     assert 0
  */
     /*else*/ {
       __pyx_v_written = snprintf((&(__pyx_v_buf[__pyx_v_buf_idx])), __pyx_v_buf_size, ((char const *)"%d "), (__pyx_v_self->__pyx_base._clauses[__pyx_v_i]));
 
-      /* "sat_toolkit/formula.pyx":1017
+      /* "sat_toolkit/formula.pyx":1052
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       __pyx_t_4 = (__pyx_v_written < 0);
       if (__pyx_t_4) {
 
-        /* "sat_toolkit/formula.pyx":1018
+        /* "sat_toolkit/formula.pyx":1053
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:
  *                     assert 0             # <<<<<<<<<<<<<<
  *                 buf_idx += written
  *                 buf_size -= written
  */
         #ifndef CYTHON_WITHOUT_ASSERTIONS
         if (unlikely(__pyx_assertions_enabled())) {
           if (unlikely(!0)) {
             __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-            __PYX_ERR(0, 1018, __pyx_L1_error)
+            __PYX_ERR(0, 1053, __pyx_L1_error)
           }
         }
         #else
-        if ((1)); else __PYX_ERR(0, 1018, __pyx_L1_error)
+        if ((1)); else __PYX_ERR(0, 1053, __pyx_L1_error)
         #endif
 
-        /* "sat_toolkit/formula.pyx":1017
+        /* "sat_toolkit/formula.pyx":1052
  *             else:
  *                 written = snprintf(&buf[buf_idx], buf_size, "%d ", self._clauses[i])
  *                 if written < 0:             # <<<<<<<<<<<<<<
  *                     assert 0
  *                 buf_idx += written
  */
       }
 
-      /* "sat_toolkit/formula.pyx":1019
+      /* "sat_toolkit/formula.pyx":1054
  *                 if written < 0:
  *                     assert 0
  *                 buf_idx += written             # <<<<<<<<<<<<<<
  *                 buf_size -= written
  * 
  */
       __pyx_v_buf_idx = (__pyx_v_buf_idx + __pyx_v_written);
 
-      /* "sat_toolkit/formula.pyx":1020
+      /* "sat_toolkit/formula.pyx":1055
  *                     assert 0
  *                 buf_idx += written
  *                 buf_size -= written             # <<<<<<<<<<<<<<
  * 
  *         assert buf_size >= 0
  */
       __pyx_v_buf_size = (__pyx_v_buf_size - __pyx_v_written);
     }
     __pyx_L5:;
   }
 
-  /* "sat_toolkit/formula.pyx":1022
+  /* "sat_toolkit/formula.pyx":1057
  *                 buf_size -= written
  * 
  *         assert buf_size >= 0             # <<<<<<<<<<<<<<
  *         py_str = buf[:buf_idx]
  *         free(buf)
  */
   #ifndef CYTHON_WITHOUT_ASSERTIONS
   if (unlikely(__pyx_assertions_enabled())) {
     __pyx_t_4 = (__pyx_v_buf_size >= 0);
     if (unlikely(!__pyx_t_4)) {
       __Pyx_Raise(__pyx_builtin_AssertionError, 0, 0, 0);
-      __PYX_ERR(0, 1022, __pyx_L1_error)
+      __PYX_ERR(0, 1057, __pyx_L1_error)
     }
   }
   #else
-  if ((1)); else __PYX_ERR(0, 1022, __pyx_L1_error)
+  if ((1)); else __PYX_ERR(0, 1057, __pyx_L1_error)
   #endif
 
-  /* "sat_toolkit/formula.pyx":1023
+  /* "sat_toolkit/formula.pyx":1058
  * 
  *         assert buf_size >= 0
  *         py_str = buf[:buf_idx]             # <<<<<<<<<<<<<<
  *         free(buf)
  * 
  */
-  __pyx_t_5 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf + 0, __pyx_v_buf_idx - 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1023, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf + 0, __pyx_v_buf_idx - 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1058, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_v_py_str = ((PyObject*)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1024
+  /* "sat_toolkit/formula.pyx":1059
  *         assert buf_size >= 0
  *         py_str = buf[:buf_idx]
  *         free(buf)             # <<<<<<<<<<<<<<
  * 
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()
  */
   free(__pyx_v_buf);
 
-  /* "sat_toolkit/formula.pyx":1026
+  /* "sat_toolkit/formula.pyx":1061
  *         free(buf)
  * 
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()             # <<<<<<<<<<<<<<
  * 
  *     def to_espresso(self, print_numvars: bool = True) -> str:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_self->__pyx_base.nvars); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_self->__pyx_base.nvars); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_Str(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Str(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Add(__pyx_kp_u_p_cnf, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Add(__pyx_kp_u_p_cnf, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_5, __pyx_kp_u__32); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_5, __pyx_kp_u__34); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_nclauses); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_nclauses); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_Str(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Str(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Add(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Add(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_5, __pyx_kp_u__33); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_5, __pyx_kp_u__35); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_decode_bytes(__pyx_v_py_str, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_decode_bytes(__pyx_v_py_str, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_6)) || __Pyx_RaiseUnexpectedTypeError("unicode", __pyx_t_6))) __PYX_ERR(0, 1026, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_6)) || __Pyx_RaiseUnexpectedTypeError("unicode", __pyx_t_6))) __PYX_ERR(0, 1061, __pyx_L1_error)
   __pyx_r = ((PyObject*)__pyx_t_6);
   __pyx_t_6 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":997
+  /* "sat_toolkit/formula.pyx":1032
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the DIMACS file format
  */
 
@@ -38056,15 +38523,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_py_str);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1028
+/* "sat_toolkit/formula.pyx":1063
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()
  * 
  *     def to_espresso(self, print_numvars: bool = True) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the espresso file format
  */
 
@@ -38118,34 +38585,34 @@
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_print_numvars);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1028, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1063, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_espresso") < 0)) __PYX_ERR(0, 1028, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_espresso") < 0)) __PYX_ERR(0, 1063, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_print_numvars = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("to_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1028, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("to_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1063, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -38184,303 +38651,303 @@
   size_t __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_espresso", 1);
 
-  /* "sat_toolkit/formula.pyx":1036
+  /* "sat_toolkit/formula.pyx":1071
  *         cdef char target_char
  *         cdef char *line_buf
  *         cdef fmt_buf buf = make_buf()             # <<<<<<<<<<<<<<
  * 
  *         if print_numvars:
  */
   __pyx_v_buf = make_buf();
 
-  /* "sat_toolkit/formula.pyx":1038
+  /* "sat_toolkit/formula.pyx":1073
  *         cdef fmt_buf buf = make_buf()
  * 
  *         if print_numvars:             # <<<<<<<<<<<<<<
  *             buf_printf(&buf, ".i %d\n", self.nvars)
  *             buf_printf(&buf, ".o 1\n", self.nvars)
  */
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_print_numvars); if (unlikely((__pyx_t_1 < 0))) __PYX_ERR(0, 1038, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_print_numvars); if (unlikely((__pyx_t_1 < 0))) __PYX_ERR(0, 1073, __pyx_L1_error)
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1039
+    /* "sat_toolkit/formula.pyx":1074
  * 
  *         if print_numvars:
  *             buf_printf(&buf, ".i %d\n", self.nvars)             # <<<<<<<<<<<<<<
  *             buf_printf(&buf, ".o 1\n", self.nvars)
  *         buf_printf(&buf, ".p %zd\n", self._start_indices.size())
  */
     (void)(buf_printf((&__pyx_v_buf), ((char const *)".i %d\n"), __pyx_v_self->__pyx_base.nvars));
 
-    /* "sat_toolkit/formula.pyx":1040
+    /* "sat_toolkit/formula.pyx":1075
  *         if print_numvars:
  *             buf_printf(&buf, ".i %d\n", self.nvars)
  *             buf_printf(&buf, ".o 1\n", self.nvars)             # <<<<<<<<<<<<<<
  *         buf_printf(&buf, ".p %zd\n", self._start_indices.size())
  * 
  */
     (void)(buf_printf((&__pyx_v_buf), ((char const *)".o 1\n"), __pyx_v_self->__pyx_base.nvars));
 
-    /* "sat_toolkit/formula.pyx":1038
+    /* "sat_toolkit/formula.pyx":1073
  *         cdef fmt_buf buf = make_buf()
  * 
  *         if print_numvars:             # <<<<<<<<<<<<<<
  *             buf_printf(&buf, ".i %d\n", self.nvars)
  *             buf_printf(&buf, ".o 1\n", self.nvars)
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1041
+  /* "sat_toolkit/formula.pyx":1076
  *             buf_printf(&buf, ".i %d\n", self.nvars)
  *             buf_printf(&buf, ".o 1\n", self.nvars)
  *         buf_printf(&buf, ".p %zd\n", self._start_indices.size())             # <<<<<<<<<<<<<<
  * 
  *         line_buf = <char *> malloc(self.nvars + 4)
  */
   (void)(buf_printf((&__pyx_v_buf), ((char const *)".p %zd\n"), __pyx_v_self->__pyx_base._start_indices.size()));
 
-  /* "sat_toolkit/formula.pyx":1043
+  /* "sat_toolkit/formula.pyx":1078
  *         buf_printf(&buf, ".p %zd\n", self._start_indices.size())
  * 
  *         line_buf = <char *> malloc(self.nvars + 4)             # <<<<<<<<<<<<<<
  *         strcpy(line_buf + self.nvars, " 1\n");
  * 
  */
   __pyx_v_line_buf = ((char *)malloc((__pyx_v_self->__pyx_base.nvars + 4)));
 
-  /* "sat_toolkit/formula.pyx":1044
+  /* "sat_toolkit/formula.pyx":1079
  * 
  *         line_buf = <char *> malloc(self.nvars + 4)
  *         strcpy(line_buf + self.nvars, " 1\n");             # <<<<<<<<<<<<<<
  * 
  *         for i in range(self._start_indices.size()):
  */
   (void)(strcpy((__pyx_v_line_buf + __pyx_v_self->__pyx_base.nvars), ((char const *)" 1\n")));
 
-  /* "sat_toolkit/formula.pyx":1046
+  /* "sat_toolkit/formula.pyx":1081
  *         strcpy(line_buf + self.nvars, " 1\n");
  * 
  *         for i in range(self._start_indices.size()):             # <<<<<<<<<<<<<<
  *             memset(line_buf, b'-', self.nvars);
  * 
  */
   __pyx_t_2 = __pyx_v_self->__pyx_base._start_indices.size();
   __pyx_t_3 = __pyx_t_2;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_i = __pyx_t_4;
 
-    /* "sat_toolkit/formula.pyx":1047
+    /* "sat_toolkit/formula.pyx":1082
  * 
  *         for i in range(self._start_indices.size()):
  *             memset(line_buf, b'-', self.nvars);             # <<<<<<<<<<<<<<
  * 
  *             j = 0
  */
     (void)(memset(__pyx_v_line_buf, '-', __pyx_v_self->__pyx_base.nvars));
 
-    /* "sat_toolkit/formula.pyx":1049
+    /* "sat_toolkit/formula.pyx":1084
  *             memset(line_buf, b'-', self.nvars);
  * 
  *             j = 0             # <<<<<<<<<<<<<<
  *             while self._clauses[self._start_indices[i] + j] != 0:
  *                 lit = self._clauses[self._start_indices[i] + j]
  */
     __pyx_v_j = 0;
 
-    /* "sat_toolkit/formula.pyx":1050
+    /* "sat_toolkit/formula.pyx":1085
  * 
  *             j = 0
  *             while self._clauses[self._start_indices[i] + j] != 0:             # <<<<<<<<<<<<<<
  *                 lit = self._clauses[self._start_indices[i] + j]
  * 
  */
     while (1) {
       __pyx_t_1 = ((__pyx_v_self->__pyx_base._clauses[((__pyx_v_self->__pyx_base._start_indices[__pyx_v_i]) + __pyx_v_j)]) != 0);
       if (!__pyx_t_1) break;
 
-      /* "sat_toolkit/formula.pyx":1051
+      /* "sat_toolkit/formula.pyx":1086
  *             j = 0
  *             while self._clauses[self._start_indices[i] + j] != 0:
  *                 lit = self._clauses[self._start_indices[i] + j]             # <<<<<<<<<<<<<<
  * 
  *                 target_char = b'0'
  */
       __pyx_v_lit = (__pyx_v_self->__pyx_base._clauses[((__pyx_v_self->__pyx_base._start_indices[__pyx_v_i]) + __pyx_v_j)]);
 
-      /* "sat_toolkit/formula.pyx":1053
+      /* "sat_toolkit/formula.pyx":1088
  *                 lit = self._clauses[self._start_indices[i] + j]
  * 
  *                 target_char = b'0'             # <<<<<<<<<<<<<<
  *                 if lit < 0:
  *                     target_char = b'1'
  */
       __pyx_v_target_char = '0';
 
-      /* "sat_toolkit/formula.pyx":1054
+      /* "sat_toolkit/formula.pyx":1089
  * 
  *                 target_char = b'0'
  *                 if lit < 0:             # <<<<<<<<<<<<<<
  *                     target_char = b'1'
  *                     lit = -lit
  */
       __pyx_t_1 = (__pyx_v_lit < 0);
       if (__pyx_t_1) {
 
-        /* "sat_toolkit/formula.pyx":1055
+        /* "sat_toolkit/formula.pyx":1090
  *                 target_char = b'0'
  *                 if lit < 0:
  *                     target_char = b'1'             # <<<<<<<<<<<<<<
  *                     lit = -lit
  * 
  */
         __pyx_v_target_char = '1';
 
-        /* "sat_toolkit/formula.pyx":1056
+        /* "sat_toolkit/formula.pyx":1091
  *                 if lit < 0:
  *                     target_char = b'1'
  *                     lit = -lit             # <<<<<<<<<<<<<<
  * 
  *                 line_buf[self.nvars - lit] = target_char
  */
         __pyx_v_lit = (-__pyx_v_lit);
 
-        /* "sat_toolkit/formula.pyx":1054
+        /* "sat_toolkit/formula.pyx":1089
  * 
  *                 target_char = b'0'
  *                 if lit < 0:             # <<<<<<<<<<<<<<
  *                     target_char = b'1'
  *                     lit = -lit
  */
       }
 
-      /* "sat_toolkit/formula.pyx":1058
+      /* "sat_toolkit/formula.pyx":1093
  *                     lit = -lit
  * 
  *                 line_buf[self.nvars - lit] = target_char             # <<<<<<<<<<<<<<
  * 
  *                 j += 1
  */
       (__pyx_v_line_buf[(__pyx_v_self->__pyx_base.nvars - __pyx_v_lit)]) = __pyx_v_target_char;
 
-      /* "sat_toolkit/formula.pyx":1060
+      /* "sat_toolkit/formula.pyx":1095
  *                 line_buf[self.nvars - lit] = target_char
  * 
  *                 j += 1             # <<<<<<<<<<<<<<
  * 
  *             buf_printf(&buf, "%s", line_buf)
  */
       __pyx_v_j = (__pyx_v_j + 1);
     }
 
-    /* "sat_toolkit/formula.pyx":1062
+    /* "sat_toolkit/formula.pyx":1097
  *                 j += 1
  * 
  *             buf_printf(&buf, "%s", line_buf)             # <<<<<<<<<<<<<<
  * 
  *         # handle the case of a CNF with 0 clauses, a.k.a. a tautology
  */
     (void)(buf_printf((&__pyx_v_buf), ((char const *)"%s"), __pyx_v_line_buf));
   }
 
-  /* "sat_toolkit/formula.pyx":1065
+  /* "sat_toolkit/formula.pyx":1100
  * 
  *         # handle the case of a CNF with 0 clauses, a.k.a. a tautology
  *         if self._start_indices.size() == 0:             # <<<<<<<<<<<<<<
  *             memset(line_buf, b'-', self.nvars);
  *             line_buf[self.nvars + 1] = b'0'
  */
   __pyx_t_1 = (__pyx_v_self->__pyx_base._start_indices.size() == 0);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1066
+    /* "sat_toolkit/formula.pyx":1101
  *         # handle the case of a CNF with 0 clauses, a.k.a. a tautology
  *         if self._start_indices.size() == 0:
  *             memset(line_buf, b'-', self.nvars);             # <<<<<<<<<<<<<<
  *             line_buf[self.nvars + 1] = b'0'
  *             buf_printf(&buf, "%s", line_buf)
  */
     (void)(memset(__pyx_v_line_buf, '-', __pyx_v_self->__pyx_base.nvars));
 
-    /* "sat_toolkit/formula.pyx":1067
+    /* "sat_toolkit/formula.pyx":1102
  *         if self._start_indices.size() == 0:
  *             memset(line_buf, b'-', self.nvars);
  *             line_buf[self.nvars + 1] = b'0'             # <<<<<<<<<<<<<<
  *             buf_printf(&buf, "%s", line_buf)
  * 
  */
     (__pyx_v_line_buf[(__pyx_v_self->__pyx_base.nvars + 1)]) = '0';
 
-    /* "sat_toolkit/formula.pyx":1068
+    /* "sat_toolkit/formula.pyx":1103
  *             memset(line_buf, b'-', self.nvars);
  *             line_buf[self.nvars + 1] = b'0'
  *             buf_printf(&buf, "%s", line_buf)             # <<<<<<<<<<<<<<
  * 
  *         buf_printf(&buf, ".e\n")
  */
     (void)(buf_printf((&__pyx_v_buf), ((char const *)"%s"), __pyx_v_line_buf));
 
-    /* "sat_toolkit/formula.pyx":1065
+    /* "sat_toolkit/formula.pyx":1100
  * 
  *         # handle the case of a CNF with 0 clauses, a.k.a. a tautology
  *         if self._start_indices.size() == 0:             # <<<<<<<<<<<<<<
  *             memset(line_buf, b'-', self.nvars);
  *             line_buf[self.nvars + 1] = b'0'
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1070
+  /* "sat_toolkit/formula.pyx":1105
  *             buf_printf(&buf, "%s", line_buf)
  * 
  *         buf_printf(&buf, ".e\n")             # <<<<<<<<<<<<<<
  *         py_bytes = buf.buf[:buf.len]
  * 
  */
   (void)(buf_printf((&__pyx_v_buf), ((char const *)".e\n")));
 
-  /* "sat_toolkit/formula.pyx":1071
+  /* "sat_toolkit/formula.pyx":1106
  * 
  *         buf_printf(&buf, ".e\n")
  *         py_bytes = buf.buf[:buf.len]             # <<<<<<<<<<<<<<
  * 
  *         free_buf(&buf)
  */
-  __pyx_t_5 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf.buf + 0, __pyx_v_buf.len - 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1071, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyBytes_FromStringAndSize(__pyx_v_buf.buf + 0, __pyx_v_buf.len - 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1106, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_v_py_bytes = ((PyObject*)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1073
+  /* "sat_toolkit/formula.pyx":1108
  *         py_bytes = buf.buf[:buf.len]
  * 
  *         free_buf(&buf)             # <<<<<<<<<<<<<<
  *         return py_bytes.decode()
  * 
  */
   free_buf((&__pyx_v_buf));
 
-  /* "sat_toolkit/formula.pyx":1074
+  /* "sat_toolkit/formula.pyx":1109
  * 
  *         free_buf(&buf)
  *         return py_bytes.decode()             # <<<<<<<<<<<<<<
  * 
  *     def minimize_espresso(self, espresso_args: List[str] = []) -> CNF:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_decode_bytes(__pyx_v_py_bytes, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1074, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_decode_bytes(__pyx_v_py_bytes, 0, PY_SSIZE_T_MAX, NULL, NULL, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_r = ((PyObject*)__pyx_t_5);
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1028
+  /* "sat_toolkit/formula.pyx":1063
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()
  * 
  *     def to_espresso(self, print_numvars: bool = True) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the espresso file format
  */
 
@@ -38492,15 +38959,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_py_bytes);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1076
+/* "sat_toolkit/formula.pyx":1111
  *         return py_bytes.decode()
  * 
  *     def minimize_espresso(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to minimize the given CNF.
  */
 
@@ -38539,49 +39006,49 @@
   #else
   __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
   #endif
   #endif
   __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
   {
     PyObject **__pyx_pyargnames[] = {&__pyx_n_s_espresso_args,0};
-    values[0] = __Pyx_Arg_NewRef_FASTCALL(__pyx_k__34);
+    values[0] = __Pyx_Arg_NewRef_FASTCALL(__pyx_k__36);
     if (__pyx_kwds) {
       Py_ssize_t kw_args;
       switch (__pyx_nargs) {
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_espresso_args);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1076, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1111, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "minimize_espresso") < 0)) __PYX_ERR(0, 1076, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "minimize_espresso") < 0)) __PYX_ERR(0, 1111, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_espresso_args = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("minimize_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1076, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("minimize_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1111, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -38625,65 +39092,65 @@
   int __pyx_t_13;
   struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_t_14 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("minimize_espresso", 1);
 
-  /* "sat_toolkit/formula.pyx":1087
+  /* "sat_toolkit/formula.pyx":1122
  *         cdef int ret_code
  * 
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.close()
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_n_u_espresso);
     __Pyx_GIVEREF(__pyx_n_u_espresso);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1087, __pyx_L1_error);
-    __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_v_espresso_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1122, __pyx_L1_error);
+    __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_v_espresso_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1122, __pyx_L1_error);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1087, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_4) < 0) __PYX_ERR(0, 1087, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_4) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1087, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1087, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1122, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L3_error)
+    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1122, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_2)) {
@@ -38695,15 +39162,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L3_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1122, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __pyx_t_1 = __pyx_t_3;
     __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     /*try:*/ {
@@ -38714,27 +39181,27 @@
         __Pyx_XGOTREF(__pyx_t_8);
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_10);
         /*try:*/ {
           __pyx_v_espresso = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1088
+          /* "sat_toolkit/formula.pyx":1123
  * 
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             espresso.stdin.write(self.to_espresso())             # <<<<<<<<<<<<<<
  *             espresso.stdin.close()
  * 
  */
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1088, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1123, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1123, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1088, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1123, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
           __pyx_t_5 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_2))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
             if (likely(__pyx_t_5)) {
@@ -38746,15 +39213,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1088, __pyx_L7_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1123, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           }
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
@@ -38769,30 +39236,30 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_4};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1123, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1089
+          /* "sat_toolkit/formula.pyx":1124
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.close()             # <<<<<<<<<<<<<<
  * 
  *             cnf = CNF.from_espresso(espresso.stdout.read())
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1089, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1124, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_close); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1089, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_close); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1124, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __pyx_t_3 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_4))) {
             __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
@@ -38805,32 +39272,32 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1124, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1091
+          /* "sat_toolkit/formula.pyx":1126
  *             espresso.stdin.close()
  * 
  *             cnf = CNF.from_espresso(espresso.stdout.read())             # <<<<<<<<<<<<<<
  * 
  *             ret_code = espresso.wait()
  */
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1091, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1126, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdout); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1091, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdout); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1126, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1091, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1126, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
@@ -38843,15 +39310,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
             __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1091, __pyx_L7_error)
+            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1126, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
           __pyx_t_5 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_4))) {
@@ -38866,29 +39333,29 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_3};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1091, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1126, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           }
           __pyx_v_cnf = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1093
+          /* "sat_toolkit/formula.pyx":1128
  *             cnf = CNF.from_espresso(espresso.stdout.read())
  * 
  *             ret_code = espresso.wait()             # <<<<<<<<<<<<<<
  *             if ret_code != 0:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  */
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1093, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1128, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
           __pyx_t_3 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_4))) {
             __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
             if (likely(__pyx_t_3)) {
@@ -38900,49 +39367,49 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1093, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1128, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           }
-          __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1093, __pyx_L7_error)
+          __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1128, __pyx_L7_error)
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __pyx_v_ret_code = __pyx_t_7;
 
-          /* "sat_toolkit/formula.pyx":1094
+          /* "sat_toolkit/formula.pyx":1129
  * 
  *             ret_code = espresso.wait()
  *             if ret_code != 0:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
           __pyx_t_11 = (__pyx_v_ret_code != 0);
           if (unlikely(__pyx_t_11)) {
 
-            /* "sat_toolkit/formula.pyx":1095
+            /* "sat_toolkit/formula.pyx":1130
  *             ret_code = espresso.wait()
  *             if ret_code != 0:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))             # <<<<<<<<<<<<<<
  * 
  *             return cnf
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1095, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1130, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1095, __pyx_L7_error)
+            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1130, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1095, __pyx_L7_error)
+            __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1130, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1095, __pyx_L7_error)
+            __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1130, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __pyx_t_2 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1095, __pyx_L7_error)
+            __pyx_t_2 = PyUnicode_Join(__pyx_kp_u__34, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1130, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             __pyx_t_5 = NULL;
             __pyx_t_7 = 0;
             #if CYTHON_UNPACK_METHODS
             if (unlikely(PyMethod_Check(__pyx_t_3))) {
               __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
@@ -38957,45 +39424,45 @@
             #endif
             {
               PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_t_4, __pyx_t_2};
               __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
               __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
               __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
               __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L7_error)
+              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1130, __pyx_L7_error)
               __Pyx_GOTREF(__pyx_t_1);
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             }
             __Pyx_Raise(__pyx_t_1, 0, 0, 0);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __PYX_ERR(0, 1095, __pyx_L7_error)
+            __PYX_ERR(0, 1130, __pyx_L7_error)
 
-            /* "sat_toolkit/formula.pyx":1094
+            /* "sat_toolkit/formula.pyx":1129
  * 
  *             ret_code = espresso.wait()
  *             if ret_code != 0:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1097
+          /* "sat_toolkit/formula.pyx":1132
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  *             return cnf             # <<<<<<<<<<<<<<
  * 
  *     def _minimize_dimacs(self, args: List[str], outfile: str) -> CNF:
  */
           __Pyx_XDECREF((PyObject *)__pyx_r);
-          if (!(likely(((__pyx_v_cnf) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_cnf, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1097, __pyx_L7_error)
+          if (!(likely(((__pyx_v_cnf) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_cnf, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1132, __pyx_L7_error)
           __Pyx_INCREF(__pyx_v_cnf);
           __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_v_cnf);
           goto __pyx_L11_try_return;
 
-          /* "sat_toolkit/formula.pyx":1087
+          /* "sat_toolkit/formula.pyx":1122
  *         cdef int ret_code
  * 
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.close()
  */
         }
@@ -39003,36 +39470,36 @@
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF.minimize_espresso", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_2) < 0) __PYX_ERR(0, 1087, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_2) < 0) __PYX_ERR(0, 1122, __pyx_L9_except_error)
           __Pyx_XGOTREF(__pyx_t_1);
           __Pyx_XGOTREF(__pyx_t_3);
           __Pyx_XGOTREF(__pyx_t_2);
-          __pyx_t_4 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1087, __pyx_L9_except_error)
+          __pyx_t_4 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1122, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_4);
           __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1087, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1122, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_12);
           __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          if (__pyx_t_11 < 0) __PYX_ERR(0, 1087, __pyx_L9_except_error)
+          if (__pyx_t_11 < 0) __PYX_ERR(0, 1122, __pyx_L9_except_error)
           __pyx_t_13 = (!__pyx_t_11);
           if (unlikely(__pyx_t_13)) {
             __Pyx_GIVEREF(__pyx_t_1);
             __Pyx_GIVEREF(__pyx_t_3);
             __Pyx_XGIVEREF(__pyx_t_2);
             __Pyx_ErrRestoreWithState(__pyx_t_1, __pyx_t_3, __pyx_t_2);
             __pyx_t_1 = 0; __pyx_t_3 = 0; __pyx_t_2 = 0; 
-            __PYX_ERR(0, 1087, __pyx_L9_except_error)
+            __PYX_ERR(0, 1122, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -39053,29 +39520,29 @@
         __Pyx_XGIVEREF(__pyx_t_10);
         __Pyx_ExceptionReset(__pyx_t_8, __pyx_t_9, __pyx_t_10);
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_6) {
-          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
+          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1087, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1122, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L4_return: {
         __pyx_t_14 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_6) {
-          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
+          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1087, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1122, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __pyx_r = __pyx_t_14;
         __pyx_t_14 = 0;
         goto __pyx_L0;
       }
@@ -39084,15 +39551,15 @@
     goto __pyx_L17;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     goto __pyx_L1_error;
     __pyx_L17:;
   }
 
-  /* "sat_toolkit/formula.pyx":1076
+  /* "sat_toolkit/formula.pyx":1111
  *         return py_bytes.decode()
  * 
  *     def minimize_espresso(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to minimize the given CNF.
  */
 
@@ -39111,15 +39578,15 @@
   __Pyx_XDECREF(__pyx_v_espresso);
   __Pyx_XDECREF(__pyx_v_cnf);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1099
+/* "sat_toolkit/formula.pyx":1134
  *             return cnf
  * 
  *     def _minimize_dimacs(self, args: List[str], outfile: str) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         calls args with self.to_dimacs() as stdin, waits for the command to
  */
 
@@ -39176,57 +39643,57 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_args)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1099, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1134, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_outfile)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1099, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1134, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("_minimize_dimacs", 1, 2, 2, 1); __PYX_ERR(0, 1099, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_minimize_dimacs", 1, 2, 2, 1); __PYX_ERR(0, 1134, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_minimize_dimacs") < 0)) __PYX_ERR(0, 1099, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_minimize_dimacs") < 0)) __PYX_ERR(0, 1134, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 2)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
     }
     __pyx_v_args = values[0];
     __pyx_v_outfile = ((PyObject*)values[1]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_minimize_dimacs", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 1099, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_minimize_dimacs", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 1134, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.CNF._minimize_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_outfile), (&PyUnicode_Type), 0, "outfile", 1))) __PYX_ERR(0, 1099, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_outfile), (&PyUnicode_Type), 0, "outfile", 1))) __PYX_ERR(0, 1134, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_26_minimize_dimacs(((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_v_self), __pyx_v_args, __pyx_v_outfile);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -39261,59 +39728,59 @@
   PyObject *__pyx_t_13 = NULL;
   struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_t_14 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_minimize_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":1107
+  /* "sat_toolkit/formula.pyx":1142
  *         :rtype: CNF
  *         """
  *         cdef int ret_code = 0             # <<<<<<<<<<<<<<
  *         with sp.Popen(args, stdin=sp.PIPE, text=True) as minimizer:
  *             minimizer.stdin.write(self.to_dimacs())
  */
   __pyx_v_ret_code = 0;
 
-  /* "sat_toolkit/formula.pyx":1108
+  /* "sat_toolkit/formula.pyx":1143
  *         """
  *         cdef int ret_code = 0
  *         with sp.Popen(args, stdin=sp.PIPE, text=True) as minimizer:             # <<<<<<<<<<<<<<
  *             minimizer.stdin.write(self.to_dimacs())
  *             minimizer.stdin.close()
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1108, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1108, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1108, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_args);
     __Pyx_GIVEREF(__pyx_v_args);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_args)) __PYX_ERR(0, 1108, __pyx_L1_error);
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L1_error)
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_args)) __PYX_ERR(0, 1143, __pyx_L1_error);
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1108, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1108, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1108, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1143, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1108, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1108, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1143, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1108, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1108, __pyx_L3_error)
+    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1143, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_2)) {
@@ -39325,15 +39792,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L3_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1143, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __pyx_t_1 = __pyx_t_3;
     __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     /*try:*/ {
@@ -39344,27 +39811,27 @@
         __Pyx_XGOTREF(__pyx_t_8);
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_10);
         /*try:*/ {
           __pyx_v_minimizer = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1109
+          /* "sat_toolkit/formula.pyx":1144
  *         cdef int ret_code = 0
  *         with sp.Popen(args, stdin=sp.PIPE, text=True) as minimizer:
  *             minimizer.stdin.write(self.to_dimacs())             # <<<<<<<<<<<<<<
  *             minimizer.stdin.close()
  * 
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1109, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1144, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1109, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1144, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1109, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1144, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
           __pyx_t_4 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_2))) {
             __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
             if (likely(__pyx_t_4)) {
@@ -39376,15 +39843,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1109, __pyx_L7_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1144, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           }
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
@@ -39399,30 +39866,30 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_5};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1109, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1110
+          /* "sat_toolkit/formula.pyx":1145
  *         with sp.Popen(args, stdin=sp.PIPE, text=True) as minimizer:
  *             minimizer.stdin.write(self.to_dimacs())
  *             minimizer.stdin.close()             # <<<<<<<<<<<<<<
  * 
  *             ret_code = minimizer.wait()
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1110, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1145, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_close); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1110, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_close); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1145, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __pyx_t_3 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
@@ -39435,28 +39902,28 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1110, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1145, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1112
+          /* "sat_toolkit/formula.pyx":1147
  *             minimizer.stdin.close()
  * 
  *             ret_code = minimizer.wait()             # <<<<<<<<<<<<<<
  *             if ret_code not in [10, 20]:
  *                 # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_wait); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1112, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_wait); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1147, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_3 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
             if (likely(__pyx_t_3)) {
@@ -39468,23 +39935,23 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1112, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1147, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
-          __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1112, __pyx_L7_error)
+          __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1147, __pyx_L7_error)
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __pyx_v_ret_code = __pyx_t_7;
 
-          /* "sat_toolkit/formula.pyx":1113
+          /* "sat_toolkit/formula.pyx":1148
  * 
  *             ret_code = minimizer.wait()
  *             if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                 # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                 # ret == 20 to UNSATISFIABLE (see for example
  */
           switch (__pyx_v_ret_code) {
@@ -39495,31 +39962,31 @@
             default:
             __pyx_t_11 = 1;
             break;
           }
           __pyx_t_12 = __pyx_t_11;
           if (unlikely(__pyx_t_12)) {
 
-            /* "sat_toolkit/formula.pyx":1117
+            /* "sat_toolkit/formula.pyx":1152
  *                 # ret == 20 to UNSATISFIABLE (see for example
  *                 # http://www.satcompetition.org/2004/format-solvers2004.html)
  *                 raise sp.CalledProcessError(ret_code, ' '.join(minimizer.args))             # <<<<<<<<<<<<<<
  * 
  *         with open(outfile, 'r') as f:
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1117, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1152, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1117, __pyx_L7_error)
+            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1152, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1117, __pyx_L7_error)
+            __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1152, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_args); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1117, __pyx_L7_error)
+            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_minimizer, __pyx_n_s_args); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1152, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
-            __pyx_t_4 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L7_error)
+            __pyx_t_4 = PyUnicode_Join(__pyx_kp_u__34, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1152, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
             __pyx_t_2 = NULL;
             __pyx_t_7 = 0;
             #if CYTHON_UNPACK_METHODS
             if (unlikely(PyMethod_Check(__pyx_t_3))) {
               __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -39534,32 +40001,32 @@
             #endif
             {
               PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_t_5, __pyx_t_4};
               __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
               __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
               __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
               __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1117, __pyx_L7_error)
+              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1152, __pyx_L7_error)
               __Pyx_GOTREF(__pyx_t_1);
               __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             }
             __Pyx_Raise(__pyx_t_1, 0, 0, 0);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __PYX_ERR(0, 1117, __pyx_L7_error)
+            __PYX_ERR(0, 1152, __pyx_L7_error)
 
-            /* "sat_toolkit/formula.pyx":1113
+            /* "sat_toolkit/formula.pyx":1148
  * 
  *             ret_code = minimizer.wait()
  *             if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                 # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                 # ret == 20 to UNSATISFIABLE (see for example
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1108
+          /* "sat_toolkit/formula.pyx":1143
  *         """
  *         cdef int ret_code = 0
  *         with sp.Popen(args, stdin=sp.PIPE, text=True) as minimizer:             # <<<<<<<<<<<<<<
  *             minimizer.stdin.write(self.to_dimacs())
  *             minimizer.stdin.close()
  */
         }
@@ -39571,36 +40038,36 @@
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF._minimize_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_4) < 0) __PYX_ERR(0, 1108, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_4) < 0) __PYX_ERR(0, 1143, __pyx_L9_except_error)
           __Pyx_XGOTREF(__pyx_t_1);
           __Pyx_XGOTREF(__pyx_t_3);
           __Pyx_XGOTREF(__pyx_t_4);
-          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1108, __pyx_L9_except_error)
+          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1143, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1108, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1143, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_13);
           __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (__pyx_t_12 < 0) __PYX_ERR(0, 1108, __pyx_L9_except_error)
+          if (__pyx_t_12 < 0) __PYX_ERR(0, 1143, __pyx_L9_except_error)
           __pyx_t_11 = (!__pyx_t_12);
           if (unlikely(__pyx_t_11)) {
             __Pyx_GIVEREF(__pyx_t_1);
             __Pyx_GIVEREF(__pyx_t_3);
             __Pyx_XGIVEREF(__pyx_t_4);
             __Pyx_ErrRestoreWithState(__pyx_t_1, __pyx_t_3, __pyx_t_4);
             __pyx_t_1 = 0; __pyx_t_3 = 0; __pyx_t_4 = 0; 
-            __PYX_ERR(0, 1108, __pyx_L9_except_error)
+            __PYX_ERR(0, 1143, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -39616,53 +40083,53 @@
         __Pyx_ExceptionReset(__pyx_t_8, __pyx_t_9, __pyx_t_10);
         __pyx_L12_try_end:;
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_6) {
-          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
+          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1143, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L6:;
     }
     goto __pyx_L17;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     goto __pyx_L1_error;
     __pyx_L17:;
   }
 
-  /* "sat_toolkit/formula.pyx":1119
+  /* "sat_toolkit/formula.pyx":1154
  *                 raise sp.CalledProcessError(ret_code, ' '.join(minimizer.args))
  * 
  *         with open(outfile, 'r') as f:             # <<<<<<<<<<<<<<
  *             return CNF.from_dimacs(f.read())
  * 
  */
   /*with:*/ {
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1119, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1154, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_outfile);
     __Pyx_GIVEREF(__pyx_v_outfile);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_outfile)) __PYX_ERR(0, 1119, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_outfile)) __PYX_ERR(0, 1154, __pyx_L1_error);
     __Pyx_INCREF(__pyx_n_u_r);
     __Pyx_GIVEREF(__pyx_n_u_r);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_n_u_r)) __PYX_ERR(0, 1119, __pyx_L1_error);
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1119, __pyx_L1_error)
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_n_u_r)) __PYX_ERR(0, 1154, __pyx_L1_error);
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1154, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1119, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1154, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1119, __pyx_L18_error)
+    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1154, __pyx_L18_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_5 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_5)) {
@@ -39674,15 +40141,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
       __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1119, __pyx_L18_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1154, __pyx_L18_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __pyx_t_1 = __pyx_t_4;
     __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     /*try:*/ {
@@ -39693,25 +40160,25 @@
         __Pyx_XGOTREF(__pyx_t_10);
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_8);
         /*try:*/ {
           __pyx_v_f = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1120
+          /* "sat_toolkit/formula.pyx":1155
  * 
  *         with open(outfile, 'r') as f:
  *             return CNF.from_dimacs(f.read())             # <<<<<<<<<<<<<<
  * 
  *     def minimize_lingeling(self, optlevel=None, timeout=0, extra_args: List[str] = []) -> CNF:
  */
           __Pyx_XDECREF((PyObject *)__pyx_r);
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1120, __pyx_L22_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1155, __pyx_L22_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1120, __pyx_L22_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1155, __pyx_L22_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
             if (likely(__pyx_t_2)) {
@@ -39723,15 +40190,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1120, __pyx_L22_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1155, __pyx_L22_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
           __pyx_t_5 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
@@ -39746,24 +40213,24 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1120, __pyx_L22_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1155, __pyx_L22_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
-          if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1120, __pyx_L22_error)
+          if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1155, __pyx_L22_error)
           __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
           __pyx_t_1 = 0;
           goto __pyx_L26_try_return;
 
-          /* "sat_toolkit/formula.pyx":1119
+          /* "sat_toolkit/formula.pyx":1154
  *                 raise sp.CalledProcessError(ret_code, ' '.join(minimizer.args))
  * 
  *         with open(outfile, 'r') as f:             # <<<<<<<<<<<<<<
  *             return CNF.from_dimacs(f.read())
  * 
  */
         }
@@ -39771,36 +40238,36 @@
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF._minimize_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_4) < 0) __PYX_ERR(0, 1119, __pyx_L24_except_error)
+          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_4) < 0) __PYX_ERR(0, 1154, __pyx_L24_except_error)
           __Pyx_XGOTREF(__pyx_t_1);
           __Pyx_XGOTREF(__pyx_t_3);
           __Pyx_XGOTREF(__pyx_t_4);
-          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1119, __pyx_L24_except_error)
+          __pyx_t_5 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1154, __pyx_L24_except_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1119, __pyx_L24_except_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1154, __pyx_L24_except_error)
           __Pyx_GOTREF(__pyx_t_13);
           __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (__pyx_t_11 < 0) __PYX_ERR(0, 1119, __pyx_L24_except_error)
+          if (__pyx_t_11 < 0) __PYX_ERR(0, 1154, __pyx_L24_except_error)
           __pyx_t_12 = (!__pyx_t_11);
           if (unlikely(__pyx_t_12)) {
             __Pyx_GIVEREF(__pyx_t_1);
             __Pyx_GIVEREF(__pyx_t_3);
             __Pyx_XGIVEREF(__pyx_t_4);
             __Pyx_ErrRestoreWithState(__pyx_t_1, __pyx_t_3, __pyx_t_4);
             __pyx_t_1 = 0; __pyx_t_3 = 0; __pyx_t_4 = 0; 
-            __PYX_ERR(0, 1119, __pyx_L24_except_error)
+            __PYX_ERR(0, 1154, __pyx_L24_except_error)
           }
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           goto __pyx_L23_exception_handled;
         }
         __pyx_L24_except_error:;
@@ -39821,29 +40288,29 @@
         __Pyx_XGIVEREF(__pyx_t_8);
         __Pyx_ExceptionReset(__pyx_t_10, __pyx_t_9, __pyx_t_8);
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_6) {
-          __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
+          __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1119, __pyx_L1_error)
+          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1154, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
         goto __pyx_L21;
       }
       __pyx_L19_return: {
         __pyx_t_14 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_6) {
-          __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
+          __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1119, __pyx_L1_error)
+          if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1154, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         }
         __pyx_r = __pyx_t_14;
         __pyx_t_14 = 0;
         goto __pyx_L0;
       }
@@ -39852,15 +40319,15 @@
     goto __pyx_L31;
     __pyx_L18_error:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     goto __pyx_L1_error;
     __pyx_L31:;
   }
 
-  /* "sat_toolkit/formula.pyx":1099
+  /* "sat_toolkit/formula.pyx":1134
  *             return cnf
  * 
  *     def _minimize_dimacs(self, args: List[str], outfile: str) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         calls args with self.to_dimacs() as stdin, waits for the command to
  */
 
@@ -39879,15 +40346,15 @@
   __Pyx_XDECREF(__pyx_v_minimizer);
   __Pyx_XDECREF(__pyx_v_f);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1122
+/* "sat_toolkit/formula.pyx":1157
  *             return CNF.from_dimacs(f.read())
  * 
  *     def minimize_lingeling(self, optlevel=None, timeout=0, extra_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses Lingeling to minimize the given CNF.
  */
 
@@ -39930,15 +40397,15 @@
   #endif
   #endif
   __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
   {
     PyObject **__pyx_pyargnames[] = {&__pyx_n_s_optlevel,&__pyx_n_s_timeout,&__pyx_n_s_extra_args,0};
     values[0] = __Pyx_Arg_NewRef_FASTCALL(((PyObject *)Py_None));
     values[1] = __Pyx_Arg_NewRef_FASTCALL(((PyObject *)__pyx_int_0));
-    values[2] = __Pyx_Arg_NewRef_FASTCALL(__pyx_k__36);
+    values[2] = __Pyx_Arg_NewRef_FASTCALL(__pyx_k__38);
     if (__pyx_kwds) {
       Py_ssize_t kw_args;
       switch (__pyx_nargs) {
         case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
@@ -39949,34 +40416,34 @@
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_optlevel);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1122, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1157, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_timeout);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1122, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1157, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_extra_args);
           if (value) { values[2] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1122, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1157, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "minimize_lingeling") < 0)) __PYX_ERR(0, 1122, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "minimize_lingeling") < 0)) __PYX_ERR(0, 1157, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
@@ -39988,15 +40455,15 @@
     }
     __pyx_v_optlevel = values[0];
     __pyx_v_timeout = values[1];
     __pyx_v_extra_args = values[2];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("minimize_lingeling", 0, 0, 3, __pyx_nargs); __PYX_ERR(0, 1122, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("minimize_lingeling", 0, 0, 3, __pyx_nargs); __PYX_ERR(0, 1157, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -40039,146 +40506,146 @@
   int __pyx_t_12;
   struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_t_13 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("minimize_lingeling", 1);
 
-  /* "sat_toolkit/formula.pyx":1133
+  /* "sat_toolkit/formula.pyx":1168
  *         :rtype: CNF
  *         """
  *         cdef int ret_code = 0             # <<<<<<<<<<<<<<
  * 
  *         args = ['lingeling', '-s']
  */
   __pyx_v_ret_code = 0;
 
-  /* "sat_toolkit/formula.pyx":1135
+  /* "sat_toolkit/formula.pyx":1170
  *         cdef int ret_code = 0
  * 
  *         args = ['lingeling', '-s']             # <<<<<<<<<<<<<<
  *         if optlevel is not None:
  *             args += [f'-O{optlevel}']
  */
-  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1135, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_n_u_lingeling);
   __Pyx_GIVEREF(__pyx_n_u_lingeling);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_lingeling)) __PYX_ERR(0, 1135, __pyx_L1_error);
+  if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_lingeling)) __PYX_ERR(0, 1170, __pyx_L1_error);
   __Pyx_INCREF(__pyx_kp_u_s);
   __Pyx_GIVEREF(__pyx_kp_u_s);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 1, __pyx_kp_u_s)) __PYX_ERR(0, 1135, __pyx_L1_error);
+  if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 1, __pyx_kp_u_s)) __PYX_ERR(0, 1170, __pyx_L1_error);
   __pyx_v_args = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1136
+  /* "sat_toolkit/formula.pyx":1171
  * 
  *         args = ['lingeling', '-s']
  *         if optlevel is not None:             # <<<<<<<<<<<<<<
  *             args += [f'-O{optlevel}']
  *         if timeout is not None:
  */
   __pyx_t_2 = (__pyx_v_optlevel != Py_None);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":1137
+    /* "sat_toolkit/formula.pyx":1172
  *         args = ['lingeling', '-s']
  *         if optlevel is not None:
  *             args += [f'-O{optlevel}']             # <<<<<<<<<<<<<<
  *         if timeout is not None:
  *             args += ['-T', f'{timeout}']
  */
-    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_optlevel, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_optlevel, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1172, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_kp_u_O_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_kp_u_O_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1172, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1172, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L1_error);
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1172, __pyx_L1_error);
     __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1137, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1172, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_args, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "sat_toolkit/formula.pyx":1136
+    /* "sat_toolkit/formula.pyx":1171
  * 
  *         args = ['lingeling', '-s']
  *         if optlevel is not None:             # <<<<<<<<<<<<<<
  *             args += [f'-O{optlevel}']
  *         if timeout is not None:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1138
+  /* "sat_toolkit/formula.pyx":1173
  *         if optlevel is not None:
  *             args += [f'-O{optlevel}']
  *         if timeout is not None:             # <<<<<<<<<<<<<<
  *             args += ['-T', f'{timeout}']
  * 
  */
   __pyx_t_2 = (__pyx_v_timeout != Py_None);
   if (__pyx_t_2) {
 
-    /* "sat_toolkit/formula.pyx":1139
+    /* "sat_toolkit/formula.pyx":1174
  *             args += [f'-O{optlevel}']
  *         if timeout is not None:
  *             args += ['-T', f'{timeout}']             # <<<<<<<<<<<<<<
  * 
  *         with NamedTemporaryFile(prefix='lingeling_', suffix='.cnf') as f:
  */
-    __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_v_timeout, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1139, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_v_timeout, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1174, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1139, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1174, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_kp_u_T_2);
     __Pyx_GIVEREF(__pyx_kp_u_T_2);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_T_2)) __PYX_ERR(0, 1139, __pyx_L1_error);
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_T_2)) __PYX_ERR(0, 1174, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_3)) __PYX_ERR(0, 1139, __pyx_L1_error);
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 1, __pyx_t_3)) __PYX_ERR(0, 1174, __pyx_L1_error);
     __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1139, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1174, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_args, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "sat_toolkit/formula.pyx":1138
+    /* "sat_toolkit/formula.pyx":1173
  *         if optlevel is not None:
  *             args += [f'-O{optlevel}']
  *         if timeout is not None:             # <<<<<<<<<<<<<<
  *             args += ['-T', f'{timeout}']
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1141
+  /* "sat_toolkit/formula.pyx":1176
  *             args += ['-T', f'{timeout}']
  * 
  *         with NamedTemporaryFile(prefix='lingeling_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             args += ['-o', f.name]
  *             args += extra_args
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1141, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1176, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1141, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1176, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_prefix, __pyx_n_u_lingeling_2) < 0) __PYX_ERR(0, 1141, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1141, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1141, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_prefix, __pyx_n_u_lingeling_2) < 0) __PYX_ERR(0, 1176, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1176, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1176, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1141, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1176, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1141, __pyx_L5_error)
+    __pyx_t_3 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1176, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_6 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_6)) {
@@ -40190,15 +40657,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1141, __pyx_L5_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1176, __pyx_L5_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __pyx_t_3 = __pyx_t_1;
     __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     /*try:*/ {
@@ -40209,60 +40676,60 @@
         __Pyx_XGOTREF(__pyx_t_8);
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_10);
         /*try:*/ {
           __pyx_v_f = __pyx_t_3;
           __pyx_t_3 = 0;
 
-          /* "sat_toolkit/formula.pyx":1142
+          /* "sat_toolkit/formula.pyx":1177
  * 
  *         with NamedTemporaryFile(prefix='lingeling_', suffix='.cnf') as f:
  *             args += ['-o', f.name]             # <<<<<<<<<<<<<<
  *             args += extra_args
  *             return self._minimize_dimacs(args, f.name)
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1142, __pyx_L9_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1177, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1142, __pyx_L9_error)
+          __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1177, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_INCREF(__pyx_kp_u_o);
           __Pyx_GIVEREF(__pyx_kp_u_o);
-          if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_kp_u_o)) __PYX_ERR(0, 1142, __pyx_L9_error);
+          if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_kp_u_o)) __PYX_ERR(0, 1177, __pyx_L9_error);
           __Pyx_GIVEREF(__pyx_t_3);
-          if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 1142, __pyx_L9_error);
+          if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 1, __pyx_t_3)) __PYX_ERR(0, 1177, __pyx_L9_error);
           __pyx_t_3 = 0;
-          __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1142, __pyx_L9_error)
+          __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1177, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF_SET(__pyx_v_args, __pyx_t_3);
           __pyx_t_3 = 0;
 
-          /* "sat_toolkit/formula.pyx":1143
+          /* "sat_toolkit/formula.pyx":1178
  *         with NamedTemporaryFile(prefix='lingeling_', suffix='.cnf') as f:
  *             args += ['-o', f.name]
  *             args += extra_args             # <<<<<<<<<<<<<<
  *             return self._minimize_dimacs(args, f.name)
  * 
  */
-          __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_v_extra_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1143, __pyx_L9_error)
+          __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_v_args, __pyx_v_extra_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1178, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF_SET(__pyx_v_args, __pyx_t_3);
           __pyx_t_3 = 0;
 
-          /* "sat_toolkit/formula.pyx":1144
+          /* "sat_toolkit/formula.pyx":1179
  *             args += ['-o', f.name]
  *             args += extra_args
  *             return self._minimize_dimacs(args, f.name)             # <<<<<<<<<<<<<<
  * 
  * 
  */
           __Pyx_XDECREF((PyObject *)__pyx_r);
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_minimize_dimacs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1144, __pyx_L9_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_minimize_dimacs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1179, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L9_error)
+          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L9_error)
           __Pyx_GOTREF(__pyx_t_1);
           __pyx_t_6 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_4))) {
             __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
             if (likely(__pyx_t_6)) {
@@ -40275,60 +40742,60 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[3] = {__pyx_t_6, __pyx_v_args, __pyx_t_1};
             __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1144, __pyx_L9_error)
+            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1179, __pyx_L9_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           }
-          if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1144, __pyx_L9_error)
+          if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1179, __pyx_L9_error)
           __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_3);
           __pyx_t_3 = 0;
           goto __pyx_L13_try_return;
 
-          /* "sat_toolkit/formula.pyx":1141
+          /* "sat_toolkit/formula.pyx":1176
  *             args += ['-T', f'{timeout}']
  * 
  *         with NamedTemporaryFile(prefix='lingeling_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             args += ['-o', f.name]
  *             args += extra_args
  */
         }
         __pyx_L9_error:;
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF.minimize_lingeling", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_3, &__pyx_t_4, &__pyx_t_1) < 0) __PYX_ERR(0, 1141, __pyx_L11_except_error)
+          if (__Pyx_GetException(&__pyx_t_3, &__pyx_t_4, &__pyx_t_1) < 0) __PYX_ERR(0, 1176, __pyx_L11_except_error)
           __Pyx_XGOTREF(__pyx_t_3);
           __Pyx_XGOTREF(__pyx_t_4);
           __Pyx_XGOTREF(__pyx_t_1);
-          __pyx_t_6 = PyTuple_Pack(3, __pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1141, __pyx_L11_except_error)
+          __pyx_t_6 = PyTuple_Pack(3, __pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1176, __pyx_L11_except_error)
           __Pyx_GOTREF(__pyx_t_6);
           __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, NULL);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1141, __pyx_L11_except_error)
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1176, __pyx_L11_except_error)
           __Pyx_GOTREF(__pyx_t_11);
           __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-          if (__pyx_t_2 < 0) __PYX_ERR(0, 1141, __pyx_L11_except_error)
+          if (__pyx_t_2 < 0) __PYX_ERR(0, 1176, __pyx_L11_except_error)
           __pyx_t_12 = (!__pyx_t_2);
           if (unlikely(__pyx_t_12)) {
             __Pyx_GIVEREF(__pyx_t_3);
             __Pyx_GIVEREF(__pyx_t_4);
             __Pyx_XGIVEREF(__pyx_t_1);
             __Pyx_ErrRestoreWithState(__pyx_t_3, __pyx_t_4, __pyx_t_1);
             __pyx_t_3 = 0; __pyx_t_4 = 0; __pyx_t_1 = 0; 
-            __PYX_ERR(0, 1141, __pyx_L11_except_error)
+            __PYX_ERR(0, 1176, __pyx_L11_except_error)
           }
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           goto __pyx_L10_exception_handled;
         }
         __pyx_L11_except_error:;
@@ -40349,29 +40816,29 @@
         __Pyx_XGIVEREF(__pyx_t_10);
         __Pyx_ExceptionReset(__pyx_t_8, __pyx_t_9, __pyx_t_10);
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_5) {
-          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__35, NULL);
+          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1141, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1176, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         goto __pyx_L8;
       }
       __pyx_L6_return: {
         __pyx_t_13 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_5) {
-          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__35, NULL);
+          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1141, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1176, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __pyx_r = __pyx_t_13;
         __pyx_t_13 = 0;
         goto __pyx_L0;
       }
@@ -40380,15 +40847,15 @@
     goto __pyx_L18;
     __pyx_L5_error:;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     goto __pyx_L1_error;
     __pyx_L18:;
   }
 
-  /* "sat_toolkit/formula.pyx":1122
+  /* "sat_toolkit/formula.pyx":1157
  *             return CNF.from_dimacs(f.read())
  * 
  *     def minimize_lingeling(self, optlevel=None, timeout=0, extra_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses Lingeling to minimize the given CNF.
  */
 
@@ -40406,15 +40873,15 @@
   __Pyx_XDECREF(__pyx_v_args);
   __Pyx_XDECREF(__pyx_v_f);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1148
+/* "sat_toolkit/formula.pyx":1183
  * 
  * 
  *     def solve_dimacs(self, command: List[str], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS the compliant sat solver given by command.
  */
 
@@ -40472,27 +40939,27 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_command)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1148, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1183, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_verbose);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1148, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1183, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "solve_dimacs") < 0)) __PYX_ERR(0, 1148, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "solve_dimacs") < 0)) __PYX_ERR(0, 1183, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         break;
@@ -40500,15 +40967,15 @@
       }
     }
     __pyx_v_command = values[0];
     __pyx_v_verbose = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("solve_dimacs", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 1148, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("solve_dimacs", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 1183, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -40573,126 +41040,126 @@
   int __pyx_t_25;
   PyObject *__pyx_t_26 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("solve_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":1155
+  /* "sat_toolkit/formula.pyx":1190
  *         Returns (False, None) for UNSAT instances.
  *         """
  *         cdef int echo_comments, ret_code = 0             # <<<<<<<<<<<<<<
  *         cdef uint8_t[:] result_view
  * 
  */
   __pyx_v_ret_code = 0;
 
-  /* "sat_toolkit/formula.pyx":1158
+  /* "sat_toolkit/formula.pyx":1193
  *         cdef uint8_t[:] result_view
  * 
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)             # <<<<<<<<<<<<<<
  *         result_view = result
  *         echo_comments = verbose
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1158, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1158, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_long((__pyx_v_self->__pyx_base.nvars + 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1158, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_long((__pyx_v_self->__pyx_base.nvars + 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1158, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1158, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error);
   __Pyx_INCREF(__pyx_int_255);
   __Pyx_GIVEREF(__pyx_int_255);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_255)) __PYX_ERR(0, 1158, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_255)) __PYX_ERR(0, 1193, __pyx_L1_error);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1158, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1158, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1158, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1158, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1158, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_result = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1159
+  /* "sat_toolkit/formula.pyx":1194
  * 
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)
  *         result_view = result             # <<<<<<<<<<<<<<
  *         echo_comments = verbose
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1159, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1194, __pyx_L1_error)
   __pyx_v_result_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1160
+  /* "sat_toolkit/formula.pyx":1195
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)
  *         result_view = result
  *         echo_comments = verbose             # <<<<<<<<<<<<<<
  * 
  *         cdef int32_t[::1] buf = None;
  */
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_verbose); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1160, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_verbose); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1195, __pyx_L1_error)
   __pyx_v_echo_comments = __pyx_t_7;
 
-  /* "sat_toolkit/formula.pyx":1162
+  /* "sat_toolkit/formula.pyx":1197
  *         echo_comments = verbose
  * 
  *         cdef int32_t[::1] buf = None;             # <<<<<<<<<<<<<<
  *         cdef int32_t lit
  *         cdef ssize_t i
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(Py_None, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1162, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(Py_None, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1197, __pyx_L1_error)
   __pyx_v_buf = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1165
+  /* "sat_toolkit/formula.pyx":1200
  *         cdef int32_t lit
  *         cdef ssize_t i
  *         cdef bint is_sat = False             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_v_is_sat = 0;
 
-  /* "sat_toolkit/formula.pyx":1168
+  /* "sat_toolkit/formula.pyx":1203
  * 
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             f.write(self.to_dimacs())
  *             f.flush()
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1168, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1203, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1168, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_prefix, __pyx_n_u_sat_toolkit) < 0) __PYX_ERR(0, 1168, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1168, __pyx_L1_error)
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__37, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1168, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_prefix, __pyx_n_u_sat_toolkit) < 0) __PYX_ERR(0, 1203, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1203, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__39, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1203, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_9 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_exit); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1168, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_exit); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1203, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1168, __pyx_L3_error)
+    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_3, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1203, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_2)) {
@@ -40704,15 +41171,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1168, __pyx_L3_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __pyx_t_5 = __pyx_t_1;
     __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     /*try:*/ {
@@ -40723,24 +41190,24 @@
         __Pyx_XGOTREF(__pyx_t_10);
         __Pyx_XGOTREF(__pyx_t_11);
         __Pyx_XGOTREF(__pyx_t_12);
         /*try:*/ {
           __pyx_v_f = __pyx_t_5;
           __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1169
+          /* "sat_toolkit/formula.pyx":1204
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:
  *             f.write(self.to_dimacs())             # <<<<<<<<<<<<<<
  *             f.flush()
  * 
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1169, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1204, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1169, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1204, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
           __pyx_t_4 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_2))) {
             __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
             if (likely(__pyx_t_4)) {
@@ -40752,15 +41219,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1169, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           }
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
@@ -40775,28 +41242,28 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_1};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1169, __pyx_L7_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1204, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1170
+          /* "sat_toolkit/formula.pyx":1205
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:
  *             f.write(self.to_dimacs())
  *             f.flush()             # <<<<<<<<<<<<<<
  * 
  *             args = command + [f.name]
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_flush); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1170, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_flush); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1205, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_1 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
             __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
             if (likely(__pyx_t_1)) {
@@ -40808,83 +41275,83 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1170, __pyx_L7_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1205, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1172
+          /* "sat_toolkit/formula.pyx":1207
  *             f.flush()
  * 
  *             args = command + [f.name]             # <<<<<<<<<<<<<<
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1172, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1207, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1172, __pyx_L7_error)
+          __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1207, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_GIVEREF(__pyx_t_5);
-          if (__Pyx_PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_5)) __PYX_ERR(0, 1172, __pyx_L7_error);
+          if (__Pyx_PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_5)) __PYX_ERR(0, 1207, __pyx_L7_error);
           __pyx_t_5 = 0;
-          __pyx_t_5 = PyNumber_Add(__pyx_v_command, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1172, __pyx_L7_error)
+          __pyx_t_5 = PyNumber_Add(__pyx_v_command, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1207, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __pyx_v_args = __pyx_t_5;
           __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1173
+          /* "sat_toolkit/formula.pyx":1208
  * 
  *             args = command + [f.name]
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:             # <<<<<<<<<<<<<<
  * 
  *                 for line in solver.stdout:
  */
           /*with:*/ {
-            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1173, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_Popen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1173, __pyx_L7_error)
+            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_Popen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1173, __pyx_L7_error)
+            __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_INCREF(__pyx_v_args);
             __Pyx_GIVEREF(__pyx_v_args);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_args)) __PYX_ERR(0, 1173, __pyx_L7_error);
-            __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1173, __pyx_L7_error)
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_args)) __PYX_ERR(0, 1208, __pyx_L7_error);
+            __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
-            __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1173, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
-            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_DEVNULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1173, __pyx_L7_error)
+            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_DEVNULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_stdin, __pyx_t_4) < 0) __PYX_ERR(0, 1173, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_stdin, __pyx_t_4) < 0) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1173, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1173, __pyx_L7_error)
+            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_stdout, __pyx_t_2) < 0) __PYX_ERR(0, 1173, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_stdout, __pyx_t_2) < 0) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1173, __pyx_L7_error)
-            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1173, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1208, __pyx_L7_error)
+            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __pyx_t_13 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1173, __pyx_L7_error)
+            __pyx_t_13 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1208, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1173, __pyx_L13_error)
+            __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1208, __pyx_L13_error)
             __Pyx_GOTREF(__pyx_t_5);
             __pyx_t_3 = NULL;
             __pyx_t_7 = 0;
             #if CYTHON_UNPACK_METHODS
             if (likely(PyMethod_Check(__pyx_t_5))) {
               __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
               if (likely(__pyx_t_3)) {
@@ -40896,15 +41363,15 @@
               }
             }
             #endif
             {
               PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
               __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
               __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1173, __pyx_L13_error)
+              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1208, __pyx_L13_error)
               __Pyx_GOTREF(__pyx_t_1);
               __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             }
             __pyx_t_5 = __pyx_t_1;
             __pyx_t_1 = 0;
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
             /*try:*/ {
@@ -40915,127 +41382,127 @@
                 __Pyx_XGOTREF(__pyx_t_14);
                 __Pyx_XGOTREF(__pyx_t_15);
                 __Pyx_XGOTREF(__pyx_t_16);
                 /*try:*/ {
                   __pyx_v_solver = __pyx_t_5;
                   __pyx_t_5 = 0;
 
-                  /* "sat_toolkit/formula.pyx":1175
+                  /* "sat_toolkit/formula.pyx":1210
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  *                 for line in solver.stdout:             # <<<<<<<<<<<<<<
  *                     if echo_comments:
  *                         print(line, end='')
  */
-                  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_stdout); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1175, __pyx_L17_error)
+                  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_stdout); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1210, __pyx_L17_error)
                   __Pyx_GOTREF(__pyx_t_5);
                   if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
                     __pyx_t_2 = __pyx_t_5; __Pyx_INCREF(__pyx_t_2);
                     __pyx_t_17 = 0;
                     __pyx_t_18 = NULL;
                   } else {
-                    __pyx_t_17 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1175, __pyx_L17_error)
+                    __pyx_t_17 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1210, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_2);
-                    __pyx_t_18 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1175, __pyx_L17_error)
+                    __pyx_t_18 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1210, __pyx_L17_error)
                   }
                   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                   for (;;) {
                     if (likely(!__pyx_t_18)) {
                       if (likely(PyList_CheckExact(__pyx_t_2))) {
                         {
                           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_2);
                           #if !CYTHON_ASSUME_SAFE_MACROS
-                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1175, __pyx_L17_error)
+                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1210, __pyx_L17_error)
                           #endif
                           if (__pyx_t_17 >= __pyx_temp) break;
                         }
                         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1175, __pyx_L17_error)
+                        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1210, __pyx_L17_error)
                         #else
-                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1175, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1210, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         #endif
                       } else {
                         {
                           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_2);
                           #if !CYTHON_ASSUME_SAFE_MACROS
-                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1175, __pyx_L17_error)
+                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1210, __pyx_L17_error)
                           #endif
                           if (__pyx_t_17 >= __pyx_temp) break;
                         }
                         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1175, __pyx_L17_error)
+                        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1210, __pyx_L17_error)
                         #else
-                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1175, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1210, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         #endif
                       }
                     } else {
                       __pyx_t_5 = __pyx_t_18(__pyx_t_2);
                       if (unlikely(!__pyx_t_5)) {
                         PyObject* exc_type = PyErr_Occurred();
                         if (exc_type) {
                           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                          else __PYX_ERR(0, 1175, __pyx_L17_error)
+                          else __PYX_ERR(0, 1210, __pyx_L17_error)
                         }
                         break;
                       }
                       __Pyx_GOTREF(__pyx_t_5);
                     }
                     __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_5);
                     __pyx_t_5 = 0;
 
-                    /* "sat_toolkit/formula.pyx":1176
+                    /* "sat_toolkit/formula.pyx":1211
  * 
  *                 for line in solver.stdout:
  *                     if echo_comments:             # <<<<<<<<<<<<<<
  *                         print(line, end='')
  * 
  */
                     __pyx_t_19 = (__pyx_v_echo_comments != 0);
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1177
+                      /* "sat_toolkit/formula.pyx":1212
  *                 for line in solver.stdout:
  *                     if echo_comments:
  *                         print(line, end='')             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('c '):
  */
-                      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1177, __pyx_L17_error)
+                      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1212, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_INCREF(__pyx_v_line);
                       __Pyx_GIVEREF(__pyx_v_line);
-                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_line)) __PYX_ERR(0, 1177, __pyx_L17_error);
-                      __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L17_error)
+                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_line)) __PYX_ERR(0, 1212, __pyx_L17_error);
+                      __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
-                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_end, __pyx_kp_u__10) < 0) __PYX_ERR(0, 1177, __pyx_L17_error)
-                      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1177, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_end, __pyx_kp_u__10) < 0) __PYX_ERR(0, 1212, __pyx_L17_error)
+                      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1212, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-                      /* "sat_toolkit/formula.pyx":1176
+                      /* "sat_toolkit/formula.pyx":1211
  * 
  *                 for line in solver.stdout:
  *                     if echo_comments:             # <<<<<<<<<<<<<<
  *                         print(line, end='')
  * 
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1179
+                    /* "sat_toolkit/formula.pyx":1214
  *                         print(line, end='')
  * 
  *                     if line.startswith('c '):             # <<<<<<<<<<<<<<
  *                         continue
  * 
  */
-                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L17_error)
+                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1214, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_1);
                     __pyx_t_5 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_1))) {
                       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
                       if (likely(__pyx_t_5)) {
@@ -41047,48 +41514,48 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_kp_u_c_2};
                       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1179, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1214, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1179, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1214, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1180
+                      /* "sat_toolkit/formula.pyx":1215
  * 
  *                     if line.startswith('c '):
  *                         continue             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('s '):
  */
                       goto __pyx_L23_continue;
 
-                      /* "sat_toolkit/formula.pyx":1179
+                      /* "sat_toolkit/formula.pyx":1214
  *                         print(line, end='')
  * 
  *                     if line.startswith('c '):             # <<<<<<<<<<<<<<
  *                         continue
  * 
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1182
+                    /* "sat_toolkit/formula.pyx":1217
  *                         continue
  * 
  *                     if line.startswith('s '):             # <<<<<<<<<<<<<<
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  */
-                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L17_error)
+                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1217, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_1);
                     __pyx_t_5 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_1))) {
                       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
                       if (likely(__pyx_t_5)) {
@@ -41100,32 +41567,32 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_kp_u_s_2};
                       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1182, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1217, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1182, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1217, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1183
+                      /* "sat_toolkit/formula.pyx":1218
  * 
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()             # <<<<<<<<<<<<<<
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  */
-                      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1183, __pyx_L17_error)
+                      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__40, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1218, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
-                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_strip); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1183, __pyx_L17_error)
+                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_strip); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1218, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                       __pyx_t_1 = NULL;
                       __pyx_t_7 = 0;
                       #if CYTHON_UNPACK_METHODS
                       if (likely(PyMethod_Check(__pyx_t_5))) {
                         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
@@ -41138,118 +41605,118 @@
                         }
                       }
                       #endif
                       {
                         PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
                         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
                         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-                        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1183, __pyx_L17_error)
+                        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1218, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_3);
                         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       }
                       __Pyx_DECREF_SET(__pyx_v_line, __pyx_t_3);
                       __pyx_t_3 = 0;
 
-                      /* "sat_toolkit/formula.pyx":1184
+                      /* "sat_toolkit/formula.pyx":1219
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  */
-                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_SATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1184, __pyx_L17_error)
+                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_SATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1219, __pyx_L17_error)
                       if (__pyx_t_19) {
 
-                        /* "sat_toolkit/formula.pyx":1185
+                        /* "sat_toolkit/formula.pyx":1220
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True             # <<<<<<<<<<<<<<
  *                         elif line == 'UNSATISFIABLE':
  *                             is_sat = False
  */
                         __pyx_v_is_sat = 1;
 
-                        /* "sat_toolkit/formula.pyx":1184
+                        /* "sat_toolkit/formula.pyx":1219
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  */
                         goto __pyx_L28;
                       }
 
-                      /* "sat_toolkit/formula.pyx":1186
+                      /* "sat_toolkit/formula.pyx":1221
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = False
  *                         else:
  */
-                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_UNSATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1186, __pyx_L17_error)
+                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_UNSATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1221, __pyx_L17_error)
                       if (likely(__pyx_t_19)) {
 
-                        /* "sat_toolkit/formula.pyx":1187
+                        /* "sat_toolkit/formula.pyx":1222
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  *                             is_sat = False             # <<<<<<<<<<<<<<
  *                         else:
  *                             raise ValueError(f'unknown status: {line}')
  */
                         __pyx_v_is_sat = 0;
 
-                        /* "sat_toolkit/formula.pyx":1186
+                        /* "sat_toolkit/formula.pyx":1221
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = False
  *                         else:
  */
                         goto __pyx_L28;
                       }
 
-                      /* "sat_toolkit/formula.pyx":1189
+                      /* "sat_toolkit/formula.pyx":1224
  *                             is_sat = False
  *                         else:
  *                             raise ValueError(f'unknown status: {line}')             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('v '):
  */
                       /*else*/ {
-                        __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_v_line, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1189, __pyx_L17_error)
+                        __pyx_t_3 = __Pyx_PyObject_FormatSimple(__pyx_v_line, __pyx_empty_unicode); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1224, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_3);
-                        __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_kp_u_unknown_status, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1189, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_kp_u_unknown_status, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1224, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1189, __pyx_L17_error)
+                        __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1224, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_3);
                         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                         __Pyx_Raise(__pyx_t_3, 0, 0, 0);
                         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                        __PYX_ERR(0, 1189, __pyx_L17_error)
+                        __PYX_ERR(0, 1224, __pyx_L17_error)
                       }
                       __pyx_L28:;
 
-                      /* "sat_toolkit/formula.pyx":1182
+                      /* "sat_toolkit/formula.pyx":1217
  *                         continue
  * 
  *                     if line.startswith('s '):             # <<<<<<<<<<<<<<
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1191
+                    /* "sat_toolkit/formula.pyx":1226
  *                             raise ValueError(f'unknown status: {line}')
  * 
  *                     if line.startswith('v '):             # <<<<<<<<<<<<<<
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  */
-                    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1191, __pyx_L17_error)
+                    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1226, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_5);
                     __pyx_t_1 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_5))) {
                       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
                       if (likely(__pyx_t_1)) {
@@ -41261,156 +41728,156 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_kp_u_v};
                       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1191, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1226, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1191, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1226, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1192
+                      /* "sat_toolkit/formula.pyx":1227
  * 
  *                     if line.startswith('v '):
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')             # <<<<<<<<<<<<<<
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  */
-                      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L17_error)
+                      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1227, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_fromstring); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1192, __pyx_L17_error)
+                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_fromstring); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1227, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L17_error)
+                      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__40, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1227, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L17_error)
+                      __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1227, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
                       __Pyx_GIVEREF(__pyx_t_3);
-                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L17_error);
+                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1227, __pyx_L17_error);
                       __pyx_t_3 = 0;
-                      __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1192, __pyx_L17_error)
+                      __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1227, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1192, __pyx_L17_error)
+                      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1227, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_4);
-                      __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1192, __pyx_L17_error)
+                      __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1227, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_20);
                       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_20) < 0) __PYX_ERR(0, 1192, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_20) < 0) __PYX_ERR(0, 1227, __pyx_L17_error)
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_sep, __pyx_kp_u__32) < 0) __PYX_ERR(0, 1192, __pyx_L17_error)
-                      __pyx_t_20 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1192, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_sep, __pyx_kp_u__34) < 0) __PYX_ERR(0, 1227, __pyx_L17_error)
+                      __pyx_t_20 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1227, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_20);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(__pyx_t_20, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1192, __pyx_L17_error)
+                      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(__pyx_t_20, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1227, __pyx_L17_error)
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                       __PYX_XCLEAR_MEMVIEW(&__pyx_v_buf, 1);
                       __pyx_v_buf = __pyx_t_8;
                       __pyx_t_8.memview = NULL;
                       __pyx_t_8.data = NULL;
 
-                      /* "sat_toolkit/formula.pyx":1193
+                      /* "sat_toolkit/formula.pyx":1228
  *                     if line.startswith('v '):
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):             # <<<<<<<<<<<<<<
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:
  */
                       __pyx_t_21 = (__pyx_v_buf.shape[0]);
                       __pyx_t_22 = __pyx_t_21;
                       for (__pyx_t_23 = 0; __pyx_t_23 < __pyx_t_22; __pyx_t_23+=1) {
                         __pyx_v_i = __pyx_t_23;
 
-                        /* "sat_toolkit/formula.pyx":1194
+                        /* "sat_toolkit/formula.pyx":1229
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]             # <<<<<<<<<<<<<<
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')
  */
                         __pyx_t_24 = __pyx_v_i;
                         __pyx_v_lit = (*((__pyx_t_11sat_toolkit_5types_int32_t *) ( /* dim=0 */ ((char *) (((__pyx_t_11sat_toolkit_5types_int32_t *) __pyx_v_buf.data) + __pyx_t_24)) )));
 
-                        /* "sat_toolkit/formula.pyx":1195
+                        /* "sat_toolkit/formula.pyx":1230
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:             # <<<<<<<<<<<<<<
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0
  */
                         __pyx_t_19 = (__pyx_f_11sat_toolkit_7formula_abs(__pyx_v_lit) >= (__pyx_v_result_view.shape[0]));
                         if (unlikely(__pyx_t_19)) {
 
-                          /* "sat_toolkit/formula.pyx":1196
+                          /* "sat_toolkit/formula.pyx":1231
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')             # <<<<<<<<<<<<<<
  *                             result_view[abs(lit)] = lit > 0
  * 
  */
-                          __pyx_t_20 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1196, __pyx_L17_error)
+                          __pyx_t_20 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__41, NULL); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1231, __pyx_L17_error)
                           __Pyx_GOTREF(__pyx_t_20);
                           __Pyx_Raise(__pyx_t_20, 0, 0, 0);
                           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                          __PYX_ERR(0, 1196, __pyx_L17_error)
+                          __PYX_ERR(0, 1231, __pyx_L17_error)
 
-                          /* "sat_toolkit/formula.pyx":1195
+                          /* "sat_toolkit/formula.pyx":1230
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:             # <<<<<<<<<<<<<<
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0
  */
                         }
 
-                        /* "sat_toolkit/formula.pyx":1197
+                        /* "sat_toolkit/formula.pyx":1232
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
                         __pyx_t_24 = __pyx_f_11sat_toolkit_7formula_abs(__pyx_v_lit);
                         *((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_result_view.data + __pyx_t_24 * __pyx_v_result_view.strides[0]) )) = (__pyx_v_lit > 0);
                       }
 
-                      /* "sat_toolkit/formula.pyx":1191
+                      /* "sat_toolkit/formula.pyx":1226
  *                             raise ValueError(f'unknown status: {line}')
  * 
  *                     if line.startswith('v '):             # <<<<<<<<<<<<<<
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1175
+                    /* "sat_toolkit/formula.pyx":1210
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  *                 for line in solver.stdout:             # <<<<<<<<<<<<<<
  *                     if echo_comments:
  *                         print(line, end='')
  */
                     __pyx_L23_continue:;
                   }
                   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-                  /* "sat_toolkit/formula.pyx":1200
+                  /* "sat_toolkit/formula.pyx":1235
  * 
  * 
  *                 ret_code = solver.wait()             # <<<<<<<<<<<<<<
  *                 if ret_code not in [10, 20]:
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  */
-                  __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_wait); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1200, __pyx_L17_error)
+                  __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_wait); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1235, __pyx_L17_error)
                   __Pyx_GOTREF(__pyx_t_20);
                   __pyx_t_3 = NULL;
                   __pyx_t_7 = 0;
                   #if CYTHON_UNPACK_METHODS
                   if (likely(PyMethod_Check(__pyx_t_20))) {
                     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_20);
                     if (likely(__pyx_t_3)) {
@@ -41422,23 +41889,23 @@
                     }
                   }
                   #endif
                   {
                     PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
                     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
                     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-                    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1200, __pyx_L17_error)
+                    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1235, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_2);
                     __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                   }
-                  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1200, __pyx_L17_error)
+                  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1235, __pyx_L17_error)
                   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                   __pyx_v_ret_code = __pyx_t_7;
 
-                  /* "sat_toolkit/formula.pyx":1201
+                  /* "sat_toolkit/formula.pyx":1236
  * 
  *                 ret_code = solver.wait()
  *                 if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                     # ret == 20 to UNSATISFIABLE (see for example
  */
                   switch (__pyx_v_ret_code) {
@@ -41449,31 +41916,31 @@
                     default:
                     __pyx_t_19 = 1;
                     break;
                   }
                   __pyx_t_25 = __pyx_t_19;
                   if (unlikely(__pyx_t_25)) {
 
-                    /* "sat_toolkit/formula.pyx":1205
+                    /* "sat_toolkit/formula.pyx":1240
  *                     # ret == 20 to UNSATISFIABLE (see for example
  *                     # http://www.satcompetition.org/2004/format-solvers2004.html)
  *                     raise sp.CalledProcessError(ret_code, ' '.join(solver.args))             # <<<<<<<<<<<<<<
  * 
  *                 is_sat = ret_code == 10
  */
-                    __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_sp); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1205, __pyx_L17_error)
+                    __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_sp); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1240, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_20);
-                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1205, __pyx_L17_error)
+                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1240, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_3);
                     __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                    __pyx_t_20 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1205, __pyx_L17_error)
+                    __pyx_t_20 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1240, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_20);
-                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_args); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L17_error)
+                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_args); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1240, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_1);
-                    __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1205, __pyx_L17_error)
+                    __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__34, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1240, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_5);
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     __pyx_t_1 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (unlikely(PyMethod_Check(__pyx_t_3))) {
                       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
@@ -41488,41 +41955,41 @@
                     #endif
                     {
                       PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_t_20, __pyx_t_5};
                       __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1205, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1240, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_2);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     }
                     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
                     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-                    __PYX_ERR(0, 1205, __pyx_L17_error)
+                    __PYX_ERR(0, 1240, __pyx_L17_error)
 
-                    /* "sat_toolkit/formula.pyx":1201
+                    /* "sat_toolkit/formula.pyx":1236
  * 
  *                 ret_code = solver.wait()
  *                 if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                     # ret == 20 to UNSATISFIABLE (see for example
  */
                   }
 
-                  /* "sat_toolkit/formula.pyx":1207
+                  /* "sat_toolkit/formula.pyx":1242
  *                     raise sp.CalledProcessError(ret_code, ' '.join(solver.args))
  * 
  *                 is_sat = ret_code == 10             # <<<<<<<<<<<<<<
  * 
  *             if is_sat:
  */
                   __pyx_v_is_sat = (__pyx_v_ret_code == 10);
 
-                  /* "sat_toolkit/formula.pyx":1173
+                  /* "sat_toolkit/formula.pyx":1208
  * 
  *             args = command + [f.name]
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:             # <<<<<<<<<<<<<<
  * 
  *                 for line in solver.stdout:
  */
                 }
@@ -41539,36 +42006,36 @@
                 __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
                 __PYX_XCLEAR_MEMVIEW(&__pyx_t_6, 1);
                 __pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;
                 __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
                 __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
                 /*except:*/ {
                   __Pyx_AddTraceback("sat_toolkit.formula.CNF.solve_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-                  if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_3, &__pyx_t_5) < 0) __PYX_ERR(0, 1173, __pyx_L19_except_error)
+                  if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_3, &__pyx_t_5) < 0) __PYX_ERR(0, 1208, __pyx_L19_except_error)
                   __Pyx_XGOTREF(__pyx_t_2);
                   __Pyx_XGOTREF(__pyx_t_3);
                   __Pyx_XGOTREF(__pyx_t_5);
-                  __pyx_t_20 = PyTuple_Pack(3, __pyx_t_2, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1173, __pyx_L19_except_error)
+                  __pyx_t_20 = PyTuple_Pack(3, __pyx_t_2, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1208, __pyx_L19_except_error)
                   __Pyx_GOTREF(__pyx_t_20);
                   __pyx_t_26 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_20, NULL);
                   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
                   __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                  if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 1173, __pyx_L19_except_error)
+                  if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 1208, __pyx_L19_except_error)
                   __Pyx_GOTREF(__pyx_t_26);
                   __pyx_t_25 = __Pyx_PyObject_IsTrue(__pyx_t_26);
                   __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-                  if (__pyx_t_25 < 0) __PYX_ERR(0, 1173, __pyx_L19_except_error)
+                  if (__pyx_t_25 < 0) __PYX_ERR(0, 1208, __pyx_L19_except_error)
                   __pyx_t_19 = (!__pyx_t_25);
                   if (unlikely(__pyx_t_19)) {
                     __Pyx_GIVEREF(__pyx_t_2);
                     __Pyx_GIVEREF(__pyx_t_3);
                     __Pyx_XGIVEREF(__pyx_t_5);
                     __Pyx_ErrRestoreWithState(__pyx_t_2, __pyx_t_3, __pyx_t_5);
                     __pyx_t_2 = 0; __pyx_t_3 = 0; __pyx_t_5 = 0; 
-                    __PYX_ERR(0, 1173, __pyx_L19_except_error)
+                    __PYX_ERR(0, 1208, __pyx_L19_except_error)
                   }
                   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
                   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
                   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
                   goto __pyx_L18_exception_handled;
                 }
                 __pyx_L19_except_error:;
@@ -41584,84 +42051,84 @@
                 __Pyx_ExceptionReset(__pyx_t_14, __pyx_t_15, __pyx_t_16);
                 __pyx_L22_try_end:;
               }
             }
             /*finally:*/ {
               /*normal exit:*/{
                 if (__pyx_t_13) {
-                  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_tuple__35, NULL);
+                  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_tuple__37, NULL);
                   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                  if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1173, __pyx_L7_error)
+                  if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1208, __pyx_L7_error)
                   __Pyx_GOTREF(__pyx_t_16);
                   __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                 }
                 goto __pyx_L16;
               }
               __pyx_L16:;
             }
             goto __pyx_L38;
             __pyx_L13_error:;
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
             goto __pyx_L7_error;
             __pyx_L38:;
           }
 
-          /* "sat_toolkit/formula.pyx":1209
+          /* "sat_toolkit/formula.pyx":1244
  *                 is_sat = ret_code == 10
  * 
  *             if is_sat:             # <<<<<<<<<<<<<<
  *                 return True, result
  *             else:
  */
           if (__pyx_v_is_sat) {
 
-            /* "sat_toolkit/formula.pyx":1210
+            /* "sat_toolkit/formula.pyx":1245
  * 
  *             if is_sat:
  *                 return True, result             # <<<<<<<<<<<<<<
  *             else:
  *                 return False, None
  */
             __Pyx_XDECREF(__pyx_r);
-            __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1210, __pyx_L7_error)
+            __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1245, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_INCREF(Py_True);
             __Pyx_GIVEREF(Py_True);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, Py_True)) __PYX_ERR(0, 1210, __pyx_L7_error);
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, Py_True)) __PYX_ERR(0, 1245, __pyx_L7_error);
             __Pyx_INCREF(__pyx_v_result);
             __Pyx_GIVEREF(__pyx_v_result);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_result)) __PYX_ERR(0, 1210, __pyx_L7_error);
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_result)) __PYX_ERR(0, 1245, __pyx_L7_error);
             __pyx_r = __pyx_t_5;
             __pyx_t_5 = 0;
             goto __pyx_L11_try_return;
 
-            /* "sat_toolkit/formula.pyx":1209
+            /* "sat_toolkit/formula.pyx":1244
  *                 is_sat = ret_code == 10
  * 
  *             if is_sat:             # <<<<<<<<<<<<<<
  *                 return True, result
  *             else:
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1212
+          /* "sat_toolkit/formula.pyx":1247
  *                 return True, result
  *             else:
  *                 return False, None             # <<<<<<<<<<<<<<
  * 
  * 
  */
           /*else*/ {
             __Pyx_XDECREF(__pyx_r);
-            __Pyx_INCREF(__pyx_tuple__40);
-            __pyx_r = __pyx_tuple__40;
+            __Pyx_INCREF(__pyx_tuple__42);
+            __pyx_r = __pyx_tuple__42;
             goto __pyx_L11_try_return;
           }
 
-          /* "sat_toolkit/formula.pyx":1168
+          /* "sat_toolkit/formula.pyx":1203
  * 
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             f.write(self.to_dimacs())
  *             f.flush()
  */
         }
@@ -41674,36 +42141,36 @@
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __PYX_XCLEAR_MEMVIEW(&__pyx_t_6, 1);
         __pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;
         __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
         __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF.solve_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_3, &__pyx_t_2) < 0) __PYX_ERR(0, 1168, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_3, &__pyx_t_2) < 0) __PYX_ERR(0, 1203, __pyx_L9_except_error)
           __Pyx_XGOTREF(__pyx_t_5);
           __Pyx_XGOTREF(__pyx_t_3);
           __Pyx_XGOTREF(__pyx_t_2);
-          __pyx_t_20 = PyTuple_Pack(3, __pyx_t_5, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1168, __pyx_L9_except_error)
+          __pyx_t_20 = PyTuple_Pack(3, __pyx_t_5, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1203, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_20);
           __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_20, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1168, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1203, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_13);
           __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (__pyx_t_19 < 0) __PYX_ERR(0, 1168, __pyx_L9_except_error)
+          if (__pyx_t_19 < 0) __PYX_ERR(0, 1203, __pyx_L9_except_error)
           __pyx_t_25 = (!__pyx_t_19);
           if (unlikely(__pyx_t_25)) {
             __Pyx_GIVEREF(__pyx_t_5);
             __Pyx_GIVEREF(__pyx_t_3);
             __Pyx_XGIVEREF(__pyx_t_2);
             __Pyx_ErrRestoreWithState(__pyx_t_5, __pyx_t_3, __pyx_t_2);
             __pyx_t_5 = 0; __pyx_t_3 = 0; __pyx_t_2 = 0; 
-            __PYX_ERR(0, 1168, __pyx_L9_except_error)
+            __PYX_ERR(0, 1203, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -41724,29 +42191,29 @@
         __Pyx_XGIVEREF(__pyx_t_12);
         __Pyx_ExceptionReset(__pyx_t_10, __pyx_t_11, __pyx_t_12);
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_9) {
-          __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__35, NULL);
+          __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1168, __pyx_L1_error)
+          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1203, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L4_return: {
         __pyx_t_12 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_9) {
-          __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__35, NULL);
+          __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1168, __pyx_L1_error)
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1203, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         }
         __pyx_r = __pyx_t_12;
         __pyx_t_12 = 0;
         goto __pyx_L0;
       }
@@ -41755,15 +42222,15 @@
     goto __pyx_L43;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     goto __pyx_L1_error;
     __pyx_L43:;
   }
 
-  /* "sat_toolkit/formula.pyx":1148
+  /* "sat_toolkit/formula.pyx":1183
  * 
  * 
  *     def solve_dimacs(self, command: List[str], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS the compliant sat solver given by command.
  */
 
@@ -41790,15 +42257,15 @@
   __Pyx_XDECREF(__pyx_v_solver);
   __Pyx_XDECREF(__pyx_v_line);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1216
+/* "sat_toolkit/formula.pyx":1251
  * 
  * 
  *     def check_solution(self, uint8_t[:] solution) -> bool:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  */
 
@@ -41852,31 +42319,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_solution)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1216, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1251, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "check_solution") < 0)) __PYX_ERR(0, 1216, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "check_solution") < 0)) __PYX_ERR(0, 1251, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
-    __pyx_v_solution = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_solution.memview)) __PYX_ERR(0, 1216, __pyx_L3_error)
+    __pyx_v_solution = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_solution.memview)) __PYX_ERR(0, 1251, __pyx_L3_error)
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("check_solution", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1216, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("check_solution", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1251, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -41915,27 +42382,27 @@
   PyObject *__pyx_t_8 = NULL;
   int __pyx_t_9;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("check_solution", 1);
 
-  /* "sat_toolkit/formula.pyx":1218
+  /* "sat_toolkit/formula.pyx":1253
  *     def check_solution(self, uint8_t[:] solution) -> bool:
  *         cdef size_t i
  *         for i in range(solution.shape[0]):             # <<<<<<<<<<<<<<
  *            if solution[i] not in [0, 1]:
  *                raise ValueError(f'all elements in solution must be in [0, 1]')
  */
   __pyx_t_1 = (__pyx_v_solution.shape[0]);
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "sat_toolkit/formula.pyx":1219
+    /* "sat_toolkit/formula.pyx":1254
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  *            if solution[i] not in [0, 1]:             # <<<<<<<<<<<<<<
  *                raise ValueError(f'all elements in solution must be in [0, 1]')
  * 
  */
     __pyx_t_4 = __pyx_v_i;
@@ -41948,53 +42415,53 @@
     }
     __pyx_t_7 = (__pyx_t_5 != 1);
     __pyx_t_6 = __pyx_t_7;
     __pyx_L6_bool_binop_done:;
     __pyx_t_7 = __pyx_t_6;
     if (unlikely(__pyx_t_7)) {
 
-      /* "sat_toolkit/formula.pyx":1220
+      /* "sat_toolkit/formula.pyx":1255
  *         for i in range(solution.shape[0]):
  *            if solution[i] not in [0, 1]:
  *                raise ValueError(f'all elements in solution must be in [0, 1]')             # <<<<<<<<<<<<<<
  * 
  *         return self._check_solution(solution)
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__41, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1220, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__43, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1255, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __PYX_ERR(0, 1220, __pyx_L1_error)
+      __PYX_ERR(0, 1255, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":1219
+      /* "sat_toolkit/formula.pyx":1254
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  *            if solution[i] not in [0, 1]:             # <<<<<<<<<<<<<<
  *                raise ValueError(f'all elements in solution must be in [0, 1]')
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":1222
+  /* "sat_toolkit/formula.pyx":1257
  *                raise ValueError(f'all elements in solution must be in [0, 1]')
  * 
  *         return self._check_solution(solution)             # <<<<<<<<<<<<<<
  * 
  *     cdef int _check_solution(self, uint8_t[:] solution) except -1 nogil:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_9 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_check_solution(__pyx_v_self, __pyx_v_solution); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 1222, __pyx_L1_error)
-  __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1222, __pyx_L1_error)
+  __pyx_t_9 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_check_solution(__pyx_v_self, __pyx_v_solution); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 1257, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1257, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __pyx_r = __pyx_t_8;
   __pyx_t_8 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1216
+  /* "sat_toolkit/formula.pyx":1251
  * 
  * 
  *     def check_solution(self, uint8_t[:] solution) -> bool:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  */
 
@@ -42005,15 +42472,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1224
+/* "sat_toolkit/formula.pyx":1259
  *         return self._check_solution(solution)
  * 
  *     cdef int _check_solution(self, uint8_t[:] solution) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t i, clause_pos, clause_elem
  *         cdef uint8_t expected
  */
 
@@ -42033,146 +42500,146 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   #ifdef WITH_THREAD
   PyGILState_STATE __pyx_gilstate_save;
   #endif
   __Pyx_RefNannySetupContext("_check_solution", 1);
 
-  /* "sat_toolkit/formula.pyx":1228
+  /* "sat_toolkit/formula.pyx":1263
  *         cdef uint8_t expected
  * 
  *         if self.nvars >= solution.shape[0]:             # <<<<<<<<<<<<<<
  *             raise IndexError(f'solution of length {solution.shape[0]} too short for CNF with {self.nvars} variables')
  * 
  */
   __pyx_t_1 = (__pyx_v_self->__pyx_base.nvars >= (__pyx_v_solution.shape[0]));
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1229
+    /* "sat_toolkit/formula.pyx":1264
  * 
  *         if self.nvars >= solution.shape[0]:
  *             raise IndexError(f'solution of length {solution.shape[0]} too short for CNF with {self.nvars} variables')             # <<<<<<<<<<<<<<
  * 
  *         for i in range(self._start_indices.size()):
  */
     {
         #ifdef WITH_THREAD
         PyGILState_STATE __pyx_gilstate_save = __Pyx_PyGILState_Ensure();
         #endif
         /*try:*/ {
-          __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1229, __pyx_L5_error)
+          __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1264, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           __pyx_t_3 = 0;
           __pyx_t_4 = 127;
           __Pyx_INCREF(__pyx_kp_u_solution_of_length);
           __pyx_t_3 += 19;
           __Pyx_GIVEREF(__pyx_kp_u_solution_of_length);
           PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_solution_of_length);
-          __pyx_t_5 = __Pyx_PyUnicode_From_Py_ssize_t((__pyx_v_solution.shape[0]), 0, ' ', 'd'); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1229, __pyx_L5_error)
+          __pyx_t_5 = __Pyx_PyUnicode_From_Py_ssize_t((__pyx_v_solution.shape[0]), 0, ' ', 'd'); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1264, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_5);
           PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_5);
           __pyx_t_5 = 0;
           __Pyx_INCREF(__pyx_kp_u_too_short_for_CNF_with);
           __pyx_t_3 += 24;
           __Pyx_GIVEREF(__pyx_kp_u_too_short_for_CNF_with);
           PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_too_short_for_CNF_with);
-          __pyx_t_5 = __Pyx_PyUnicode_From_int(__pyx_v_self->__pyx_base.nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1229, __pyx_L5_error)
+          __pyx_t_5 = __Pyx_PyUnicode_From_int(__pyx_v_self->__pyx_base.nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1264, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_3 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_5);
           PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_t_5);
           __pyx_t_5 = 0;
           __Pyx_INCREF(__pyx_kp_u_variables_2);
           __pyx_t_3 += 10;
           __Pyx_GIVEREF(__pyx_kp_u_variables_2);
           PyTuple_SET_ITEM(__pyx_t_2, 4, __pyx_kp_u_variables_2);
-          __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_2, 5, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1229, __pyx_L5_error)
+          __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_2, 5, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1264, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1229, __pyx_L5_error)
+          __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_IndexError, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1264, __pyx_L5_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_Raise(__pyx_t_2, 0, 0, 0);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __PYX_ERR(0, 1229, __pyx_L5_error)
+          __PYX_ERR(0, 1264, __pyx_L5_error)
         }
         /*finally:*/ {
           __pyx_L5_error: {
             #ifdef WITH_THREAD
             __Pyx_PyGILState_Release(__pyx_gilstate_save);
             #endif
             goto __pyx_L1_error;
           }
         }
     }
 
-    /* "sat_toolkit/formula.pyx":1228
+    /* "sat_toolkit/formula.pyx":1263
  *         cdef uint8_t expected
  * 
  *         if self.nvars >= solution.shape[0]:             # <<<<<<<<<<<<<<
  *             raise IndexError(f'solution of length {solution.shape[0]} too short for CNF with {self.nvars} variables')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1231
+  /* "sat_toolkit/formula.pyx":1266
  *             raise IndexError(f'solution of length {solution.shape[0]} too short for CNF with {self.nvars} variables')
  * 
  *         for i in range(self._start_indices.size()):             # <<<<<<<<<<<<<<
  *             if not self._check_solution_for_single_clause(i, solution):
  *                 return 0
  */
   __pyx_t_6 = __pyx_v_self->__pyx_base._start_indices.size();
   __pyx_t_7 = __pyx_t_6;
   for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
     __pyx_v_i = __pyx_t_8;
 
-    /* "sat_toolkit/formula.pyx":1232
+    /* "sat_toolkit/formula.pyx":1267
  * 
  *         for i in range(self._start_indices.size()):
  *             if not self._check_solution_for_single_clause(i, solution):             # <<<<<<<<<<<<<<
  *                 return 0
  * 
  */
     __pyx_t_1 = (!(((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_check_solution_for_single_clause(__pyx_v_self, __pyx_v_i, __pyx_v_solution) != 0));
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":1233
+      /* "sat_toolkit/formula.pyx":1268
  *         for i in range(self._start_indices.size()):
  *             if not self._check_solution_for_single_clause(i, solution):
  *                 return 0             # <<<<<<<<<<<<<<
  * 
  *         return 1
  */
       __pyx_r = 0;
       goto __pyx_L0;
 
-      /* "sat_toolkit/formula.pyx":1232
+      /* "sat_toolkit/formula.pyx":1267
  * 
  *         for i in range(self._start_indices.size()):
  *             if not self._check_solution_for_single_clause(i, solution):             # <<<<<<<<<<<<<<
  *                 return 0
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":1235
+  /* "sat_toolkit/formula.pyx":1270
  *                 return 0
  * 
  *         return 1             # <<<<<<<<<<<<<<
  * 
  *     cdef int _check_solution_for_single_clause(self, size_t clause_idx, uint8_t[:] solution) noexcept nogil:
  */
   __pyx_r = 1;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1224
+  /* "sat_toolkit/formula.pyx":1259
  *         return self._check_solution(solution)
  * 
  *     cdef int _check_solution(self, uint8_t[:] solution) except -1 nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t i, clause_pos, clause_elem
  *         cdef uint8_t expected
  */
 
@@ -42189,15 +42656,15 @@
   __Pyx_PyGILState_Release(__pyx_gilstate_save);
   #endif
   __pyx_L0:;
   __Pyx_RefNannyFinishContextNogil()
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1237
+/* "sat_toolkit/formula.pyx":1272
  *         return 1
  * 
  *     cdef int _check_solution_for_single_clause(self, size_t clause_idx, uint8_t[:] solution) noexcept nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t clause_pos
  *         cdef uint8_t expected
  */
 
@@ -42205,144 +42672,144 @@
   size_t __pyx_v_clause_pos;
   __pyx_t_11sat_toolkit_5types_uint8_t __pyx_v_expected;
   int __pyx_v_clause_elem;
   int __pyx_r;
   int __pyx_t_1;
   Py_ssize_t __pyx_t_2;
 
-  /* "sat_toolkit/formula.pyx":1242
+  /* "sat_toolkit/formula.pyx":1277
  *         cdef int clause_elem
  * 
  *         clause_pos = self._start_indices[clause_idx]             # <<<<<<<<<<<<<<
  * 
  *         while self._clauses[clause_pos] != 0:
  */
   __pyx_v_clause_pos = (__pyx_v_self->__pyx_base._start_indices[__pyx_v_clause_idx]);
 
-  /* "sat_toolkit/formula.pyx":1244
+  /* "sat_toolkit/formula.pyx":1279
  *         clause_pos = self._start_indices[clause_idx]
  * 
  *         while self._clauses[clause_pos] != 0:             # <<<<<<<<<<<<<<
  *             clause_elem = self._clauses[clause_pos]
  *             expected = clause_elem > 0
  */
   while (1) {
     __pyx_t_1 = ((__pyx_v_self->__pyx_base._clauses[__pyx_v_clause_pos]) != 0);
     if (!__pyx_t_1) break;
 
-    /* "sat_toolkit/formula.pyx":1245
+    /* "sat_toolkit/formula.pyx":1280
  * 
  *         while self._clauses[clause_pos] != 0:
  *             clause_elem = self._clauses[clause_pos]             # <<<<<<<<<<<<<<
  *             expected = clause_elem > 0
  *             if clause_elem < 0:
  */
     __pyx_v_clause_elem = (__pyx_v_self->__pyx_base._clauses[__pyx_v_clause_pos]);
 
-    /* "sat_toolkit/formula.pyx":1246
+    /* "sat_toolkit/formula.pyx":1281
  *         while self._clauses[clause_pos] != 0:
  *             clause_elem = self._clauses[clause_pos]
  *             expected = clause_elem > 0             # <<<<<<<<<<<<<<
  *             if clause_elem < 0:
  *                 clause_elem = -clause_elem
  */
     __pyx_v_expected = (__pyx_v_clause_elem > 0);
 
-    /* "sat_toolkit/formula.pyx":1247
+    /* "sat_toolkit/formula.pyx":1282
  *             clause_elem = self._clauses[clause_pos]
  *             expected = clause_elem > 0
  *             if clause_elem < 0:             # <<<<<<<<<<<<<<
  *                 clause_elem = -clause_elem
  * 
  */
     __pyx_t_1 = (__pyx_v_clause_elem < 0);
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":1248
+      /* "sat_toolkit/formula.pyx":1283
  *             expected = clause_elem > 0
  *             if clause_elem < 0:
  *                 clause_elem = -clause_elem             # <<<<<<<<<<<<<<
  * 
  *             if expected == solution[clause_elem]:
  */
       __pyx_v_clause_elem = (-__pyx_v_clause_elem);
 
-      /* "sat_toolkit/formula.pyx":1247
+      /* "sat_toolkit/formula.pyx":1282
  *             clause_elem = self._clauses[clause_pos]
  *             expected = clause_elem > 0
  *             if clause_elem < 0:             # <<<<<<<<<<<<<<
  *                 clause_elem = -clause_elem
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":1250
+    /* "sat_toolkit/formula.pyx":1285
  *                 clause_elem = -clause_elem
  * 
  *             if expected == solution[clause_elem]:             # <<<<<<<<<<<<<<
  *                 return True
  * 
  */
     __pyx_t_2 = __pyx_v_clause_elem;
     __pyx_t_1 = (__pyx_v_expected == (*((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_solution.data + __pyx_t_2 * __pyx_v_solution.strides[0]) ))));
     if (__pyx_t_1) {
 
-      /* "sat_toolkit/formula.pyx":1251
+      /* "sat_toolkit/formula.pyx":1286
  * 
  *             if expected == solution[clause_elem]:
  *                 return True             # <<<<<<<<<<<<<<
  * 
  *             clause_pos += 1
  */
       __pyx_r = 1;
       goto __pyx_L0;
 
-      /* "sat_toolkit/formula.pyx":1250
+      /* "sat_toolkit/formula.pyx":1285
  *                 clause_elem = -clause_elem
  * 
  *             if expected == solution[clause_elem]:             # <<<<<<<<<<<<<<
  *                 return True
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":1253
+    /* "sat_toolkit/formula.pyx":1288
  *                 return True
  * 
  *             clause_pos += 1             # <<<<<<<<<<<<<<
  * 
  *         return False
  */
     __pyx_v_clause_pos = (__pyx_v_clause_pos + 1);
   }
 
-  /* "sat_toolkit/formula.pyx":1255
+  /* "sat_toolkit/formula.pyx":1290
  *             clause_pos += 1
  * 
  *         return False             # <<<<<<<<<<<<<<
  * 
  *     def to_truthtable(self) -> Truthtable:
  */
   __pyx_r = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1237
+  /* "sat_toolkit/formula.pyx":1272
  *         return 1
  * 
  *     cdef int _check_solution_for_single_clause(self, size_t clause_idx, uint8_t[:] solution) noexcept nogil:             # <<<<<<<<<<<<<<
  *         cdef size_t clause_pos
  *         cdef uint8_t expected
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1257
+/* "sat_toolkit/formula.pyx":1292
  *         return False
  * 
  *     def to_truthtable(self) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Return the current CNF as a Truthtable by iterating over all possible
  */
 
@@ -42414,63 +42881,63 @@
   size_t __pyx_t_15;
   size_t __pyx_t_16;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_truthtable", 1);
 
-  /* "sat_toolkit/formula.pyx":1266
+  /* "sat_toolkit/formula.pyx":1301
  *         cdef uint8_t[:] current_sol_view
  * 
  *         if self.nvars > 32:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot find all solutions for CNF with more than 32 variables')
  * 
  */
   __pyx_t_1 = (__pyx_v_self->__pyx_base.nvars > 32);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1267
+    /* "sat_toolkit/formula.pyx":1302
  * 
  *         if self.nvars > 32:
  *             raise ValueError('cannot find all solutions for CNF with more than 32 variables')             # <<<<<<<<<<<<<<
  * 
  *         truthtable = np.empty((<uint64_t> 1) << self.nvars, np.uint8)
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1267, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1302, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1267, __pyx_L1_error)
+    __PYX_ERR(0, 1302, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1266
+    /* "sat_toolkit/formula.pyx":1301
  *         cdef uint8_t[:] current_sol_view
  * 
  *         if self.nvars > 32:             # <<<<<<<<<<<<<<
  *             raise ValueError('cannot find all solutions for CNF with more than 32 variables')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1269
+  /* "sat_toolkit/formula.pyx":1304
  *             raise ValueError('cannot find all solutions for CNF with more than 32 variables')
  * 
  *         truthtable = np.empty((<uint64_t> 1) << self.nvars, np.uint8)             # <<<<<<<<<<<<<<
  *         current_sol = np.empty(1 + self.nvars, np.uint8)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1304, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1269, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1304, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_unsigned_long((((__pyx_t_11sat_toolkit_5types_uint64_t)1) << __pyx_v_self->__pyx_base.nvars)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_unsigned_long((((__pyx_t_11sat_toolkit_5types_uint64_t)1) << __pyx_v_self->__pyx_base.nvars)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1304, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1269, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1304, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_uint8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1269, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_uint8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1304, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
@@ -42485,38 +42952,38 @@
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_t_3, __pyx_t_6};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1269, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1304, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
   __pyx_v_truthtable = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1270
+  /* "sat_toolkit/formula.pyx":1305
  * 
  *         truthtable = np.empty((<uint64_t> 1) << self.nvars, np.uint8)
  *         current_sol = np.empty(1 + self.nvars, np.uint8)             # <<<<<<<<<<<<<<
  * 
  *         truthtable_view = truthtable
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1270, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1305, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1270, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1305, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_long((1 + __pyx_v_self->__pyx_base.nvars)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1270, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_long((1 + __pyx_v_self->__pyx_base.nvars)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1305, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1270, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1305, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1270, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1305, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
@@ -42531,120 +42998,120 @@
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_4, __pyx_t_5};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1270, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1305, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __pyx_v_current_sol = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1272
+  /* "sat_toolkit/formula.pyx":1307
  *         current_sol = np.empty(1 + self.nvars, np.uint8)
  * 
  *         truthtable_view = truthtable             # <<<<<<<<<<<<<<
  *         current_sol_view = current_sol
  *         current_sol_view[0] = 0
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_truthtable, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1272, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_truthtable, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1307, __pyx_L1_error)
   __pyx_v_truthtable_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1273
+  /* "sat_toolkit/formula.pyx":1308
  * 
  *         truthtable_view = truthtable
  *         current_sol_view = current_sol             # <<<<<<<<<<<<<<
  *         current_sol_view[0] = 0
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_current_sol, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1273, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_current_sol, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1308, __pyx_L1_error)
   __pyx_v_current_sol_view = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1274
+  /* "sat_toolkit/formula.pyx":1309
  *         truthtable_view = truthtable
  *         current_sol_view = current_sol
  *         current_sol_view[0] = 0             # <<<<<<<<<<<<<<
  * 
  *         for i in range((<uint64_t> 1) << self.nvars):
  */
   __pyx_t_9 = 0;
   *((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_current_sol_view.data + __pyx_t_9 * __pyx_v_current_sol_view.strides[0]) )) = 0;
 
-  /* "sat_toolkit/formula.pyx":1276
+  /* "sat_toolkit/formula.pyx":1311
  *         current_sol_view[0] = 0
  * 
  *         for i in range((<uint64_t> 1) << self.nvars):             # <<<<<<<<<<<<<<
  *             for j in range(1, self.nvars + 1):
  *                 current_sol_view[j] = (i >> (j - 1)) & 1
  */
   __pyx_t_10 = (((__pyx_t_11sat_toolkit_5types_uint64_t)1) << __pyx_v_self->__pyx_base.nvars);
   __pyx_t_11 = __pyx_t_10;
   for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
     __pyx_v_i = __pyx_t_12;
 
-    /* "sat_toolkit/formula.pyx":1277
+    /* "sat_toolkit/formula.pyx":1312
  * 
  *         for i in range((<uint64_t> 1) << self.nvars):
  *             for j in range(1, self.nvars + 1):             # <<<<<<<<<<<<<<
  *                 current_sol_view[j] = (i >> (j - 1)) & 1
  *             truthtable_view[i] = self._check_solution(current_sol_view)
  */
     __pyx_t_13 = (__pyx_v_self->__pyx_base.nvars + 1);
     __pyx_t_14 = __pyx_t_13;
     for (__pyx_t_15 = 1; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
       __pyx_v_j = __pyx_t_15;
 
-      /* "sat_toolkit/formula.pyx":1278
+      /* "sat_toolkit/formula.pyx":1313
  *         for i in range((<uint64_t> 1) << self.nvars):
  *             for j in range(1, self.nvars + 1):
  *                 current_sol_view[j] = (i >> (j - 1)) & 1             # <<<<<<<<<<<<<<
  *             truthtable_view[i] = self._check_solution(current_sol_view)
  *             PyErr_CheckSignals()
  */
       __pyx_t_16 = __pyx_v_j;
       *((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_current_sol_view.data + __pyx_t_16 * __pyx_v_current_sol_view.strides[0]) )) = ((__pyx_v_i >> (__pyx_v_j - 1)) & 1);
     }
 
-    /* "sat_toolkit/formula.pyx":1279
+    /* "sat_toolkit/formula.pyx":1314
  *             for j in range(1, self.nvars + 1):
  *                 current_sol_view[j] = (i >> (j - 1)) & 1
  *             truthtable_view[i] = self._check_solution(current_sol_view)             # <<<<<<<<<<<<<<
  *             PyErr_CheckSignals()
  * 
  */
-    __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_check_solution(__pyx_v_self, __pyx_v_current_sol_view); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 1279, __pyx_L1_error)
+    __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->_check_solution(__pyx_v_self, __pyx_v_current_sol_view); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 1314, __pyx_L1_error)
     __pyx_t_15 = __pyx_v_i;
     *((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_truthtable_view.data + __pyx_t_15 * __pyx_v_truthtable_view.strides[0]) )) = __pyx_t_7;
 
-    /* "sat_toolkit/formula.pyx":1280
+    /* "sat_toolkit/formula.pyx":1315
  *                 current_sol_view[j] = (i >> (j - 1)) & 1
  *             truthtable_view[i] = self._check_solution(current_sol_view)
  *             PyErr_CheckSignals()             # <<<<<<<<<<<<<<
  * 
  *         return Truthtable.from_lut(truthtable)
  */
-    __pyx_t_7 = PyErr_CheckSignals(); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 1280, __pyx_L1_error)
+    __pyx_t_7 = PyErr_CheckSignals(); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 1315, __pyx_L1_error)
   }
 
-  /* "sat_toolkit/formula.pyx":1282
+  /* "sat_toolkit/formula.pyx":1317
  *             PyErr_CheckSignals()
  * 
  *         return Truthtable.from_lut(truthtable)             # <<<<<<<<<<<<<<
  * 
  *     cdef Clause get_clause(self, ssize_t idx):
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable), __pyx_n_s_from_lut); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1282, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable), __pyx_n_s_from_lut); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1317, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_5 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_5)) {
@@ -42656,24 +43123,24 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_truthtable};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1282, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1317, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
-  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1282, __pyx_L1_error)
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1317, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_Truthtable *)__pyx_t_2);
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1257
+  /* "sat_toolkit/formula.pyx":1292
  *         return False
  * 
  *     def to_truthtable(self) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Return the current CNF as a Truthtable by iterating over all possible
  */
 
@@ -42693,15 +43160,15 @@
   __Pyx_XDECREF(__pyx_v_truthtable);
   __Pyx_XDECREF(__pyx_v_current_sol);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1284
+/* "sat_toolkit/formula.pyx":1319
  *         return Truthtable.from_lut(truthtable)
  * 
  *     cdef Clause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef Clause result
  *         result = Clause.from_memview(self._get_clause(idx))
  */
 
@@ -42712,42 +43179,42 @@
   __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":1286
+  /* "sat_toolkit/formula.pyx":1321
  *     cdef Clause get_clause(self, ssize_t idx):
  *         cdef Clause result
  *         result = Clause.from_memview(self._get_clause(idx))             # <<<<<<<<<<<<<<
  * 
  *         return result
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_idx); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1286, __pyx_L1_error)
-  __pyx_t_2 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_6Clause_from_memview(__pyx_t_1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1286, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_idx); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1321, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_6Clause_from_memview(__pyx_t_1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1321, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_1, 1);
   __pyx_t_1.memview = NULL; __pyx_t_1.data = NULL;
   __pyx_v_result = ((struct __pyx_obj_11sat_toolkit_7formula_Clause *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1288
+  /* "sat_toolkit/formula.pyx":1323
  *         result = Clause.from_memview(self._get_clause(idx))
  * 
  *         return result             # <<<<<<<<<<<<<<
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_result);
   __pyx_r = __pyx_v_result;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1284
+  /* "sat_toolkit/formula.pyx":1319
  *         return Truthtable.from_lut(truthtable)
  * 
  *     cdef Clause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef Clause result
  *         result = Clause.from_memview(self._get_clause(idx))
  */
 
@@ -42764,51 +43231,51 @@
   return __pyx_r;
 }
 
 struct __pyx_obj_11sat_toolkit_7formula_Clause *__pyx_f_11sat_toolkit_7formula_3CNF_get_clause__pyx_wrap_1(struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self, Py_ssize_t __pyx_v_idx) {
   return __pyx_f_11sat_toolkit_7formula_3CNF_get_clause(__pyx_v_self, __pyx_v_idx);
 }
 
-/* "sat_toolkit/formula.pyx":1290
+/* "sat_toolkit/formula.pyx":1325
  *         return result
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         return isinstance(clause, Clause)
  * 
  */
 
 static int __pyx_f_11sat_toolkit_7formula_3CNF__check_clause_type(CYTHON_UNUSED struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self, struct __pyx_obj_11sat_toolkit_7formula__BaseClause *__pyx_v_clause) {
   int __pyx_r;
   int __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":1291
+  /* "sat_toolkit/formula.pyx":1326
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:
  *         return isinstance(clause, Clause)             # <<<<<<<<<<<<<<
  * 
  *     def __repr__(self) -> str:
  */
   __pyx_t_1 = __Pyx_TypeCheck(((PyObject *)__pyx_v_clause), __pyx_ptype_11sat_toolkit_7formula_Clause); 
   __pyx_r = __pyx_t_1;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1290
+  /* "sat_toolkit/formula.pyx":1325
  *         return result
  * 
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         return isinstance(clause, Clause)
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1293
+/* "sat_toolkit/formula.pyx":1328
  *         return isinstance(clause, Clause)
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         return f'CNF over {self.nvars} variables with {self._start_indices.size()} clauses'
  * 
  */
 
@@ -42836,62 +43303,62 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__repr__", 1);
 
-  /* "sat_toolkit/formula.pyx":1294
+  /* "sat_toolkit/formula.pyx":1329
  * 
  *     def __repr__(self) -> str:
  *         return f'CNF over {self.nvars} variables with {self._start_indices.size()} clauses'             # <<<<<<<<<<<<<<
  * 
  *     def __str__(self) -> str:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1294, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_3 = 127;
   __Pyx_INCREF(__pyx_kp_u_CNF_over);
   __pyx_t_2 += 9;
   __Pyx_GIVEREF(__pyx_kp_u_CNF_over);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_CNF_over);
-  __pyx_t_4 = __Pyx_PyUnicode_From_int(__pyx_v_self->__pyx_base.nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1294, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_int(__pyx_v_self->__pyx_base.nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u_variables_with);
   __pyx_t_2 += 16;
   __Pyx_GIVEREF(__pyx_kp_u_variables_with);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u_variables_with);
-  __pyx_t_4 = __Pyx_PyInt_FromSize_t(__pyx_v_self->__pyx_base._start_indices.size()); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1294, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_FromSize_t(__pyx_v_self->__pyx_base._start_indices.size()); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1294, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_t_5);
   __pyx_t_5 = 0;
   __Pyx_INCREF(__pyx_kp_u_clauses_2);
   __pyx_t_2 += 8;
   __Pyx_GIVEREF(__pyx_kp_u_clauses_2);
   PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_kp_u_clauses_2);
-  __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_1, 5, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1294, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_1, 5, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_5;
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1293
+  /* "sat_toolkit/formula.pyx":1328
  *         return isinstance(clause, Clause)
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         return f'CNF over {self.nvars} variables with {self._start_indices.size()} clauses'
  * 
  */
 
@@ -42904,15 +43371,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1296
+/* "sat_toolkit/formula.pyx":1331
  *         return f'CNF over {self.nvars} variables with {self._start_indices.size()} clauses'
  * 
  *     def __str__(self) -> str:             # <<<<<<<<<<<<<<
  *         return self.to_dimacs().rstrip()
  * 
  */
 
@@ -42940,23 +43407,23 @@
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__str__", 1);
 
-  /* "sat_toolkit/formula.pyx":1297
+  /* "sat_toolkit/formula.pyx":1332
  * 
  *     def __str__(self) -> str:
  *         return self.to_dimacs().rstrip()             # <<<<<<<<<<<<<<
  * 
  *     def equiv(self, CNF other) -> bool:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1297, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
@@ -42968,19 +43435,19 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1297, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1332, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1297, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -42993,23 +43460,23 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1297, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1332, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1296
+  /* "sat_toolkit/formula.pyx":1331
  *         return f'CNF over {self.nvars} variables with {self._start_indices.size()} clauses'
  * 
  *     def __str__(self) -> str:             # <<<<<<<<<<<<<<
  *         return self.to_dimacs().rstrip()
  * 
  */
 
@@ -43023,15 +43490,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1299
+/* "sat_toolkit/formula.pyx":1334
  *         return self.to_dimacs().rstrip()
  * 
  *     def equiv(self, CNF other) -> bool:             # <<<<<<<<<<<<<<
  *         """
  *         Check for logical eqivalence between self and other.
  */
 
@@ -43085,45 +43552,45 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_other)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1299, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1334, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "equiv") < 0)) __PYX_ERR(0, 1299, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "equiv") < 0)) __PYX_ERR(0, 1334, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_other = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)values[0]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("equiv", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1299, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("equiv", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1334, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.CNF.equiv", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_other), __pyx_ptype_11sat_toolkit_7formula_CNF, 1, "other", 0))) __PYX_ERR(0, 1299, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_other), __pyx_ptype_11sat_toolkit_7formula_CNF, 1, "other", 0))) __PYX_ERR(0, 1334, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_40equiv(((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_v_self), __pyx_v_other);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -43156,105 +43623,105 @@
   int __pyx_t_12;
   PyObject *__pyx_t_13 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("equiv", 1);
 
-  /* "sat_toolkit/formula.pyx":1304
+  /* "sat_toolkit/formula.pyx":1339
  *         Calls `espresso -Dverify` to perform the comparison.
  *         """
  *         cdef int ret_code = 0             # <<<<<<<<<<<<<<
  * 
  *         if self.nvars != other.nvars:
  */
   __pyx_v_ret_code = 0;
 
-  /* "sat_toolkit/formula.pyx":1306
+  /* "sat_toolkit/formula.pyx":1341
  *         cdef int ret_code = 0
  * 
  *         if self.nvars != other.nvars:             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   __pyx_t_1 = (__pyx_v_self->__pyx_base.nvars != __pyx_v_other->__pyx_base.nvars);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1307
+    /* "sat_toolkit/formula.pyx":1342
  * 
  *         if self.nvars != other.nvars:
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         with sp.Popen(['espresso', '-Dverify'], stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1306
+    /* "sat_toolkit/formula.pyx":1341
  *         cdef int ret_code = 0
  * 
  *         if self.nvars != other.nvars:             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1309
+  /* "sat_toolkit/formula.pyx":1344
  *             return False
  * 
  *         with sp.Popen(['espresso', '-Dverify'], stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.write(other.to_espresso(print_numvars = False))
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_Popen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1309, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_Popen); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L1_error)
+    __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_n_u_espresso);
     __Pyx_GIVEREF(__pyx_n_u_espresso);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1309, __pyx_L1_error);
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1344, __pyx_L1_error);
     __Pyx_INCREF(__pyx_kp_u_Dverify);
     __Pyx_GIVEREF(__pyx_kp_u_Dverify);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_2, 1, __pyx_kp_u_Dverify)) __PYX_ERR(0, 1309, __pyx_L1_error);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1309, __pyx_L1_error)
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_2, 1, __pyx_kp_u_Dverify)) __PYX_ERR(0, 1344, __pyx_L1_error);
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_2);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 1344, __pyx_L1_error);
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1309, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1309, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_stdin, __pyx_t_6) < 0) __PYX_ERR(0, 1309, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_stdin, __pyx_t_6) < 0) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_sp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1309, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_sp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1309, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_stdout, __pyx_t_5) < 0) __PYX_ERR(0, 1309, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_stdout, __pyx_t_5) < 0) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1309, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1309, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1344, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_7 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_exit); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1309, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_exit); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_enter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1309, __pyx_L4_error)
+    __pyx_t_4 = __Pyx_PyObject_LookupSpecial(__pyx_t_5, __pyx_n_s_enter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1344, __pyx_L4_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     __pyx_t_8 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
@@ -43266,15 +43733,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
       __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1309, __pyx_L4_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1344, __pyx_L4_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __pyx_t_4 = __pyx_t_2;
     __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     /*try:*/ {
@@ -43285,27 +43752,27 @@
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_10);
         __Pyx_XGOTREF(__pyx_t_11);
         /*try:*/ {
           __pyx_v_espresso = __pyx_t_4;
           __pyx_t_4 = 0;
 
-          /* "sat_toolkit/formula.pyx":1310
+          /* "sat_toolkit/formula.pyx":1345
  * 
  *         with sp.Popen(['espresso', '-Dverify'], stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             espresso.stdin.write(self.to_espresso())             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(other.to_espresso(print_numvars = False))
  *             espresso.stdin.close()
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1310, __pyx_L8_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1345, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1310, __pyx_L8_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1345, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_2);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1310, __pyx_L8_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1345, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_6 = NULL;
           __pyx_t_8 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
             __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
             if (likely(__pyx_t_6)) {
@@ -43317,15 +43784,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
             __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1310, __pyx_L8_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1345, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __pyx_t_3 = NULL;
           __pyx_t_8 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_2))) {
@@ -43340,38 +43807,38 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_5};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1310, __pyx_L8_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1345, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           }
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-          /* "sat_toolkit/formula.pyx":1311
+          /* "sat_toolkit/formula.pyx":1346
  *         with sp.Popen(['espresso', '-Dverify'], stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.write(other.to_espresso(print_numvars = False))             # <<<<<<<<<<<<<<
  *             espresso.stdin.close()
  * 
  */
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1311, __pyx_L8_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1346, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_write); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1311, __pyx_L8_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_write); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1346, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_other), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1311, __pyx_L8_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_other), __pyx_n_s_to_espresso); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1346, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1311, __pyx_L8_error)
+          __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1346, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_3);
-          if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_print_numvars, Py_False) < 0) __PYX_ERR(0, 1311, __pyx_L8_error)
-          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_empty_tuple, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1311, __pyx_L8_error)
+          if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_print_numvars, Py_False) < 0) __PYX_ERR(0, 1346, __pyx_L8_error)
+          __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_empty_tuple, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1346, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __pyx_t_3 = NULL;
           __pyx_t_8 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
@@ -43386,30 +43853,30 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_6};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1311, __pyx_L8_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1346, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-          /* "sat_toolkit/formula.pyx":1312
+          /* "sat_toolkit/formula.pyx":1347
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.write(other.to_espresso(print_numvars = False))
  *             espresso.stdin.close()             # <<<<<<<<<<<<<<
  * 
  *             ret_code = espresso.wait()
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1312, __pyx_L8_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1347, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_close); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1312, __pyx_L8_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_close); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1347, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __pyx_t_5 = NULL;
           __pyx_t_8 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_6))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
@@ -43422,28 +43889,28 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1312, __pyx_L8_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1347, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           }
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-          /* "sat_toolkit/formula.pyx":1314
+          /* "sat_toolkit/formula.pyx":1349
  *             espresso.stdin.close()
  * 
  *             ret_code = espresso.wait()             # <<<<<<<<<<<<<<
  *             if ret_code not in [0, 1]:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  */
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1314, __pyx_L8_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1349, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_6);
           __pyx_t_5 = NULL;
           __pyx_t_8 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_6))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
             if (likely(__pyx_t_5)) {
@@ -43455,23 +43922,23 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1314, __pyx_L8_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1349, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           }
-          __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_t_4); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1314, __pyx_L8_error)
+          __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_t_4); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1349, __pyx_L8_error)
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __pyx_v_ret_code = __pyx_t_8;
 
-          /* "sat_toolkit/formula.pyx":1315
+          /* "sat_toolkit/formula.pyx":1350
  * 
  *             ret_code = espresso.wait()
  *             if ret_code not in [0, 1]:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
           switch (__pyx_v_ret_code) {
@@ -43482,31 +43949,31 @@
             default:
             __pyx_t_1 = 1;
             break;
           }
           __pyx_t_12 = __pyx_t_1;
           if (unlikely(__pyx_t_12)) {
 
-            /* "sat_toolkit/formula.pyx":1316
+            /* "sat_toolkit/formula.pyx":1351
  *             ret_code = espresso.wait()
  *             if ret_code not in [0, 1]:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))             # <<<<<<<<<<<<<<
  * 
  *             return ret_code == 0
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_sp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1316, __pyx_L8_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_sp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1351, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1316, __pyx_L8_error)
+            __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1351, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-            __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1316, __pyx_L8_error)
+            __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1351, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_6);
-            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1316, __pyx_L8_error)
+            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1351, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_2 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1316, __pyx_L8_error)
+            __pyx_t_2 = PyUnicode_Join(__pyx_kp_u__34, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1351, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             __pyx_t_3 = NULL;
             __pyx_t_8 = 0;
             #if CYTHON_UNPACK_METHODS
             if (unlikely(PyMethod_Check(__pyx_t_5))) {
               __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
@@ -43521,46 +43988,46 @@
             #endif
             {
               PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_6, __pyx_t_2};
               __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
               __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
               __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
               __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-              if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1316, __pyx_L8_error)
+              if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1351, __pyx_L8_error)
               __Pyx_GOTREF(__pyx_t_4);
               __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             }
             __Pyx_Raise(__pyx_t_4, 0, 0, 0);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            __PYX_ERR(0, 1316, __pyx_L8_error)
+            __PYX_ERR(0, 1351, __pyx_L8_error)
 
-            /* "sat_toolkit/formula.pyx":1315
+            /* "sat_toolkit/formula.pyx":1350
  * 
  *             ret_code = espresso.wait()
  *             if ret_code not in [0, 1]:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1318
+          /* "sat_toolkit/formula.pyx":1353
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  *             return ret_code == 0             # <<<<<<<<<<<<<<
  * 
- *     def translate(self, mapping) -> CNF:
+ * collections.abc.Sequence.register(_ClauseList)
  */
           __Pyx_XDECREF(__pyx_r);
-          __pyx_t_4 = __Pyx_PyBool_FromLong((__pyx_v_ret_code == 0)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1318, __pyx_L8_error)
+          __pyx_t_4 = __Pyx_PyBool_FromLong((__pyx_v_ret_code == 0)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1353, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_4);
           __pyx_r = __pyx_t_4;
           __pyx_t_4 = 0;
           goto __pyx_L12_try_return;
 
-          /* "sat_toolkit/formula.pyx":1309
+          /* "sat_toolkit/formula.pyx":1344
  *             return False
  * 
  *         with sp.Popen(['espresso', '-Dverify'], stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.write(other.to_espresso(print_numvars = False))
  */
         }
@@ -43568,36 +44035,36 @@
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.CNF.equiv", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_5, &__pyx_t_2) < 0) __PYX_ERR(0, 1309, __pyx_L10_except_error)
+          if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_5, &__pyx_t_2) < 0) __PYX_ERR(0, 1344, __pyx_L10_except_error)
           __Pyx_XGOTREF(__pyx_t_4);
           __Pyx_XGOTREF(__pyx_t_5);
           __Pyx_XGOTREF(__pyx_t_2);
-          __pyx_t_6 = PyTuple_Pack(3, __pyx_t_4, __pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1309, __pyx_L10_except_error)
+          __pyx_t_6 = PyTuple_Pack(3, __pyx_t_4, __pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1344, __pyx_L10_except_error)
           __Pyx_GOTREF(__pyx_t_6);
           __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_6, NULL);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1309, __pyx_L10_except_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1344, __pyx_L10_except_error)
           __Pyx_GOTREF(__pyx_t_13);
           __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (__pyx_t_12 < 0) __PYX_ERR(0, 1309, __pyx_L10_except_error)
+          if (__pyx_t_12 < 0) __PYX_ERR(0, 1344, __pyx_L10_except_error)
           __pyx_t_1 = (!__pyx_t_12);
           if (unlikely(__pyx_t_1)) {
             __Pyx_GIVEREF(__pyx_t_4);
             __Pyx_GIVEREF(__pyx_t_5);
             __Pyx_XGIVEREF(__pyx_t_2);
             __Pyx_ErrRestoreWithState(__pyx_t_4, __pyx_t_5, __pyx_t_2);
             __pyx_t_4 = 0; __pyx_t_5 = 0; __pyx_t_2 = 0; 
-            __PYX_ERR(0, 1309, __pyx_L10_except_error)
+            __PYX_ERR(0, 1344, __pyx_L10_except_error)
           }
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           goto __pyx_L9_exception_handled;
         }
         __pyx_L10_except_error:;
@@ -43618,29 +44085,29 @@
         __Pyx_XGIVEREF(__pyx_t_11);
         __Pyx_ExceptionReset(__pyx_t_9, __pyx_t_10, __pyx_t_11);
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_7) {
-          __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__35, NULL);
+          __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1309, __pyx_L1_error)
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1344, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         }
         goto __pyx_L7;
       }
       __pyx_L5_return: {
         __pyx_t_11 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_7) {
-          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__35, NULL);
+          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1309, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1344, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __pyx_r = __pyx_t_11;
         __pyx_t_11 = 0;
         goto __pyx_L0;
       }
@@ -43649,15 +44116,15 @@
     goto __pyx_L18;
     __pyx_L4_error:;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     goto __pyx_L1_error;
     __pyx_L18:;
   }
 
-  /* "sat_toolkit/formula.pyx":1299
+  /* "sat_toolkit/formula.pyx":1334
  *         return self.to_dimacs().rstrip()
  * 
  *     def equiv(self, CNF other) -> bool:             # <<<<<<<<<<<<<<
  *         """
  *         Check for logical eqivalence between self and other.
  */
 
@@ -43675,502 +44142,51 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_espresso);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1320
- *             return ret_code == 0
- * 
- *     def translate(self, mapping) -> CNF:             # <<<<<<<<<<<<<<
- *         """
- *         Translate all variables in the CNF to a new index.
- */
-
-/* Python wrapper */
-static struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_pw_11sat_toolkit_7formula_3CNF_43translate(PyObject *__pyx_v_self, 
-#if CYTHON_METH_FASTCALL
-PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
-#else
-PyObject *__pyx_args, PyObject *__pyx_kwds
-#endif
-); /*proto*/
-PyDoc_STRVAR(__pyx_doc_11sat_toolkit_7formula_3CNF_42translate, "CNF.translate(self, mapping) -> CNF\n\n        Translate all variables in the CNF to a new index.\n        The translation mapping is given by the mapping paramter.\n\n        Index 0 must always map to index 0 again.\n\n        :return: a new CNF with variables changed according to mapping parameter\n        ");
-static PyMethodDef __pyx_mdef_11sat_toolkit_7formula_3CNF_43translate = {"translate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_3CNF_43translate, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_3CNF_42translate};
-static struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_pw_11sat_toolkit_7formula_3CNF_43translate(PyObject *__pyx_v_self, 
-#if CYTHON_METH_FASTCALL
-PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
-#else
-PyObject *__pyx_args, PyObject *__pyx_kwds
-#endif
-) {
-  PyObject *__pyx_v_mapping = 0;
-  #if !CYTHON_METH_FASTCALL
-  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
-  #endif
-  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
-  PyObject* values[1] = {0};
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_r = 0;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("translate (wrapper)", 0);
-  #if !CYTHON_METH_FASTCALL
-  #if CYTHON_ASSUME_SAFE_MACROS
-  __pyx_nargs = PyTuple_GET_SIZE(__pyx_args);
-  #else
-  __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
-  #endif
-  #endif
-  __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
-  {
-    PyObject **__pyx_pyargnames[] = {&__pyx_n_s_mapping,0};
-    if (__pyx_kwds) {
-      Py_ssize_t kw_args;
-      switch (__pyx_nargs) {
-        case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
-        CYTHON_FALLTHROUGH;
-        case  0: break;
-        default: goto __pyx_L5_argtuple_error;
-      }
-      kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
-      switch (__pyx_nargs) {
-        case  0:
-        if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_mapping)) != 0)) {
-          (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
-          kw_args--;
-        }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1320, __pyx_L3_error)
-        else goto __pyx_L5_argtuple_error;
-      }
-      if (unlikely(kw_args > 0)) {
-        const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "translate") < 0)) __PYX_ERR(0, 1320, __pyx_L3_error)
-      }
-    } else if (unlikely(__pyx_nargs != 1)) {
-      goto __pyx_L5_argtuple_error;
-    } else {
-      values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
-    }
-    __pyx_v_mapping = values[0];
-  }
-  goto __pyx_L6_skip;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("translate", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1320, __pyx_L3_error)
-  __pyx_L6_skip:;
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L3_error:;
-  {
-    Py_ssize_t __pyx_temp;
-    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
-      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
-    }
-  }
-  __Pyx_AddTraceback("sat_toolkit.formula.CNF.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __Pyx_RefNannyFinishContext();
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11sat_toolkit_7formula_3CNF_42translate(((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_v_self), __pyx_v_mapping);
-
-  /* function exit code */
-  {
-    Py_ssize_t __pyx_temp;
-    for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
-      __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
-    }
-  }
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-static struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_pf_11sat_toolkit_7formula_3CNF_42translate(struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_self, PyObject *__pyx_v_mapping) {
-  PyObject *__pyx_v_np_vars = 0;
-  __Pyx_memviewslice __pyx_v_var_view = { 0, 0, { 0 }, { 0 }, { 0 } };
-  size_t __pyx_v_i;
-  std::vector<int>  __pyx_v_new_clauses;
-  int __pyx_v_var;
-  struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_v_res = 0;
-  struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  PyObject *__pyx_t_4 = NULL;
-  PyObject *__pyx_t_5 = NULL;
-  __Pyx_memviewslice __pyx_t_6 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  int __pyx_t_7;
-  Py_ssize_t __pyx_t_8;
-  Py_UCS4 __pyx_t_9;
-  Py_ssize_t __pyx_t_10;
-  size_t __pyx_t_11;
-  size_t __pyx_t_12;
-  size_t __pyx_t_13;
-  size_t __pyx_t_14;
-  std::vector<int> ::size_type __pyx_t_15;
-  std::vector<int> ::size_type __pyx_t_16;
-  long __pyx_t_17;
-  int *__pyx_t_18;
-  struct __pyx_array_obj *__pyx_t_19 = NULL;
-  __Pyx_memviewslice __pyx_t_20 = { 0, 0, { 0 }, { 0 }, { 0 } };
-  int __pyx_t_21;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("translate", 1);
-
-  /* "sat_toolkit/formula.pyx":1329
- *         :return: a new CNF with variables changed according to mapping parameter
- *         """
- *         cdef np_vars = np.array(mapping, copy=False, dtype=np.int32)             # <<<<<<<<<<<<<<
- *         cdef int [::1] var_view = np_vars
- *         cdef size_t i
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1329, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1329, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1329, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_v_mapping);
-  __Pyx_GIVEREF(__pyx_v_mapping);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_mapping)) __PYX_ERR(0, 1329, __pyx_L1_error);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1329, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_copy, Py_False) < 0) __PYX_ERR(0, 1329, __pyx_L1_error)
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1329, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1329, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1329, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1329, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_np_vars = __pyx_t_5;
-  __pyx_t_5 = 0;
-
-  /* "sat_toolkit/formula.pyx":1330
- *         """
- *         cdef np_vars = np.array(mapping, copy=False, dtype=np.int32)
- *         cdef int [::1] var_view = np_vars             # <<<<<<<<<<<<<<
- *         cdef size_t i
- * 
- */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_np_vars, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1330, __pyx_L1_error)
-  __pyx_v_var_view = __pyx_t_6;
-  __pyx_t_6.memview = NULL;
-  __pyx_t_6.data = NULL;
-
-  /* "sat_toolkit/formula.pyx":1333
- *         cdef size_t i
- * 
- *         if var_view.shape[0] != self.nvars + 1:             # <<<<<<<<<<<<<<
- *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
- *         if var_view[0] != 0:
- */
-  __pyx_t_7 = ((__pyx_v_var_view.shape[0]) != (__pyx_v_self->__pyx_base.nvars + 1));
-  if (unlikely(__pyx_t_7)) {
-
-    /* "sat_toolkit/formula.pyx":1334
- * 
- *         if var_view.shape[0] != self.nvars + 1:
- *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')             # <<<<<<<<<<<<<<
- *         if var_view[0] != 0:
- *             raise ValueError('variable 0 must map to 0 again')
- */
-    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1334, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = 0;
-    __pyx_t_9 = 127;
-    __Pyx_INCREF(__pyx_kp_u_need_to_provide_translation_for);
-    __pyx_t_8 += 38;
-    __Pyx_GIVEREF(__pyx_kp_u_need_to_provide_translation_for);
-    PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_kp_u_need_to_provide_translation_for);
-    __pyx_t_3 = __Pyx_PyUnicode_From_int(__pyx_v_self->__pyx_base.nvars, 0, ' ', 'd'); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1334, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_8 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_3);
-    __Pyx_GIVEREF(__pyx_t_3);
-    PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_3);
-    __pyx_t_3 = 0;
-    __Pyx_INCREF(__pyx_kp_u_variables_2);
-    __pyx_t_8 += 10;
-    __Pyx_GIVEREF(__pyx_kp_u_variables_2);
-    PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_kp_u_variables_2);
-    __pyx_t_3 = __Pyx_PyUnicode_Join(__pyx_t_5, 3, __pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1334, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1334, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __PYX_ERR(0, 1334, __pyx_L1_error)
-
-    /* "sat_toolkit/formula.pyx":1333
- *         cdef size_t i
- * 
- *         if var_view.shape[0] != self.nvars + 1:             # <<<<<<<<<<<<<<
- *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
- *         if var_view[0] != 0:
- */
-  }
-
-  /* "sat_toolkit/formula.pyx":1335
- *         if var_view.shape[0] != self.nvars + 1:
- *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
- *         if var_view[0] != 0:             # <<<<<<<<<<<<<<
- *             raise ValueError('variable 0 must map to 0 again')
- * 
- */
-  __pyx_t_10 = 0;
-  __pyx_t_7 = ((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_var_view.data) + __pyx_t_10)) ))) != 0);
-  if (unlikely(__pyx_t_7)) {
-
-    /* "sat_toolkit/formula.pyx":1336
- *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
- *         if var_view[0] != 0:
- *             raise ValueError('variable 0 must map to 0 again')             # <<<<<<<<<<<<<<
- * 
- *         for i in range(1, <size_t> var_view.shape[0]):
- */
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__43, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1336, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
-    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __PYX_ERR(0, 1336, __pyx_L1_error)
-
-    /* "sat_toolkit/formula.pyx":1335
- *         if var_view.shape[0] != self.nvars + 1:
- *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
- *         if var_view[0] != 0:             # <<<<<<<<<<<<<<
- *             raise ValueError('variable 0 must map to 0 again')
- * 
- */
-  }
-
-  /* "sat_toolkit/formula.pyx":1338
- *             raise ValueError('variable 0 must map to 0 again')
- * 
- *         for i in range(1, <size_t> var_view.shape[0]):             # <<<<<<<<<<<<<<
- *             if var_view[i] == 0:
- *                 raise ValueError('variable must not be mapped to 0')
- */
-  __pyx_t_11 = ((size_t)(__pyx_v_var_view.shape[0]));
-  __pyx_t_12 = __pyx_t_11;
-  for (__pyx_t_13 = 1; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
-    __pyx_v_i = __pyx_t_13;
-
-    /* "sat_toolkit/formula.pyx":1339
- * 
- *         for i in range(1, <size_t> var_view.shape[0]):
- *             if var_view[i] == 0:             # <<<<<<<<<<<<<<
- *                 raise ValueError('variable must not be mapped to 0')
- * 
- */
-    __pyx_t_14 = __pyx_v_i;
-    __pyx_t_7 = ((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_var_view.data) + __pyx_t_14)) ))) == 0);
-    if (unlikely(__pyx_t_7)) {
-
-      /* "sat_toolkit/formula.pyx":1340
- *         for i in range(1, <size_t> var_view.shape[0]):
- *             if var_view[i] == 0:
- *                 raise ValueError('variable must not be mapped to 0')             # <<<<<<<<<<<<<<
- * 
- *         cdef vector[int] new_clauses
- */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__44, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1340, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_Raise(__pyx_t_5, 0, 0, 0);
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __PYX_ERR(0, 1340, __pyx_L1_error)
-
-      /* "sat_toolkit/formula.pyx":1339
- * 
- *         for i in range(1, <size_t> var_view.shape[0]):
- *             if var_view[i] == 0:             # <<<<<<<<<<<<<<
- *                 raise ValueError('variable must not be mapped to 0')
- * 
- */
-    }
-  }
-
-  /* "sat_toolkit/formula.pyx":1343
- * 
- *         cdef vector[int] new_clauses
- *         new_clauses.resize(self._clauses.size())             # <<<<<<<<<<<<<<
- * 
- *         cdef int var
- */
-  try {
-    __pyx_v_new_clauses.resize(__pyx_v_self->__pyx_base._clauses.size());
-  } catch(...) {
-    __Pyx_CppExn2PyErr();
-    __PYX_ERR(0, 1343, __pyx_L1_error)
-  }
-
-  /* "sat_toolkit/formula.pyx":1346
- * 
- *         cdef int var
- *         for i in range(self._clauses.size()):             # <<<<<<<<<<<<<<
- *             var = self._clauses[i]
- *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)
- */
-  __pyx_t_15 = __pyx_v_self->__pyx_base._clauses.size();
-  __pyx_t_16 = __pyx_t_15;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_16; __pyx_t_11+=1) {
-    __pyx_v_i = __pyx_t_11;
-
-    /* "sat_toolkit/formula.pyx":1347
- *         cdef int var
- *         for i in range(self._clauses.size()):
- *             var = self._clauses[i]             # <<<<<<<<<<<<<<
- *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)
- * 
- */
-    __pyx_v_var = (__pyx_v_self->__pyx_base._clauses[__pyx_v_i]);
-
-    /* "sat_toolkit/formula.pyx":1348
- *         for i in range(self._clauses.size()):
- *             var = self._clauses[i]
- *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)             # <<<<<<<<<<<<<<
- * 
- *         cdef CNF res = CNF.__new__(CNF)
- */
-    __pyx_t_10 = __pyx_f_11sat_toolkit_7formula_abs(__pyx_v_var);
-    __pyx_t_7 = (__pyx_v_var > 0);
-    if (__pyx_t_7) {
-      __pyx_t_17 = 1;
-    } else {
-      __pyx_t_17 = -1L;
-    }
-    (__pyx_v_new_clauses[__pyx_v_i]) = ((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_var_view.data) + __pyx_t_10)) ))) * __pyx_t_17);
-  }
-
-  /* "sat_toolkit/formula.pyx":1350
- *             new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)
- * 
- *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
- *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())
- *         return res
- */
-  __pyx_t_5 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1350, __pyx_L1_error)
-  __Pyx_GOTREF((PyObject *)__pyx_t_5);
-  __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "sat_toolkit/formula.pyx":1351
- * 
- *         cdef CNF res = CNF.__new__(CNF)
- *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())             # <<<<<<<<<<<<<<
- *         return res
- * 
- */
-  __pyx_t_18 = __pyx_v_new_clauses.data();
-  if (!__pyx_t_18) {
-    PyErr_SetString(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
-    __PYX_ERR(0, 1351, __pyx_L1_error)
-  }
-  __pyx_t_3 = __pyx_format_from_typeinfo(&__Pyx_TypeInfo_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1351, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)__pyx_v_new_clauses.size())); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1351, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_19 = __pyx_array_new(__pyx_t_5, sizeof(int), PyBytes_AS_STRING(__pyx_t_3), (char *) "c", (char *) __pyx_t_18); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1351, __pyx_L1_error)
-  __Pyx_GOTREF((PyObject *)__pyx_t_19);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_20 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_t_19), 0); if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 1351, __pyx_L1_error)
-  __Pyx_DECREF((PyObject *)__pyx_t_19); __pyx_t_19 = 0;
-  __pyx_t_21 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_20); if (unlikely(__pyx_t_21 == ((int)-1))) __PYX_ERR(0, 1351, __pyx_L1_error)
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_20, 1);
-  __pyx_t_20.memview = NULL; __pyx_t_20.data = NULL;
-
-  /* "sat_toolkit/formula.pyx":1352
- *         cdef CNF res = CNF.__new__(CNF)
- *         res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())
- *         return res             # <<<<<<<<<<<<<<
- * 
- * collections.abc.Sequence.register(_ClauseList)
- */
-  __Pyx_XDECREF((PyObject *)__pyx_r);
-  __Pyx_INCREF((PyObject *)__pyx_v_res);
-  __pyx_r = __pyx_v_res;
-  goto __pyx_L0;
-
-  /* "sat_toolkit/formula.pyx":1320
- *             return ret_code == 0
- * 
- *     def translate(self, mapping) -> CNF:             # <<<<<<<<<<<<<<
- *         """
- *         Translate all variables in the CNF to a new index.
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_5);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_6, 1);
-  __Pyx_XDECREF((PyObject *)__pyx_t_19);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_t_20, 1);
-  __Pyx_AddTraceback("sat_toolkit.formula.CNF.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_np_vars);
-  __PYX_XCLEAR_MEMVIEW(&__pyx_v_var_view, 1);
-  __Pyx_XDECREF((PyObject *)__pyx_v_res);
-  __Pyx_XGIVEREF((PyObject *)__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "sat_toolkit/formula.pyx":1361
+/* "sat_toolkit/formula.pyx":1362
  *     Class for storing and manipulating a list of xor clauses.
  *     """
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         return isinstance(clause, XorClause)
  * 
  */
 
 static int __pyx_f_11sat_toolkit_7formula_13XorClauseList__check_clause_type(CYTHON_UNUSED struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *__pyx_v_self, struct __pyx_obj_11sat_toolkit_7formula__BaseClause *__pyx_v_clause) {
   int __pyx_r;
   int __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":1362
+  /* "sat_toolkit/formula.pyx":1363
  *     """
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:
  *         return isinstance(clause, XorClause)             # <<<<<<<<<<<<<<
  * 
  *     cdef XorClause get_clause(self, ssize_t idx):
  */
   __pyx_t_1 = __Pyx_TypeCheck(((PyObject *)__pyx_v_clause), __pyx_ptype_11sat_toolkit_7formula_XorClause); 
   __pyx_r = __pyx_t_1;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1361
+  /* "sat_toolkit/formula.pyx":1362
  *     Class for storing and manipulating a list of xor clauses.
  *     """
  *     cdef int _check_clause_type(self, _BaseClause clause) noexcept:             # <<<<<<<<<<<<<<
  *         return isinstance(clause, XorClause)
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1364
+/* "sat_toolkit/formula.pyx":1365
  *         return isinstance(clause, XorClause)
  * 
  *     cdef XorClause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef XorClause result
  *         result = XorClause.from_memview(self._get_clause(idx))
  */
 
@@ -44181,42 +44197,42 @@
   __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_clause", 1);
 
-  /* "sat_toolkit/formula.pyx":1366
+  /* "sat_toolkit/formula.pyx":1367
  *     cdef XorClause get_clause(self, ssize_t idx):
  *         cdef XorClause result
  *         result = XorClause.from_memview(self._get_clause(idx))             # <<<<<<<<<<<<<<
  * 
  *         return result
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_idx); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1366, __pyx_L1_error)
-  __pyx_t_2 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_9XorClause_from_memview(__pyx_t_1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1366, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self), __pyx_v_idx); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1367, __pyx_L1_error)
+  __pyx_t_2 = ((PyObject *)__pyx_f_11sat_toolkit_7formula_9XorClause_from_memview(__pyx_t_1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1367, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_1, 1);
   __pyx_t_1.memview = NULL; __pyx_t_1.data = NULL;
   __pyx_v_result = ((struct __pyx_obj_11sat_toolkit_7formula_XorClause *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1368
+  /* "sat_toolkit/formula.pyx":1369
  *         result = XorClause.from_memview(self._get_clause(idx))
  * 
  *         return result             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_result);
   __pyx_r = __pyx_v_result;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1364
+  /* "sat_toolkit/formula.pyx":1365
  *         return isinstance(clause, XorClause)
  * 
  *     cdef XorClause get_clause(self, ssize_t idx):             # <<<<<<<<<<<<<<
  *         cdef XorClause result
  *         result = XorClause.from_memview(self._get_clause(idx))
  */
 
@@ -44233,15 +44249,15 @@
   return __pyx_r;
 }
 
 struct __pyx_obj_11sat_toolkit_7formula_XorClause *__pyx_f_11sat_toolkit_7formula_13XorClauseList_get_clause__pyx_wrap_1(struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *__pyx_v_self, Py_ssize_t __pyx_v_idx) {
   return __pyx_f_11sat_toolkit_7formula_13XorClauseList_get_clause(__pyx_v_self, __pyx_v_idx);
 }
 
-/* "sat_toolkit/formula.pyx":1375
+/* "sat_toolkit/formula.pyx":1376
  *     cdef readonly XorClauseList _xor_clauses
  * 
  *     def __cinit__(self):             # <<<<<<<<<<<<<<
  *         self._clauses = CNF.__new__(CNF)
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)
  */
 
@@ -44274,45 +44290,45 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 1);
 
-  /* "sat_toolkit/formula.pyx":1376
+  /* "sat_toolkit/formula.pyx":1377
  * 
  *     def __cinit__(self):
  *         self._clauses = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)
  * 
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1376, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1377, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __Pyx_GIVEREF((PyObject *)__pyx_t_1);
   __Pyx_GOTREF((PyObject *)__pyx_v_self->_clauses);
   __Pyx_DECREF((PyObject *)__pyx_v_self->_clauses);
   __pyx_v_self->_clauses = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1377
+  /* "sat_toolkit/formula.pyx":1378
  *     def __cinit__(self):
  *         self._clauses = CNF.__new__(CNF)
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorClauseList(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorClauseList), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1377, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorClauseList(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorClauseList), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1378, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __Pyx_GIVEREF((PyObject *)__pyx_t_1);
   __Pyx_GOTREF((PyObject *)__pyx_v_self->_xor_clauses);
   __Pyx_DECREF((PyObject *)__pyx_v_self->_xor_clauses);
   __pyx_v_self->_xor_clauses = ((struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1375
+  /* "sat_toolkit/formula.pyx":1376
  *     cdef readonly XorClauseList _xor_clauses
  * 
  *     def __cinit__(self):             # <<<<<<<<<<<<<<
  *         self._clauses = CNF.__new__(CNF)
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)
  */
 
@@ -44324,15 +44340,15 @@
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1379
+/* "sat_toolkit/formula.pyx":1380
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)
  * 
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):             # <<<<<<<<<<<<<<
  *         if clauses is not None:
  *             self._clauses.add_clauses(clauses)
  */
 
@@ -44372,27 +44388,27 @@
       }
       kw_args = __Pyx_NumKwargs_VARARGS(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_clauses);
           if (value) { values[0] = __Pyx_Arg_NewRef_VARARGS(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1379, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1380, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_xor_clauses);
           if (value) { values[1] = __Pyx_Arg_NewRef_VARARGS(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1379, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1380, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "__init__") < 0)) __PYX_ERR(0, 1379, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "__init__") < 0)) __PYX_ERR(0, 1380, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  2: values[1] = __Pyx_Arg_VARARGS(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = __Pyx_Arg_VARARGS(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
@@ -44401,15 +44417,15 @@
       }
     }
     __pyx_v_clauses = values[0];
     __pyx_v_xor_clauses = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1379, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1380, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_VARARGS(values[__pyx_temp]);
@@ -44441,32 +44457,32 @@
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 1);
 
-  /* "sat_toolkit/formula.pyx":1380
+  /* "sat_toolkit/formula.pyx":1381
  * 
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):
  *         if clauses is not None:             # <<<<<<<<<<<<<<
  *             self._clauses.add_clauses(clauses)
  *         if xor_clauses is not None:
  */
   __pyx_t_1 = (__pyx_v_clauses != Py_None);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1381
+    /* "sat_toolkit/formula.pyx":1382
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):
  *         if clauses is not None:
  *             self._clauses.add_clauses(clauses)             # <<<<<<<<<<<<<<
  *         if xor_clauses is not None:
  *             self._xor_clauses.add_clauses(xor_clauses)
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1381, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1382, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = NULL;
     __pyx_t_5 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
@@ -44478,47 +44494,47 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_clauses};
       __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1381, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1382, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "sat_toolkit/formula.pyx":1380
+    /* "sat_toolkit/formula.pyx":1381
  * 
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):
  *         if clauses is not None:             # <<<<<<<<<<<<<<
  *             self._clauses.add_clauses(clauses)
  *         if xor_clauses is not None:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1382
+  /* "sat_toolkit/formula.pyx":1383
  *         if clauses is not None:
  *             self._clauses.add_clauses(clauses)
  *         if xor_clauses is not None:             # <<<<<<<<<<<<<<
  *             self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
   __pyx_t_1 = (__pyx_v_xor_clauses != Py_None);
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1383
+    /* "sat_toolkit/formula.pyx":1384
  *             self._clauses.add_clauses(clauses)
  *         if xor_clauses is not None:
  *             self._xor_clauses.add_clauses(xor_clauses)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1383, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1384, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = NULL;
     __pyx_t_5 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
@@ -44530,30 +44546,30 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_xor_clauses};
       __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1383, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1384, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "sat_toolkit/formula.pyx":1382
+    /* "sat_toolkit/formula.pyx":1383
  *         if clauses is not None:
  *             self._clauses.add_clauses(clauses)
  *         if xor_clauses is not None:             # <<<<<<<<<<<<<<
  *             self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1379
+  /* "sat_toolkit/formula.pyx":1380
  *         self._xor_clauses = XorClauseList.__new__(XorClauseList)
  * 
  *     def __init__(self, clauses: CNF|None=None, xor_clauses: XorClauseList|None=None):             # <<<<<<<<<<<<<<
  *         if clauses is not None:
  *             self._clauses.add_clauses(clauses)
  */
 
@@ -44567,15 +44583,15 @@
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1386
+/* "sat_toolkit/formula.pyx":1387
  * 
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)
  */
 
@@ -44629,45 +44645,45 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dimacs)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1386, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1387, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_dimacs") < 0)) __PYX_ERR(0, 1386, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_dimacs") < 0)) __PYX_ERR(0, 1387, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_dimacs = ((PyObject*)values[0]);
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("from_dimacs", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1386, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("from_dimacs", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1387, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.from_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dimacs), (&PyUnicode_Type), 0, "dimacs", 1))) __PYX_ERR(0, 1387, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dimacs), (&PyUnicode_Type), 0, "dimacs", 1))) __PYX_ERR(0, 1388, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_6XorCNF_4from_dimacs(__pyx_v_dimacs);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -44712,66 +44728,66 @@
   int __pyx_t_15;
   int __pyx_t_16;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("from_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":1388
+  /* "sat_toolkit/formula.pyx":1389
  *     @staticmethod
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         cdef XorClauseList xors = XorClauseList.__new__(XorClauseList)
  *         cdef int nvars = -1
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1388, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1389, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __pyx_v_clauses = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1389
+  /* "sat_toolkit/formula.pyx":1390
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)
  *         cdef XorClauseList xors = XorClauseList.__new__(XorClauseList)             # <<<<<<<<<<<<<<
  *         cdef int nvars = -1
  *         cdef int nclauses = -1
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorClauseList(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorClauseList), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1389, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorClauseList(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorClauseList), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1390, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __pyx_v_xors = ((struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1390
+  /* "sat_toolkit/formula.pyx":1391
  *         cdef CNF clauses = CNF.__new__(CNF)
  *         cdef XorClauseList xors = XorClauseList.__new__(XorClauseList)
  *         cdef int nvars = -1             # <<<<<<<<<<<<<<
  *         cdef int nclauses = -1
  * 
  */
   __pyx_v_nvars = -1;
 
-  /* "sat_toolkit/formula.pyx":1391
+  /* "sat_toolkit/formula.pyx":1392
  *         cdef XorClauseList xors = XorClauseList.__new__(XorClauseList)
  *         cdef int nvars = -1
  *         cdef int nclauses = -1             # <<<<<<<<<<<<<<
  * 
  *         lines = io.StringIO(dimacs)
  */
   __pyx_v_nclauses = -1;
 
-  /* "sat_toolkit/formula.pyx":1393
+  /* "sat_toolkit/formula.pyx":1394
  *         cdef int nclauses = -1
  * 
  *         lines = io.StringIO(dimacs)             # <<<<<<<<<<<<<<
  * 
  *         for line in lines:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1393, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1394, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1393, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1394, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -44784,91 +44800,91 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_dimacs};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1393, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1394, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_v_lines = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1395
+  /* "sat_toolkit/formula.pyx":1396
  *         lines = io.StringIO(dimacs)
  * 
  *         for line in lines:             # <<<<<<<<<<<<<<
  *             if line.startswith('c'):
  *                 continue
  */
   if (likely(PyList_CheckExact(__pyx_v_lines)) || PyTuple_CheckExact(__pyx_v_lines)) {
     __pyx_t_1 = __pyx_v_lines; __Pyx_INCREF(__pyx_t_1);
     __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_lines); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1395, __pyx_L1_error)
+    __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_lines); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1396, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1395, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1396, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_1);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1395, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1396, __pyx_L1_error)
           #endif
           if (__pyx_t_5 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 1395, __pyx_L1_error)
+        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 1396, __pyx_L1_error)
         #else
-        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1395, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1396, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       } else {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_1);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1395, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1396, __pyx_L1_error)
           #endif
           if (__pyx_t_5 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 1395, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_3); __pyx_t_5++; if (unlikely((0 < 0))) __PYX_ERR(0, 1396, __pyx_L1_error)
         #else
-        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1395, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1396, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       }
     } else {
       __pyx_t_3 = __pyx_t_6(__pyx_t_1);
       if (unlikely(!__pyx_t_3)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1395, __pyx_L1_error)
+          else __PYX_ERR(0, 1396, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_3);
     }
     __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "sat_toolkit/formula.pyx":1396
+    /* "sat_toolkit/formula.pyx":1397
  * 
  *         for line in lines:
  *             if line.startswith('c'):             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1396, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1397, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_7 = NULL;
     __pyx_t_4 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_7)) {
@@ -44880,48 +44896,48 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_n_u_c};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1396, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1397, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1396, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1397, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_8) {
 
-      /* "sat_toolkit/formula.pyx":1397
+      /* "sat_toolkit/formula.pyx":1398
  *         for line in lines:
  *             if line.startswith('c'):
  *                 continue             # <<<<<<<<<<<<<<
  * 
  *             if line.startswith('p cnf '):
  */
       goto __pyx_L3_continue;
 
-      /* "sat_toolkit/formula.pyx":1396
+      /* "sat_toolkit/formula.pyx":1397
  * 
  *         for line in lines:
  *             if line.startswith('c'):             # <<<<<<<<<<<<<<
  *                 continue
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":1399
+    /* "sat_toolkit/formula.pyx":1400
  *                 continue
  * 
  *             if line.startswith('p cnf '):             # <<<<<<<<<<<<<<
  *                 if nvars != -1:
  *                     raise ValueError('multiple p cnf lines in dimacs')
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1399, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1400, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_7 = NULL;
     __pyx_t_4 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_7)) {
@@ -44933,65 +44949,65 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_kp_u_p_cnf};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1399, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1400, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1399, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1400, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_8) {
 
-      /* "sat_toolkit/formula.pyx":1400
+      /* "sat_toolkit/formula.pyx":1401
  * 
  *             if line.startswith('p cnf '):
  *                 if nvars != -1:             # <<<<<<<<<<<<<<
  *                     raise ValueError('multiple p cnf lines in dimacs')
  * 
  */
       __pyx_t_8 = (__pyx_v_nvars != -1L);
       if (unlikely(__pyx_t_8)) {
 
-        /* "sat_toolkit/formula.pyx":1401
+        /* "sat_toolkit/formula.pyx":1402
  *             if line.startswith('p cnf '):
  *                 if nvars != -1:
  *                     raise ValueError('multiple p cnf lines in dimacs')             # <<<<<<<<<<<<<<
  * 
  *                 tmp_nvars, tmp_nclauses = line[len('p cnf '):].split()
  */
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1401, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1402, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_Raise(__pyx_t_3, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __PYX_ERR(0, 1401, __pyx_L1_error)
+        __PYX_ERR(0, 1402, __pyx_L1_error)
 
-        /* "sat_toolkit/formula.pyx":1400
+        /* "sat_toolkit/formula.pyx":1401
  * 
  *             if line.startswith('p cnf '):
  *                 if nvars != -1:             # <<<<<<<<<<<<<<
  *                     raise ValueError('multiple p cnf lines in dimacs')
  * 
  */
       }
 
-      /* "sat_toolkit/formula.pyx":1403
+      /* "sat_toolkit/formula.pyx":1404
  *                     raise ValueError('multiple p cnf lines in dimacs')
  * 
  *                 tmp_nvars, tmp_nclauses = line[len('p cnf '):].split()             # <<<<<<<<<<<<<<
  *                 nvars = int(tmp_nvars)
  *                 nclaues = int(tmp_nclauses)
  */
-      __pyx_t_9 = __Pyx_PyUnicode_GET_LENGTH(__pyx_kp_u_p_cnf); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1403, __pyx_L1_error)
-      __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_line, __pyx_t_9, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1403, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyUnicode_GET_LENGTH(__pyx_kp_u_p_cnf); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1404, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_line, __pyx_t_9, 0, NULL, NULL, NULL, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1404, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_split); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1403, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_split); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1404, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       __pyx_t_4 = 0;
       #if CYTHON_UNPACK_METHODS
       if (likely(PyMethod_Check(__pyx_t_7))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
@@ -45004,112 +45020,112 @@
         }
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1403, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1404, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       }
       if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
         PyObject* sequence = __pyx_t_3;
         Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
         if (unlikely(size != 2)) {
           if (size > 2) __Pyx_RaiseTooManyValuesError(2);
           else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 1403, __pyx_L1_error)
+          __PYX_ERR(0, 1404, __pyx_L1_error)
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
         if (likely(PyTuple_CheckExact(sequence))) {
           __pyx_t_7 = PyTuple_GET_ITEM(sequence, 0); 
           __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
         } else {
           __pyx_t_7 = PyList_GET_ITEM(sequence, 0); 
           __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
         }
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_2);
         #else
-        __pyx_t_7 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1403, __pyx_L1_error)
+        __pyx_t_7 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1404, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1403, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1404, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else {
         Py_ssize_t index = -1;
-        __pyx_t_10 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1403, __pyx_L1_error)
+        __pyx_t_10 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1404, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_11 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_10);
         index = 0; __pyx_t_7 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_7)) goto __pyx_L8_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_7);
         index = 1; __pyx_t_2 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_2)) goto __pyx_L8_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_2);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_11(__pyx_t_10), 2) < 0) __PYX_ERR(0, 1403, __pyx_L1_error)
+        if (__Pyx_IternextUnpackEndCheck(__pyx_t_11(__pyx_t_10), 2) < 0) __PYX_ERR(0, 1404, __pyx_L1_error)
         __pyx_t_11 = NULL;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         goto __pyx_L9_unpacking_done;
         __pyx_L8_unpacking_failed:;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __pyx_t_11 = NULL;
         if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 1403, __pyx_L1_error)
+        __PYX_ERR(0, 1404, __pyx_L1_error)
         __pyx_L9_unpacking_done:;
       }
       __Pyx_XDECREF_SET(__pyx_v_tmp_nvars, __pyx_t_7);
       __pyx_t_7 = 0;
       __Pyx_XDECREF_SET(__pyx_v_tmp_nclauses, __pyx_t_2);
       __pyx_t_2 = 0;
 
-      /* "sat_toolkit/formula.pyx":1404
+      /* "sat_toolkit/formula.pyx":1405
  * 
  *                 tmp_nvars, tmp_nclauses = line[len('p cnf '):].split()
  *                 nvars = int(tmp_nvars)             # <<<<<<<<<<<<<<
  *                 nclaues = int(tmp_nclauses)
  * 
  */
-      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_tmp_nvars); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1404, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_tmp_nvars); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1405, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1404, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1405, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_v_nvars = __pyx_t_4;
 
-      /* "sat_toolkit/formula.pyx":1405
+      /* "sat_toolkit/formula.pyx":1406
  *                 tmp_nvars, tmp_nclauses = line[len('p cnf '):].split()
  *                 nvars = int(tmp_nvars)
  *                 nclaues = int(tmp_nclauses)             # <<<<<<<<<<<<<<
  * 
  *             elif line.startswith('x'):
  */
-      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_tmp_nclauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1405, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_tmp_nclauses); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1406, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_XDECREF_SET(__pyx_v_nclaues, __pyx_t_3);
       __pyx_t_3 = 0;
 
-      /* "sat_toolkit/formula.pyx":1399
+      /* "sat_toolkit/formula.pyx":1400
  *                 continue
  * 
  *             if line.startswith('p cnf '):             # <<<<<<<<<<<<<<
  *                 if nvars != -1:
  *                     raise ValueError('multiple p cnf lines in dimacs')
  */
       goto __pyx_L6;
     }
 
-    /* "sat_toolkit/formula.pyx":1407
+    /* "sat_toolkit/formula.pyx":1408
  *                 nclaues = int(tmp_nclauses)
  * 
  *             elif line.startswith('x'):             # <<<<<<<<<<<<<<
  *                 xors.add_clauses([int(x) for x in line[1:].split()])
  *             else:
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1407, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1408, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_7 = NULL;
     __pyx_t_4 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_7)) {
@@ -45121,37 +45137,37 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_n_u_x};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1407, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1408, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1407, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_8 < 0))) __PYX_ERR(0, 1408, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_8) {
 
-      /* "sat_toolkit/formula.pyx":1408
+      /* "sat_toolkit/formula.pyx":1409
  * 
  *             elif line.startswith('x'):
  *                 xors.add_clauses([int(x) for x in line[1:].split()])             # <<<<<<<<<<<<<<
  *             else:
  *                 clauses.add_clauses([int(x) for x in line.split()])
  */
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_xors), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1408, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_xors), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       { /* enter inner scope */
-        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1408, __pyx_L12_error)
+        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1409, __pyx_L12_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_line, 1, 0, NULL, NULL, &__pyx_slice__46, 1, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1408, __pyx_L12_error)
+        __pyx_t_12 = __Pyx_PyObject_GetSlice(__pyx_v_line, 1, 0, NULL, NULL, &__pyx_slice__46, 1, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1409, __pyx_L12_error)
         __Pyx_GOTREF(__pyx_t_12);
-        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_split); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1408, __pyx_L12_error)
+        __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_split); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1409, __pyx_L12_error)
         __Pyx_GOTREF(__pyx_t_13);
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         __pyx_t_12 = NULL;
         __pyx_t_4 = 0;
         #if CYTHON_UNPACK_METHODS
         if (likely(PyMethod_Check(__pyx_t_13))) {
           __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_13);
@@ -45164,76 +45180,76 @@
           }
         }
         #endif
         {
           PyObject *__pyx_callargs[2] = {__pyx_t_12, NULL};
           __pyx_t_10 = __Pyx_PyObject_FastCall(__pyx_t_13, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
           __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1408, __pyx_L12_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1409, __pyx_L12_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         }
         if (likely(PyList_CheckExact(__pyx_t_10)) || PyTuple_CheckExact(__pyx_t_10)) {
           __pyx_t_13 = __pyx_t_10; __Pyx_INCREF(__pyx_t_13);
           __pyx_t_9 = 0;
           __pyx_t_14 = NULL;
         } else {
-          __pyx_t_9 = -1; __pyx_t_13 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1408, __pyx_L12_error)
+          __pyx_t_9 = -1; __pyx_t_13 = PyObject_GetIter(__pyx_t_10); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1409, __pyx_L12_error)
           __Pyx_GOTREF(__pyx_t_13);
-          __pyx_t_14 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1408, __pyx_L12_error)
+          __pyx_t_14 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1409, __pyx_L12_error)
         }
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         for (;;) {
           if (likely(!__pyx_t_14)) {
             if (likely(PyList_CheckExact(__pyx_t_13))) {
               {
                 Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_13);
                 #if !CYTHON_ASSUME_SAFE_MACROS
-                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1408, __pyx_L12_error)
+                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1409, __pyx_L12_error)
                 #endif
                 if (__pyx_t_9 >= __pyx_temp) break;
               }
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_10 = PyList_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_10); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1408, __pyx_L12_error)
+              __pyx_t_10 = PyList_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_10); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1409, __pyx_L12_error)
               #else
-              __pyx_t_10 = __Pyx_PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1408, __pyx_L12_error)
+              __pyx_t_10 = __Pyx_PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1409, __pyx_L12_error)
               __Pyx_GOTREF(__pyx_t_10);
               #endif
             } else {
               {
                 Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_13);
                 #if !CYTHON_ASSUME_SAFE_MACROS
-                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1408, __pyx_L12_error)
+                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1409, __pyx_L12_error)
                 #endif
                 if (__pyx_t_9 >= __pyx_temp) break;
               }
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_10); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1408, __pyx_L12_error)
+              __pyx_t_10 = PyTuple_GET_ITEM(__pyx_t_13, __pyx_t_9); __Pyx_INCREF(__pyx_t_10); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1409, __pyx_L12_error)
               #else
-              __pyx_t_10 = __Pyx_PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1408, __pyx_L12_error)
+              __pyx_t_10 = __Pyx_PySequence_ITEM(__pyx_t_13, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1409, __pyx_L12_error)
               __Pyx_GOTREF(__pyx_t_10);
               #endif
             }
           } else {
             __pyx_t_10 = __pyx_t_14(__pyx_t_13);
             if (unlikely(!__pyx_t_10)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 1408, __pyx_L12_error)
+                else __PYX_ERR(0, 1409, __pyx_L12_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_10);
           }
           __Pyx_XDECREF_SET(__pyx_7genexpr__pyx_v_x, __pyx_t_10);
           __pyx_t_10 = 0;
-          __pyx_t_10 = __Pyx_PyNumber_Int(__pyx_7genexpr__pyx_v_x); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1408, __pyx_L12_error)
+          __pyx_t_10 = __Pyx_PyNumber_Int(__pyx_7genexpr__pyx_v_x); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1409, __pyx_L12_error)
           __Pyx_GOTREF(__pyx_t_10);
-          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 1408, __pyx_L12_error)
+          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_10))) __PYX_ERR(0, 1409, __pyx_L12_error)
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_XDECREF(__pyx_7genexpr__pyx_v_x); __pyx_7genexpr__pyx_v_x = 0;
         goto __pyx_L16_exit_scope;
         __pyx_L12_error:;
         __Pyx_XDECREF(__pyx_7genexpr__pyx_v_x); __pyx_7genexpr__pyx_v_x = 0;
@@ -45255,44 +45271,44 @@
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_13, __pyx_t_7};
         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
         __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1408, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1409, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "sat_toolkit/formula.pyx":1407
+      /* "sat_toolkit/formula.pyx":1408
  *                 nclaues = int(tmp_nclauses)
  * 
  *             elif line.startswith('x'):             # <<<<<<<<<<<<<<
  *                 xors.add_clauses([int(x) for x in line[1:].split()])
  *             else:
  */
       goto __pyx_L6;
     }
 
-    /* "sat_toolkit/formula.pyx":1410
+    /* "sat_toolkit/formula.pyx":1411
  *                 xors.add_clauses([int(x) for x in line[1:].split()])
  *             else:
  *                 clauses.add_clauses([int(x) for x in line.split()])             # <<<<<<<<<<<<<<
  * 
  *         if nvars == -1:
  */
     /*else*/ {
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1410, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1411, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       { /* enter inner scope */
-        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1410, __pyx_L19_error)
+        __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1411, __pyx_L19_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_split); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1410, __pyx_L19_error)
+        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_split); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1411, __pyx_L19_error)
         __Pyx_GOTREF(__pyx_t_10);
         __pyx_t_12 = NULL;
         __pyx_t_4 = 0;
         #if CYTHON_UNPACK_METHODS
         if (likely(PyMethod_Check(__pyx_t_10))) {
           __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_10);
           if (likely(__pyx_t_12)) {
@@ -45304,76 +45320,76 @@
           }
         }
         #endif
         {
           PyObject *__pyx_callargs[2] = {__pyx_t_12, NULL};
           __pyx_t_13 = __Pyx_PyObject_FastCall(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
           __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1410, __pyx_L19_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1411, __pyx_L19_error)
           __Pyx_GOTREF(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         if (likely(PyList_CheckExact(__pyx_t_13)) || PyTuple_CheckExact(__pyx_t_13)) {
           __pyx_t_10 = __pyx_t_13; __Pyx_INCREF(__pyx_t_10);
           __pyx_t_9 = 0;
           __pyx_t_14 = NULL;
         } else {
-          __pyx_t_9 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_t_13); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1410, __pyx_L19_error)
+          __pyx_t_9 = -1; __pyx_t_10 = PyObject_GetIter(__pyx_t_13); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1411, __pyx_L19_error)
           __Pyx_GOTREF(__pyx_t_10);
-          __pyx_t_14 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_10); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1410, __pyx_L19_error)
+          __pyx_t_14 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_10); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1411, __pyx_L19_error)
         }
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         for (;;) {
           if (likely(!__pyx_t_14)) {
             if (likely(PyList_CheckExact(__pyx_t_10))) {
               {
                 Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_10);
                 #if !CYTHON_ASSUME_SAFE_MACROS
-                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1410, __pyx_L19_error)
+                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1411, __pyx_L19_error)
                 #endif
                 if (__pyx_t_9 >= __pyx_temp) break;
               }
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_13 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_9); __Pyx_INCREF(__pyx_t_13); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1410, __pyx_L19_error)
+              __pyx_t_13 = PyList_GET_ITEM(__pyx_t_10, __pyx_t_9); __Pyx_INCREF(__pyx_t_13); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1411, __pyx_L19_error)
               #else
-              __pyx_t_13 = __Pyx_PySequence_ITEM(__pyx_t_10, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1410, __pyx_L19_error)
+              __pyx_t_13 = __Pyx_PySequence_ITEM(__pyx_t_10, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1411, __pyx_L19_error)
               __Pyx_GOTREF(__pyx_t_13);
               #endif
             } else {
               {
                 Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_10);
                 #if !CYTHON_ASSUME_SAFE_MACROS
-                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1410, __pyx_L19_error)
+                if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1411, __pyx_L19_error)
                 #endif
                 if (__pyx_t_9 >= __pyx_temp) break;
               }
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_13 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_9); __Pyx_INCREF(__pyx_t_13); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1410, __pyx_L19_error)
+              __pyx_t_13 = PyTuple_GET_ITEM(__pyx_t_10, __pyx_t_9); __Pyx_INCREF(__pyx_t_13); __pyx_t_9++; if (unlikely((0 < 0))) __PYX_ERR(0, 1411, __pyx_L19_error)
               #else
-              __pyx_t_13 = __Pyx_PySequence_ITEM(__pyx_t_10, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1410, __pyx_L19_error)
+              __pyx_t_13 = __Pyx_PySequence_ITEM(__pyx_t_10, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1411, __pyx_L19_error)
               __Pyx_GOTREF(__pyx_t_13);
               #endif
             }
           } else {
             __pyx_t_13 = __pyx_t_14(__pyx_t_10);
             if (unlikely(!__pyx_t_13)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 1410, __pyx_L19_error)
+                else __PYX_ERR(0, 1411, __pyx_L19_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_13);
           }
           __Pyx_XDECREF_SET(__pyx_8genexpr1__pyx_v_x, __pyx_t_13);
           __pyx_t_13 = 0;
-          __pyx_t_13 = __Pyx_PyNumber_Int(__pyx_8genexpr1__pyx_v_x); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1410, __pyx_L19_error)
+          __pyx_t_13 = __Pyx_PyNumber_Int(__pyx_8genexpr1__pyx_v_x); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1411, __pyx_L19_error)
           __Pyx_GOTREF(__pyx_t_13);
-          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_13))) __PYX_ERR(0, 1410, __pyx_L19_error)
+          if (unlikely(__Pyx_ListComp_Append(__pyx_t_7, (PyObject*)__pyx_t_13))) __PYX_ERR(0, 1411, __pyx_L19_error)
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         }
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_x); __pyx_8genexpr1__pyx_v_x = 0;
         goto __pyx_L23_exit_scope;
         __pyx_L19_error:;
         __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_x); __pyx_8genexpr1__pyx_v_x = 0;
@@ -45395,66 +45411,66 @@
       }
       #endif
       {
         PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_7};
         __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1410, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1411, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __pyx_L6:;
 
-    /* "sat_toolkit/formula.pyx":1395
+    /* "sat_toolkit/formula.pyx":1396
  *         lines = io.StringIO(dimacs)
  * 
  *         for line in lines:             # <<<<<<<<<<<<<<
  *             if line.startswith('c'):
  *                 continue
  */
     __pyx_L3_continue:;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1412
+  /* "sat_toolkit/formula.pyx":1413
  *                 clauses.add_clauses([int(x) for x in line.split()])
  * 
  *         if nvars == -1:             # <<<<<<<<<<<<<<
  *             raise ValueError('no \'p cnf ...\' line in dimacs')
  * 
  */
   __pyx_t_8 = (__pyx_v_nvars == -1L);
   if (unlikely(__pyx_t_8)) {
 
-    /* "sat_toolkit/formula.pyx":1413
+    /* "sat_toolkit/formula.pyx":1414
  * 
  *         if nvars == -1:
  *             raise ValueError('no \'p cnf ...\' line in dimacs')             # <<<<<<<<<<<<<<
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1413, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1414, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1413, __pyx_L1_error)
+    __PYX_ERR(0, 1414, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1412
+    /* "sat_toolkit/formula.pyx":1413
  *                 clauses.add_clauses([int(x) for x in line.split()])
  * 
  *         if nvars == -1:             # <<<<<<<<<<<<<<
  *             raise ValueError('no \'p cnf ...\' line in dimacs')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1415
+  /* "sat_toolkit/formula.pyx":1416
  *             raise ValueError('no \'p cnf ...\' line in dimacs')
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):             # <<<<<<<<<<<<<<
  *             raise ValueError('nvars in p cnf line is smaller than the biggest encountered variable')
  * 
  */
   __pyx_t_4 = __pyx_v_xors->__pyx_base.nvars;
@@ -45464,74 +45480,74 @@
     __pyx_t_16 = __pyx_t_4;
   } else {
     __pyx_t_16 = __pyx_t_15;
   }
   __pyx_t_8 = (__pyx_v_nvars < __pyx_t_16);
   if (unlikely(__pyx_t_8)) {
 
-    /* "sat_toolkit/formula.pyx":1416
+    /* "sat_toolkit/formula.pyx":1417
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):
  *             raise ValueError('nvars in p cnf line is smaller than the biggest encountered variable')             # <<<<<<<<<<<<<<
  * 
  *         clauses.nvars = nvars
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1416, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1416, __pyx_L1_error)
+    __PYX_ERR(0, 1417, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1415
+    /* "sat_toolkit/formula.pyx":1416
  *             raise ValueError('no \'p cnf ...\' line in dimacs')
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):             # <<<<<<<<<<<<<<
  *             raise ValueError('nvars in p cnf line is smaller than the biggest encountered variable')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1418
+  /* "sat_toolkit/formula.pyx":1419
  *             raise ValueError('nvars in p cnf line is smaller than the biggest encountered variable')
  * 
  *         clauses.nvars = nvars             # <<<<<<<<<<<<<<
  *         xors.nvars = nvars
  * 
  */
   __pyx_v_clauses->__pyx_base.nvars = __pyx_v_nvars;
 
-  /* "sat_toolkit/formula.pyx":1419
+  /* "sat_toolkit/formula.pyx":1420
  * 
  *         clauses.nvars = nvars
  *         xors.nvars = nvars             # <<<<<<<<<<<<<<
  * 
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  */
   __pyx_v_xors->__pyx_base.nvars = __pyx_v_nvars;
 
-  /* "sat_toolkit/formula.pyx":1421
+  /* "sat_toolkit/formula.pyx":1422
  *         xors.nvars = nvars
  * 
  *         return XorCNF(clauses=clauses, xor_clauses=xors)             # <<<<<<<<<<<<<<
  * 
  *     @staticmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1421, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_clauses, ((PyObject *)__pyx_v_clauses)) < 0) __PYX_ERR(0, 1421, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_xor_clauses, ((PyObject *)__pyx_v_xors)) < 0) __PYX_ERR(0, 1421, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1421, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_clauses, ((PyObject *)__pyx_v_clauses)) < 0) __PYX_ERR(0, 1422, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_xor_clauses, ((PyObject *)__pyx_v_xors)) < 0) __PYX_ERR(0, 1422, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_3);
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1386
+  /* "sat_toolkit/formula.pyx":1387
  * 
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)
  */
 
@@ -45557,15 +45573,15 @@
   __Pyx_XDECREF(__pyx_7genexpr__pyx_v_x);
   __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_x);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1423
+/* "sat_toolkit/formula.pyx":1424
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
 
@@ -45592,15 +45608,15 @@
   #endif
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
   __Pyx_INCREF(__pyx_args);
   __pyx_v_args = __pyx_args;
   {
     PyObject **__pyx_pyargnames[] = {&__pyx_n_s_rhs,0};
 
-    /* "sat_toolkit/formula.pyx":1424
+    /* "sat_toolkit/formula.pyx":1425
  * 
  *     @staticmethod
  *     def create_xor(*args, rhs=None) -> XorCNF:             # <<<<<<<<<<<<<<
  *         """
  *         creates an XorCNF specifying the xor of the arguments is equal to the right
  */
     values[0] = __Pyx_Arg_NewRef_VARARGS(((PyObject *)Py_None));
@@ -45611,28 +45627,28 @@
         case  0: break;
       }
       kw_args = __Pyx_NumKwargs_VARARGS(__pyx_kwds);
       if (kw_args == 1) {
         const Py_ssize_t index = 0;
         PyObject* value = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
         if (value) { values[index] = __Pyx_Arg_NewRef_VARARGS(value); kw_args--; }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1423, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1424, __pyx_L3_error)
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "create_xor") < 0)) __PYX_ERR(0, 1423, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "create_xor") < 0)) __PYX_ERR(0, 1424, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs < 0)) {
       goto __pyx_L5_argtuple_error;
     } else {
     }
     __pyx_v_rhs = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("create_xor", 0, 0, 0, __pyx_nargs); __PYX_ERR(0, 1423, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("create_xor", 0, 0, 0, __pyx_nargs); __PYX_ERR(0, 1424, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_VARARGS(values[__pyx_temp]);
@@ -45641,15 +45657,15 @@
   __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.create_xor", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_6XorCNF_6create_xor(__pyx_v_rhs, __pyx_v_args);
 
-  /* "sat_toolkit/formula.pyx":1423
+  /* "sat_toolkit/formula.pyx":1424
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
 
@@ -45706,34 +45722,34 @@
   size_t __pyx_t_27;
   __Pyx_memviewslice __pyx_t_28 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("create_xor", 1);
 
-  /* "sat_toolkit/formula.pyx":1434
+  /* "sat_toolkit/formula.pyx":1435
  *         Each argument is a 1-D array. The xors are computed elementwise.
  *         """
  *         cdef size_t num_args = len(args)             # <<<<<<<<<<<<<<
  *         cdef size_t num_xors = -1
  *         cdef size_t i, j
  */
-  __pyx_t_1 = __Pyx_PyTuple_GET_SIZE(__pyx_v_args); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1434, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyTuple_GET_SIZE(__pyx_v_args); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1435, __pyx_L1_error)
   __pyx_v_num_args = __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":1435
+  /* "sat_toolkit/formula.pyx":1436
  *         """
  *         cdef size_t num_args = len(args)
  *         cdef size_t num_xors = -1             # <<<<<<<<<<<<<<
  *         cdef size_t i, j
  * 
  */
   __pyx_v_num_xors = -1L;
 
-  /* "sat_toolkit/formula.pyx":1440
+  /* "sat_toolkit/formula.pyx":1441
  *         cdef int[::1] rhs_view
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             rhs_view = rhs
  *         except (TypeError, ValueError):
  */
   {
@@ -45741,27 +45757,27 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_2, &__pyx_t_3, &__pyx_t_4);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_4);
     /*try:*/ {
 
-      /* "sat_toolkit/formula.pyx":1441
+      /* "sat_toolkit/formula.pyx":1442
  * 
  *         try:
  *             rhs_view = rhs             # <<<<<<<<<<<<<<
  *         except (TypeError, ValueError):
  *             rhs_view = np.array(rhs, dtype=np.int32)
  */
-      __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_rhs, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1441, __pyx_L3_error)
+      __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_v_rhs, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1442, __pyx_L3_error)
       __pyx_v_rhs_view = __pyx_t_5;
       __pyx_t_5.memview = NULL;
       __pyx_t_5.data = NULL;
 
-      /* "sat_toolkit/formula.pyx":1440
+      /* "sat_toolkit/formula.pyx":1441
  *         cdef int[::1] rhs_view
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             rhs_view = rhs
  *         except (TypeError, ValueError):
  */
     }
@@ -45769,74 +45785,74 @@
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_5, 1);
     __pyx_t_5.memview = NULL; __pyx_t_5.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":1442
+    /* "sat_toolkit/formula.pyx":1443
  *         try:
  *             rhs_view = rhs
  *         except (TypeError, ValueError):             # <<<<<<<<<<<<<<
  *             rhs_view = np.array(rhs, dtype=np.int32)
  * 
  */
     __pyx_t_6 = __Pyx_PyErr_ExceptionMatches2(__pyx_builtin_TypeError, __pyx_builtin_ValueError);
     if (__pyx_t_6) {
       __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.create_xor", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9) < 0) __PYX_ERR(0, 1442, __pyx_L5_except_error)
+      if (__Pyx_GetException(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9) < 0) __PYX_ERR(0, 1443, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_7);
       __Pyx_XGOTREF(__pyx_t_8);
       __Pyx_XGOTREF(__pyx_t_9);
 
-      /* "sat_toolkit/formula.pyx":1443
+      /* "sat_toolkit/formula.pyx":1444
  *             rhs_view = rhs
  *         except (TypeError, ValueError):
  *             rhs_view = np.array(rhs, dtype=np.int32)             # <<<<<<<<<<<<<<
  * 
  *         if num_args < 1:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1444, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1444, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
+      __pyx_t_10 = PyTuple_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1444, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_INCREF(__pyx_v_rhs);
       __Pyx_GIVEREF(__pyx_v_rhs);
-      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_rhs)) __PYX_ERR(0, 1443, __pyx_L5_except_error);
-      __pyx_t_12 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
+      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_rhs)) __PYX_ERR(0, 1444, __pyx_L5_except_error);
+      __pyx_t_12 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1444, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_12);
-      __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_13, __pyx_n_s_np); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1444, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_13);
-      __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_int32); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
+      __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_int32); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1444, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_dtype, __pyx_t_14) < 0) __PYX_ERR(0, 1443, __pyx_L5_except_error)
+      if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_dtype, __pyx_t_14) < 0) __PYX_ERR(0, 1444, __pyx_L5_except_error)
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-      __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_10, __pyx_t_12); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
+      __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_10, __pyx_t_12); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1444, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_14, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1443, __pyx_L5_except_error)
+      __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dc_int(__pyx_t_14, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1444, __pyx_L5_except_error)
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __PYX_XCLEAR_MEMVIEW(&__pyx_v_rhs_view, 1);
       __pyx_v_rhs_view = __pyx_t_5;
       __pyx_t_5.memview = NULL;
       __pyx_t_5.data = NULL;
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       goto __pyx_L4_exception_handled;
     }
     goto __pyx_L5_except_error;
 
-    /* "sat_toolkit/formula.pyx":1440
+    /* "sat_toolkit/formula.pyx":1441
  *         cdef int[::1] rhs_view
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             rhs_view = rhs
  *         except (TypeError, ValueError):
  */
     __pyx_L5_except_error:;
@@ -45849,60 +45865,60 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_XGIVEREF(__pyx_t_4);
     __Pyx_ExceptionReset(__pyx_t_2, __pyx_t_3, __pyx_t_4);
     __pyx_L8_try_end:;
   }
 
-  /* "sat_toolkit/formula.pyx":1445
+  /* "sat_toolkit/formula.pyx":1446
  *             rhs_view = np.array(rhs, dtype=np.int32)
  * 
  *         if num_args < 1:             # <<<<<<<<<<<<<<
  *             raise ValueError('must provide at least one argument')
  * 
  */
   __pyx_t_15 = (__pyx_v_num_args < 1);
   if (unlikely(__pyx_t_15)) {
 
-    /* "sat_toolkit/formula.pyx":1446
+    /* "sat_toolkit/formula.pyx":1447
  * 
  *         if num_args < 1:
  *             raise ValueError('must provide at least one argument')             # <<<<<<<<<<<<<<
  * 
  *         num_xors = len(args[0])
  */
-    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1446, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__32, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1447, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_Raise(__pyx_t_9, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __PYX_ERR(0, 1446, __pyx_L1_error)
+    __PYX_ERR(0, 1447, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1445
+    /* "sat_toolkit/formula.pyx":1446
  *             rhs_view = np.array(rhs, dtype=np.int32)
  * 
  *         if num_args < 1:             # <<<<<<<<<<<<<<
  *             raise ValueError('must provide at least one argument')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1448
+  /* "sat_toolkit/formula.pyx":1449
  *             raise ValueError('must provide at least one argument')
  * 
  *         num_xors = len(args[0])             # <<<<<<<<<<<<<<
  * 
  *         if rhs_view is not None and len(rhs_view) != num_xors:
  */
   __pyx_t_9 = PyTuple_GET_ITEM(__pyx_v_args, 0);
   __Pyx_INCREF(__pyx_t_9);
-  __pyx_t_1 = PyObject_Length(__pyx_t_9); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1448, __pyx_L1_error)
+  __pyx_t_1 = PyObject_Length(__pyx_t_9); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1449, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __pyx_v_num_xors = __pyx_t_1;
 
-  /* "sat_toolkit/formula.pyx":1450
+  /* "sat_toolkit/formula.pyx":1451
  *         num_xors = len(args[0])
  * 
  *         if rhs_view is not None and len(rhs_view) != num_xors:             # <<<<<<<<<<<<<<
  *             raise ValueError('rhs must have the same length as the arguments')
  * 
  */
   __pyx_t_16 = (((PyObject *) __pyx_v_rhs_view.memview) != Py_None);
@@ -45913,63 +45929,63 @@
   }
   __pyx_t_1 = __Pyx_MemoryView_Len(__pyx_v_rhs_view); 
   __pyx_t_16 = (__pyx_t_1 != __pyx_v_num_xors);
   __pyx_t_15 = __pyx_t_16;
   __pyx_L13_bool_binop_done:;
   if (unlikely(__pyx_t_15)) {
 
-    /* "sat_toolkit/formula.pyx":1451
+    /* "sat_toolkit/formula.pyx":1452
  * 
  *         if rhs_view is not None and len(rhs_view) != num_xors:
  *             raise ValueError('rhs must have the same length as the arguments')             # <<<<<<<<<<<<<<
  * 
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  */
-    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1451, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1452, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_Raise(__pyx_t_9, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __PYX_ERR(0, 1451, __pyx_L1_error)
+    __PYX_ERR(0, 1452, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1450
+    /* "sat_toolkit/formula.pyx":1451
  *         num_xors = len(args[0])
  * 
  *         if rhs_view is not None and len(rhs_view) != num_xors:             # <<<<<<<<<<<<<<
  *             raise ValueError('rhs must have the same length as the arguments')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1453
+  /* "sat_toolkit/formula.pyx":1454
  *             raise ValueError('rhs must have the same length as the arguments')
  * 
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)             # <<<<<<<<<<<<<<
  * 
  *         for i, arg in enumerate(args):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1454, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1454, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = __Pyx_PyInt_FromSize_t(__pyx_v_num_xors); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_FromSize_t(__pyx_v_num_xors); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1454, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_14 = __Pyx_PyInt_FromSize_t((__pyx_v_num_args + 1)); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyInt_FromSize_t((__pyx_v_num_args + 1)); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1454, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
-  __pyx_t_12 = PyTuple_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_12 = PyTuple_New(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1454, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_GIVEREF(__pyx_t_8);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_8)) __PYX_ERR(0, 1453, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_8)) __PYX_ERR(0, 1454, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_14);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_12, 1, __pyx_t_14)) __PYX_ERR(0, 1453, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_12, 1, __pyx_t_14)) __PYX_ERR(0, 1454, __pyx_L1_error);
   __pyx_t_8 = 0;
   __pyx_t_14 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1454, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_int32); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1453, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_int32); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1454, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
   __pyx_t_14 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_7);
@@ -45984,105 +46000,105 @@
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_14, __pyx_t_12, __pyx_t_8};
     __pyx_t_9 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1453, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __pyx_v_packed_args = __pyx_t_9;
   __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":1455
+  /* "sat_toolkit/formula.pyx":1456
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  * 
  *         for i, arg in enumerate(args):             # <<<<<<<<<<<<<<
  *             packed_args[:, i] = arg
  * 
  */
   __pyx_t_17 = 0;
   __pyx_t_9 = __pyx_v_args; __Pyx_INCREF(__pyx_t_9);
   __pyx_t_1 = 0;
   for (;;) {
     {
       Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_9);
       #if !CYTHON_ASSUME_SAFE_MACROS
-      if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1455, __pyx_L1_error)
+      if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1456, __pyx_L1_error)
       #endif
       if (__pyx_t_1 >= __pyx_temp) break;
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_1); __Pyx_INCREF(__pyx_t_7); __pyx_t_1++; if (unlikely((0 < 0))) __PYX_ERR(0, 1455, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_1); __Pyx_INCREF(__pyx_t_7); __pyx_t_1++; if (unlikely((0 < 0))) __PYX_ERR(0, 1456, __pyx_L1_error)
     #else
-    __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_9, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1455, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PySequence_ITEM(__pyx_t_9, __pyx_t_1); __pyx_t_1++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1456, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     #endif
     __Pyx_XDECREF_SET(__pyx_v_arg, __pyx_t_7);
     __pyx_t_7 = 0;
     __pyx_v_i = __pyx_t_17;
     __pyx_t_17 = (__pyx_t_17 + 1);
 
-    /* "sat_toolkit/formula.pyx":1456
+    /* "sat_toolkit/formula.pyx":1457
  * 
  *         for i, arg in enumerate(args):
  *             packed_args[:, i] = arg             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_7 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1456, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1457, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1456, __pyx_L1_error)
+    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1457, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_slice__5)) __PYX_ERR(0, 1456, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_slice__5)) __PYX_ERR(0, 1457, __pyx_L1_error);
     __Pyx_GIVEREF(__pyx_t_7);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_7)) __PYX_ERR(0, 1456, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_7)) __PYX_ERR(0, 1457, __pyx_L1_error);
     __pyx_t_7 = 0;
-    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_8, __pyx_v_arg) < 0))) __PYX_ERR(0, 1456, __pyx_L1_error)
+    if (unlikely((PyObject_SetItem(__pyx_v_packed_args, __pyx_t_8, __pyx_v_arg) < 0))) __PYX_ERR(0, 1457, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "sat_toolkit/formula.pyx":1455
+    /* "sat_toolkit/formula.pyx":1456
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  * 
  *         for i, arg in enumerate(args):             # <<<<<<<<<<<<<<
  *             packed_args[:, i] = arg
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":1459
+  /* "sat_toolkit/formula.pyx":1460
  * 
  * 
  *         cdef int[:, ::1] packed_args_view = packed_args             # <<<<<<<<<<<<<<
  * 
  *         for i in range(num_xors):
  */
-  __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_int(__pyx_v_packed_args, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 1459, __pyx_L1_error)
+  __pyx_t_18 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_int(__pyx_v_packed_args, PyBUF_WRITABLE); if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 1460, __pyx_L1_error)
   __pyx_v_packed_args_view = __pyx_t_18;
   __pyx_t_18.memview = NULL;
   __pyx_t_18.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1461
+  /* "sat_toolkit/formula.pyx":1462
  *         cdef int[:, ::1] packed_args_view = packed_args
  * 
  *         for i in range(num_xors):             # <<<<<<<<<<<<<<
  *             if rhs_view is not None and rhs_view[i] not in [0, 1]:
  *                 raise ValueError(f"right hand side must be 0 or 1, not {rhs_view[i]}")
  */
   __pyx_t_17 = __pyx_v_num_xors;
   __pyx_t_19 = __pyx_t_17;
   for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
     __pyx_v_i = __pyx_t_20;
 
-    /* "sat_toolkit/formula.pyx":1462
+    /* "sat_toolkit/formula.pyx":1463
  * 
  *         for i in range(num_xors):
  *             if rhs_view is not None and rhs_view[i] not in [0, 1]:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f"right hand side must be 0 or 1, not {rhs_view[i]}")
  * 
  */
     __pyx_t_16 = (((PyObject *) __pyx_v_rhs_view.memview) != Py_None);
@@ -46103,44 +46119,44 @@
     __pyx_t_16 = __pyx_t_22;
     __pyx_L23_bool_binop_done:;
     __pyx_t_22 = __pyx_t_16;
     __pyx_t_15 = __pyx_t_22;
     __pyx_L21_bool_binop_done:;
     if (unlikely(__pyx_t_15)) {
 
-      /* "sat_toolkit/formula.pyx":1463
+      /* "sat_toolkit/formula.pyx":1464
  *         for i in range(num_xors):
  *             if rhs_view is not None and rhs_view[i] not in [0, 1]:
  *                 raise ValueError(f"right hand side must be 0 or 1, not {rhs_view[i]}")             # <<<<<<<<<<<<<<
  * 
  *             # the default rhs value in cryptominisat is 1 while our default is 0
  */
       __pyx_t_21 = __pyx_v_i;
-      __pyx_t_9 = __Pyx_PyUnicode_From_int((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_rhs_view.data) + __pyx_t_21)) ))), 0, ' ', 'd'); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1463, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyUnicode_From_int((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_rhs_view.data) + __pyx_t_21)) ))), 0, ' ', 'd'); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1464, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_right_hand_side_must_be_0_or_1_n, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1463, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Concat(__pyx_kp_u_right_hand_side_must_be_0_or_1_n, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1464, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1463, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1464, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_9, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __PYX_ERR(0, 1463, __pyx_L1_error)
+      __PYX_ERR(0, 1464, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":1462
+      /* "sat_toolkit/formula.pyx":1463
  * 
  *         for i in range(num_xors):
  *             if rhs_view is not None and rhs_view[i] not in [0, 1]:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f"right hand side must be 0 or 1, not {rhs_view[i]}")
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":1468
+    /* "sat_toolkit/formula.pyx":1469
  *             # so we need to flip the first sign if rhs is 0
  *             # (see https://www.msoos.org/xor-clauses/)
  *             if rhs_view is None or rhs_view[i] == 0:             # <<<<<<<<<<<<<<
  *                 packed_args_view[i, 0] *= -1
  * 
  */
     __pyx_t_22 = (((PyObject *) __pyx_v_rhs_view.memview) == Py_None);
@@ -46151,102 +46167,102 @@
     }
     __pyx_t_21 = __pyx_v_i;
     __pyx_t_22 = ((*((int *) ( /* dim=0 */ ((char *) (((int *) __pyx_v_rhs_view.data) + __pyx_t_21)) ))) == 0);
     __pyx_t_15 = __pyx_t_22;
     __pyx_L26_bool_binop_done:;
     if (__pyx_t_15) {
 
-      /* "sat_toolkit/formula.pyx":1469
+      /* "sat_toolkit/formula.pyx":1470
  *             # (see https://www.msoos.org/xor-clauses/)
  *             if rhs_view is None or rhs_view[i] == 0:
  *                 packed_args_view[i, 0] *= -1             # <<<<<<<<<<<<<<
  * 
  *             for j in range(num_args):
  */
       __pyx_t_21 = __pyx_v_i;
       __pyx_t_23 = 0;
       *((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_packed_args_view.data + __pyx_t_21 * __pyx_v_packed_args_view.strides[0]) )) + __pyx_t_23)) )) *= -1;
 
-      /* "sat_toolkit/formula.pyx":1468
+      /* "sat_toolkit/formula.pyx":1469
  *             # so we need to flip the first sign if rhs is 0
  *             # (see https://www.msoos.org/xor-clauses/)
  *             if rhs_view is None or rhs_view[i] == 0:             # <<<<<<<<<<<<<<
  *                 packed_args_view[i, 0] *= -1
  * 
  */
     }
 
-    /* "sat_toolkit/formula.pyx":1471
+    /* "sat_toolkit/formula.pyx":1472
  *                 packed_args_view[i, 0] *= -1
  * 
  *             for j in range(num_args):             # <<<<<<<<<<<<<<
  *                 if packed_args_view[i, j] == 0:
  *                     raise ValueError('all indices must be nonzero')
  */
     __pyx_t_21 = __pyx_v_num_args;
     __pyx_t_24 = __pyx_t_21;
     for (__pyx_t_25 = 0; __pyx_t_25 < __pyx_t_24; __pyx_t_25+=1) {
       __pyx_v_j = __pyx_t_25;
 
-      /* "sat_toolkit/formula.pyx":1472
+      /* "sat_toolkit/formula.pyx":1473
  * 
  *             for j in range(num_args):
  *                 if packed_args_view[i, j] == 0:             # <<<<<<<<<<<<<<
  *                     raise ValueError('all indices must be nonzero')
  * 
  */
       __pyx_t_26 = __pyx_v_i;
       __pyx_t_27 = __pyx_v_j;
       __pyx_t_15 = ((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_packed_args_view.data + __pyx_t_26 * __pyx_v_packed_args_view.strides[0]) )) + __pyx_t_27)) ))) == 0);
       if (unlikely(__pyx_t_15)) {
 
-        /* "sat_toolkit/formula.pyx":1473
+        /* "sat_toolkit/formula.pyx":1474
  *             for j in range(num_args):
  *                 if packed_args_view[i, j] == 0:
  *                     raise ValueError('all indices must be nonzero')             # <<<<<<<<<<<<<<
  * 
  *         cdef XorCNF res = XorCNF.__new__(XorCNF)
  */
-        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1473, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1474, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_Raise(__pyx_t_9, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        __PYX_ERR(0, 1473, __pyx_L1_error)
+        __PYX_ERR(0, 1474, __pyx_L1_error)
 
-        /* "sat_toolkit/formula.pyx":1472
+        /* "sat_toolkit/formula.pyx":1473
  * 
  *             for j in range(num_args):
  *                 if packed_args_view[i, j] == 0:             # <<<<<<<<<<<<<<
  *                     raise ValueError('all indices must be nonzero')
  * 
  */
       }
     }
   }
 
-  /* "sat_toolkit/formula.pyx":1475
+  /* "sat_toolkit/formula.pyx":1476
  *                     raise ValueError('all indices must be nonzero')
  * 
  *         cdef XorCNF res = XorCNF.__new__(XorCNF)             # <<<<<<<<<<<<<<
  *         res._xor_clauses._add_clauses(packed_args.reshape(-1))
  *         return res
  */
-  __pyx_t_9 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorCNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1475, __pyx_L1_error)
+  __pyx_t_9 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_XorCNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1476, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_9);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_9);
   __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":1476
+  /* "sat_toolkit/formula.pyx":1477
  * 
  *         cdef XorCNF res = XorCNF.__new__(XorCNF)
  *         res._xor_clauses._add_clauses(packed_args.reshape(-1))             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_packed_args, __pyx_n_s_reshape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1476, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_packed_args, __pyx_n_s_reshape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __pyx_t_7 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_8);
     if (likely(__pyx_t_7)) {
@@ -46258,37 +46274,37 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_int_neg_1};
     __pyx_t_9 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1476, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1477, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   }
-  __pyx_t_28 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_t_9, 0); if (unlikely(!__pyx_t_28.memview)) __PYX_ERR(0, 1476, __pyx_L1_error)
+  __pyx_t_28 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_t_9, 0); if (unlikely(!__pyx_t_28.memview)) __PYX_ERR(0, 1477, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_res->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->_xor_clauses), __pyx_t_28); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 1476, __pyx_L1_error)
+  __pyx_t_6 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_res->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res->_xor_clauses), __pyx_t_28); if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 1477, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_28, 1);
   __pyx_t_28.memview = NULL; __pyx_t_28.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1477
+  /* "sat_toolkit/formula.pyx":1478
  *         cdef XorCNF res = XorCNF.__new__(XorCNF)
  *         res._xor_clauses._add_clauses(packed_args.reshape(-1))
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     def partition(self) -> tuple[list[CNF], list[XorClauseList]]:
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1423
+  /* "sat_toolkit/formula.pyx":1424
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
 
@@ -46314,15 +46330,15 @@
   __PYX_XCLEAR_MEMVIEW(&__pyx_v_packed_args_view, 1);
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1479
+/* "sat_toolkit/formula.pyx":1480
  *         return res
  * 
  *     def partition(self) -> tuple[list[CNF], list[XorClauseList]]:             # <<<<<<<<<<<<<<
  *         """
  *         Separately partition the CNF and XorClauseList into a lists of CNFs and
  */
 
@@ -46377,23 +46393,23 @@
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("partition", 1);
 
-  /* "sat_toolkit/formula.pyx":1487
+  /* "sat_toolkit/formula.pyx":1488
  *         containing XorClauseLists.
  *         """
  *         return (self._clauses.partition(), self._xor_clauses.partition())             # <<<<<<<<<<<<<<
  * 
  *     def to_cnf(self) -> CNF:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_partition); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1487, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_partition); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1488, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -46405,19 +46421,19 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1487, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1488, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_partition); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1487, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_partition); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1488, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
@@ -46429,31 +46445,31 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1487, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1488, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1487, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1488, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1487, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1488, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_2);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2)) __PYX_ERR(0, 1487, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2)) __PYX_ERR(0, 1488, __pyx_L1_error);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_r = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1479
+  /* "sat_toolkit/formula.pyx":1480
  *         return res
  * 
  *     def partition(self) -> tuple[list[CNF], list[XorClauseList]]:             # <<<<<<<<<<<<<<
  *         """
  *         Separately partition the CNF and XorClauseList into a lists of CNFs and
  */
 
@@ -46467,15 +46483,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1489
+/* "sat_toolkit/formula.pyx":1490
  *         return (self._clauses.partition(), self._xor_clauses.partition())
  * 
  *     def to_cnf(self) -> CNF:             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  *         cdef size_t idx
  */
 
@@ -46535,87 +46551,87 @@
   __Pyx_memviewslice __pyx_t_7 = { 0, 0, { 0 }, { 0 }, { 0 } };
   struct __pyx_opt_args_11sat_toolkit_7formula_3CNF__add_xor_clause __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_cnf", 1);
 
-  /* "sat_toolkit/formula.pyx":1490
+  /* "sat_toolkit/formula.pyx":1491
  * 
  *     def to_cnf(self) -> CNF:
  *         cdef CNF res = CNF.__new__(CNF)             # <<<<<<<<<<<<<<
  *         cdef size_t idx
  * 
  */
-  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1490, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__pyx_tp_new_11sat_toolkit_7formula_CNF(((PyTypeObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_empty_tuple, NULL)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1491, __pyx_L1_error)
   __Pyx_GOTREF((PyObject *)__pyx_t_1);
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1493
+  /* "sat_toolkit/formula.pyx":1494
  *         cdef size_t idx
  * 
  *         res._add_clauses(self._clauses)             # <<<<<<<<<<<<<<
  *         res.nvars = self._nvars()
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_self->_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1493, __pyx_L1_error)
-  __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_2); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1493, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)__pyx_v_self->_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1494, __pyx_L1_error)
+  __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_res), __pyx_t_2); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1494, __pyx_L1_error)
   __PYX_XCLEAR_MEMVIEW(&__pyx_t_2, 1);
   __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1494
+  /* "sat_toolkit/formula.pyx":1495
  * 
  *         res._add_clauses(self._clauses)
  *         res.nvars = self._nvars()             # <<<<<<<<<<<<<<
  * 
  *         for idx in range(self._xor_clauses._start_indices.size()):
  */
   __pyx_v_res->__pyx_base.nvars = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self);
 
-  /* "sat_toolkit/formula.pyx":1496
+  /* "sat_toolkit/formula.pyx":1497
  *         res.nvars = self._nvars()
  * 
  *         for idx in range(self._xor_clauses._start_indices.size()):             # <<<<<<<<<<<<<<
  *             res._add_xor_clause(self._xor_clauses._get_clause(idx), rhs=1)
  * 
  */
   __pyx_t_4 = __pyx_v_self->_xor_clauses->__pyx_base._start_indices.size();
   __pyx_t_5 = __pyx_t_4;
   for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
     __pyx_v_idx = __pyx_t_6;
 
-    /* "sat_toolkit/formula.pyx":1497
+    /* "sat_toolkit/formula.pyx":1498
  * 
  *         for idx in range(self._xor_clauses._start_indices.size()):
  *             res._add_xor_clause(self._xor_clauses._get_clause(idx), rhs=1)             # <<<<<<<<<<<<<<
  * 
  *         return res
  */
-    __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_v_idx); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1497, __pyx_L1_error)
+    __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._get_clause(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_v_idx); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1498, __pyx_L1_error)
     __pyx_t_8.__pyx_n = 1;
     __pyx_t_8.rhs = 1;
-    __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->_add_xor_clause(__pyx_v_res, __pyx_t_7, &__pyx_t_8); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1497, __pyx_L1_error)
+    __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_res->__pyx_base.__pyx_vtab)->_add_xor_clause(__pyx_v_res, __pyx_t_7, &__pyx_t_8); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1498, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_7, 1);
     __pyx_t_7.memview = NULL; __pyx_t_7.data = NULL;
   }
 
-  /* "sat_toolkit/formula.pyx":1499
+  /* "sat_toolkit/formula.pyx":1500
  *             res._add_xor_clause(self._xor_clauses._get_clause(idx), rhs=1)
  * 
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     def add_clauses(self, clauses):
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1489
+  /* "sat_toolkit/formula.pyx":1490
  *         return (self._clauses.partition(), self._xor_clauses.partition())
  * 
  *     def to_cnf(self) -> CNF:             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  *         cdef size_t idx
  */
 
@@ -46629,15 +46645,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1501
+/* "sat_toolkit/formula.pyx":1502
  *         return res
  * 
  *     def add_clauses(self, clauses):             # <<<<<<<<<<<<<<
  *         self._clauses.add_clauses(clauses)
  * 
  */
 
@@ -46691,31 +46707,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_clauses)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1501, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1502, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clauses") < 0)) __PYX_ERR(0, 1501, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_clauses") < 0)) __PYX_ERR(0, 1502, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_clauses = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("add_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1501, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("add_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1502, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -46746,22 +46762,22 @@
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("add_clauses", 1);
 
-  /* "sat_toolkit/formula.pyx":1502
+  /* "sat_toolkit/formula.pyx":1503
  * 
  *     def add_clauses(self, clauses):
  *         self._clauses.add_clauses(clauses)             # <<<<<<<<<<<<<<
  * 
  *     def add_xor_clauses(self, xor_clauses):
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1502, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1503, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -46773,21 +46789,21 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_clauses};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1502, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1503, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1501
+  /* "sat_toolkit/formula.pyx":1502
  *         return res
  * 
  *     def add_clauses(self, clauses):             # <<<<<<<<<<<<<<
  *         self._clauses.add_clauses(clauses)
  * 
  */
 
@@ -46802,15 +46818,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1504
+/* "sat_toolkit/formula.pyx":1505
  *         self._clauses.add_clauses(clauses)
  * 
  *     def add_xor_clauses(self, xor_clauses):             # <<<<<<<<<<<<<<
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
 
@@ -46864,31 +46880,31 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_xor_clauses)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1504, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1505, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_xor_clauses") < 0)) __PYX_ERR(0, 1504, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "add_xor_clauses") < 0)) __PYX_ERR(0, 1505, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 1)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
     }
     __pyx_v_xor_clauses = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("add_xor_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1504, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("add_xor_clauses", 1, 1, 1, __pyx_nargs); __PYX_ERR(0, 1505, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -46919,22 +46935,22 @@
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("add_xor_clauses", 1);
 
-  /* "sat_toolkit/formula.pyx":1505
+  /* "sat_toolkit/formula.pyx":1506
  * 
  *     def add_xor_clauses(self, xor_clauses):
  *         self._xor_clauses.add_clauses(xor_clauses)             # <<<<<<<<<<<<<<
  * 
  *     cdef int _nvars(self) noexcept:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1505, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self->_xor_clauses), __pyx_n_s_add_clauses); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1506, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -46946,21 +46962,21 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_xor_clauses};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1505, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1506, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1504
+  /* "sat_toolkit/formula.pyx":1505
  *         self._clauses.add_clauses(clauses)
  * 
  *     def add_xor_clauses(self, xor_clauses):             # <<<<<<<<<<<<<<
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
 
@@ -46975,30 +46991,30 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1507
+/* "sat_toolkit/formula.pyx":1508
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  *     cdef int _nvars(self) noexcept:             # <<<<<<<<<<<<<<
  *         return max(self._clauses.nvars, self._xor_clauses.nvars)
  * 
  */
 
 static int __pyx_f_11sat_toolkit_7formula_6XorCNF__nvars(struct __pyx_obj_11sat_toolkit_7formula_XorCNF *__pyx_v_self) {
   int __pyx_r;
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_t_4;
 
-  /* "sat_toolkit/formula.pyx":1508
+  /* "sat_toolkit/formula.pyx":1509
  * 
  *     cdef int _nvars(self) noexcept:
  *         return max(self._clauses.nvars, self._xor_clauses.nvars)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __pyx_t_1 = __pyx_v_self->_xor_clauses->__pyx_base.nvars;
@@ -47008,28 +47024,28 @@
     __pyx_t_3 = __pyx_t_1;
   } else {
     __pyx_t_3 = __pyx_t_2;
   }
   __pyx_r = __pyx_t_3;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1507
+  /* "sat_toolkit/formula.pyx":1508
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  *     cdef int _nvars(self) noexcept:             # <<<<<<<<<<<<<<
  *         return max(self._clauses.nvars, self._xor_clauses.nvars)
  * 
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1510
+/* "sat_toolkit/formula.pyx":1511
  *         return max(self._clauses.nvars, self._xor_clauses.nvars)
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nvars(self) -> int:
  *         return self._nvars()
  */
 
@@ -47053,29 +47069,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 1);
 
-  /* "sat_toolkit/formula.pyx":1512
+  /* "sat_toolkit/formula.pyx":1513
  *     @property
  *     def nvars(self) -> int:
  *         return self._nvars()             # <<<<<<<<<<<<<<
  * 
  *     @nvars.setter
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1512, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1513, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1510
+  /* "sat_toolkit/formula.pyx":1511
  *         return max(self._clauses.nvars, self._xor_clauses.nvars)
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nvars(self) -> int:
  *         return self._nvars()
  */
 
@@ -47086,15 +47102,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1514
+/* "sat_toolkit/formula.pyx":1515
  *         return self._nvars()
  * 
  *     @nvars.setter             # <<<<<<<<<<<<<<
  *     def nvars(self, int val):
  *         if val < 0:
  */
 
@@ -47107,15 +47123,15 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__set__ (wrapper)", 0);
   __pyx_kwvalues = __Pyx_KwValues_VARARGS(__pyx_args, __pyx_nargs);
   assert(__pyx_arg_val); {
-    __pyx_v_val = __Pyx_PyInt_As_int(__pyx_arg_val); if (unlikely((__pyx_v_val == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1515, __pyx_L3_error)
+    __pyx_v_val = __Pyx_PyInt_As_int(__pyx_arg_val); if (unlikely((__pyx_v_val == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1516, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.nvars.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
@@ -47139,240 +47155,240 @@
   Py_UCS4 __pyx_t_7;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__set__", 1);
 
-  /* "sat_toolkit/formula.pyx":1516
+  /* "sat_toolkit/formula.pyx":1517
  *     @nvars.setter
  *     def nvars(self, int val):
  *         if val < 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('nvars must be nonnegative')
  * 
  */
   __pyx_t_1 = (__pyx_v_val < 0);
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1517
+    /* "sat_toolkit/formula.pyx":1518
  *     def nvars(self, int val):
  *         if val < 0:
  *             raise ValueError('nvars must be nonnegative')             # <<<<<<<<<<<<<<
  * 
  *         if val >= self._nvars():
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1517, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1518, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1517, __pyx_L1_error)
+    __PYX_ERR(0, 1518, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1516
+    /* "sat_toolkit/formula.pyx":1517
  *     @nvars.setter
  *     def nvars(self, int val):
  *         if val < 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('nvars must be nonnegative')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1519
+  /* "sat_toolkit/formula.pyx":1520
  *             raise ValueError('nvars must be nonnegative')
  * 
  *         if val >= self._nvars():             # <<<<<<<<<<<<<<
  *             self._clauses.nvars = val
  *             self._xor_clauses.nvars = val
  */
   __pyx_t_1 = (__pyx_v_val >= ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self));
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1520
+    /* "sat_toolkit/formula.pyx":1521
  * 
  *         if val >= self._nvars():
  *             self._clauses.nvars = val             # <<<<<<<<<<<<<<
  *             self._xor_clauses.nvars = val
  *             return
  */
     __pyx_v_self->_clauses->__pyx_base.nvars = __pyx_v_val;
 
-    /* "sat_toolkit/formula.pyx":1521
+    /* "sat_toolkit/formula.pyx":1522
  *         if val >= self._nvars():
  *             self._clauses.nvars = val
  *             self._xor_clauses.nvars = val             # <<<<<<<<<<<<<<
  *             return
  * 
  */
     __pyx_v_self->_xor_clauses->__pyx_base.nvars = __pyx_v_val;
 
-    /* "sat_toolkit/formula.pyx":1522
+    /* "sat_toolkit/formula.pyx":1523
  *             self._clauses.nvars = val
  *             self._xor_clauses.nvars = val
  *             return             # <<<<<<<<<<<<<<
  * 
  *         cdef size_t i
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1519
+    /* "sat_toolkit/formula.pyx":1520
  *             raise ValueError('nvars must be nonnegative')
  * 
  *         if val >= self._nvars():             # <<<<<<<<<<<<<<
  *             self._clauses.nvars = val
  *             self._xor_clauses.nvars = val
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1525
+  /* "sat_toolkit/formula.pyx":1526
  * 
  *         cdef size_t i
  *         for i in range(self._xor_clauses._clauses.size()):             # <<<<<<<<<<<<<<
  *             if abs(self._xor_clauses._clauses[i]) > val:
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  */
   __pyx_t_3 = __pyx_v_self->_xor_clauses->__pyx_base._clauses.size();
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_i = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":1526
+    /* "sat_toolkit/formula.pyx":1527
  *         cdef size_t i
  *         for i in range(self._xor_clauses._clauses.size()):
  *             if abs(self._xor_clauses._clauses[i]) > val:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  *         for i in range(self._clauses._clauses.size()):
  */
     __pyx_t_1 = (__pyx_f_11sat_toolkit_7formula_abs((__pyx_v_self->_xor_clauses->__pyx_base._clauses[__pyx_v_i])) > __pyx_v_val);
     if (unlikely(__pyx_t_1)) {
 
-      /* "sat_toolkit/formula.pyx":1527
+      /* "sat_toolkit/formula.pyx":1528
  *         for i in range(self._xor_clauses._clauses.size()):
  *             if abs(self._xor_clauses._clauses[i]) > val:
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')             # <<<<<<<<<<<<<<
  *         for i in range(self._clauses._clauses.size()):
  *             if abs(self._clauses._clauses[i]) > val:
  */
-      __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1527, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1528, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_6 = 0;
       __pyx_t_7 = 127;
       __Pyx_INCREF(__pyx_kp_u_cannot_set_nvars_to);
       __pyx_t_6 += 20;
       __Pyx_GIVEREF(__pyx_kp_u_cannot_set_nvars_to);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_cannot_set_nvars_to);
-      __pyx_t_8 = __Pyx_PyUnicode_From_int(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1527, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_From_int(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1528, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_6 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_8);
       __pyx_t_8 = 0;
       __Pyx_INCREF(__pyx_kp_u_as_it_is_too_small);
       __pyx_t_6 += 19;
       __Pyx_GIVEREF(__pyx_kp_u_as_it_is_too_small);
       PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_as_it_is_too_small);
-      __pyx_t_8 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1527, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1528, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1527, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1528, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1527, __pyx_L1_error)
+      __PYX_ERR(0, 1528, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":1526
+      /* "sat_toolkit/formula.pyx":1527
  *         cdef size_t i
  *         for i in range(self._xor_clauses._clauses.size()):
  *             if abs(self._xor_clauses._clauses[i]) > val:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  *         for i in range(self._clauses._clauses.size()):
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":1528
+  /* "sat_toolkit/formula.pyx":1529
  *             if abs(self._xor_clauses._clauses[i]) > val:
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  *         for i in range(self._clauses._clauses.size()):             # <<<<<<<<<<<<<<
  *             if abs(self._clauses._clauses[i]) > val:
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  */
   __pyx_t_3 = __pyx_v_self->_clauses->__pyx_base._clauses.size();
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_i = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":1529
+    /* "sat_toolkit/formula.pyx":1530
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  *         for i in range(self._clauses._clauses.size()):
  *             if abs(self._clauses._clauses[i]) > val:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  * 
  */
     __pyx_t_1 = (__pyx_f_11sat_toolkit_7formula_abs((__pyx_v_self->_clauses->__pyx_base._clauses[__pyx_v_i])) > __pyx_v_val);
     if (unlikely(__pyx_t_1)) {
 
-      /* "sat_toolkit/formula.pyx":1530
+      /* "sat_toolkit/formula.pyx":1531
  *         for i in range(self._clauses._clauses.size()):
  *             if abs(self._clauses._clauses[i]) > val:
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')             # <<<<<<<<<<<<<<
  * 
  *         self.nvars = val
  */
-      __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1530, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1531, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_6 = 0;
       __pyx_t_7 = 127;
       __Pyx_INCREF(__pyx_kp_u_cannot_set_nvars_to);
       __pyx_t_6 += 20;
       __Pyx_GIVEREF(__pyx_kp_u_cannot_set_nvars_to);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_cannot_set_nvars_to);
-      __pyx_t_8 = __Pyx_PyUnicode_From_int(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1530, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_From_int(__pyx_v_val, 0, ' ', 'd'); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1531, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_6 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_8);
       __pyx_t_8 = 0;
       __Pyx_INCREF(__pyx_kp_u_as_it_is_too_small);
       __pyx_t_6 += 19;
       __Pyx_GIVEREF(__pyx_kp_u_as_it_is_too_small);
       PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_as_it_is_too_small);
-      __pyx_t_8 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1530, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1531, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1530, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1531, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 1530, __pyx_L1_error)
+      __PYX_ERR(0, 1531, __pyx_L1_error)
 
-      /* "sat_toolkit/formula.pyx":1529
+      /* "sat_toolkit/formula.pyx":1530
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  *         for i in range(self._clauses._clauses.size()):
  *             if abs(self._clauses._clauses[i]) > val:             # <<<<<<<<<<<<<<
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  * 
  */
     }
   }
 
-  /* "sat_toolkit/formula.pyx":1532
+  /* "sat_toolkit/formula.pyx":1533
  *                 raise ValueError(f'cannot set nvars to {val} as it is too small')
  * 
  *         self.nvars = val             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_val); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1532, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_val); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1533, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_nvars, __pyx_t_2) < 0) __PYX_ERR(0, 1532, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_nvars, __pyx_t_2) < 0) __PYX_ERR(0, 1533, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1514
+  /* "sat_toolkit/formula.pyx":1515
  *         return self._nvars()
  * 
  *     @nvars.setter             # <<<<<<<<<<<<<<
  *     def nvars(self, int val):
  *         if val < 0:
  */
 
@@ -47385,15 +47401,15 @@
   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.nvars.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1534
+/* "sat_toolkit/formula.pyx":1535
  *         self.nvars = val
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nclauses(self) -> int:
  *         return len(self._clauses)
  */
 
@@ -47418,33 +47434,33 @@
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 1);
 
-  /* "sat_toolkit/formula.pyx":1536
+  /* "sat_toolkit/formula.pyx":1537
  *     @property
  *     def nclauses(self) -> int:
  *         return len(self._clauses)             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = ((PyObject *)__pyx_v_self->_clauses);
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1536, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1537, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1536, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1537, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1534
+  /* "sat_toolkit/formula.pyx":1535
  *         self.nvars = val
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nclauses(self) -> int:
  *         return len(self._clauses)
  */
 
@@ -47455,15 +47471,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1538
+/* "sat_toolkit/formula.pyx":1539
  *         return len(self._clauses)
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nxor_clauses(self) -> int:
  *         return len(self._xor_clauses)
  */
 
@@ -47488,33 +47504,33 @@
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 1);
 
-  /* "sat_toolkit/formula.pyx":1540
+  /* "sat_toolkit/formula.pyx":1541
  *     @property
  *     def nxor_clauses(self) -> int:
  *         return len(self._xor_clauses)             # <<<<<<<<<<<<<<
  * 
  *     def __repr__(self) -> str:
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = ((PyObject *)__pyx_v_self->_xor_clauses);
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1540, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1541, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1540, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1541, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1538
+  /* "sat_toolkit/formula.pyx":1539
  *         return len(self._clauses)
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def nxor_clauses(self) -> int:
  *         return len(self._xor_clauses)
  */
 
@@ -47525,15 +47541,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1542
+/* "sat_toolkit/formula.pyx":1543
  *         return len(self._xor_clauses)
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         return f'XorCNF over {self._nvars()} variables with {len(self._clauses)} clauses and {len(self._xor_clauses)} xor clauses'
  * 
  */
 
@@ -47561,76 +47577,76 @@
   PyObject *__pyx_t_4 = NULL;
   Py_ssize_t __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__repr__", 1);
 
-  /* "sat_toolkit/formula.pyx":1543
+  /* "sat_toolkit/formula.pyx":1544
  * 
  *     def __repr__(self) -> str:
  *         return f'XorCNF over {self._nvars()} variables with {len(self._clauses)} clauses and {len(self._xor_clauses)} xor clauses'             # <<<<<<<<<<<<<<
  * 
  *     def __str__(self) -> str:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1543, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1544, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_3 = 127;
   __Pyx_INCREF(__pyx_kp_u_XorCNF_over);
   __pyx_t_2 += 12;
   __Pyx_GIVEREF(__pyx_kp_u_XorCNF_over);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_XorCNF_over);
-  __pyx_t_4 = __Pyx_PyUnicode_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1543, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1544, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u_variables_with);
   __pyx_t_2 += 16;
   __Pyx_GIVEREF(__pyx_kp_u_variables_with);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u_variables_with);
   __pyx_t_4 = ((PyObject *)__pyx_v_self->_clauses);
   __Pyx_INCREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1543, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1544, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_5, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1543, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_5, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1544, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u_clauses_and);
   __pyx_t_2 += 13;
   __Pyx_GIVEREF(__pyx_kp_u_clauses_and);
   PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_kp_u_clauses_and);
   __pyx_t_4 = ((PyObject *)__pyx_v_self->_xor_clauses);
   __Pyx_INCREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1543, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1544, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_5, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1543, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_5, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1544, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 5, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u_xor_clauses_2);
   __pyx_t_2 += 12;
   __Pyx_GIVEREF(__pyx_kp_u_xor_clauses_2);
   PyTuple_SET_ITEM(__pyx_t_1, 6, __pyx_kp_u_xor_clauses_2);
-  __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_1, 7, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1543, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_1, 7, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1544, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_4;
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1542
+  /* "sat_toolkit/formula.pyx":1543
  *         return len(self._xor_clauses)
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         return f'XorCNF over {self._nvars()} variables with {len(self._clauses)} clauses and {len(self._xor_clauses)} xor clauses'
  * 
  */
 
@@ -47642,15 +47658,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1545
+/* "sat_toolkit/formula.pyx":1546
  *         return f'XorCNF over {self._nvars()} variables with {len(self._clauses)} clauses and {len(self._xor_clauses)} xor clauses'
  * 
  *     def __str__(self) -> str:             # <<<<<<<<<<<<<<
  *         return self.to_dimacs().rstrip()
  * 
  */
 
@@ -47678,23 +47694,23 @@
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__str__", 1);
 
-  /* "sat_toolkit/formula.pyx":1546
+  /* "sat_toolkit/formula.pyx":1547
  * 
  *     def __str__(self) -> str:
  *         return self.to_dimacs().rstrip()             # <<<<<<<<<<<<<<
  * 
  *     def __iadd__(self, other):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1546, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1547, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
@@ -47706,19 +47722,19 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1546, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1547, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1546, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_rstrip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1547, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_5 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -47731,23 +47747,23 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1546, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1547, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1545
+  /* "sat_toolkit/formula.pyx":1546
  *         return f'XorCNF over {self._nvars()} variables with {len(self._clauses)} clauses and {len(self._xor_clauses)} xor clauses'
  * 
  *     def __str__(self) -> str:             # <<<<<<<<<<<<<<
  *         return self.to_dimacs().rstrip()
  * 
  */
 
@@ -47761,15 +47777,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1548
+/* "sat_toolkit/formula.pyx":1549
  *         return self.to_dimacs().rstrip()
  * 
  *     def __iadd__(self, other):             # <<<<<<<<<<<<<<
  *         if isinstance(other, CNF):
  *             self._clauses._add_clauses(other)
  */
 
@@ -47802,37 +47818,37 @@
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__iadd__", 1);
 
-  /* "sat_toolkit/formula.pyx":1549
+  /* "sat_toolkit/formula.pyx":1550
  * 
  *     def __iadd__(self, other):
  *         if isinstance(other, CNF):             # <<<<<<<<<<<<<<
  *             self._clauses._add_clauses(other)
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_other, __pyx_ptype_11sat_toolkit_7formula_CNF); 
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1550
+    /* "sat_toolkit/formula.pyx":1551
  *     def __iadd__(self, other):
  *         if isinstance(other, CNF):
  *             self._clauses._add_clauses(other)             # <<<<<<<<<<<<<<
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  *         elif isinstance(other, XorClauseList):
  */
-    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_other, 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1550, __pyx_L1_error)
-    __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), __pyx_t_2); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1550, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_other, 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1551, __pyx_L1_error)
+    __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), __pyx_t_2); if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1551, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_2, 1);
     __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":1551
+    /* "sat_toolkit/formula.pyx":1552
  *         if isinstance(other, CNF):
  *             self._clauses._add_clauses(other)
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)             # <<<<<<<<<<<<<<
  *         elif isinstance(other, XorClauseList):
  *             self._xor_clauses._add_clauses(other)
  */
     __pyx_t_3 = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_v_other)->__pyx_base.nvars;
@@ -47841,47 +47857,47 @@
     if (__pyx_t_1) {
       __pyx_t_5 = __pyx_t_3;
     } else {
       __pyx_t_5 = __pyx_t_4;
     }
     __pyx_v_self->_clauses->__pyx_base.nvars = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":1549
+    /* "sat_toolkit/formula.pyx":1550
  * 
  *     def __iadd__(self, other):
  *         if isinstance(other, CNF):             # <<<<<<<<<<<<<<
  *             self._clauses._add_clauses(other)
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  */
     goto __pyx_L3;
   }
 
-  /* "sat_toolkit/formula.pyx":1552
+  /* "sat_toolkit/formula.pyx":1553
  *             self._clauses._add_clauses(other)
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  *         elif isinstance(other, XorClauseList):             # <<<<<<<<<<<<<<
  *             self._xor_clauses._add_clauses(other)
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_other, __pyx_ptype_11sat_toolkit_7formula_XorClauseList); 
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1553
+    /* "sat_toolkit/formula.pyx":1554
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  *         elif isinstance(other, XorClauseList):
  *             self._xor_clauses._add_clauses(other)             # <<<<<<<<<<<<<<
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  *         elif isinstance(other, XorCNF):
  */
-    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_other, 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1553, __pyx_L1_error)
-    __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_t_2); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 1553, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(__pyx_v_other, 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1554, __pyx_L1_error)
+    __pyx_t_5 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_t_2); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 1554, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_2, 1);
     __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":1554
+    /* "sat_toolkit/formula.pyx":1555
  *         elif isinstance(other, XorClauseList):
  *             self._xor_clauses._add_clauses(other)
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)             # <<<<<<<<<<<<<<
  *         elif isinstance(other, XorCNF):
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)
  */
     __pyx_t_5 = ((struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *)__pyx_v_other)->__pyx_base.nvars;
@@ -47890,59 +47906,59 @@
     if (__pyx_t_1) {
       __pyx_t_4 = __pyx_t_5;
     } else {
       __pyx_t_4 = __pyx_t_3;
     }
     __pyx_v_self->_xor_clauses->__pyx_base.nvars = __pyx_t_4;
 
-    /* "sat_toolkit/formula.pyx":1552
+    /* "sat_toolkit/formula.pyx":1553
  *             self._clauses._add_clauses(other)
  *             self._clauses.nvars = max(self._nvars(), (<CNF> other).nvars)
  *         elif isinstance(other, XorClauseList):             # <<<<<<<<<<<<<<
  *             self._xor_clauses._add_clauses(other)
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  */
     goto __pyx_L3;
   }
 
-  /* "sat_toolkit/formula.pyx":1555
+  /* "sat_toolkit/formula.pyx":1556
  *             self._xor_clauses._add_clauses(other)
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  *         elif isinstance(other, XorCNF):             # <<<<<<<<<<<<<<
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_other, __pyx_ptype_11sat_toolkit_7formula_XorCNF); 
   if (likely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1556
+    /* "sat_toolkit/formula.pyx":1557
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  *         elif isinstance(other, XorCNF):
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)             # <<<<<<<<<<<<<<
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)
  *             self._clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  */
-    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1556, __pyx_L1_error)
-    __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), __pyx_t_2); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 1556, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1557, __pyx_L1_error)
+    __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), __pyx_t_2); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 1557, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_2, 1);
     __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":1557
+    /* "sat_toolkit/formula.pyx":1558
  *         elif isinstance(other, XorCNF):
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)             # <<<<<<<<<<<<<<
  *             self._clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  */
-    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->_xor_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1557, __pyx_L1_error)
-    __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_t_2); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 1557, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_ds_int__const__(((PyObject *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->_xor_clauses), 0); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1558, __pyx_L1_error)
+    __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._add_clauses(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), __pyx_t_2); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 1558, __pyx_L1_error)
     __PYX_XCLEAR_MEMVIEW(&__pyx_t_2, 1);
     __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
 
-    /* "sat_toolkit/formula.pyx":1558
+    /* "sat_toolkit/formula.pyx":1559
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)
  *             self._clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())             # <<<<<<<<<<<<<<
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  *         else:
  */
     __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->__pyx_vtab)->_nvars(((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other));
@@ -47951,15 +47967,15 @@
     if (__pyx_t_1) {
       __pyx_t_3 = __pyx_t_4;
     } else {
       __pyx_t_3 = __pyx_t_5;
     }
     __pyx_v_self->_clauses->__pyx_base.nvars = __pyx_t_3;
 
-    /* "sat_toolkit/formula.pyx":1559
+    /* "sat_toolkit/formula.pyx":1560
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)
  *             self._clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())             # <<<<<<<<<<<<<<
  *         else:
  *             raise ValueError(f'cannot add {type(other).__name__} to {type(self).__name__}')
  */
     __pyx_t_3 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other)->__pyx_vtab)->_nvars(((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_v_other));
@@ -47968,89 +47984,89 @@
     if (__pyx_t_1) {
       __pyx_t_5 = __pyx_t_3;
     } else {
       __pyx_t_5 = __pyx_t_4;
     }
     __pyx_v_self->_xor_clauses->__pyx_base.nvars = __pyx_t_5;
 
-    /* "sat_toolkit/formula.pyx":1555
+    /* "sat_toolkit/formula.pyx":1556
  *             self._xor_clauses._add_clauses(other)
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorClauseList> other).nvars)
  *         elif isinstance(other, XorCNF):             # <<<<<<<<<<<<<<
  *             self._clauses._add_clauses((<XorCNF> other)._clauses)
  *             self._xor_clauses._add_clauses((<XorCNF> other)._xor_clauses)
  */
     goto __pyx_L3;
   }
 
-  /* "sat_toolkit/formula.pyx":1561
+  /* "sat_toolkit/formula.pyx":1562
  *             self._xor_clauses.nvars = max(self._nvars(), (<XorCNF> other)._nvars())
  *         else:
  *             raise ValueError(f'cannot add {type(other).__name__} to {type(self).__name__}')             # <<<<<<<<<<<<<<
  * 
  *         return self
  */
   /*else*/ {
-    __pyx_t_6 = PyTuple_New(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1561, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1562, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_7 = 0;
     __pyx_t_8 = 127;
     __Pyx_INCREF(__pyx_kp_u_cannot_add);
     __pyx_t_7 += 11;
     __Pyx_GIVEREF(__pyx_kp_u_cannot_add);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_kp_u_cannot_add);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_other)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1561, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(__pyx_v_other)), __pyx_n_s_name_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1562, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_10 = __Pyx_PyObject_FormatSimple(__pyx_t_9, __pyx_empty_unicode); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1561, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_FormatSimple(__pyx_t_9, __pyx_empty_unicode); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1562, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_10) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_10) : __pyx_t_8;
     __pyx_t_7 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_10);
     __Pyx_GIVEREF(__pyx_t_10);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_10);
     __pyx_t_10 = 0;
     __Pyx_INCREF(__pyx_kp_u_to);
     __pyx_t_7 += 4;
     __Pyx_GIVEREF(__pyx_kp_u_to);
     PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_kp_u_to);
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1561, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_name_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1562, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_10, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1561, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_10, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1562, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) : __pyx_t_8;
     __pyx_t_7 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_6, 3, __pyx_t_9);
     __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_6, 4, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1561, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_6, 4, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1562, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1561, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1562, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 1561, __pyx_L1_error)
+    __PYX_ERR(0, 1562, __pyx_L1_error)
   }
   __pyx_L3:;
 
-  /* "sat_toolkit/formula.pyx":1563
+  /* "sat_toolkit/formula.pyx":1564
  *             raise ValueError(f'cannot add {type(other).__name__} to {type(self).__name__}')
  * 
  *         return self             # <<<<<<<<<<<<<<
  * 
  *     def __add__(self, other) -> Self:
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_self);
   __pyx_r = ((PyObject *)__pyx_v_self);
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1548
+  /* "sat_toolkit/formula.pyx":1549
  *         return self.to_dimacs().rstrip()
  * 
  *     def __iadd__(self, other):             # <<<<<<<<<<<<<<
  *         if isinstance(other, CNF):
  *             self._clauses._add_clauses(other)
  */
 
@@ -48064,15 +48080,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1565
+/* "sat_toolkit/formula.pyx":1566
  *         return self
  * 
  *     def __add__(self, other) -> Self:             # <<<<<<<<<<<<<<
  *         cdef XorCNF res = type(self).__new__(type(self))
  *         res += self
  */
 
@@ -48100,22 +48116,22 @@
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__add__", 1);
 
-  /* "sat_toolkit/formula.pyx":1566
+  /* "sat_toolkit/formula.pyx":1567
  * 
  *     def __add__(self, other) -> Self:
  *         cdef XorCNF res = type(self).__new__(type(self))             # <<<<<<<<<<<<<<
  *         res += self
  *         res += other
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1566, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))), __pyx_n_s_new); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
@@ -48127,61 +48143,61 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_3, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self)))};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1566, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1567, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1566, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1567, __pyx_L1_error)
   __pyx_v_res = ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1567
+  /* "sat_toolkit/formula.pyx":1568
  *     def __add__(self, other) -> Self:
  *         cdef XorCNF res = type(self).__new__(type(self))
  *         res += self             # <<<<<<<<<<<<<<
  *         res += other
  *         return res
  */
-  __pyx_t_1 = PyNumber_InPlaceAdd(((PyObject *)__pyx_v_res), ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1567, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_InPlaceAdd(((PyObject *)__pyx_v_res), ((PyObject *)__pyx_v_self)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1568, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1567, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1568, __pyx_L1_error)
   __Pyx_DECREF_SET(__pyx_v_res, ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_1));
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1568
+  /* "sat_toolkit/formula.pyx":1569
  *         cdef XorCNF res = type(self).__new__(type(self))
  *         res += self
  *         res += other             # <<<<<<<<<<<<<<
  *         return res
  * 
  */
-  __pyx_t_1 = PyNumber_InPlaceAdd(((PyObject *)__pyx_v_res), __pyx_v_other); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1568, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_InPlaceAdd(((PyObject *)__pyx_v_res), __pyx_v_other); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1569, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1568, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1569, __pyx_L1_error)
   __Pyx_DECREF_SET(__pyx_v_res, ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_1));
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1569
+  /* "sat_toolkit/formula.pyx":1570
  *         res += self
  *         res += other
  *         return res             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF((PyObject *)__pyx_v_res);
   __pyx_r = ((PyObject *)__pyx_v_res);
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1565
+  /* "sat_toolkit/formula.pyx":1566
  *         return self
  * 
  *     def __add__(self, other) -> Self:             # <<<<<<<<<<<<<<
  *         cdef XorCNF res = type(self).__new__(type(self))
  *         res += self
  */
 
@@ -48195,15 +48211,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_res);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1572
+/* "sat_toolkit/formula.pyx":1573
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the XorCNF formatted in the extended DIMACS file format
  */
 
@@ -48260,86 +48276,86 @@
   Py_ssize_t __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":1576
+  /* "sat_toolkit/formula.pyx":1577
  *         return the XorCNF formatted in the extended DIMACS file format
  *         '''
  *         return f'p cnf {self._nvars()} {len(self._clauses) + len(self._xor_clauses)}\n{self._clauses._to_dimacs("")}{self._xor_clauses._to_dimacs("x")}'             # <<<<<<<<<<<<<<
  * 
  *     def __reduce__(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_3 = 127;
   __Pyx_INCREF(__pyx_kp_u_p_cnf);
   __pyx_t_2 += 6;
   __Pyx_GIVEREF(__pyx_kp_u_p_cnf);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_p_cnf);
-  __pyx_t_4 = __Pyx_PyUnicode_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_int(((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __pyx_t_4 = 0;
-  __Pyx_INCREF(__pyx_kp_u__32);
+  __Pyx_INCREF(__pyx_kp_u__34);
   __pyx_t_2 += 1;
-  __Pyx_GIVEREF(__pyx_kp_u__32);
-  PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u__32);
+  __Pyx_GIVEREF(__pyx_kp_u__34);
+  PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u__34);
   __pyx_t_4 = ((PyObject *)__pyx_v_self->_clauses);
   __Pyx_INCREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1577, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = ((PyObject *)__pyx_v_self->_xor_clauses);
   __Pyx_INCREF(__pyx_t_4);
-  __pyx_t_6 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __pyx_t_6 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1577, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t((__pyx_t_5 + __pyx_t_6), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t((__pyx_t_5 + __pyx_t_6), 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_t_4);
   __pyx_t_4 = 0;
-  __Pyx_INCREF(__pyx_kp_u__33);
+  __Pyx_INCREF(__pyx_kp_u__35);
   __pyx_t_2 += 1;
-  __Pyx_GIVEREF(__pyx_kp_u__33);
-  PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_kp_u__33);
-  __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._to_dimacs(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), ((char const *)"")); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_kp_u__35);
+  PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_kp_u__35);
+  __pyx_t_4 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_CNF *)__pyx_v_self->_clauses->__pyx_base.__pyx_vtab)->__pyx_base._to_dimacs(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_clauses), ((char const *)"")); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyUnicode_Unicode(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyUnicode_Unicode(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_1, 5, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._to_dimacs(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), ((char const *)"x")); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __pyx_t_7 = ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorClauseList *)__pyx_v_self->_xor_clauses->__pyx_base.__pyx_vtab)->__pyx_base._to_dimacs(((struct __pyx_obj_11sat_toolkit_7formula__ClauseList *)__pyx_v_self->_xor_clauses), ((char const *)"x")); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyUnicode_Unicode(__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_Unicode(__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 6, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_1, 7, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1576, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_1, 7, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = ((PyObject*)__pyx_t_4);
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1572
+  /* "sat_toolkit/formula.pyx":1573
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the XorCNF formatted in the extended DIMACS file format
  */
 
@@ -48352,15 +48368,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1578
+/* "sat_toolkit/formula.pyx":1579
  *         return f'p cnf {self._nvars()} {len(self._clauses) + len(self._xor_clauses)}\n{self._clauses._to_dimacs("")}{self._xor_clauses._to_dimacs("x")}'
  * 
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  */
 
@@ -48412,43 +48428,43 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__reduce__", 1);
 
-  /* "sat_toolkit/formula.pyx":1579
+  /* "sat_toolkit/formula.pyx":1580
  * 
  *     def __reduce__(self):
  *         return type(self), (self._clauses, self._xor_clauses)             # <<<<<<<<<<<<<<
  * 
  *     def __eq__(self, other):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1579, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1580, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF((PyObject *)__pyx_v_self->_clauses);
   __Pyx_GIVEREF((PyObject *)__pyx_v_self->_clauses);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self->_clauses))) __PYX_ERR(0, 1579, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_self->_clauses))) __PYX_ERR(0, 1580, __pyx_L1_error);
   __Pyx_INCREF((PyObject *)__pyx_v_self->_xor_clauses);
   __Pyx_GIVEREF((PyObject *)__pyx_v_self->_xor_clauses);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, ((PyObject *)__pyx_v_self->_xor_clauses))) __PYX_ERR(0, 1579, __pyx_L1_error);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1579, __pyx_L1_error)
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, ((PyObject *)__pyx_v_self->_xor_clauses))) __PYX_ERR(0, 1580, __pyx_L1_error);
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1580, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
   __Pyx_GIVEREF(((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))));
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))))) __PYX_ERR(0, 1579, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)Py_TYPE(((PyObject *)__pyx_v_self))))) __PYX_ERR(0, 1580, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1)) __PYX_ERR(0, 1579, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1)) __PYX_ERR(0, 1580, __pyx_L1_error);
   __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1578
+  /* "sat_toolkit/formula.pyx":1579
  *         return f'p cnf {self._nvars()} {len(self._clauses) + len(self._xor_clauses)}\n{self._clauses._to_dimacs("")}{self._xor_clauses._to_dimacs("x")}'
  * 
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  */
 
@@ -48460,15 +48476,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1581
+/* "sat_toolkit/formula.pyx":1582
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  *     def __eq__(self, other):             # <<<<<<<<<<<<<<
  *         cdef XorCNF c_other
  * 
  */
 
@@ -48500,15 +48516,15 @@
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__eq__", 1);
 
-  /* "sat_toolkit/formula.pyx":1584
+  /* "sat_toolkit/formula.pyx":1585
  *         cdef XorCNF c_other
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_other = other
  *         except TypeError:
  */
   {
@@ -48516,58 +48532,58 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "sat_toolkit/formula.pyx":1585
+      /* "sat_toolkit/formula.pyx":1586
  * 
  *         try:
  *             c_other = other             # <<<<<<<<<<<<<<
  *         except TypeError:
  *             return False
  */
-      if (!(likely(((__pyx_v_other) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_other, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1585, __pyx_L3_error)
+      if (!(likely(((__pyx_v_other) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_other, __pyx_ptype_11sat_toolkit_7formula_XorCNF))))) __PYX_ERR(0, 1586, __pyx_L3_error)
       __pyx_t_4 = __pyx_v_other;
       __Pyx_INCREF(__pyx_t_4);
       __pyx_v_c_other = ((struct __pyx_obj_11sat_toolkit_7formula_XorCNF *)__pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "sat_toolkit/formula.pyx":1584
+      /* "sat_toolkit/formula.pyx":1585
  *         cdef XorCNF c_other
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_other = other
  *         except TypeError:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":1586
+    /* "sat_toolkit/formula.pyx":1587
  *         try:
  *             c_other = other
  *         except TypeError:             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
     __pyx_t_5 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_TypeError);
     if (__pyx_t_5) {
       __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.__eq__", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(0, 1586, __pyx_L5_except_error)
+      if (__Pyx_GetException(&__pyx_t_4, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(0, 1587, __pyx_L5_except_error)
       __Pyx_XGOTREF(__pyx_t_4);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
 
-      /* "sat_toolkit/formula.pyx":1587
+      /* "sat_toolkit/formula.pyx":1588
  *             c_other = other
  *         except TypeError:
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         if self._nvars() != c_other._nvars():
  */
       __Pyx_XDECREF(__pyx_r);
@@ -48576,15 +48592,15 @@
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       goto __pyx_L6_except_return;
     }
     goto __pyx_L5_except_error;
 
-    /* "sat_toolkit/formula.pyx":1584
+    /* "sat_toolkit/formula.pyx":1585
  *         cdef XorCNF c_other
  * 
  *         try:             # <<<<<<<<<<<<<<
  *             c_other = other
  *         except TypeError:
  */
     __pyx_L5_except_error:;
@@ -48598,73 +48614,73 @@
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L0;
     __pyx_L8_try_end:;
   }
 
-  /* "sat_toolkit/formula.pyx":1589
+  /* "sat_toolkit/formula.pyx":1590
  *             return False
  * 
  *         if self._nvars() != c_other._nvars():             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   __pyx_t_8 = (((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_self->__pyx_vtab)->_nvars(__pyx_v_self) != ((struct __pyx_vtabstruct_11sat_toolkit_7formula_XorCNF *)__pyx_v_c_other->__pyx_vtab)->_nvars(__pyx_v_c_other));
   if (__pyx_t_8) {
 
-    /* "sat_toolkit/formula.pyx":1590
+    /* "sat_toolkit/formula.pyx":1591
  * 
  *         if self._nvars() != c_other._nvars():
  *             return False             # <<<<<<<<<<<<<<
  * 
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1589
+    /* "sat_toolkit/formula.pyx":1590
  *             return False
  * 
  *         if self._nvars() != c_other._nvars():             # <<<<<<<<<<<<<<
  *             return False
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1592
+  /* "sat_toolkit/formula.pyx":1593
  *             return False
  * 
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses             # <<<<<<<<<<<<<<
  * 
  *     def solve_dimacs(self, command: List[str]=['cryptominisat5'], verbose=False) -> Tuple[bool, np.array|None]:
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_8 = (__pyx_v_self->_clauses->__pyx_base._clauses == __pyx_v_c_other->_clauses->__pyx_base._clauses);
   if (__pyx_t_8) {
   } else {
-    __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1592, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1593, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_7 = __pyx_t_6;
     __pyx_t_6 = 0;
     goto __pyx_L12_bool_binop_done;
   }
   __pyx_t_8 = (__pyx_v_self->_xor_clauses->__pyx_base._clauses == __pyx_v_c_other->_xor_clauses->__pyx_base._clauses);
-  __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1592, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyBool_FromLong(__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1593, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_7 = __pyx_t_6;
   __pyx_t_6 = 0;
   __pyx_L12_bool_binop_done:;
   __pyx_r = __pyx_t_7;
   __pyx_t_7 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1581
+  /* "sat_toolkit/formula.pyx":1582
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  *     def __eq__(self, other):             # <<<<<<<<<<<<<<
  *         cdef XorCNF c_other
  * 
  */
 
@@ -48678,15 +48694,15 @@
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_c_other);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1594
+/* "sat_toolkit/formula.pyx":1595
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses
  * 
  *     def solve_dimacs(self, command: List[str]=['cryptominisat5'], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS compliant sat solver that also
  */
 
@@ -48744,27 +48760,27 @@
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_command);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1594, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1595, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_verbose);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1594, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1595, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "solve_dimacs") < 0)) __PYX_ERR(0, 1594, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "solve_dimacs") < 0)) __PYX_ERR(0, 1595, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
@@ -48773,15 +48789,15 @@
       }
     }
     __pyx_v_command = values[0];
     __pyx_v_verbose = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("solve_dimacs", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1594, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("solve_dimacs", 0, 0, 2, __pyx_nargs); __PYX_ERR(0, 1595, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -48846,129 +48862,129 @@
   int __pyx_t_25;
   PyObject *__pyx_t_26 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("solve_dimacs", 1);
 
-  /* "sat_toolkit/formula.pyx":1604
+  /* "sat_toolkit/formula.pyx":1605
  *         Returns (False, None) for UNSAT instances.
  *         """
  *         cdef int echo_comments, ret_code = 0             # <<<<<<<<<<<<<<
  *         cdef uint8_t[:] result_view
  * 
  */
   __pyx_v_ret_code = 0;
 
-  /* "sat_toolkit/formula.pyx":1607
+  /* "sat_toolkit/formula.pyx":1608
  *         cdef uint8_t[:] result_view
  * 
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)             # <<<<<<<<<<<<<<
  *         result_view = result
  *         echo_comments = verbose
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1607, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1608, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1607, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1608, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_nvars); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1607, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_nvars); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1608, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1607, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1608, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1607, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1608, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1607, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1608, __pyx_L1_error);
   __Pyx_INCREF(__pyx_int_255);
   __Pyx_GIVEREF(__pyx_int_255);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_255)) __PYX_ERR(0, 1607, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_255)) __PYX_ERR(0, 1608, __pyx_L1_error);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1607, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1608, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1607, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1608, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1607, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1608, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1607, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1608, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1607, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1608, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_result = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1608
+  /* "sat_toolkit/formula.pyx":1609
  * 
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)
  *         result_view = result             # <<<<<<<<<<<<<<
  *         echo_comments = verbose
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1608, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_11sat_toolkit_5types_uint8_t(__pyx_v_result, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1609, __pyx_L1_error)
   __pyx_v_result_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1609
+  /* "sat_toolkit/formula.pyx":1610
  *         result = np.full(self.nvars + 1, 255, dtype=np.uint8)
  *         result_view = result
  *         echo_comments = verbose             # <<<<<<<<<<<<<<
  * 
  *         cdef int32_t[::1] buf = None;
  */
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_verbose); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1609, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_verbose); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1610, __pyx_L1_error)
   __pyx_v_echo_comments = __pyx_t_7;
 
-  /* "sat_toolkit/formula.pyx":1611
+  /* "sat_toolkit/formula.pyx":1612
  *         echo_comments = verbose
  * 
  *         cdef int32_t[::1] buf = None;             # <<<<<<<<<<<<<<
  *         cdef int32_t lit
  *         cdef ssize_t i
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(Py_None, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1611, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(Py_None, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1612, __pyx_L1_error)
   __pyx_v_buf = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "sat_toolkit/formula.pyx":1614
+  /* "sat_toolkit/formula.pyx":1615
  *         cdef int32_t lit
  *         cdef ssize_t i
  *         cdef bint is_sat = False             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_v_is_sat = 0;
 
-  /* "sat_toolkit/formula.pyx":1617
+  /* "sat_toolkit/formula.pyx":1618
  * 
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             f.write(self.to_dimacs())
  *             f.flush()
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1617, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_NamedTemporaryFile); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1617, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_prefix, __pyx_n_u_sat_toolkit) < 0) __PYX_ERR(0, 1617, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1617, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__37, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1617, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_prefix, __pyx_n_u_sat_toolkit) < 0) __PYX_ERR(0, 1618, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_suffix, __pyx_kp_u_cnf) < 0) __PYX_ERR(0, 1618, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__39, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_9 = __Pyx_PyObject_LookupSpecial(__pyx_t_1, __pyx_n_s_exit); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1617, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_LookupSpecial(__pyx_t_1, __pyx_n_s_exit); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_1, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1617, __pyx_L3_error)
+    __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_1, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1618, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_2)) {
@@ -48980,15 +48996,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1617, __pyx_L3_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1618, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __pyx_t_5 = __pyx_t_3;
     __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     /*try:*/ {
@@ -48999,24 +49015,24 @@
         __Pyx_XGOTREF(__pyx_t_10);
         __Pyx_XGOTREF(__pyx_t_11);
         __Pyx_XGOTREF(__pyx_t_12);
         /*try:*/ {
           __pyx_v_f = __pyx_t_5;
           __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1618
+          /* "sat_toolkit/formula.pyx":1619
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:
  *             f.write(self.to_dimacs())             # <<<<<<<<<<<<<<
  *             f.flush()
  * 
  */
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1618, __pyx_L7_error)
+          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_write); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1619, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1618, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_to_dimacs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1619, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
           __pyx_t_4 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_2))) {
             __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
             if (likely(__pyx_t_4)) {
@@ -49028,15 +49044,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
             __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1618, __pyx_L7_error)
+            if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1619, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           }
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_1))) {
@@ -49051,28 +49067,28 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_3};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1618, __pyx_L7_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1619, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           }
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1619
+          /* "sat_toolkit/formula.pyx":1620
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:
  *             f.write(self.to_dimacs())
  *             f.flush()             # <<<<<<<<<<<<<<
  * 
  *             args = command + [f.name]
  */
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_flush); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1619, __pyx_L7_error)
+          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_flush); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1620, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_1);
           __pyx_t_3 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_1))) {
             __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
             if (likely(__pyx_t_3)) {
@@ -49084,83 +49100,83 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
             __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1619, __pyx_L7_error)
+            if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1620, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           }
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1621
+          /* "sat_toolkit/formula.pyx":1622
  *             f.flush()
  * 
  *             args = command + [f.name]             # <<<<<<<<<<<<<<
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1621, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1621, __pyx_L7_error)
+          __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1622, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_GIVEREF(__pyx_t_5);
-          if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_5)) __PYX_ERR(0, 1621, __pyx_L7_error);
+          if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L7_error);
           __pyx_t_5 = 0;
-          __pyx_t_5 = PyNumber_Add(__pyx_v_command, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1621, __pyx_L7_error)
+          __pyx_t_5 = PyNumber_Add(__pyx_v_command, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __pyx_v_args = __pyx_t_5;
           __pyx_t_5 = 0;
 
-          /* "sat_toolkit/formula.pyx":1622
+          /* "sat_toolkit/formula.pyx":1623
  * 
  *             args = command + [f.name]
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:             # <<<<<<<<<<<<<<
  * 
  *                 for line in solver.stdout:
  */
           /*with:*/ {
-            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
-            __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_Popen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1622, __pyx_L7_error)
+            __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_Popen); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-            __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L7_error)
+            __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_INCREF(__pyx_v_args);
             __Pyx_GIVEREF(__pyx_v_args);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_args)) __PYX_ERR(0, 1622, __pyx_L7_error);
-            __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1622, __pyx_L7_error)
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_args)) __PYX_ERR(0, 1623, __pyx_L7_error);
+            __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1622, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_sp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
-            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_DEVNULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1622, __pyx_L7_error)
+            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_DEVNULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_4) < 0) __PYX_ERR(0, 1622, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_4) < 0) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1622, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1622, __pyx_L7_error)
+            __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_2) < 0) __PYX_ERR(0, 1622, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_2) < 0) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1622, __pyx_L7_error)
-            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1622, __pyx_L7_error)
+            if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1623, __pyx_L7_error)
+            __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_2);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            __pyx_t_13 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1622, __pyx_L7_error)
+            __pyx_t_13 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_exit); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1623, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_13);
-            __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L13_error)
+            __pyx_t_5 = __Pyx_PyObject_LookupSpecial(__pyx_t_2, __pyx_n_s_enter); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1623, __pyx_L13_error)
             __Pyx_GOTREF(__pyx_t_5);
             __pyx_t_1 = NULL;
             __pyx_t_7 = 0;
             #if CYTHON_UNPACK_METHODS
             if (likely(PyMethod_Check(__pyx_t_5))) {
               __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
               if (likely(__pyx_t_1)) {
@@ -49172,15 +49188,15 @@
               }
             }
             #endif
             {
               PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
               __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
               __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-              if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1622, __pyx_L13_error)
+              if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1623, __pyx_L13_error)
               __Pyx_GOTREF(__pyx_t_3);
               __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             }
             __pyx_t_5 = __pyx_t_3;
             __pyx_t_3 = 0;
             __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
             /*try:*/ {
@@ -49191,127 +49207,127 @@
                 __Pyx_XGOTREF(__pyx_t_14);
                 __Pyx_XGOTREF(__pyx_t_15);
                 __Pyx_XGOTREF(__pyx_t_16);
                 /*try:*/ {
                   __pyx_v_solver = __pyx_t_5;
                   __pyx_t_5 = 0;
 
-                  /* "sat_toolkit/formula.pyx":1624
+                  /* "sat_toolkit/formula.pyx":1625
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  *                 for line in solver.stdout:             # <<<<<<<<<<<<<<
  *                     if echo_comments:
  *                         print(line, end='')
  */
-                  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_stdout); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1624, __pyx_L17_error)
+                  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_stdout); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1625, __pyx_L17_error)
                   __Pyx_GOTREF(__pyx_t_5);
                   if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
                     __pyx_t_2 = __pyx_t_5; __Pyx_INCREF(__pyx_t_2);
                     __pyx_t_17 = 0;
                     __pyx_t_18 = NULL;
                   } else {
-                    __pyx_t_17 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1624, __pyx_L17_error)
+                    __pyx_t_17 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1625, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_2);
-                    __pyx_t_18 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1624, __pyx_L17_error)
+                    __pyx_t_18 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1625, __pyx_L17_error)
                   }
                   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                   for (;;) {
                     if (likely(!__pyx_t_18)) {
                       if (likely(PyList_CheckExact(__pyx_t_2))) {
                         {
                           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_2);
                           #if !CYTHON_ASSUME_SAFE_MACROS
-                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1624, __pyx_L17_error)
+                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1625, __pyx_L17_error)
                           #endif
                           if (__pyx_t_17 >= __pyx_temp) break;
                         }
                         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1624, __pyx_L17_error)
+                        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1625, __pyx_L17_error)
                         #else
-                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1624, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1625, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         #endif
                       } else {
                         {
                           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_2);
                           #if !CYTHON_ASSUME_SAFE_MACROS
-                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1624, __pyx_L17_error)
+                          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1625, __pyx_L17_error)
                           #endif
                           if (__pyx_t_17 >= __pyx_temp) break;
                         }
                         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1624, __pyx_L17_error)
+                        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_17); __Pyx_INCREF(__pyx_t_5); __pyx_t_17++; if (unlikely((0 < 0))) __PYX_ERR(0, 1625, __pyx_L17_error)
                         #else
-                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1624, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PySequence_ITEM(__pyx_t_2, __pyx_t_17); __pyx_t_17++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1625, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         #endif
                       }
                     } else {
                       __pyx_t_5 = __pyx_t_18(__pyx_t_2);
                       if (unlikely(!__pyx_t_5)) {
                         PyObject* exc_type = PyErr_Occurred();
                         if (exc_type) {
                           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                          else __PYX_ERR(0, 1624, __pyx_L17_error)
+                          else __PYX_ERR(0, 1625, __pyx_L17_error)
                         }
                         break;
                       }
                       __Pyx_GOTREF(__pyx_t_5);
                     }
                     __Pyx_XDECREF_SET(__pyx_v_line, __pyx_t_5);
                     __pyx_t_5 = 0;
 
-                    /* "sat_toolkit/formula.pyx":1625
+                    /* "sat_toolkit/formula.pyx":1626
  * 
  *                 for line in solver.stdout:
  *                     if echo_comments:             # <<<<<<<<<<<<<<
  *                         print(line, end='')
  * 
  */
                     __pyx_t_19 = (__pyx_v_echo_comments != 0);
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1626
+                      /* "sat_toolkit/formula.pyx":1627
  *                 for line in solver.stdout:
  *                     if echo_comments:
  *                         print(line, end='')             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('c '):
  */
-                      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1626, __pyx_L17_error)
+                      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1627, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_INCREF(__pyx_v_line);
                       __Pyx_GIVEREF(__pyx_v_line);
-                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_line)) __PYX_ERR(0, 1626, __pyx_L17_error);
-                      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1626, __pyx_L17_error)
+                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_line)) __PYX_ERR(0, 1627, __pyx_L17_error);
+                      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1627, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_end, __pyx_kp_u__10) < 0) __PYX_ERR(0, 1626, __pyx_L17_error)
-                      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1626, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_end, __pyx_kp_u__10) < 0) __PYX_ERR(0, 1627, __pyx_L17_error)
+                      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1627, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-                      /* "sat_toolkit/formula.pyx":1625
+                      /* "sat_toolkit/formula.pyx":1626
  * 
  *                 for line in solver.stdout:
  *                     if echo_comments:             # <<<<<<<<<<<<<<
  *                         print(line, end='')
  * 
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1628
+                    /* "sat_toolkit/formula.pyx":1629
  *                         print(line, end='')
  * 
  *                     if line.startswith('c '):             # <<<<<<<<<<<<<<
  *                         continue
  * 
  */
-                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1628, __pyx_L17_error)
+                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1629, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_3);
                     __pyx_t_5 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_3))) {
                       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
                       if (likely(__pyx_t_5)) {
@@ -49323,48 +49339,48 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_kp_u_c_2};
                       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1628, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1629, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1628, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1629, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1629
+                      /* "sat_toolkit/formula.pyx":1630
  * 
  *                     if line.startswith('c '):
  *                         continue             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('s '):
  */
                       goto __pyx_L23_continue;
 
-                      /* "sat_toolkit/formula.pyx":1628
+                      /* "sat_toolkit/formula.pyx":1629
  *                         print(line, end='')
  * 
  *                     if line.startswith('c '):             # <<<<<<<<<<<<<<
  *                         continue
  * 
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1631
+                    /* "sat_toolkit/formula.pyx":1632
  *                         continue
  * 
  *                     if line.startswith('s '):             # <<<<<<<<<<<<<<
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  */
-                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1631, __pyx_L17_error)
+                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1632, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_3);
                     __pyx_t_5 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_3))) {
                       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
                       if (likely(__pyx_t_5)) {
@@ -49376,32 +49392,32 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_kp_u_s_2};
                       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1631, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1632, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1631, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1632, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1632
+                      /* "sat_toolkit/formula.pyx":1633
  * 
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()             # <<<<<<<<<<<<<<
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  */
-                      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1632, __pyx_L17_error)
+                      __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__40, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1633, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
-                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_strip); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1632, __pyx_L17_error)
+                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_strip); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1633, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                       __pyx_t_3 = NULL;
                       __pyx_t_7 = 0;
                       #if CYTHON_UNPACK_METHODS
                       if (likely(PyMethod_Check(__pyx_t_5))) {
                         __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
@@ -49414,118 +49430,118 @@
                         }
                       }
                       #endif
                       {
                         PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
                         __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
                         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-                        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1632, __pyx_L17_error)
+                        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1633, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_1);
                         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       }
                       __Pyx_DECREF_SET(__pyx_v_line, __pyx_t_1);
                       __pyx_t_1 = 0;
 
-                      /* "sat_toolkit/formula.pyx":1633
+                      /* "sat_toolkit/formula.pyx":1634
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  */
-                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_SATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1633, __pyx_L17_error)
+                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_SATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1634, __pyx_L17_error)
                       if (__pyx_t_19) {
 
-                        /* "sat_toolkit/formula.pyx":1634
+                        /* "sat_toolkit/formula.pyx":1635
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True             # <<<<<<<<<<<<<<
  *                         elif line == 'UNSATISFIABLE':
  *                             is_sat = False
  */
                         __pyx_v_is_sat = 1;
 
-                        /* "sat_toolkit/formula.pyx":1633
+                        /* "sat_toolkit/formula.pyx":1634
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  */
                         goto __pyx_L28;
                       }
 
-                      /* "sat_toolkit/formula.pyx":1635
+                      /* "sat_toolkit/formula.pyx":1636
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = False
  *                         else:
  */
-                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_UNSATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1635, __pyx_L17_error)
+                      __pyx_t_19 = (__Pyx_PyUnicode_Equals(__pyx_v_line, __pyx_n_u_UNSATISFIABLE, Py_EQ)); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1636, __pyx_L17_error)
                       if (likely(__pyx_t_19)) {
 
-                        /* "sat_toolkit/formula.pyx":1636
+                        /* "sat_toolkit/formula.pyx":1637
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':
  *                             is_sat = False             # <<<<<<<<<<<<<<
  *                         else:
  *                             raise ValueError(f'unknown status: {line}')
  */
                         __pyx_v_is_sat = 0;
 
-                        /* "sat_toolkit/formula.pyx":1635
+                        /* "sat_toolkit/formula.pyx":1636
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  *                         elif line == 'UNSATISFIABLE':             # <<<<<<<<<<<<<<
  *                             is_sat = False
  *                         else:
  */
                         goto __pyx_L28;
                       }
 
-                      /* "sat_toolkit/formula.pyx":1638
+                      /* "sat_toolkit/formula.pyx":1639
  *                             is_sat = False
  *                         else:
  *                             raise ValueError(f'unknown status: {line}')             # <<<<<<<<<<<<<<
  * 
  *                     if line.startswith('v '):
  */
                       /*else*/ {
-                        __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_line, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1638, __pyx_L17_error)
+                        __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_v_line, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1639, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_1);
-                        __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_kp_u_unknown_status, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1638, __pyx_L17_error)
+                        __pyx_t_5 = __Pyx_PyUnicode_Concat(__pyx_kp_u_unknown_status, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1639, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_5);
                         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1638, __pyx_L17_error)
+                        __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1639, __pyx_L17_error)
                         __Pyx_GOTREF(__pyx_t_1);
                         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                         __Pyx_Raise(__pyx_t_1, 0, 0, 0);
                         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                        __PYX_ERR(0, 1638, __pyx_L17_error)
+                        __PYX_ERR(0, 1639, __pyx_L17_error)
                       }
                       __pyx_L28:;
 
-                      /* "sat_toolkit/formula.pyx":1631
+                      /* "sat_toolkit/formula.pyx":1632
  *                         continue
  * 
  *                     if line.startswith('s '):             # <<<<<<<<<<<<<<
  *                         line = line[2:].strip()
  *                         if line == 'SATISFIABLE':
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1640
+                    /* "sat_toolkit/formula.pyx":1641
  *                             raise ValueError(f'unknown status: {line}')
  * 
  *                     if line.startswith('v '):             # <<<<<<<<<<<<<<
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  */
-                    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1640, __pyx_L17_error)
+                    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_line, __pyx_n_s_startswith); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1641, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_5);
                     __pyx_t_3 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (likely(PyMethod_Check(__pyx_t_5))) {
                       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
                       if (likely(__pyx_t_3)) {
@@ -49537,156 +49553,156 @@
                       }
                     }
                     #endif
                     {
                       PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_kp_u_v};
                       __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1640, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                     }
-                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1640, __pyx_L17_error)
+                    __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely((__pyx_t_19 < 0))) __PYX_ERR(0, 1641, __pyx_L17_error)
                     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     if (__pyx_t_19) {
 
-                      /* "sat_toolkit/formula.pyx":1641
+                      /* "sat_toolkit/formula.pyx":1642
  * 
  *                     if line.startswith('v '):
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')             # <<<<<<<<<<<<<<
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  */
-                      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L17_error)
+                      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1642, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
-                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_fromstring); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1641, __pyx_L17_error)
+                      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_fromstring); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1642, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_5);
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__38, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L17_error)
+                      __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_line, 2, 0, NULL, NULL, &__pyx_slice__40, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1642, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
-                      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1641, __pyx_L17_error)
+                      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1642, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_3);
                       __Pyx_GIVEREF(__pyx_t_1);
-                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L17_error);
+                      if (__Pyx_PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1)) __PYX_ERR(0, 1642, __pyx_L17_error);
                       __pyx_t_1 = 0;
-                      __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1641, __pyx_L17_error)
+                      __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1642, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_1);
-                      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1641, __pyx_L17_error)
+                      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1642, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_4);
-                      __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1641, __pyx_L17_error)
+                      __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int32); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1642, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_20);
                       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_20) < 0) __PYX_ERR(0, 1641, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_20) < 0) __PYX_ERR(0, 1642, __pyx_L17_error)
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_sep, __pyx_kp_u__32) < 0) __PYX_ERR(0, 1641, __pyx_L17_error)
-                      __pyx_t_20 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1641, __pyx_L17_error)
+                      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_sep, __pyx_kp_u__34) < 0) __PYX_ERR(0, 1642, __pyx_L17_error)
+                      __pyx_t_20 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1642, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_20);
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
                       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-                      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(__pyx_t_20, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1641, __pyx_L17_error)
+                      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_11sat_toolkit_5types_int32_t(__pyx_t_20, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1642, __pyx_L17_error)
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                       __PYX_XCLEAR_MEMVIEW(&__pyx_v_buf, 1);
                       __pyx_v_buf = __pyx_t_8;
                       __pyx_t_8.memview = NULL;
                       __pyx_t_8.data = NULL;
 
-                      /* "sat_toolkit/formula.pyx":1642
+                      /* "sat_toolkit/formula.pyx":1643
  *                     if line.startswith('v '):
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):             # <<<<<<<<<<<<<<
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:
  */
                       __pyx_t_21 = (__pyx_v_buf.shape[0]);
                       __pyx_t_22 = __pyx_t_21;
                       for (__pyx_t_23 = 0; __pyx_t_23 < __pyx_t_22; __pyx_t_23+=1) {
                         __pyx_v_i = __pyx_t_23;
 
-                        /* "sat_toolkit/formula.pyx":1643
+                        /* "sat_toolkit/formula.pyx":1644
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]             # <<<<<<<<<<<<<<
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')
  */
                         __pyx_t_24 = __pyx_v_i;
                         __pyx_v_lit = (*((__pyx_t_11sat_toolkit_5types_int32_t *) ( /* dim=0 */ ((char *) (((__pyx_t_11sat_toolkit_5types_int32_t *) __pyx_v_buf.data) + __pyx_t_24)) )));
 
-                        /* "sat_toolkit/formula.pyx":1644
+                        /* "sat_toolkit/formula.pyx":1645
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:             # <<<<<<<<<<<<<<
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0
  */
                         __pyx_t_19 = (__pyx_f_11sat_toolkit_7formula_abs(__pyx_v_lit) >= (__pyx_v_result_view.shape[0]));
                         if (unlikely(__pyx_t_19)) {
 
-                          /* "sat_toolkit/formula.pyx":1645
+                          /* "sat_toolkit/formula.pyx":1646
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')             # <<<<<<<<<<<<<<
  *                             result_view[abs(lit)] = lit > 0
  * 
  */
-                          __pyx_t_20 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1645, __pyx_L17_error)
+                          __pyx_t_20 = __Pyx_PyObject_Call(__pyx_builtin_IndexError, __pyx_tuple__41, NULL); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1646, __pyx_L17_error)
                           __Pyx_GOTREF(__pyx_t_20);
                           __Pyx_Raise(__pyx_t_20, 0, 0, 0);
                           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                          __PYX_ERR(0, 1645, __pyx_L17_error)
+                          __PYX_ERR(0, 1646, __pyx_L17_error)
 
-                          /* "sat_toolkit/formula.pyx":1644
+                          /* "sat_toolkit/formula.pyx":1645
  *                         for i in range(buf.shape[0]):
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:             # <<<<<<<<<<<<<<
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0
  */
                         }
 
-                        /* "sat_toolkit/formula.pyx":1646
+                        /* "sat_toolkit/formula.pyx":1647
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')
  *                             result_view[abs(lit)] = lit > 0             # <<<<<<<<<<<<<<
  * 
  * 
  */
                         __pyx_t_24 = __pyx_f_11sat_toolkit_7formula_abs(__pyx_v_lit);
                         *((__pyx_t_11sat_toolkit_5types_uint8_t *) ( /* dim=0 */ (__pyx_v_result_view.data + __pyx_t_24 * __pyx_v_result_view.strides[0]) )) = (__pyx_v_lit > 0);
                       }
 
-                      /* "sat_toolkit/formula.pyx":1640
+                      /* "sat_toolkit/formula.pyx":1641
  *                             raise ValueError(f'unknown status: {line}')
  * 
  *                     if line.startswith('v '):             # <<<<<<<<<<<<<<
  *                         buf = np.fromstring(line[2:], dtype=np.int32, sep=' ')
  *                         for i in range(buf.shape[0]):
  */
                     }
 
-                    /* "sat_toolkit/formula.pyx":1624
+                    /* "sat_toolkit/formula.pyx":1625
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:
  * 
  *                 for line in solver.stdout:             # <<<<<<<<<<<<<<
  *                     if echo_comments:
  *                         print(line, end='')
  */
                     __pyx_L23_continue:;
                   }
                   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-                  /* "sat_toolkit/formula.pyx":1649
+                  /* "sat_toolkit/formula.pyx":1650
  * 
  * 
  *                 ret_code = solver.wait()             # <<<<<<<<<<<<<<
  *                 if ret_code not in [10, 20]:
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  */
-                  __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_wait); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1649, __pyx_L17_error)
+                  __pyx_t_20 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_wait); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1650, __pyx_L17_error)
                   __Pyx_GOTREF(__pyx_t_20);
                   __pyx_t_1 = NULL;
                   __pyx_t_7 = 0;
                   #if CYTHON_UNPACK_METHODS
                   if (likely(PyMethod_Check(__pyx_t_20))) {
                     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_20);
                     if (likely(__pyx_t_1)) {
@@ -49698,23 +49714,23 @@
                     }
                   }
                   #endif
                   {
                     PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
                     __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_20, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
                     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-                    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1649, __pyx_L17_error)
+                    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1650, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_2);
                     __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                   }
-                  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1649, __pyx_L17_error)
+                  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 1650, __pyx_L17_error)
                   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
                   __pyx_v_ret_code = __pyx_t_7;
 
-                  /* "sat_toolkit/formula.pyx":1650
+                  /* "sat_toolkit/formula.pyx":1651
  * 
  *                 ret_code = solver.wait()
  *                 if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                     # ret == 20 to UNSATISFIABLE (see for example
  */
                   switch (__pyx_v_ret_code) {
@@ -49725,31 +49741,31 @@
                     default:
                     __pyx_t_19 = 1;
                     break;
                   }
                   __pyx_t_25 = __pyx_t_19;
                   if (unlikely(__pyx_t_25)) {
 
-                    /* "sat_toolkit/formula.pyx":1654
+                    /* "sat_toolkit/formula.pyx":1655
  *                     # ret == 20 to UNSATISFIABLE (see for example
  *                     # http://www.satcompetition.org/2004/format-solvers2004.html)
  *                     raise sp.CalledProcessError(ret_code, ' '.join(solver.args))             # <<<<<<<<<<<<<<
  * 
  *                 is_sat = ret_code == 10
  */
-                    __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_sp); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1654, __pyx_L17_error)
+                    __Pyx_GetModuleGlobalName(__pyx_t_20, __pyx_n_s_sp); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1655, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_20);
-                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1654, __pyx_L17_error)
+                    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_20, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1655, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_1);
                     __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                    __pyx_t_20 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1654, __pyx_L17_error)
+                    __pyx_t_20 = __Pyx_PyInt_From_int(__pyx_v_ret_code); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1655, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_20);
-                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1654, __pyx_L17_error)
+                    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_solver, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1655, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_3);
-                    __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1654, __pyx_L17_error)
+                    __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__34, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1655, __pyx_L17_error)
                     __Pyx_GOTREF(__pyx_t_5);
                     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                     __pyx_t_3 = NULL;
                     __pyx_t_7 = 0;
                     #if CYTHON_UNPACK_METHODS
                     if (unlikely(PyMethod_Check(__pyx_t_1))) {
                       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
@@ -49764,41 +49780,41 @@
                     #endif
                     {
                       PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_20, __pyx_t_5};
                       __pyx_t_2 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
                       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
                       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
                       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-                      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1654, __pyx_L17_error)
+                      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1655, __pyx_L17_error)
                       __Pyx_GOTREF(__pyx_t_2);
                       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
                     }
                     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
                     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-                    __PYX_ERR(0, 1654, __pyx_L17_error)
+                    __PYX_ERR(0, 1655, __pyx_L17_error)
 
-                    /* "sat_toolkit/formula.pyx":1650
+                    /* "sat_toolkit/formula.pyx":1651
  * 
  *                 ret_code = solver.wait()
  *                 if ret_code not in [10, 20]:             # <<<<<<<<<<<<<<
  *                     # for SAT solvers ret_code == 10 corresponds to SATISFIABLE and
  *                     # ret == 20 to UNSATISFIABLE (see for example
  */
                   }
 
-                  /* "sat_toolkit/formula.pyx":1656
+                  /* "sat_toolkit/formula.pyx":1657
  *                     raise sp.CalledProcessError(ret_code, ' '.join(solver.args))
  * 
  *                 is_sat = ret_code == 10             # <<<<<<<<<<<<<<
  * 
  *             if is_sat:
  */
                   __pyx_v_is_sat = (__pyx_v_ret_code == 10);
 
-                  /* "sat_toolkit/formula.pyx":1622
+                  /* "sat_toolkit/formula.pyx":1623
  * 
  *             args = command + [f.name]
  *             with sp.Popen(args, stdin=sp.DEVNULL, stdout=sp.PIPE, text=True) as solver:             # <<<<<<<<<<<<<<
  * 
  *                 for line in solver.stdout:
  */
                 }
@@ -49815,36 +49831,36 @@
                 __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
                 __PYX_XCLEAR_MEMVIEW(&__pyx_t_6, 1);
                 __pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;
                 __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
                 __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
                 /*except:*/ {
                   __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.solve_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-                  if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_1, &__pyx_t_5) < 0) __PYX_ERR(0, 1622, __pyx_L19_except_error)
+                  if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_1, &__pyx_t_5) < 0) __PYX_ERR(0, 1623, __pyx_L19_except_error)
                   __Pyx_XGOTREF(__pyx_t_2);
                   __Pyx_XGOTREF(__pyx_t_1);
                   __Pyx_XGOTREF(__pyx_t_5);
-                  __pyx_t_20 = PyTuple_Pack(3, __pyx_t_2, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1622, __pyx_L19_except_error)
+                  __pyx_t_20 = PyTuple_Pack(3, __pyx_t_2, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1623, __pyx_L19_except_error)
                   __Pyx_GOTREF(__pyx_t_20);
                   __pyx_t_26 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_t_20, NULL);
                   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
                   __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-                  if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 1622, __pyx_L19_except_error)
+                  if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 1623, __pyx_L19_except_error)
                   __Pyx_GOTREF(__pyx_t_26);
                   __pyx_t_25 = __Pyx_PyObject_IsTrue(__pyx_t_26);
                   __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-                  if (__pyx_t_25 < 0) __PYX_ERR(0, 1622, __pyx_L19_except_error)
+                  if (__pyx_t_25 < 0) __PYX_ERR(0, 1623, __pyx_L19_except_error)
                   __pyx_t_19 = (!__pyx_t_25);
                   if (unlikely(__pyx_t_19)) {
                     __Pyx_GIVEREF(__pyx_t_2);
                     __Pyx_GIVEREF(__pyx_t_1);
                     __Pyx_XGIVEREF(__pyx_t_5);
                     __Pyx_ErrRestoreWithState(__pyx_t_2, __pyx_t_1, __pyx_t_5);
                     __pyx_t_2 = 0; __pyx_t_1 = 0; __pyx_t_5 = 0; 
-                    __PYX_ERR(0, 1622, __pyx_L19_except_error)
+                    __PYX_ERR(0, 1623, __pyx_L19_except_error)
                   }
                   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
                   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
                   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
                   goto __pyx_L18_exception_handled;
                 }
                 __pyx_L19_except_error:;
@@ -49860,84 +49876,84 @@
                 __Pyx_ExceptionReset(__pyx_t_14, __pyx_t_15, __pyx_t_16);
                 __pyx_L22_try_end:;
               }
             }
             /*finally:*/ {
               /*normal exit:*/{
                 if (__pyx_t_13) {
-                  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_tuple__35, NULL);
+                  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_13, __pyx_tuple__37, NULL);
                   __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-                  if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1622, __pyx_L7_error)
+                  if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1623, __pyx_L7_error)
                   __Pyx_GOTREF(__pyx_t_16);
                   __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
                 }
                 goto __pyx_L16;
               }
               __pyx_L16:;
             }
             goto __pyx_L38;
             __pyx_L13_error:;
             __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
             goto __pyx_L7_error;
             __pyx_L38:;
           }
 
-          /* "sat_toolkit/formula.pyx":1658
+          /* "sat_toolkit/formula.pyx":1659
  *                 is_sat = ret_code == 10
  * 
  *             if is_sat:             # <<<<<<<<<<<<<<
  *                 return True, result
  *             else:
  */
           if (__pyx_v_is_sat) {
 
-            /* "sat_toolkit/formula.pyx":1659
+            /* "sat_toolkit/formula.pyx":1660
  * 
  *             if is_sat:
  *                 return True, result             # <<<<<<<<<<<<<<
  *             else:
  *                 return False, None
  */
             __Pyx_XDECREF(__pyx_r);
-            __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1659, __pyx_L7_error)
+            __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1660, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_INCREF(Py_True);
             __Pyx_GIVEREF(Py_True);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, Py_True)) __PYX_ERR(0, 1659, __pyx_L7_error);
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, Py_True)) __PYX_ERR(0, 1660, __pyx_L7_error);
             __Pyx_INCREF(__pyx_v_result);
             __Pyx_GIVEREF(__pyx_v_result);
-            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_result)) __PYX_ERR(0, 1659, __pyx_L7_error);
+            if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_result)) __PYX_ERR(0, 1660, __pyx_L7_error);
             __pyx_r = __pyx_t_5;
             __pyx_t_5 = 0;
             goto __pyx_L11_try_return;
 
-            /* "sat_toolkit/formula.pyx":1658
+            /* "sat_toolkit/formula.pyx":1659
  *                 is_sat = ret_code == 10
  * 
  *             if is_sat:             # <<<<<<<<<<<<<<
  *                 return True, result
  *             else:
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1661
+          /* "sat_toolkit/formula.pyx":1662
  *                 return True, result
  *             else:
  *                 return False, None             # <<<<<<<<<<<<<<
  * 
  * 
  */
           /*else*/ {
             __Pyx_XDECREF(__pyx_r);
-            __Pyx_INCREF(__pyx_tuple__40);
-            __pyx_r = __pyx_tuple__40;
+            __Pyx_INCREF(__pyx_tuple__42);
+            __pyx_r = __pyx_tuple__42;
             goto __pyx_L11_try_return;
           }
 
-          /* "sat_toolkit/formula.pyx":1617
+          /* "sat_toolkit/formula.pyx":1618
  * 
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             f.write(self.to_dimacs())
  *             f.flush()
  */
         }
@@ -49950,36 +49966,36 @@
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __PYX_XCLEAR_MEMVIEW(&__pyx_t_6, 1);
         __pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;
         __PYX_XCLEAR_MEMVIEW(&__pyx_t_8, 1);
         __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.XorCNF.solve_dimacs", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_1, &__pyx_t_2) < 0) __PYX_ERR(0, 1617, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_1, &__pyx_t_2) < 0) __PYX_ERR(0, 1618, __pyx_L9_except_error)
           __Pyx_XGOTREF(__pyx_t_5);
           __Pyx_XGOTREF(__pyx_t_1);
           __Pyx_XGOTREF(__pyx_t_2);
-          __pyx_t_20 = PyTuple_Pack(3, __pyx_t_5, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1617, __pyx_L9_except_error)
+          __pyx_t_20 = PyTuple_Pack(3, __pyx_t_5, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1618, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_20);
           __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_20, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
-          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1617, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1618, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_13);
           __pyx_t_19 = __Pyx_PyObject_IsTrue(__pyx_t_13);
           __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-          if (__pyx_t_19 < 0) __PYX_ERR(0, 1617, __pyx_L9_except_error)
+          if (__pyx_t_19 < 0) __PYX_ERR(0, 1618, __pyx_L9_except_error)
           __pyx_t_25 = (!__pyx_t_19);
           if (unlikely(__pyx_t_25)) {
             __Pyx_GIVEREF(__pyx_t_5);
             __Pyx_GIVEREF(__pyx_t_1);
             __Pyx_XGIVEREF(__pyx_t_2);
             __Pyx_ErrRestoreWithState(__pyx_t_5, __pyx_t_1, __pyx_t_2);
             __pyx_t_5 = 0; __pyx_t_1 = 0; __pyx_t_2 = 0; 
-            __PYX_ERR(0, 1617, __pyx_L9_except_error)
+            __PYX_ERR(0, 1618, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -50000,29 +50016,29 @@
         __Pyx_XGIVEREF(__pyx_t_12);
         __Pyx_ExceptionReset(__pyx_t_10, __pyx_t_11, __pyx_t_12);
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_9) {
-          __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__35, NULL);
+          __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1617, __pyx_L1_error)
+          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1618, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L4_return: {
         __pyx_t_12 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_9) {
-          __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__35, NULL);
+          __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1617, __pyx_L1_error)
+          if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1618, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_11);
           __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         }
         __pyx_r = __pyx_t_12;
         __pyx_t_12 = 0;
         goto __pyx_L0;
       }
@@ -50031,15 +50047,15 @@
     goto __pyx_L43;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     goto __pyx_L1_error;
     __pyx_L43:;
   }
 
-  /* "sat_toolkit/formula.pyx":1594
+  /* "sat_toolkit/formula.pyx":1595
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses
  * 
  *     def solve_dimacs(self, command: List[str]=['cryptominisat5'], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS compliant sat solver that also
  */
 
@@ -50066,15 +50082,15 @@
   __Pyx_XDECREF(__pyx_v_solver);
   __Pyx_XDECREF(__pyx_v_line);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1372
+/* "sat_toolkit/formula.pyx":1373
  * 
  * cdef class XorCNF:
  *     cdef readonly CNF _clauses             # <<<<<<<<<<<<<<
  *     cdef readonly XorClauseList _xor_clauses
  * 
  */
 
@@ -50105,15 +50121,15 @@
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1373
+/* "sat_toolkit/formula.pyx":1374
  * cdef class XorCNF:
  *     cdef readonly CNF _clauses
  *     cdef readonly XorClauseList _xor_clauses             # <<<<<<<<<<<<<<
  * 
  *     def __cinit__(self):
  */
 
@@ -50144,15 +50160,15 @@
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1679
+/* "sat_toolkit/formula.pyx":1680
  *     INIT_INDEX_SET = object()
  * 
  *     def __init__(self, init_key, numbits, on_set, dc_set):             # <<<<<<<<<<<<<<
  *         if init_key is not self.INIT_INDEX_SET:
  *             raise ValueError('use .from_lut or .from_indices')
  */
 
@@ -50197,50 +50213,50 @@
       kw_args = __Pyx_NumKwargs_VARARGS(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_init_key)) != 0)) {
           (void)__Pyx_Arg_NewRef_VARARGS(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1679, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1680, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_numbits)) != 0)) {
           (void)__Pyx_Arg_NewRef_VARARGS(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1679, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1680, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 1); __PYX_ERR(0, 1679, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 1); __PYX_ERR(0, 1680, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_set)) != 0)) {
           (void)__Pyx_Arg_NewRef_VARARGS(values[2]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1679, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1680, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 2); __PYX_ERR(0, 1679, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 2); __PYX_ERR(0, 1680, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_GetKwValue_VARARGS(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dc_set)) != 0)) {
           (void)__Pyx_Arg_NewRef_VARARGS(values[3]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1679, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1680, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 3); __PYX_ERR(0, 1679, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, 3); __PYX_ERR(0, 1680, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "__init__") < 0)) __PYX_ERR(0, 1679, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "__init__") < 0)) __PYX_ERR(0, 1680, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 4)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_VARARGS(__pyx_args, 0);
       values[1] = __Pyx_Arg_VARARGS(__pyx_args, 1);
       values[2] = __Pyx_Arg_VARARGS(__pyx_args, 2);
@@ -50249,15 +50265,15 @@
     __pyx_v_init_key = values[0];
     __pyx_v_numbits = values[1];
     __pyx_v_on_set = values[2];
     __pyx_v_dc_set = values[3];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 1679, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 4, 4, __pyx_nargs); __PYX_ERR(0, 1680, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_VARARGS(values[__pyx_temp]);
@@ -50292,123 +50308,123 @@
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 1);
 
-  /* "sat_toolkit/formula.pyx":1680
+  /* "sat_toolkit/formula.pyx":1681
  * 
  *     def __init__(self, init_key, numbits, on_set, dc_set):
  *         if init_key is not self.INIT_INDEX_SET:             # <<<<<<<<<<<<<<
  *             raise ValueError('use .from_lut or .from_indices')
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1680, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1681, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = (__pyx_v_init_key != __pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (unlikely(__pyx_t_2)) {
 
-    /* "sat_toolkit/formula.pyx":1681
+    /* "sat_toolkit/formula.pyx":1682
  *     def __init__(self, init_key, numbits, on_set, dc_set):
  *         if init_key is not self.INIT_INDEX_SET:
  *             raise ValueError('use .from_lut or .from_indices')             # <<<<<<<<<<<<<<
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1681, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1682, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1681, __pyx_L1_error)
+    __PYX_ERR(0, 1682, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1680
+    /* "sat_toolkit/formula.pyx":1681
  * 
  *     def __init__(self, init_key, numbits, on_set, dc_set):
  *         if init_key is not self.INIT_INDEX_SET:             # <<<<<<<<<<<<<<
  *             raise ValueError('use .from_lut or .from_indices')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1683
+  /* "sat_toolkit/formula.pyx":1684
  *             raise ValueError('use .from_lut or .from_indices')
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must be one dimensional')
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_set, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1683, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_set, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1684, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1683, __pyx_L1_error)
+  __pyx_t_3 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1684, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_4 = (__pyx_t_3 != 1);
   if (!__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L5_bool_binop_done;
   }
   __pyx_t_4 = (__pyx_v_dc_set != Py_None);
   if (__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L5_bool_binop_done;
   }
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_set, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1683, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_set, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1684, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1683, __pyx_L1_error)
+  __pyx_t_3 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1684, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_4 = (__pyx_t_3 != 1);
   __pyx_t_2 = __pyx_t_4;
   __pyx_L5_bool_binop_done:;
   if (unlikely(__pyx_t_2)) {
 
-    /* "sat_toolkit/formula.pyx":1684
+    /* "sat_toolkit/formula.pyx":1685
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):
  *             raise ValueError('parameters must be one dimensional')             # <<<<<<<<<<<<<<
  * 
  *         self.numbits = numbits
  */
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1684, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1685, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 1684, __pyx_L1_error)
+    __PYX_ERR(0, 1685, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1683
+    /* "sat_toolkit/formula.pyx":1684
  *             raise ValueError('use .from_lut or .from_indices')
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must be one dimensional')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1686
+  /* "sat_toolkit/formula.pyx":1687
  *             raise ValueError('parameters must be one dimensional')
  * 
  *         self.numbits = numbits             # <<<<<<<<<<<<<<
  *         self.on_set = np.sort(on_set)
  *         self.dc_set = np.sort(dc_set)
  */
-  __pyx_t_5 = __Pyx_PyInt_As_unsigned_long(__pyx_v_numbits); if (unlikely((__pyx_t_5 == (unsigned long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1686, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_As_unsigned_long(__pyx_v_numbits); if (unlikely((__pyx_t_5 == (unsigned long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1687, __pyx_L1_error)
   __pyx_v_self->numbits = __pyx_t_5;
 
-  /* "sat_toolkit/formula.pyx":1687
+  /* "sat_toolkit/formula.pyx":1688
  * 
  *         self.numbits = numbits
  *         self.on_set = np.sort(on_set)             # <<<<<<<<<<<<<<
  *         self.dc_set = np.sort(dc_set)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1687, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1688, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sort); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1687, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sort); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1688, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   __pyx_t_8 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
@@ -50421,34 +50437,34 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_v_on_set};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_7, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1687, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1688, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->on_set);
   __Pyx_DECREF(__pyx_v_self->on_set);
   __pyx_v_self->on_set = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1688
+  /* "sat_toolkit/formula.pyx":1689
  *         self.numbits = numbits
  *         self.on_set = np.sort(on_set)
  *         self.dc_set = np.sort(dc_set)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1688, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1689, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sort); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1688, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sort); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1689, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_7 = NULL;
   __pyx_t_8 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
@@ -50461,25 +50477,25 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_dc_set};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1688, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1689, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->dc_set);
   __Pyx_DECREF(__pyx_v_self->dc_set);
   __pyx_v_self->dc_set = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1679
+  /* "sat_toolkit/formula.pyx":1680
  *     INIT_INDEX_SET = object()
  * 
  *     def __init__(self, init_key, numbits, on_set, dc_set):             # <<<<<<<<<<<<<<
  *         if init_key is not self.INIT_INDEX_SET:
  *             raise ValueError('use .from_lut or .from_indices')
  */
 
@@ -50493,15 +50509,15 @@
   __Pyx_AddTraceback("sat_toolkit.formula.Truthtable.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1691
+/* "sat_toolkit/formula.pyx":1692
  * 
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:
  *         """
  */
 
@@ -50542,15 +50558,15 @@
   __pyx_nargs = PyTuple_Size(__pyx_args); if (unlikely(__pyx_nargs < 0)) return NULL;
   #endif
   #endif
   __pyx_kwvalues = __Pyx_KwValues_FASTCALL(__pyx_args, __pyx_nargs);
   {
     PyObject **__pyx_pyargnames[] = {&__pyx_n_s_on_lut,&__pyx_n_s_dc_lut,0};
 
-    /* "sat_toolkit/formula.pyx":1692
+    /* "sat_toolkit/formula.pyx":1693
  * 
  *     @classmethod
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Creates a Truthtable from a lookup table (LUT).
  */
     values[1] = __Pyx_Arg_NewRef_FASTCALL(((PyObject *)Py_None));
@@ -50567,27 +50583,27 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_lut)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1691, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1692, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dc_lut);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1691, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1692, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_lut") < 0)) __PYX_ERR(0, 1691, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_lut") < 0)) __PYX_ERR(0, 1692, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         break;
@@ -50595,15 +50611,15 @@
       }
     }
     __pyx_v_on_lut = values[0];
     __pyx_v_dc_lut = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("from_lut", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 1691, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("from_lut", 0, 1, 2, __pyx_nargs); __PYX_ERR(0, 1692, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -50611,15 +50627,15 @@
   }
   __Pyx_AddTraceback("sat_toolkit.formula.Truthtable.from_lut", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_10Truthtable_2from_lut(((PyTypeObject*)__pyx_v_cls), __pyx_v_on_lut, __pyx_v_dc_lut);
 
-  /* "sat_toolkit/formula.pyx":1691
+  /* "sat_toolkit/formula.pyx":1692
  * 
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:
  *         """
  */
 
@@ -50652,185 +50668,185 @@
   PyObject *(*__pyx_t_9)(PyObject *);
   PyObject *__pyx_t_10 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("from_lut", 1);
 
-  /* "sat_toolkit/formula.pyx":1702
+  /* "sat_toolkit/formula.pyx":1703
  *         :rtype: Truthtable
  *         """
  *         if len(on_lut.shape) != 1 or (dc_lut is not None and len(dc_lut.shape) != 1):             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must be one dimensional')
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1702, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1702, __pyx_L1_error)
+  __pyx_t_3 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_4 = (__pyx_t_3 != 1);
   if (!__pyx_t_4) {
   } else {
     __pyx_t_1 = __pyx_t_4;
     goto __pyx_L4_bool_binop_done;
   }
   __pyx_t_4 = (__pyx_v_dc_lut != Py_None);
   if (__pyx_t_4) {
   } else {
     __pyx_t_1 = __pyx_t_4;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1702, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1702, __pyx_L1_error)
+  __pyx_t_3 = PyObject_Length(__pyx_t_2); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1703, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_4 = (__pyx_t_3 != 1);
   __pyx_t_1 = __pyx_t_4;
   __pyx_L4_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1703
+    /* "sat_toolkit/formula.pyx":1704
  *         """
  *         if len(on_lut.shape) != 1 or (dc_lut is not None and len(dc_lut.shape) != 1):
  *             raise ValueError('parameters must be one dimensional')             # <<<<<<<<<<<<<<
  * 
  *         if dc_lut is not None and on_lut.shape != dc_lut.shape:
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1703, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1704, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 1703, __pyx_L1_error)
+    __PYX_ERR(0, 1704, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1702
+    /* "sat_toolkit/formula.pyx":1703
  *         :rtype: Truthtable
  *         """
  *         if len(on_lut.shape) != 1 or (dc_lut is not None and len(dc_lut.shape) != 1):             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must be one dimensional')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1705
+  /* "sat_toolkit/formula.pyx":1706
  *             raise ValueError('parameters must be one dimensional')
  * 
  *         if dc_lut is not None and on_lut.shape != dc_lut.shape:             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must have the same shape')
  * 
  */
   __pyx_t_4 = (__pyx_v_dc_lut != Py_None);
   if (__pyx_t_4) {
   } else {
     __pyx_t_1 = __pyx_t_4;
     goto __pyx_L8_bool_binop_done;
   }
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1705, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1705, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_dc_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyObject_RichCompare(__pyx_t_2, __pyx_t_5, Py_NE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1705, __pyx_L1_error)
+  __pyx_t_6 = PyObject_RichCompare(__pyx_t_2, __pyx_t_5, Py_NE); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1705, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1706, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_1 = __pyx_t_4;
   __pyx_L8_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1706
+    /* "sat_toolkit/formula.pyx":1707
  * 
  *         if dc_lut is not None and on_lut.shape != dc_lut.shape:
  *             raise ValueError('parameters must have the same shape')             # <<<<<<<<<<<<<<
  * 
  *         numvals = on_lut.shape[0]
  */
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1706, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__53, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1707, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 1706, __pyx_L1_error)
+    __PYX_ERR(0, 1707, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1705
+    /* "sat_toolkit/formula.pyx":1706
  *             raise ValueError('parameters must be one dimensional')
  * 
  *         if dc_lut is not None and on_lut.shape != dc_lut.shape:             # <<<<<<<<<<<<<<
  *             raise ValueError('parameters must have the same shape')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1708
+  /* "sat_toolkit/formula.pyx":1709
  *             raise ValueError('parameters must have the same shape')
  * 
  *         numvals = on_lut.shape[0]             # <<<<<<<<<<<<<<
  *         if (numvals & (numvals - 1)) != 0 or numvals == 0:
  *             raise ValueError('length parameter must be a power of 2')
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1708, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_on_lut, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1709, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1708, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1709, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_numvals = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1709
+  /* "sat_toolkit/formula.pyx":1710
  * 
  *         numvals = on_lut.shape[0]
  *         if (numvals & (numvals - 1)) != 0 or numvals == 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('length parameter must be a power of 2')
  * 
  */
-  __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_v_numvals, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1709, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_v_numvals, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1710, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyNumber_And(__pyx_v_numvals, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1709, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_And(__pyx_v_numvals, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1710, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_4 = (__Pyx_PyInt_BoolNeObjC(__pyx_t_6, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1709, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyInt_BoolNeObjC(__pyx_t_6, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1710, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (!__pyx_t_4) {
   } else {
     __pyx_t_1 = __pyx_t_4;
     goto __pyx_L11_bool_binop_done;
   }
-  __pyx_t_4 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_numvals, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1709, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_numvals, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1710, __pyx_L1_error)
   __pyx_t_1 = __pyx_t_4;
   __pyx_L11_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1710
+    /* "sat_toolkit/formula.pyx":1711
  *         numvals = on_lut.shape[0]
  *         if (numvals & (numvals - 1)) != 0 or numvals == 0:
  *             raise ValueError('length parameter must be a power of 2')             # <<<<<<<<<<<<<<
  * 
  *         numbits = numvals.bit_length() - 1
  */
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__54, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1710, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__54, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1711, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 1710, __pyx_L1_error)
+    __PYX_ERR(0, 1711, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1709
+    /* "sat_toolkit/formula.pyx":1710
  * 
  *         numvals = on_lut.shape[0]
  *         if (numvals & (numvals - 1)) != 0 or numvals == 0:             # <<<<<<<<<<<<<<
  *             raise ValueError('length parameter must be a power of 2')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1712
+  /* "sat_toolkit/formula.pyx":1713
  *             raise ValueError('length parameter must be a power of 2')
  * 
  *         numbits = numvals.bit_length() - 1             # <<<<<<<<<<<<<<
  * 
  *         if dc_lut is not None and np.any(on_lut & dc_lut):
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_numvals, __pyx_n_s_bit_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1712, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_numvals, __pyx_n_s_bit_length); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1713, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_2 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_2)) {
@@ -50842,43 +50858,43 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
     __pyx_t_6 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1712, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1713, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
-  __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1712, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1713, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_numbits = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1714
+  /* "sat_toolkit/formula.pyx":1715
  *         numbits = numvals.bit_length() - 1
  * 
  *         if dc_lut is not None and np.any(on_lut & dc_lut):             # <<<<<<<<<<<<<<
  *             raise ValueError('on_lut and dc_lut must be distinct')
  * 
  */
   __pyx_t_4 = (__pyx_v_dc_lut != Py_None);
   if (__pyx_t_4) {
   } else {
     __pyx_t_1 = __pyx_t_4;
     goto __pyx_L14_bool_binop_done;
   }
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1714, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_any); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1714, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_any); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyNumber_And(__pyx_v_on_lut, __pyx_v_dc_lut); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1714, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_And(__pyx_v_on_lut, __pyx_v_dc_lut); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_8 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_8)) {
@@ -50891,56 +50907,56 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_t_6};
     __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1714, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1715, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1714, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1715, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_1 = __pyx_t_4;
   __pyx_L14_bool_binop_done:;
   if (unlikely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1715
+    /* "sat_toolkit/formula.pyx":1716
  * 
  *         if dc_lut is not None and np.any(on_lut & dc_lut):
  *             raise ValueError('on_lut and dc_lut must be distinct')             # <<<<<<<<<<<<<<
  * 
  *         on_set, = np.where(on_lut)
  */
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__55, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1715, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__55, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1716, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_Raise(__pyx_t_5, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __PYX_ERR(0, 1715, __pyx_L1_error)
+    __PYX_ERR(0, 1716, __pyx_L1_error)
 
-    /* "sat_toolkit/formula.pyx":1714
+    /* "sat_toolkit/formula.pyx":1715
  *         numbits = numvals.bit_length() - 1
  * 
  *         if dc_lut is not None and np.any(on_lut & dc_lut):             # <<<<<<<<<<<<<<
  *             raise ValueError('on_lut and dc_lut must be distinct')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1717
+  /* "sat_toolkit/formula.pyx":1718
  *             raise ValueError('on_lut and dc_lut must be distinct')
  * 
  *         on_set, = np.where(on_lut)             # <<<<<<<<<<<<<<
  *         dc_set, = np.where(dc_lut) if dc_lut is not None else (np.array([], int),)
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1717, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_where); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1717, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_where); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1718, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_7 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
@@ -50953,72 +50969,72 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_on_lut};
     __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1717, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1718, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   if ((likely(PyTuple_CheckExact(__pyx_t_5))) || (PyList_CheckExact(__pyx_t_5))) {
     PyObject* sequence = __pyx_t_5;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 1)) {
       if (size > 1) __Pyx_RaiseTooManyValuesError(1);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 1717, __pyx_L1_error)
+      __PYX_ERR(0, 1718, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_6 = PyTuple_GET_ITEM(sequence, 0); 
     } else {
       __pyx_t_6 = PyList_GET_ITEM(sequence, 0); 
     }
     __Pyx_INCREF(__pyx_t_6);
     #else
-    __pyx_t_6 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1717, __pyx_L1_error)
+    __pyx_t_6 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1718, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     #endif
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1717, __pyx_L1_error)
+    __pyx_t_2 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_9 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_2);
     index = 0; __pyx_t_6 = __pyx_t_9(__pyx_t_2); if (unlikely(!__pyx_t_6)) goto __pyx_L16_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_6);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_2), 1) < 0) __PYX_ERR(0, 1717, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_2), 1) < 0) __PYX_ERR(0, 1718, __pyx_L1_error)
     __pyx_t_9 = NULL;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     goto __pyx_L17_unpacking_done;
     __pyx_L16_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_9 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 1717, __pyx_L1_error)
+    __PYX_ERR(0, 1718, __pyx_L1_error)
     __pyx_L17_unpacking_done:;
   }
   __pyx_v_on_set = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "sat_toolkit/formula.pyx":1718
+  /* "sat_toolkit/formula.pyx":1719
  * 
  *         on_set, = np.where(on_lut)
  *         dc_set, = np.where(dc_lut) if dc_lut is not None else (np.array([], int),)             # <<<<<<<<<<<<<<
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  */
   __pyx_t_1 = (__pyx_v_dc_lut != Py_None);
   if (__pyx_t_1) {
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1719, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_where); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1718, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_where); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1719, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_8);
@@ -51031,27 +51047,27 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_dc_lut};
       __pyx_t_6 = __Pyx_PyObject_FastCall(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1718, __pyx_L1_error)
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1719, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
     __pyx_t_5 = __pyx_t_6;
     __pyx_t_6 = 0;
   } else {
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1718, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1719, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1719, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1718, __pyx_L1_error)
+    __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1719, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_10 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_10)) {
@@ -51064,101 +51080,101 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[3] = {__pyx_t_10, __pyx_t_8, ((PyObject *)(&PyInt_Type))};
       __pyx_t_6 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1718, __pyx_L1_error)
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1719, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1719, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_6);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6)) __PYX_ERR(0, 1718, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6)) __PYX_ERR(0, 1719, __pyx_L1_error);
     __pyx_t_6 = 0;
     __pyx_t_5 = __pyx_t_2;
     __pyx_t_2 = 0;
   }
   if ((likely(PyTuple_CheckExact(__pyx_t_5))) || (PyList_CheckExact(__pyx_t_5))) {
     PyObject* sequence = __pyx_t_5;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 1)) {
       if (size > 1) __Pyx_RaiseTooManyValuesError(1);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 1718, __pyx_L1_error)
+      __PYX_ERR(0, 1719, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
     } else {
       __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
     }
     __Pyx_INCREF(__pyx_t_2);
     #else
-    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)
+    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1719, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     #endif
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_6 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1718, __pyx_L1_error)
+    __pyx_t_6 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1719, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_9 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_6);
     index = 0; __pyx_t_2 = __pyx_t_9(__pyx_t_6); if (unlikely(!__pyx_t_2)) goto __pyx_L18_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_2);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_6), 1) < 0) __PYX_ERR(0, 1718, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_6), 1) < 0) __PYX_ERR(0, 1719, __pyx_L1_error)
     __pyx_t_9 = NULL;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     goto __pyx_L19_unpacking_done;
     __pyx_L18_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_9 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 1718, __pyx_L1_error)
+    __PYX_ERR(0, 1719, __pyx_L1_error)
     __pyx_L19_unpacking_done:;
   }
   __pyx_v_dc_set = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1719
+  /* "sat_toolkit/formula.pyx":1720
  *         on_set, = np.where(on_lut)
  *         dc_set, = np.where(dc_lut) if dc_lut is not None else (np.array([], int),)
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)             # <<<<<<<<<<<<<<
  * 
  *     @classmethod
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_cls), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1719, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_cls), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1719, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5)) __PYX_ERR(0, 1719, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5)) __PYX_ERR(0, 1720, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_numbits);
   __Pyx_GIVEREF(__pyx_v_numbits);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_numbits)) __PYX_ERR(0, 1719, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_numbits)) __PYX_ERR(0, 1720, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_on_set);
   __Pyx_GIVEREF(__pyx_v_on_set);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_on_set)) __PYX_ERR(0, 1719, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_on_set)) __PYX_ERR(0, 1720, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_dc_set);
   __Pyx_GIVEREF(__pyx_v_dc_set);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_dc_set)) __PYX_ERR(0, 1719, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_dc_set)) __PYX_ERR(0, 1720, __pyx_L1_error);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_v_cls), __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1719, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_v_cls), __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1720, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1719, __pyx_L1_error)
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1720, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_Truthtable *)__pyx_t_5);
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1691
+  /* "sat_toolkit/formula.pyx":1692
  * 
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:
  *         """
  */
 
@@ -51177,15 +51193,15 @@
   __Pyx_XDECREF(__pyx_v_on_set);
   __Pyx_XDECREF(__pyx_v_dc_set);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1721
+/* "sat_toolkit/formula.pyx":1722
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:
  *         """
  */
 
@@ -51246,37 +51262,37 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_numbits)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1721, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1722, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_indices)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1721, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1722, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("from_indices", 0, 2, 3, 1); __PYX_ERR(0, 1721, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("from_indices", 0, 2, 3, 1); __PYX_ERR(0, 1722, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dc_indices);
           if (value) { values[2] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1721, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1722, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_indices") < 0)) __PYX_ERR(0, 1721, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "from_indices") < 0)) __PYX_ERR(0, 1722, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
@@ -51286,29 +51302,29 @@
     }
     __pyx_v_numbits = ((PyObject*)values[0]);
     __pyx_v_on_indices = values[1];
     __pyx_v_dc_indices = values[2];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("from_indices", 0, 2, 3, __pyx_nargs); __PYX_ERR(0, 1721, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("from_indices", 0, 2, 3, __pyx_nargs); __PYX_ERR(0, 1722, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_AddTraceback("sat_toolkit.formula.Truthtable.from_indices", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_numbits), (&PyInt_Type), 0, "numbits", 1))) __PYX_ERR(0, 1722, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_numbits), (&PyInt_Type), 0, "numbits", 1))) __PYX_ERR(0, 1723, __pyx_L1_error)
   __pyx_r = __pyx_pf_11sat_toolkit_7formula_10Truthtable_4from_indices(((PyTypeObject*)__pyx_v_cls), __pyx_v_numbits, __pyx_v_on_indices, __pyx_v_dc_indices);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -51328,47 +51344,47 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("from_indices", 1);
 
-  /* "sat_toolkit/formula.pyx":1733
+  /* "sat_toolkit/formula.pyx":1734
  *         :rtype: Truthtable
  *         """
  *         return cls(cls.INIT_INDEX_SET, numbits, on_indices, dc_indices)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF((PyObject *)__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_cls), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1733, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_cls), __pyx_n_s_INIT_INDEX_SET); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1734, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1733, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1734, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1)) __PYX_ERR(0, 1733, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1)) __PYX_ERR(0, 1734, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_numbits);
   __Pyx_GIVEREF(__pyx_v_numbits);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_numbits)) __PYX_ERR(0, 1733, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_numbits)) __PYX_ERR(0, 1734, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_on_indices);
   __Pyx_GIVEREF(__pyx_v_on_indices);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_on_indices)) __PYX_ERR(0, 1733, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_v_on_indices)) __PYX_ERR(0, 1734, __pyx_L1_error);
   __Pyx_INCREF(__pyx_v_dc_indices);
   __Pyx_GIVEREF(__pyx_v_dc_indices);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_dc_indices)) __PYX_ERR(0, 1733, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_v_dc_indices)) __PYX_ERR(0, 1734, __pyx_L1_error);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_v_cls), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1733, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_v_cls), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1734, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1733, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_11sat_toolkit_7formula_Truthtable))))) __PYX_ERR(0, 1734, __pyx_L1_error)
   __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_Truthtable *)__pyx_t_1);
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1721
+  /* "sat_toolkit/formula.pyx":1722
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:
  *         """
  */
 
@@ -51380,15 +51396,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1736
+/* "sat_toolkit/formula.pyx":1737
  * 
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:             # <<<<<<<<<<<<<<
  *         i_list = range(1 << self.numbits)
  * 
  */
 
@@ -51450,34 +51466,34 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_io)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1736, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1737, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_espresso);
           if (value) { values[1] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1736, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1737, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_invert);
           if (value) { values[2] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1736, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1737, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_write") < 0)) __PYX_ERR(0, 1736, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_write") < 0)) __PYX_ERR(0, 1737, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  3: values[2] = __Pyx_Arg_FASTCALL(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
@@ -51488,15 +51504,15 @@
     }
     __pyx_v_io = values[0];
     __pyx_v_espresso = values[1];
     __pyx_v_invert = values[2];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_write", 0, 1, 3, __pyx_nargs); __PYX_ERR(0, 1736, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_write", 0, 1, 3, __pyx_nargs); __PYX_ERR(0, 1737, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -51515,15 +51531,15 @@
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
     }
   }
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1749
+/* "sat_toolkit/formula.pyx":1750
  *             io.write(f'.phase {not invert:b}\n')
  * 
  *         def sorted_contains(a, v):             # <<<<<<<<<<<<<<
  *             idx = np.searchsorted(a, v)
  *             return idx < len(a) and a[idx] == v
  */
 
@@ -51579,43 +51595,43 @@
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (likely((values[0] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[0]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1749, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1750, __pyx_L3_error)
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_2)) != 0)) {
           (void)__Pyx_Arg_NewRef_FASTCALL(values[1]);
           kw_args--;
         }
-        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1749, __pyx_L3_error)
+        else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1750, __pyx_L3_error)
         else {
-          __Pyx_RaiseArgtupleInvalid("sorted_contains", 1, 2, 2, 1); __PYX_ERR(0, 1749, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("sorted_contains", 1, 2, 2, 1); __PYX_ERR(0, 1750, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "sorted_contains") < 0)) __PYX_ERR(0, 1749, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "sorted_contains") < 0)) __PYX_ERR(0, 1750, __pyx_L3_error)
       }
     } else if (unlikely(__pyx_nargs != 2)) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
       values[1] = __Pyx_Arg_FASTCALL(__pyx_args, 1);
     }
     __pyx_v_a = values[0];
     __pyx_v_v = values[1];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("sorted_contains", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 1749, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("sorted_contains", 1, 2, 2, __pyx_nargs); __PYX_ERR(0, 1750, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -51649,24 +51665,24 @@
   Py_ssize_t __pyx_t_5;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("sorted_contains", 1);
 
-  /* "sat_toolkit/formula.pyx":1750
+  /* "sat_toolkit/formula.pyx":1751
  * 
  *         def sorted_contains(a, v):
  *             idx = np.searchsorted(a, v)             # <<<<<<<<<<<<<<
  *             return idx < len(a) and a[idx] == v
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1750, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1751, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_searchsorted); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1750, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_searchsorted); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1751, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -51679,56 +51695,56 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_a, __pyx_v_v};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1750, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1751, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_v_idx = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1751
+  /* "sat_toolkit/formula.pyx":1752
  *         def sorted_contains(a, v):
  *             idx = np.searchsorted(a, v)
  *             return idx < len(a) and a[idx] == v             # <<<<<<<<<<<<<<
  * 
  *         for i in i_list:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = PyObject_Length(__pyx_v_a); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1751, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1751, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_v_a); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1752, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1752, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyObject_RichCompare(__pyx_v_idx, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1751, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_v_idx, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1752, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 1751, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely((__pyx_t_6 < 0))) __PYX_ERR(0, 1752, __pyx_L1_error)
   if (__pyx_t_6) {
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else {
     __Pyx_INCREF(__pyx_t_2);
     __pyx_t_1 = __pyx_t_2;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     goto __pyx_L3_bool_binop_done;
   }
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_a, __pyx_v_idx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1751, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_a, __pyx_v_idx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1752, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_v_v, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1751, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_v_v, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1752, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_INCREF(__pyx_t_3);
   __pyx_t_1 = __pyx_t_3;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_L3_bool_binop_done:;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1749
+  /* "sat_toolkit/formula.pyx":1750
  *             io.write(f'.phase {not invert:b}\n')
  * 
  *         def sorted_contains(a, v):             # <<<<<<<<<<<<<<
  *             idx = np.searchsorted(a, v)
  *             return idx < len(a) and a[idx] == v
  */
 
@@ -51742,15 +51758,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_idx);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1736
+/* "sat_toolkit/formula.pyx":1737
  * 
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:             # <<<<<<<<<<<<<<
  *         i_list = range(1 << self.numbits)
  * 
  */
 
@@ -51779,83 +51795,83 @@
   PyObject *__pyx_t_14 = NULL;
   PyObject *__pyx_t_15 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_write", 1);
 
-  /* "sat_toolkit/formula.pyx":1737
+  /* "sat_toolkit/formula.pyx":1738
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:
  *         i_list = range(1 << self.numbits)             # <<<<<<<<<<<<<<
  * 
  *         if espresso:
  */
-  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long((1 << __pyx_v_self->numbits)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long((1 << __pyx_v_self->numbits)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_i_list = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "sat_toolkit/formula.pyx":1739
+  /* "sat_toolkit/formula.pyx":1740
  *         i_list = range(1 << self.numbits)
  * 
  *         if espresso:             # <<<<<<<<<<<<<<
  *             i_list = np.concatenate((self.on_set, self.dc_set), axis=0)
  *             i_list.sort()
  */
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_espresso); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1739, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_espresso); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1740, __pyx_L1_error)
   if (__pyx_t_3) {
 
-    /* "sat_toolkit/formula.pyx":1740
+    /* "sat_toolkit/formula.pyx":1741
  * 
  *         if espresso:
  *             i_list = np.concatenate((self.on_set, self.dc_set), axis=0)             # <<<<<<<<<<<<<<
  *             i_list.sort()
  *             io.write(f'.i {self.numbits}\n')
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1741, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1741, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1741, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_v_self->on_set);
     __Pyx_GIVEREF(__pyx_v_self->on_set);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_self->on_set)) __PYX_ERR(0, 1740, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_self->on_set)) __PYX_ERR(0, 1741, __pyx_L1_error);
     __Pyx_INCREF(__pyx_v_self->dc_set);
     __Pyx_GIVEREF(__pyx_v_self->dc_set);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self->dc_set)) __PYX_ERR(0, 1740, __pyx_L1_error);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self->dc_set)) __PYX_ERR(0, 1741, __pyx_L1_error);
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1741, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_2);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 1740, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2)) __PYX_ERR(0, 1741, __pyx_L1_error);
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1741, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 1740, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1740, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 1741, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1741, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF_SET(__pyx_v_i_list, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1741
+    /* "sat_toolkit/formula.pyx":1742
  *         if espresso:
  *             i_list = np.concatenate((self.on_set, self.dc_set), axis=0)
  *             i_list.sort()             # <<<<<<<<<<<<<<
  *             io.write(f'.i {self.numbits}\n')
  *             io.write(f'.o 1\n')
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_i_list, __pyx_n_s_sort); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1741, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_i_list, __pyx_n_s_sort); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1742, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_4 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_4)) {
@@ -51867,52 +51883,52 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1741, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1742, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1742
+    /* "sat_toolkit/formula.pyx":1743
  *             i_list = np.concatenate((self.on_set, self.dc_set), axis=0)
  *             i_list.sort()
  *             io.write(f'.i {self.numbits}\n')             # <<<<<<<<<<<<<<
  *             io.write(f'.o 1\n')
  *             io.write(f'.p {len(i_list)}\n')
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1742, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1743, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1742, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1743, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_7 = 0;
     __pyx_t_8 = 127;
     __Pyx_INCREF(__pyx_kp_u_i);
     __pyx_t_7 += 3;
     __Pyx_GIVEREF(__pyx_kp_u_i);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_kp_u_i);
-    __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1742, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1743, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_1, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1742, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_t_1, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1743, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) : __pyx_t_8;
     __pyx_t_7 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_9);
     __pyx_t_9 = 0;
-    __Pyx_INCREF(__pyx_kp_u__33);
+    __Pyx_INCREF(__pyx_kp_u__35);
     __pyx_t_7 += 1;
-    __Pyx_GIVEREF(__pyx_kp_u__33);
-    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_kp_u__33);
-    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_4, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1742, __pyx_L1_error)
+    __Pyx_GIVEREF(__pyx_kp_u__35);
+    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_kp_u__35);
+    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_4, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1743, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
@@ -51926,28 +51942,28 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_9};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1742, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1743, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1743
+    /* "sat_toolkit/formula.pyx":1744
  *             i_list.sort()
  *             io.write(f'.i {self.numbits}\n')
  *             io.write(f'.o 1\n')             # <<<<<<<<<<<<<<
  *             io.write(f'.p {len(i_list)}\n')
  * 
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1743, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1744, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_9 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_9)) {
@@ -51959,49 +51975,49 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_kp_u_o_1};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1743, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1744, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1744
+    /* "sat_toolkit/formula.pyx":1745
  *             io.write(f'.i {self.numbits}\n')
  *             io.write(f'.o 1\n')
  *             io.write(f'.p {len(i_list)}\n')             # <<<<<<<<<<<<<<
  * 
  *             # this parameter is important so espresso minimizes the inverted function
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1744, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1745, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_9 = PyTuple_New(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1744, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1745, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_t_7 = 0;
     __pyx_t_8 = 127;
     __Pyx_INCREF(__pyx_kp_u_p);
     __pyx_t_7 += 3;
     __Pyx_GIVEREF(__pyx_kp_u_p);
     PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_kp_u_p);
-    __pyx_t_10 = PyObject_Length(__pyx_v_i_list); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1744, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_10, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1744, __pyx_L1_error)
+    __pyx_t_10 = PyObject_Length(__pyx_v_i_list); if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1745, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_10, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1745, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_7 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_4);
     __pyx_t_4 = 0;
-    __Pyx_INCREF(__pyx_kp_u__33);
+    __Pyx_INCREF(__pyx_kp_u__35);
     __pyx_t_7 += 1;
-    __Pyx_GIVEREF(__pyx_kp_u__33);
-    PyTuple_SET_ITEM(__pyx_t_9, 2, __pyx_kp_u__33);
-    __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_9, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1744, __pyx_L1_error)
+    __Pyx_GIVEREF(__pyx_kp_u__35);
+    PyTuple_SET_ITEM(__pyx_t_9, 2, __pyx_kp_u__35);
+    __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_9, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1745, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_9 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
@@ -52015,53 +52031,53 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_4};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1744, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1745, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1747
+    /* "sat_toolkit/formula.pyx":1748
  * 
  *             # this parameter is important so espresso minimizes the inverted function
  *             io.write(f'.phase {not invert:b}\n')             # <<<<<<<<<<<<<<
  * 
  *         def sorted_contains(a, v):
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1747, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1747, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_7 = 0;
     __pyx_t_8 = 127;
     __Pyx_INCREF(__pyx_kp_u_phase);
     __pyx_t_7 += 7;
     __Pyx_GIVEREF(__pyx_kp_u_phase);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_kp_u_phase);
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_invert); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1747, __pyx_L1_error)
-    __pyx_t_9 = __Pyx_PyBool_FromLong((!__pyx_t_3)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1747, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_invert); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1748, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyBool_FromLong((!__pyx_t_3)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_1 = __Pyx_PyObject_Format(__pyx_t_9, __pyx_n_u_b); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1747, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Format(__pyx_t_9, __pyx_n_u_b); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1) : __pyx_t_8;
     __pyx_t_7 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
     __pyx_t_1 = 0;
-    __Pyx_INCREF(__pyx_kp_u__33);
+    __Pyx_INCREF(__pyx_kp_u__35);
     __pyx_t_7 += 1;
-    __Pyx_GIVEREF(__pyx_kp_u__33);
-    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_kp_u__33);
-    __pyx_t_1 = __Pyx_PyUnicode_Join(__pyx_t_4, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1747, __pyx_L1_error)
+    __Pyx_GIVEREF(__pyx_kp_u__35);
+    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_kp_u__35);
+    __pyx_t_1 = __Pyx_PyUnicode_Join(__pyx_t_4, 3, __pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
@@ -52075,207 +52091,207 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_1};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1747, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1748, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1739
+    /* "sat_toolkit/formula.pyx":1740
  *         i_list = range(1 << self.numbits)
  * 
  *         if espresso:             # <<<<<<<<<<<<<<
  *             i_list = np.concatenate((self.on_set, self.dc_set), axis=0)
  *             i_list.sort()
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1749
+  /* "sat_toolkit/formula.pyx":1750
  *             io.write(f'.phase {not invert:b}\n')
  * 
  *         def sorted_contains(a, v):             # <<<<<<<<<<<<<<
  *             idx = np.searchsorted(a, v)
  *             return idx < len(a) and a[idx] == v
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_6_write_1sorted_contains, 0, __pyx_n_s_write_locals_sorted_contains, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__58)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1749, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_6_write_1sorted_contains, 0, __pyx_n_s_write_locals_sorted_contains, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__58)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1750, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_v_sorted_contains = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1753
+  /* "sat_toolkit/formula.pyx":1754
  *             return idx < len(a) and a[idx] == v
  * 
  *         for i in i_list:             # <<<<<<<<<<<<<<
  *             on, dc = sorted_contains(self.on_set, i), sorted_contains(self.dc_set, i)
  *             desc = '-' if dc else f'{on:b}'
  */
   if (likely(PyList_CheckExact(__pyx_v_i_list)) || PyTuple_CheckExact(__pyx_v_i_list)) {
     __pyx_t_5 = __pyx_v_i_list; __Pyx_INCREF(__pyx_t_5);
     __pyx_t_7 = 0;
     __pyx_t_11 = NULL;
   } else {
-    __pyx_t_7 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_i_list); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1753, __pyx_L1_error)
+    __pyx_t_7 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_i_list); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1754, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_11 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1753, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetIterNextFunc(__pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1754, __pyx_L1_error)
   }
   for (;;) {
     if (likely(!__pyx_t_11)) {
       if (likely(PyList_CheckExact(__pyx_t_5))) {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyList_GET_SIZE(__pyx_t_5);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1753, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1754, __pyx_L1_error)
           #endif
           if (__pyx_t_7 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_7); __Pyx_INCREF(__pyx_t_2); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 1753, __pyx_L1_error)
+        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_7); __Pyx_INCREF(__pyx_t_2); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 1754, __pyx_L1_error)
         #else
-        __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1753, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1754, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       } else {
         {
           Py_ssize_t __pyx_temp = __Pyx_PyTuple_GET_SIZE(__pyx_t_5);
           #if !CYTHON_ASSUME_SAFE_MACROS
-          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1753, __pyx_L1_error)
+          if (unlikely((__pyx_temp < 0))) __PYX_ERR(0, 1754, __pyx_L1_error)
           #endif
           if (__pyx_t_7 >= __pyx_temp) break;
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_7); __Pyx_INCREF(__pyx_t_2); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 1753, __pyx_L1_error)
+        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_7); __Pyx_INCREF(__pyx_t_2); __pyx_t_7++; if (unlikely((0 < 0))) __PYX_ERR(0, 1754, __pyx_L1_error)
         #else
-        __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1753, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PySequence_ITEM(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1754, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       }
     } else {
       __pyx_t_2 = __pyx_t_11(__pyx_t_5);
       if (unlikely(!__pyx_t_2)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1753, __pyx_L1_error)
+          else __PYX_ERR(0, 1754, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_2);
     }
     __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "sat_toolkit/formula.pyx":1754
+    /* "sat_toolkit/formula.pyx":1755
  * 
  *         for i in i_list:
  *             on, dc = sorted_contains(self.on_set, i), sorted_contains(self.dc_set, i)             # <<<<<<<<<<<<<<
  *             desc = '-' if dc else f'{on:b}'
  *             io.write(f'{i:0{self.numbits}b} {desc}\n')
  */
     __pyx_t_2 = __pyx_v_self->on_set;
     __Pyx_INCREF(__pyx_t_2);
-    __pyx_t_1 = __pyx_pf_11sat_toolkit_7formula_10Truthtable_6_write_sorted_contains(__pyx_v_sorted_contains, __pyx_t_2, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1754, __pyx_L1_error)
+    __pyx_t_1 = __pyx_pf_11sat_toolkit_7formula_10Truthtable_6_write_sorted_contains(__pyx_v_sorted_contains, __pyx_t_2, __pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1755, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = __pyx_v_self->dc_set;
     __Pyx_INCREF(__pyx_t_2);
-    __pyx_t_4 = __pyx_pf_11sat_toolkit_7formula_10Truthtable_6_write_sorted_contains(__pyx_v_sorted_contains, __pyx_t_2, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1754, __pyx_L1_error)
+    __pyx_t_4 = __pyx_pf_11sat_toolkit_7formula_10Truthtable_6_write_sorted_contains(__pyx_v_sorted_contains, __pyx_t_2, __pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1755, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF_SET(__pyx_v_on, __pyx_t_1);
     __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_dc, __pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":1755
+    /* "sat_toolkit/formula.pyx":1756
  *         for i in i_list:
  *             on, dc = sorted_contains(self.on_set, i), sorted_contains(self.dc_set, i)
  *             desc = '-' if dc else f'{on:b}'             # <<<<<<<<<<<<<<
  *             io.write(f'{i:0{self.numbits}b} {desc}\n')
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_dc); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1755, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_dc); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1756, __pyx_L1_error)
     if (__pyx_t_3) {
       __Pyx_INCREF(__pyx_kp_u__59);
       __pyx_t_4 = __pyx_kp_u__59;
     } else {
-      __pyx_t_1 = __Pyx_PyObject_Format(__pyx_v_on, __pyx_n_u_b); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1755, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Format(__pyx_v_on, __pyx_n_u_b); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1756, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_4 = __pyx_t_1;
       __pyx_t_1 = 0;
     }
     __Pyx_XDECREF_SET(__pyx_v_desc, ((PyObject*)__pyx_t_4));
     __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":1756
+    /* "sat_toolkit/formula.pyx":1757
  *             on, dc = sorted_contains(self.on_set, i), sorted_contains(self.dc_set, i)
  *             desc = '-' if dc else f'{on:b}'
  *             io.write(f'{i:0{self.numbits}b} {desc}\n')             # <<<<<<<<<<<<<<
  * 
  *         # ensure that we write some PLA description
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1756, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1756, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_10 = 0;
     __pyx_t_8 = 127;
-    __pyx_t_9 = PyTuple_New(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1756, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_t_12 = 0;
     __pyx_t_13 = 127;
     __Pyx_INCREF(__pyx_kp_u_0);
     __pyx_t_12 += 1;
     __Pyx_GIVEREF(__pyx_kp_u_0);
     PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_kp_u_0);
-    __pyx_t_14 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1756, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_15 = __Pyx_PyObject_FormatSimple(__pyx_t_14, __pyx_empty_unicode); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1756, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyObject_FormatSimple(__pyx_t_14, __pyx_empty_unicode); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __pyx_t_13 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_15) > __pyx_t_13) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_15) : __pyx_t_13;
     __pyx_t_12 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_15);
     __Pyx_GIVEREF(__pyx_t_15);
     PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_15);
     __pyx_t_15 = 0;
     __Pyx_INCREF(__pyx_n_u_b);
     __pyx_t_12 += 1;
     __Pyx_GIVEREF(__pyx_n_u_b);
     PyTuple_SET_ITEM(__pyx_t_9, 2, __pyx_n_u_b);
-    __pyx_t_15 = __Pyx_PyUnicode_Join(__pyx_t_9, 3, __pyx_t_12, __pyx_t_13); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1756, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyUnicode_Join(__pyx_t_9, 3, __pyx_t_12, __pyx_t_13); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_Format(__pyx_v_i, __pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1756, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_Format(__pyx_v_i, __pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) : __pyx_t_8;
     __pyx_t_10 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_9);
     __pyx_t_9 = 0;
-    __Pyx_INCREF(__pyx_kp_u__32);
+    __Pyx_INCREF(__pyx_kp_u__34);
     __pyx_t_10 += 1;
-    __Pyx_GIVEREF(__pyx_kp_u__32);
-    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_kp_u__32);
-    __pyx_t_9 = __Pyx_PyUnicode_Unicode(__pyx_v_desc); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1756, __pyx_L1_error)
+    __Pyx_GIVEREF(__pyx_kp_u__34);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_kp_u__34);
+    __pyx_t_9 = __Pyx_PyUnicode_Unicode(__pyx_v_desc); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) : __pyx_t_8;
     __pyx_t_10 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_9);
     __pyx_t_9 = 0;
-    __Pyx_INCREF(__pyx_kp_u__33);
+    __Pyx_INCREF(__pyx_kp_u__35);
     __pyx_t_10 += 1;
-    __Pyx_GIVEREF(__pyx_kp_u__33);
-    PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_kp_u__33);
-    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_2, 4, __pyx_t_10, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1756, __pyx_L1_error)
+    __Pyx_GIVEREF(__pyx_kp_u__35);
+    PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_kp_u__35);
+    __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_2, 4, __pyx_t_10, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
@@ -52289,53 +52305,53 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_9};
       __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1756, __pyx_L1_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1757, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "sat_toolkit/formula.pyx":1753
+    /* "sat_toolkit/formula.pyx":1754
  *             return idx < len(a) and a[idx] == v
  * 
  *         for i in i_list:             # <<<<<<<<<<<<<<
  *             on, dc = sorted_contains(self.on_set, i), sorted_contains(self.dc_set, i)
  *             desc = '-' if dc else f'{on:b}'
  */
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "sat_toolkit/formula.pyx":1759
+  /* "sat_toolkit/formula.pyx":1760
  * 
  *         # ensure that we write some PLA description
  *         if len(i_list) == 0:             # <<<<<<<<<<<<<<
  *             io.write('-' * self.numbits + ' 0\n')
  * 
  */
-  __pyx_t_7 = PyObject_Length(__pyx_v_i_list); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1759, __pyx_L1_error)
+  __pyx_t_7 = PyObject_Length(__pyx_v_i_list); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1760, __pyx_L1_error)
   __pyx_t_3 = (__pyx_t_7 == 0);
   if (__pyx_t_3) {
 
-    /* "sat_toolkit/formula.pyx":1760
+    /* "sat_toolkit/formula.pyx":1761
  *         # ensure that we write some PLA description
  *         if len(i_list) == 0:
  *             io.write('-' * self.numbits + ' 0\n')             # <<<<<<<<<<<<<<
  * 
  *         if espresso:
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1760, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1761, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_PySequence_Multiply(__pyx_kp_u__59, __pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1760, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PySequence_Multiply(__pyx_kp_u__59, __pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1761, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_1, __pyx_kp_u_0_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1760, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyUnicode_ConcatInPlace(__pyx_t_1, __pyx_kp_u_0_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1761, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
@@ -52349,47 +52365,47 @@
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_9};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1760, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1761, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1759
+    /* "sat_toolkit/formula.pyx":1760
  * 
  *         # ensure that we write some PLA description
  *         if len(i_list) == 0:             # <<<<<<<<<<<<<<
  *             io.write('-' * self.numbits + ' 0\n')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1762
+  /* "sat_toolkit/formula.pyx":1763
  *             io.write('-' * self.numbits + ' 0\n')
  * 
  *         if espresso:             # <<<<<<<<<<<<<<
  *             io.write(f'.end\n')
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_espresso); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1762, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_espresso); if (unlikely((__pyx_t_3 < 0))) __PYX_ERR(0, 1763, __pyx_L1_error)
   if (__pyx_t_3) {
 
-    /* "sat_toolkit/formula.pyx":1763
+    /* "sat_toolkit/formula.pyx":1764
  * 
  *         if espresso:
  *             io.write(f'.end\n')             # <<<<<<<<<<<<<<
  * 
  *     def to_espresso(self, phase='cnf') -> str:
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1763, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_io, __pyx_n_s_write); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1764, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_9 = NULL;
     __pyx_t_6 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_9)) {
@@ -52401,30 +52417,30 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_kp_u_end_2};
       __pyx_t_5 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1763, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1764, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "sat_toolkit/formula.pyx":1762
+    /* "sat_toolkit/formula.pyx":1763
  *             io.write('-' * self.numbits + ' 0\n')
  * 
  *         if espresso:             # <<<<<<<<<<<<<<
  *             io.write(f'.end\n')
  * 
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1736
+  /* "sat_toolkit/formula.pyx":1737
  * 
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:             # <<<<<<<<<<<<<<
  *         i_list = range(1 << self.numbits)
  * 
  */
 
@@ -52449,15 +52465,15 @@
   __Pyx_XDECREF(__pyx_v_dc);
   __Pyx_XDECREF(__pyx_v_desc);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1765
+/* "sat_toolkit/formula.pyx":1766
  *             io.write(f'.end\n')
  * 
  *     def to_espresso(self, phase='cnf') -> str:             # <<<<<<<<<<<<<<
  *         """
  *         return the truthtable in espresso format
  */
 
@@ -52511,34 +52527,34 @@
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_phase_2);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1765, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1766, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_espresso") < 0)) __PYX_ERR(0, 1765, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_espresso") < 0)) __PYX_ERR(0, 1766, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_phase = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("to_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1765, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("to_espresso", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1766, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -52574,126 +52590,126 @@
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_espresso", 1);
 
-  /* "sat_toolkit/formula.pyx":1774
+  /* "sat_toolkit/formula.pyx":1775
  *         :rtype: Truthtable
  *         """
  *         if phase == 'cnf' or phase == '0' or phase == 0:             # <<<<<<<<<<<<<<
  *             invert = True
  *         elif phase == 'dnf' or phase == '1' or phase == 1:
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_n_u_cnf_2, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1774, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_n_u_cnf_2, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1775, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_kp_u_0, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1774, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_kp_u_0, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1775, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_phase, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1774, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_phase, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1775, __pyx_L1_error)
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "sat_toolkit/formula.pyx":1775
+    /* "sat_toolkit/formula.pyx":1776
  *         """
  *         if phase == 'cnf' or phase == '0' or phase == 0:
  *             invert = True             # <<<<<<<<<<<<<<
  *         elif phase == 'dnf' or phase == '1' or phase == 1:
  *             invert = False
  */
     __pyx_v_invert = 1;
 
-    /* "sat_toolkit/formula.pyx":1774
+    /* "sat_toolkit/formula.pyx":1775
  *         :rtype: Truthtable
  *         """
  *         if phase == 'cnf' or phase == '0' or phase == 0:             # <<<<<<<<<<<<<<
  *             invert = True
  *         elif phase == 'dnf' or phase == '1' or phase == 1:
  */
     goto __pyx_L3;
   }
 
-  /* "sat_toolkit/formula.pyx":1776
+  /* "sat_toolkit/formula.pyx":1777
  *         if phase == 'cnf' or phase == '0' or phase == 0:
  *             invert = True
  *         elif phase == 'dnf' or phase == '1' or phase == 1:             # <<<<<<<<<<<<<<
  *             invert = False
  *         else:
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_n_u_dnf, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1776, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_n_u_dnf, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1777, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L7_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_kp_u_1, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1776, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_phase, __pyx_kp_u_1, Py_EQ)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1777, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L7_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_phase, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1776, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyInt_BoolEqObjC(__pyx_v_phase, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_2 < 0))) __PYX_ERR(0, 1777, __pyx_L1_error)
   __pyx_t_1 = __pyx_t_2;
   __pyx_L7_bool_binop_done:;
   if (likely(__pyx_t_1)) {
 
-    /* "sat_toolkit/formula.pyx":1777
+    /* "sat_toolkit/formula.pyx":1778
  *             invert = True
  *         elif phase == 'dnf' or phase == '1' or phase == 1:
  *             invert = False             # <<<<<<<<<<<<<<
  *         else:
  *             raise ValueError('invalid value for `phase`')
  */
     __pyx_v_invert = 0;
 
-    /* "sat_toolkit/formula.pyx":1776
+    /* "sat_toolkit/formula.pyx":1777
  *         if phase == 'cnf' or phase == '0' or phase == 0:
  *             invert = True
  *         elif phase == 'dnf' or phase == '1' or phase == 1:             # <<<<<<<<<<<<<<
  *             invert = False
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "sat_toolkit/formula.pyx":1779
+  /* "sat_toolkit/formula.pyx":1780
  *             invert = False
  *         else:
  *             raise ValueError('invalid value for `phase`')             # <<<<<<<<<<<<<<
  * 
  *         res = io.StringIO()
  */
   /*else*/ {
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__60, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1779, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__60, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1780, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 1779, __pyx_L1_error)
+    __PYX_ERR(0, 1780, __pyx_L1_error)
   }
   __pyx_L3:;
 
-  /* "sat_toolkit/formula.pyx":1781
+  /* "sat_toolkit/formula.pyx":1782
  *             raise ValueError('invalid value for `phase`')
  * 
  *         res = io.StringIO()             # <<<<<<<<<<<<<<
  *         self._write(res, True, invert)
  *         return res.getvalue()
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_io); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1781, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_io); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1782, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1781, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1782, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
@@ -52706,31 +52722,31 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1781, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1782, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __pyx_v_res = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "sat_toolkit/formula.pyx":1782
+  /* "sat_toolkit/formula.pyx":1783
  * 
  *         res = io.StringIO()
  *         self._write(res, True, invert)             # <<<<<<<<<<<<<<
  *         return res.getvalue()
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1782, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_invert); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1782, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyBool_FromLong(__pyx_v_invert); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_7 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_7)) {
@@ -52743,29 +52759,29 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[4] = {__pyx_t_7, __pyx_v_res, Py_True, __pyx_t_4};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 3+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1782, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1783, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "sat_toolkit/formula.pyx":1783
+  /* "sat_toolkit/formula.pyx":1784
  *         res = io.StringIO()
  *         self._write(res, True, invert)
  *         return res.getvalue()             # <<<<<<<<<<<<<<
  * 
  *     def __repr__(self) -> str:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_res, __pyx_n_s_getvalue); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1783, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_res, __pyx_n_s_getvalue); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1784, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_4 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_4)) {
@@ -52777,24 +52793,24 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1783, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1784, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None) || __Pyx_RaiseUnexpectedTypeError("unicode", __pyx_t_3))) __PYX_ERR(0, 1783, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None) || __Pyx_RaiseUnexpectedTypeError("unicode", __pyx_t_3))) __PYX_ERR(0, 1784, __pyx_L1_error)
   __pyx_r = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1765
+  /* "sat_toolkit/formula.pyx":1766
  *             io.write(f'.end\n')
  * 
  *     def to_espresso(self, phase='cnf') -> str:             # <<<<<<<<<<<<<<
  *         """
  *         return the truthtable in espresso format
  */
 
@@ -52809,15 +52825,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_res);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1785
+/* "sat_toolkit/formula.pyx":1786
  *         return res.getvalue()
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         result = io.StringIO()
  *         result.write("Truthtable\n")
  */
 
@@ -52845,24 +52861,24 @@
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__repr__", 1);
 
-  /* "sat_toolkit/formula.pyx":1786
+  /* "sat_toolkit/formula.pyx":1787
  * 
  *     def __repr__(self) -> str:
  *         result = io.StringIO()             # <<<<<<<<<<<<<<
  *         result.write("Truthtable\n")
  *         self._write(result)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1786, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_io); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1787, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1786, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_StringIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1787, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
@@ -52875,29 +52891,29 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1786, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1787, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_v_result = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1787
+  /* "sat_toolkit/formula.pyx":1788
  *     def __repr__(self) -> str:
  *         result = io.StringIO()
  *         result.write("Truthtable\n")             # <<<<<<<<<<<<<<
  *         self._write(result)
  *         return result.getvalue()
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_result, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1787, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_result, __pyx_n_s_write); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1788, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
@@ -52909,28 +52925,28 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_n_u_Truthtable};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1787, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1788, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1788
+  /* "sat_toolkit/formula.pyx":1789
  *         result = io.StringIO()
  *         result.write("Truthtable\n")
  *         self._write(result)             # <<<<<<<<<<<<<<
  *         return result.getvalue()
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1788, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1789, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
@@ -52942,29 +52958,29 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_result};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1788, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1789, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "sat_toolkit/formula.pyx":1789
+  /* "sat_toolkit/formula.pyx":1790
  *         result.write("Truthtable\n")
  *         self._write(result)
  *         return result.getvalue()             # <<<<<<<<<<<<<<
  * 
  *     def __eq__(self, other) -> bool:
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_result, __pyx_n_s_getvalue); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1789, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_result, __pyx_n_s_getvalue); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1790, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   #if CYTHON_UNPACK_METHODS
   if (likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
@@ -52976,23 +52992,23 @@
     }
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
     __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1789, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1790, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1785
+  /* "sat_toolkit/formula.pyx":1786
  *         return res.getvalue()
  * 
  *     def __repr__(self) -> str:             # <<<<<<<<<<<<<<
  *         result = io.StringIO()
  *         result.write("Truthtable\n")
  */
 
@@ -53006,15 +53022,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_result);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1791
+/* "sat_toolkit/formula.pyx":1792
  *         return result.getvalue()
  * 
  *     def __eq__(self, other) -> bool:             # <<<<<<<<<<<<<<
  *         if self.numbits != other.numbits:
  *             return False
  */
 
@@ -53044,68 +53060,68 @@
   int __pyx_t_6;
   int __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__eq__", 1);
 
-  /* "sat_toolkit/formula.pyx":1792
+  /* "sat_toolkit/formula.pyx":1793
  * 
  *     def __eq__(self, other) -> bool:
  *         if self.numbits != other.numbits:             # <<<<<<<<<<<<<<
  *             return False
  *         if not np.all(self.on_set == other.on_set):
  */
-  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1792, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_numbits); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1792, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_numbits); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_NE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1792, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_NE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1793, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1792, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1793, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "sat_toolkit/formula.pyx":1793
+    /* "sat_toolkit/formula.pyx":1794
  *     def __eq__(self, other) -> bool:
  *         if self.numbits != other.numbits:
  *             return False             # <<<<<<<<<<<<<<
  *         if not np.all(self.on_set == other.on_set):
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1792
+    /* "sat_toolkit/formula.pyx":1793
  * 
  *     def __eq__(self, other) -> bool:
  *         if self.numbits != other.numbits:             # <<<<<<<<<<<<<<
  *             return False
  *         if not np.all(self.on_set == other.on_set):
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1794
+  /* "sat_toolkit/formula.pyx":1795
  *         if self.numbits != other.numbits:
  *             return False
  *         if not np.all(self.on_set == other.on_set):             # <<<<<<<<<<<<<<
  *             return False
  *         if self.dc_set is None and other.dc_set is not None:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1794, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1795, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_all); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1794, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_all); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1795, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_on_set); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1794, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_on_set); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1795, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyObject_RichCompare(__pyx_v_self->on_set, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1794, __pyx_L1_error)
+  __pyx_t_5 = PyObject_RichCompare(__pyx_v_self->on_set, __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1795, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_2)) {
@@ -53118,143 +53134,143 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_5};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1794, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1794, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_4 < 0))) __PYX_ERR(0, 1795, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_7 = (!__pyx_t_4);
   if (__pyx_t_7) {
 
-    /* "sat_toolkit/formula.pyx":1795
+    /* "sat_toolkit/formula.pyx":1796
  *             return False
  *         if not np.all(self.on_set == other.on_set):
  *             return False             # <<<<<<<<<<<<<<
  *         if self.dc_set is None and other.dc_set is not None:
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1794
+    /* "sat_toolkit/formula.pyx":1795
  *         if self.numbits != other.numbits:
  *             return False
  *         if not np.all(self.on_set == other.on_set):             # <<<<<<<<<<<<<<
  *             return False
  *         if self.dc_set is None and other.dc_set is not None:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1796
+  /* "sat_toolkit/formula.pyx":1797
  *         if not np.all(self.on_set == other.on_set):
  *             return False
  *         if self.dc_set is None and other.dc_set is not None:             # <<<<<<<<<<<<<<
  *             return False
  *         if other.dc_set is None and self.dc_set is not None:
  */
   __pyx_t_4 = (__pyx_v_self->dc_set == Py_None);
   if (__pyx_t_4) {
   } else {
     __pyx_t_7 = __pyx_t_4;
     goto __pyx_L6_bool_binop_done;
   }
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1796, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1797, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = (__pyx_t_3 != Py_None);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_7 = __pyx_t_4;
   __pyx_L6_bool_binop_done:;
   if (__pyx_t_7) {
 
-    /* "sat_toolkit/formula.pyx":1797
+    /* "sat_toolkit/formula.pyx":1798
  *             return False
  *         if self.dc_set is None and other.dc_set is not None:
  *             return False             # <<<<<<<<<<<<<<
  *         if other.dc_set is None and self.dc_set is not None:
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1796
+    /* "sat_toolkit/formula.pyx":1797
  *         if not np.all(self.on_set == other.on_set):
  *             return False
  *         if self.dc_set is None and other.dc_set is not None:             # <<<<<<<<<<<<<<
  *             return False
  *         if other.dc_set is None and self.dc_set is not None:
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1798
+  /* "sat_toolkit/formula.pyx":1799
  *         if self.dc_set is None and other.dc_set is not None:
  *             return False
  *         if other.dc_set is None and self.dc_set is not None:             # <<<<<<<<<<<<<<
  *             return False
  *         if not np.all(self.dc_set == other.dc_set):
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1798, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1799, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = (__pyx_t_3 == Py_None);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
   } else {
     __pyx_t_7 = __pyx_t_4;
     goto __pyx_L9_bool_binop_done;
   }
   __pyx_t_4 = (__pyx_v_self->dc_set != Py_None);
   __pyx_t_7 = __pyx_t_4;
   __pyx_L9_bool_binop_done:;
   if (__pyx_t_7) {
 
-    /* "sat_toolkit/formula.pyx":1799
+    /* "sat_toolkit/formula.pyx":1800
  *             return False
  *         if other.dc_set is None and self.dc_set is not None:
  *             return False             # <<<<<<<<<<<<<<
  *         if not np.all(self.dc_set == other.dc_set):
  *             return False
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1798
+    /* "sat_toolkit/formula.pyx":1799
  *         if self.dc_set is None and other.dc_set is not None:
  *             return False
  *         if other.dc_set is None and self.dc_set is not None:             # <<<<<<<<<<<<<<
  *             return False
  *         if not np.all(self.dc_set == other.dc_set):
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1800
+  /* "sat_toolkit/formula.pyx":1801
  *         if other.dc_set is None and self.dc_set is not None:
  *             return False
  *         if not np.all(self.dc_set == other.dc_set):             # <<<<<<<<<<<<<<
  *             return False
  *         return True
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1800, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1801, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_all); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1800, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_all); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1801, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1800, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_other, __pyx_n_s_dc_set); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1801, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_RichCompare(__pyx_v_self->dc_set, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1800, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_v_self->dc_set, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1801, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = NULL;
   __pyx_t_6 = 0;
   #if CYTHON_UNPACK_METHODS
   if (unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_1)) {
@@ -53267,57 +53283,57 @@
   }
   #endif
   {
     PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_2};
     __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1800, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
-  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_7 < 0))) __PYX_ERR(0, 1800, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely((__pyx_t_7 < 0))) __PYX_ERR(0, 1801, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_4 = (!__pyx_t_7);
   if (__pyx_t_4) {
 
-    /* "sat_toolkit/formula.pyx":1801
+    /* "sat_toolkit/formula.pyx":1802
  *             return False
  *         if not np.all(self.dc_set == other.dc_set):
  *             return False             # <<<<<<<<<<<<<<
  *         return True
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_False);
     __pyx_r = Py_False;
     goto __pyx_L0;
 
-    /* "sat_toolkit/formula.pyx":1800
+    /* "sat_toolkit/formula.pyx":1801
  *         if other.dc_set is None and self.dc_set is not None:
  *             return False
  *         if not np.all(self.dc_set == other.dc_set):             # <<<<<<<<<<<<<<
  *             return False
  *         return True
  */
   }
 
-  /* "sat_toolkit/formula.pyx":1802
+  /* "sat_toolkit/formula.pyx":1803
  *         if not np.all(self.dc_set == other.dc_set):
  *             return False
  *         return True             # <<<<<<<<<<<<<<
  * 
  *     def to_cnf(self, espresso_args: List[str] = []) -> CNF:
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(Py_True);
   __pyx_r = Py_True;
   goto __pyx_L0;
 
-  /* "sat_toolkit/formula.pyx":1791
+  /* "sat_toolkit/formula.pyx":1792
  *         return result.getvalue()
  * 
  *     def __eq__(self, other) -> bool:             # <<<<<<<<<<<<<<
  *         if self.numbits != other.numbits:
  *             return False
  */
 
@@ -53331,15 +53347,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1804
+/* "sat_toolkit/formula.pyx":1805
  *         return True
  * 
  *     def to_cnf(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to convert the Truthtable to a minimized CNF.
  */
 
@@ -53393,34 +53409,34 @@
       }
       kw_args = __Pyx_NumKwargs_FASTCALL(__pyx_kwds);
       switch (__pyx_nargs) {
         case  0:
         if (kw_args > 0) {
           PyObject* value = __Pyx_GetKwValue_FASTCALL(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_espresso_args);
           if (value) { values[0] = __Pyx_Arg_NewRef_FASTCALL(value); kw_args--; }
-          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1804, __pyx_L3_error)
+          else if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1805, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
         const Py_ssize_t kwd_pos_args = __pyx_nargs;
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_cnf") < 0)) __PYX_ERR(0, 1804, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_cnf") < 0)) __PYX_ERR(0, 1805, __pyx_L3_error)
       }
     } else {
       switch (__pyx_nargs) {
         case  1: values[0] = __Pyx_Arg_FASTCALL(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_espresso_args = values[0];
   }
   goto __pyx_L6_skip;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("to_cnf", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1804, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("to_cnf", 0, 0, 1, __pyx_nargs); __PYX_ERR(0, 1805, __pyx_L3_error)
   __pyx_L6_skip:;
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L3_error:;
   {
     Py_ssize_t __pyx_temp;
     for (__pyx_temp=0; __pyx_temp < (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
       __Pyx_Arg_XDECREF_FASTCALL(values[__pyx_temp]);
@@ -53464,65 +53480,65 @@
   int __pyx_t_13;
   struct __pyx_obj_11sat_toolkit_7formula_CNF *__pyx_t_14 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("to_cnf", 1);
 
-  /* "sat_toolkit/formula.pyx":1816
+  /* "sat_toolkit/formula.pyx":1817
  *         :rtype: CNF
  *         """
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             self._write(espresso.stdin, True, True)
  *             espresso.stdin.close()
  */
   /*with:*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Popen); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_n_u_espresso);
     __Pyx_GIVEREF(__pyx_n_u_espresso);
-    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1816, __pyx_L1_error);
-    __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_v_espresso_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    if (__Pyx_PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_espresso)) __PYX_ERR(0, 1817, __pyx_L1_error);
+    __pyx_t_3 = PyNumber_Add(__pyx_t_1, __pyx_v_espresso_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_3);
-    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L1_error);
+    if (__Pyx_PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L1_error);
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1816, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdin, __pyx_t_5) < 0) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_sp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_PIPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_4) < 0) __PYX_ERR(0, 1816, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_4) < 0) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1816, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_text, Py_True) < 0) __PYX_ERR(0, 1817, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1816, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1816, __pyx_L3_error)
+    __pyx_t_1 = __Pyx_PyObject_LookupSpecial(__pyx_t_4, __pyx_n_s_enter); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1817, __pyx_L3_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     #if CYTHON_UNPACK_METHODS
     if (likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_2)) {
@@ -53534,15 +53550,15 @@
       }
     }
     #endif
     {
       PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
       __pyx_t_3 = __Pyx_PyObject_FastCall(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L3_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __pyx_t_1 = __pyx_t_3;
     __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     /*try:*/ {
@@ -53553,24 +53569,24 @@
         __Pyx_XGOTREF(__pyx_t_8);
         __Pyx_XGOTREF(__pyx_t_9);
         __Pyx_XGOTREF(__pyx_t_10);
         /*try:*/ {
           __pyx_v_espresso = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1817
+          /* "sat_toolkit/formula.pyx":1818
  *         """
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             self._write(espresso.stdin, True, True)             # <<<<<<<<<<<<<<
  *             espresso.stdin.close()
  * 
  */
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1817, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_write_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1818, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1818, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_4))) {
             __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
             if (likely(__pyx_t_2)) {
@@ -53583,30 +53599,30 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[4] = {__pyx_t_2, __pyx_t_3, Py_True, Py_True};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 3+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1817, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1818, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1818
+          /* "sat_toolkit/formula.pyx":1819
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:
  *             self._write(espresso.stdin, True, True)
  *             espresso.stdin.close()             # <<<<<<<<<<<<<<
  * 
  *             cnf = CNF.from_espresso(espresso.stdout.read())
  */
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1818, __pyx_L7_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1819, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_close); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1818, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_close); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1819, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __pyx_t_4 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
             __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
@@ -53619,32 +53635,32 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1818, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1819, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1820
+          /* "sat_toolkit/formula.pyx":1821
  *             espresso.stdin.close()
  * 
  *             cnf = CNF.from_espresso(espresso.stdout.read())             # <<<<<<<<<<<<<<
  * 
  *             ret_code = espresso.wait()
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1820, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF), __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1821, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdout); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1820, __pyx_L7_error)
+          __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_stdout); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1821, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_2);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1820, __pyx_L7_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_read); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1821, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           __pyx_t_2 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
@@ -53657,15 +53673,15 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
             __pyx_t_4 = __Pyx_PyObject_FastCall(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1820, __pyx_L7_error)
+            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1821, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           }
           __pyx_t_5 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
@@ -53680,29 +53696,29 @@
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1820, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1821, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __pyx_v_cnf = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1822
+          /* "sat_toolkit/formula.pyx":1823
  *             cnf = CNF.from_espresso(espresso.stdout.read())
  * 
  *             ret_code = espresso.wait()             # <<<<<<<<<<<<<<
  *             if ret_code != 0:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1822, __pyx_L7_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_wait); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1823, __pyx_L7_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_4 = NULL;
           __pyx_t_7 = 0;
           #if CYTHON_UNPACK_METHODS
           if (likely(PyMethod_Check(__pyx_t_3))) {
             __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
             if (likely(__pyx_t_4)) {
@@ -53714,46 +53730,46 @@
             }
           }
           #endif
           {
             PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
             __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1822, __pyx_L7_error)
+            if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1823, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_1);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           }
           __pyx_v_ret_code = __pyx_t_1;
           __pyx_t_1 = 0;
 
-          /* "sat_toolkit/formula.pyx":1823
+          /* "sat_toolkit/formula.pyx":1824
  * 
  *             ret_code = espresso.wait()
  *             if ret_code != 0:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
-          __pyx_t_11 = (__Pyx_PyInt_BoolNeObjC(__pyx_v_ret_code, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_11 < 0))) __PYX_ERR(0, 1823, __pyx_L7_error)
+          __pyx_t_11 = (__Pyx_PyInt_BoolNeObjC(__pyx_v_ret_code, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_11 < 0))) __PYX_ERR(0, 1824, __pyx_L7_error)
           if (unlikely(__pyx_t_11)) {
 
-            /* "sat_toolkit/formula.pyx":1824
+            /* "sat_toolkit/formula.pyx":1825
  *             ret_code = espresso.wait()
  *             if ret_code != 0:
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))             # <<<<<<<<<<<<<<
  * 
  *             return cnf
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_sp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1824, __pyx_L7_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_sp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1825, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1824, __pyx_L7_error)
+            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_CalledProcessError); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1825, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1824, __pyx_L7_error)
+            __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_espresso, __pyx_n_s_args); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1825, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_3);
-            __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__32, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1824, __pyx_L7_error)
+            __pyx_t_5 = PyUnicode_Join(__pyx_kp_u__34, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1825, __pyx_L7_error)
             __Pyx_GOTREF(__pyx_t_5);
             __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
             __pyx_t_3 = NULL;
             __pyx_t_7 = 0;
             #if CYTHON_UNPACK_METHODS
             if (unlikely(PyMethod_Check(__pyx_t_4))) {
               __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
@@ -53767,43 +53783,43 @@
             }
             #endif
             {
               PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_ret_code, __pyx_t_5};
               __pyx_t_1 = __Pyx_PyObject_FastCall(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
               __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
               __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1824, __pyx_L7_error)
+              if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1825, __pyx_L7_error)
               __Pyx_GOTREF(__pyx_t_1);
               __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
             }
             __Pyx_Raise(__pyx_t_1, 0, 0, 0);
             __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-            __PYX_ERR(0, 1824, __pyx_L7_error)
+            __PYX_ERR(0, 1825, __pyx_L7_error)
 
-            /* "sat_toolkit/formula.pyx":1823
+            /* "sat_toolkit/formula.pyx":1824
  * 
  *             ret_code = espresso.wait()
  *             if ret_code != 0:             # <<<<<<<<<<<<<<
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  */
           }
 
-          /* "sat_toolkit/formula.pyx":1826
+          /* "sat_toolkit/formula.pyx":1827
  *                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
  * 
  *             return cnf             # <<<<<<<<<<<<<<
  */
           __Pyx_XDECREF((PyObject *)__pyx_r);
-          if (!(likely(((__pyx_v_cnf) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_cnf, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1826, __pyx_L7_error)
+          if (!(likely(((__pyx_v_cnf) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_cnf, __pyx_ptype_11sat_toolkit_7formula_CNF))))) __PYX_ERR(0, 1827, __pyx_L7_error)
           __Pyx_INCREF(__pyx_v_cnf);
           __pyx_r = ((struct __pyx_obj_11sat_toolkit_7formula_CNF *)__pyx_v_cnf);
           goto __pyx_L11_try_return;
 
-          /* "sat_toolkit/formula.pyx":1816
+          /* "sat_toolkit/formula.pyx":1817
  *         :rtype: CNF
  *         """
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             self._write(espresso.stdin, True, True)
  *             espresso.stdin.close()
  */
         }
@@ -53811,36 +53827,36 @@
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         /*except:*/ {
           __Pyx_AddTraceback("sat_toolkit.formula.Truthtable.to_cnf", __pyx_clineno, __pyx_lineno, __pyx_filename);
-          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_4, &__pyx_t_5) < 0) __PYX_ERR(0, 1816, __pyx_L9_except_error)
+          if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_4, &__pyx_t_5) < 0) __PYX_ERR(0, 1817, __pyx_L9_except_error)
           __Pyx_XGOTREF(__pyx_t_1);
           __Pyx_XGOTREF(__pyx_t_4);
           __Pyx_XGOTREF(__pyx_t_5);
-          __pyx_t_3 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1816, __pyx_L9_except_error)
+          __pyx_t_3 = PyTuple_Pack(3, __pyx_t_1, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1816, __pyx_L9_except_error)
+          if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1817, __pyx_L9_except_error)
           __Pyx_GOTREF(__pyx_t_12);
           __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_12);
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-          if (__pyx_t_11 < 0) __PYX_ERR(0, 1816, __pyx_L9_except_error)
+          if (__pyx_t_11 < 0) __PYX_ERR(0, 1817, __pyx_L9_except_error)
           __pyx_t_13 = (!__pyx_t_11);
           if (unlikely(__pyx_t_13)) {
             __Pyx_GIVEREF(__pyx_t_1);
             __Pyx_GIVEREF(__pyx_t_4);
             __Pyx_XGIVEREF(__pyx_t_5);
             __Pyx_ErrRestoreWithState(__pyx_t_1, __pyx_t_4, __pyx_t_5);
             __pyx_t_1 = 0; __pyx_t_4 = 0; __pyx_t_5 = 0; 
-            __PYX_ERR(0, 1816, __pyx_L9_except_error)
+            __PYX_ERR(0, 1817, __pyx_L9_except_error)
           }
           __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           goto __pyx_L8_exception_handled;
         }
         __pyx_L9_except_error:;
@@ -53861,29 +53877,29 @@
         __Pyx_XGIVEREF(__pyx_t_10);
         __Pyx_ExceptionReset(__pyx_t_8, __pyx_t_9, __pyx_t_10);
       }
     }
     /*finally:*/ {
       /*normal exit:*/{
         if (__pyx_t_6) {
-          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
+          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1816, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1817, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         goto __pyx_L6;
       }
       __pyx_L4_return: {
         __pyx_t_14 = __pyx_r;
         __pyx_r = 0;
         if (__pyx_t_6) {
-          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__35, NULL);
+          __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__37, NULL);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1816, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1817, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __pyx_r = __pyx_t_14;
         __pyx_t_14 = 0;
         goto __pyx_L0;
       }
@@ -53892,15 +53908,15 @@
     goto __pyx_L17;
     __pyx_L3_error:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     goto __pyx_L1_error;
     __pyx_L17:;
   }
 
-  /* "sat_toolkit/formula.pyx":1804
+  /* "sat_toolkit/formula.pyx":1805
  *         return True
  * 
  *     def to_cnf(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to convert the Truthtable to a minimized CNF.
  */
 
@@ -53920,15 +53936,15 @@
   __Pyx_XDECREF(__pyx_v_cnf);
   __Pyx_XDECREF(__pyx_v_ret_code);
   __Pyx_XGIVEREF((PyObject *)__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1673
+/* "sat_toolkit/formula.pyx":1674
  *     The OFF set is the complement of the two sets.
  *     """
  *     cdef public on_set             # <<<<<<<<<<<<<<
  *     cdef public dc_set
  *     cdef public uint64_t numbits
  */
 
@@ -54021,15 +54037,15 @@
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1674
+/* "sat_toolkit/formula.pyx":1675
  *     """
  *     cdef public on_set
  *     cdef public dc_set             # <<<<<<<<<<<<<<
  *     cdef public uint64_t numbits
  * 
  */
 
@@ -54122,15 +54138,15 @@
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "sat_toolkit/formula.pyx":1675
+/* "sat_toolkit/formula.pyx":1676
  *     cdef public on_set
  *     cdef public dc_set
  *     cdef public uint64_t numbits             # <<<<<<<<<<<<<<
  * 
  *     INIT_INDEX_SET = object()
  */
 
@@ -54154,15 +54170,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__get__", 1);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1675, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->numbits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -54192,15 +54208,15 @@
 
 static int __pyx_pf_11sat_toolkit_7formula_10Truthtable_7numbits_2__set__(struct __pyx_obj_11sat_toolkit_7formula_Truthtable *__pyx_v_self, PyObject *__pyx_v_value) {
   int __pyx_r;
   __pyx_t_11sat_toolkit_5types_uint64_t __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
-  __pyx_t_1 = __Pyx_PyInt_As_unsigned_long(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1675, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_As_unsigned_long(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1676, __pyx_L1_error)
   __pyx_v_self->numbits = __pyx_t_1;
 
   /* function exit code */
   __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_AddTraceback("sat_toolkit.formula.Truthtable.numbits.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
@@ -56919,19 +56935,19 @@
   Py_DECREF(x);
   return r;
 }
 
 static PyObject *__pyx_tp_richcompare_11sat_toolkit_7formula__ClauseList(PyObject *o1, PyObject *o2, int op) {
   switch (op) {
     case Py_EQ: {
-      return __pyx_pw_11sat_toolkit_7formula_11_ClauseList_29__eq__(o1, o2);
+      return __pyx_pw_11sat_toolkit_7formula_11_ClauseList_31__eq__(o1, o2);
     }
     case Py_NE: {
       PyObject *ret;
-      ret = __pyx_pw_11sat_toolkit_7formula_11_ClauseList_29__eq__(o1, o2);
+      ret = __pyx_pw_11sat_toolkit_7formula_11_ClauseList_31__eq__(o1, o2);
       if (likely(ret && ret != Py_NotImplemented)) {
         int b = __Pyx_PyObject_IsTrue(ret);
         Py_DECREF(ret);
         if (unlikely(b < 0)) return NULL;
         ret = (b) ? Py_False : Py_True;
         Py_INCREF(ret);
       }
@@ -56957,15 +56973,15 @@
     maybe_self_is_left = Py_TYPE(left) == Py_TYPE(right)
 #if CYTHON_USE_TYPE_SLOTS
             || (Py_TYPE(left)->tp_as_number && Py_TYPE(left)->tp_as_number->nb_add == &__pyx_nb_add_11sat_toolkit_7formula__ClauseList)
 #endif
             || __Pyx_TypeCheck(left, __pyx_ptype_11sat_toolkit_7formula__ClauseList);
     if (maybe_self_is_left) {
         PyObject *res;
-        res = __pyx_pw_11sat_toolkit_7formula_11_ClauseList_17__add__(left, right);
+        res = __pyx_pw_11sat_toolkit_7formula_11_ClauseList_19__add__(left, right);
         if (res != Py_NotImplemented) return res;
         Py_DECREF(res);
     }
     maybe_self_is_right = Py_TYPE(left) == Py_TYPE(right)
 #if CYTHON_USE_TYPE_SLOTS
             || (Py_TYPE(right)->tp_as_number && Py_TYPE(right)->tp_as_number->nb_add == &__pyx_nb_add_11sat_toolkit_7formula__ClauseList)
 #endif
@@ -57000,20 +57016,21 @@
   return __pyx_pw_11sat_toolkit_7formula_11_ClauseList_14_start_indices_1__get__(o);
 }
 
 static PyMethodDef __pyx_methods_11sat_toolkit_7formula__ClauseList[] = {
   {"get_vars", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_5get_vars, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_4get_vars},
   {"clear", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_7clear, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_6clear},
   {"partition", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_9partition, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_8partition},
-  {"add_clauses", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_11add_clauses, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_10add_clauses},
-  {"add_clause", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_13add_clause, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_12add_clause},
-  {"__reversed__", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_26__reversed__, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_25__reversed__},
-  {"count", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_33count, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_32count},
-  {"index", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_35index, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_34index},
-  {"__reduce__", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_37__reduce__, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_36__reduce__},
+  {"translate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_11translate, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_10translate},
+  {"add_clauses", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_13add_clauses, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_12add_clauses},
+  {"add_clause", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_15add_clause, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_14add_clause},
+  {"__reversed__", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_28__reversed__, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_27__reversed__},
+  {"count", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_35count, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_34count},
+  {"index", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_37index, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_36index},
+  {"__reduce__", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_39__reduce__, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_11_ClauseList_38__reduce__},
   {0, 0, 0, 0}
 };
 
 static struct PyGetSetDef __pyx_getsets_11sat_toolkit_7formula__ClauseList[] = {
   {(char *)"nvars", __pyx_getprop_11sat_toolkit_7formula_11_ClauseList_nvars, __pyx_setprop_11sat_toolkit_7formula_11_ClauseList_nvars, (char *)PyDoc_STR("_ClauseList.nvars: int"), 0},
   {(char *)"_clauses", __pyx_getprop_11sat_toolkit_7formula_11_ClauseList__clauses, 0, (char *)0, 0},
   {(char *)"_start_indices", __pyx_getprop_11sat_toolkit_7formula_11_ClauseList__start_indices, 0, (char *)0, 0},
@@ -57031,36 +57048,36 @@
   #endif
   #if PY_MAJOR_VERSION < 3
   0, /*bf_getsegcount*/
   #endif
   #if PY_MAJOR_VERSION < 3
   0, /*bf_getcharbuffer*/
   #endif
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_39__getbuffer__, /*bf_getbuffer*/
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__releasebuffer__, /*bf_releasebuffer*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__getbuffer__, /*bf_getbuffer*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_43__releasebuffer__, /*bf_releasebuffer*/
 };
 #endif
 static PyType_Slot __pyx_type_11sat_toolkit_7formula__ClauseList_slots[] = {
   {Py_tp_dealloc, (void *)__pyx_tp_dealloc_11sat_toolkit_7formula__ClauseList},
   {Py_nb_add, (void *)__pyx_nb_add_11sat_toolkit_7formula__ClauseList},
-  {Py_nb_inplace_add, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_15__iadd__},
-  {Py_sq_length, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_21__len__},
+  {Py_nb_inplace_add, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_17__iadd__},
+  {Py_sq_length, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__len__},
   {Py_sq_item, (void *)__pyx_sq_item_11sat_toolkit_7formula__ClauseList},
-  {Py_sq_contains, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_31__contains__},
-  {Py_mp_length, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_21__len__},
-  {Py_mp_subscript, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_19__getitem__},
+  {Py_sq_contains, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_33__contains__},
+  {Py_mp_length, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__len__},
+  {Py_mp_subscript, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_21__getitem__},
   #if defined(Py_bf_getbuffer)
-  {Py_bf_getbuffer, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_39__getbuffer__},
+  {Py_bf_getbuffer, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__getbuffer__},
   #endif
   #if defined(Py_bf_releasebuffer)
-  {Py_bf_releasebuffer, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__releasebuffer__},
+  {Py_bf_releasebuffer, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_43__releasebuffer__},
   #endif
   {Py_tp_doc, (void *)PyDoc_STR("_ClauseList(clauses=None, nvars=-1)")},
   {Py_tp_richcompare, (void *)__pyx_tp_richcompare_11sat_toolkit_7formula__ClauseList},
-  {Py_tp_iter, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__iter__},
+  {Py_tp_iter, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_25__iter__},
   {Py_tp_methods, (void *)__pyx_methods_11sat_toolkit_7formula__ClauseList},
   {Py_tp_getset, (void *)__pyx_getsets_11sat_toolkit_7formula__ClauseList},
   {Py_tp_init, (void *)__pyx_pw_11sat_toolkit_7formula_11_ClauseList_1__init__},
   {Py_tp_new, (void *)__pyx_tp_new_11sat_toolkit_7formula__ClauseList},
   {0, 0},
 };
 static PyType_Spec __pyx_type_11sat_toolkit_7formula__ClauseList_spec = {
@@ -57104,15 +57121,15 @@
   0, /*nb_float*/
   #if PY_MAJOR_VERSION < 3 || (CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX < 0x03050000)
   0, /*nb_oct*/
   #endif
   #if PY_MAJOR_VERSION < 3 || (CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX < 0x03050000)
   0, /*nb_hex*/
   #endif
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_15__iadd__, /*nb_inplace_add*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_17__iadd__, /*nb_inplace_add*/
   0, /*nb_inplace_subtract*/
   0, /*nb_inplace_multiply*/
   #if PY_MAJOR_VERSION < 3 || (CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX < 0x03050000)
   0, /*nb_inplace_divide*/
   #endif
   0, /*nb_inplace_remainder*/
   0, /*nb_inplace_power*/
@@ -57131,29 +57148,29 @@
   #endif
   #if PY_VERSION_HEX >= 0x03050000
   0, /*nb_inplace_matrix_multiply*/
   #endif
 };
 
 static PySequenceMethods __pyx_tp_as_sequence__ClauseList = {
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_21__len__, /*sq_length*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__len__, /*sq_length*/
   0, /*sq_concat*/
   0, /*sq_repeat*/
   __pyx_sq_item_11sat_toolkit_7formula__ClauseList, /*sq_item*/
   0, /*sq_slice*/
   0, /*sq_ass_item*/
   0, /*sq_ass_slice*/
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_31__contains__, /*sq_contains*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_33__contains__, /*sq_contains*/
   0, /*sq_inplace_concat*/
   0, /*sq_inplace_repeat*/
 };
 
 static PyMappingMethods __pyx_tp_as_mapping__ClauseList = {
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_21__len__, /*mp_length*/
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_19__getitem__, /*mp_subscript*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__len__, /*mp_length*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_21__getitem__, /*mp_subscript*/
   0, /*mp_ass_subscript*/
 };
 
 static PyBufferProcs __pyx_tp_as_buffer__ClauseList = {
   #if PY_MAJOR_VERSION < 3
   0, /*bf_getreadbuffer*/
   #endif
@@ -57162,16 +57179,16 @@
   #endif
   #if PY_MAJOR_VERSION < 3
   0, /*bf_getsegcount*/
   #endif
   #if PY_MAJOR_VERSION < 3
   0, /*bf_getcharbuffer*/
   #endif
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_39__getbuffer__, /*bf_getbuffer*/
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__releasebuffer__, /*bf_releasebuffer*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__getbuffer__, /*bf_getbuffer*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_43__releasebuffer__, /*bf_releasebuffer*/
 };
 
 static PyTypeObject __pyx_type_11sat_toolkit_7formula__ClauseList = {
   PyVarObject_HEAD_INIT(0, 0)
   "sat_toolkit.formula.""_ClauseList", /*tp_name*/
   sizeof(struct __pyx_obj_11sat_toolkit_7formula__ClauseList), /*tp_basicsize*/
   0, /*tp_itemsize*/
@@ -57202,15 +57219,15 @@
   &__pyx_tp_as_buffer__ClauseList, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
   PyDoc_STR("_ClauseList(clauses=None, nvars=-1)"), /*tp_doc*/
   0, /*tp_traverse*/
   0, /*tp_clear*/
   __pyx_tp_richcompare_11sat_toolkit_7formula__ClauseList, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__iter__, /*tp_iter*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_25__iter__, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_11sat_toolkit_7formula__ClauseList, /*tp_methods*/
   0, /*tp_members*/
   __pyx_getsets_11sat_toolkit_7formula__ClauseList, /*tp_getset*/
   0, /*tp_base*/
   0, /*tp_dict*/
   0, /*tp_descr_get*/
@@ -57283,15 +57300,14 @@
   {"_minimize_dimacs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_3CNF_27_minimize_dimacs, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_3CNF_26_minimize_dimacs},
   {"minimize_lingeling", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_3CNF_29minimize_lingeling, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_3CNF_28minimize_lingeling},
   {"solve_dimacs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_3CNF_31solve_dimacs, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_3CNF_30solve_dimacs},
   {"check_solution", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_3CNF_33check_solution, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_3CNF_32check_solution},
   {"to_truthtable", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_3CNF_35to_truthtable, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_3CNF_34to_truthtable},
   {"__repr__", (PyCFunction)__pyx_specialmethod___pyx_pw_11sat_toolkit_7formula_3CNF_37__repr__, METH_NOARGS|METH_COEXIST, 0},
   {"equiv", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_3CNF_41equiv, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_3CNF_40equiv},
-  {"translate", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_11sat_toolkit_7formula_3CNF_43translate, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_11sat_toolkit_7formula_3CNF_42translate},
   {0, 0, 0, 0}
 };
 #if CYTHON_USE_TYPE_SPECS
 static PyType_Slot __pyx_type_11sat_toolkit_7formula_CNF_slots[] = {
   {Py_tp_repr, (void *)__pyx_pw_11sat_toolkit_7formula_3CNF_37__repr__},
   {Py_tp_str, (void *)__pyx_pw_11sat_toolkit_7formula_3CNF_39__str__},
   {Py_tp_doc, (void *)PyDoc_STR("\n    Class for storing and manipulating CNF formulas.\n\n    The CNF is represented in a format closely related to the DIMACS format.\n    A CNF is conjuction (logical AND) of clauses.\n    Each clause (logical AND) is a list of variables that ends with a 0.\n    A positive number indicates the presence of a variable in the clause while\n    a negative number indicates the presence of the negated varaible in the\n    clause.\n\n    For example, the CNF (x1 or not x2) and (x2 or x3) can be represented as\n    CNF([1, -2, 0, 2, 3, 0]).\n    ")},
@@ -57341,15 +57357,15 @@
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
   PyDoc_STR("\n    Class for storing and manipulating CNF formulas.\n\n    The CNF is represented in a format closely related to the DIMACS format.\n    A CNF is conjuction (logical AND) of clauses.\n    Each clause (logical AND) is a list of variables that ends with a 0.\n    A positive number indicates the presence of a variable in the clause while\n    a negative number indicates the presence of the negated varaible in the\n    clause.\n\n    For example, the CNF (x1 or not x2) and (x2 or x3) can be represented as\n    CNF([1, -2, 0, 2, 3, 0]).\n    "), /*tp_doc*/
   0, /*tp_traverse*/
   0, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   #if CYTHON_COMPILING_IN_PYPY || 0
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__iter__, /*tp_iter*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_25__iter__, /*tp_iter*/
   #else
   0, /*tp_iter*/
   #endif
   0, /*tp_iternext*/
   __pyx_methods_11sat_toolkit_7formula_CNF, /*tp_methods*/
   0, /*tp_members*/
   0, /*tp_getset*/
@@ -57455,15 +57471,15 @@
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
   PyDoc_STR("\n    Class for storing and manipulating a list of xor clauses.\n    "), /*tp_doc*/
   0, /*tp_traverse*/
   0, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   #if CYTHON_COMPILING_IN_PYPY || 0
-  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_23__iter__, /*tp_iter*/
+  __pyx_pw_11sat_toolkit_7formula_11_ClauseList_25__iter__, /*tp_iter*/
   #else
   0, /*tp_iter*/
   #endif
   0, /*tp_iternext*/
   0, /*tp_methods*/
   0, /*tp_members*/
   0, /*tp_getset*/
@@ -59758,27 +59774,26 @@
     {&__pyx_n_s_CNF_create_all_equal, __pyx_k_CNF_create_all_equal, sizeof(__pyx_k_CNF_create_all_equal), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_create_all_zero, __pyx_k_CNF_create_all_zero, sizeof(__pyx_k_CNF_create_all_zero), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_create_xor, __pyx_k_CNF_create_xor, sizeof(__pyx_k_CNF_create_xor), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_equiv, __pyx_k_CNF_equiv, sizeof(__pyx_k_CNF_equiv), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_from_dimacs, __pyx_k_CNF_from_dimacs, sizeof(__pyx_k_CNF_from_dimacs), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_from_espresso, __pyx_k_CNF_from_espresso, sizeof(__pyx_k_CNF_from_espresso), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_get_units, __pyx_k_CNF_get_units, sizeof(__pyx_k_CNF_get_units), 0, 0, 1, 1},
-    {&__pyx_kp_u_CNF_get_units_line_974, __pyx_k_CNF_get_units_line_974, sizeof(__pyx_k_CNF_get_units_line_974), 0, 1, 0, 0},
+    {&__pyx_kp_u_CNF_get_units_line_1009, __pyx_k_CNF_get_units_line_1009, sizeof(__pyx_k_CNF_get_units_line_1009), 0, 1, 0, 0},
     {&__pyx_n_s_CNF_implied_by, __pyx_k_CNF_implied_by, sizeof(__pyx_k_CNF_implied_by), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_logical_or, __pyx_k_CNF_logical_or, sizeof(__pyx_k_CNF_logical_or), 0, 0, 1, 1},
-    {&__pyx_kp_u_CNF_logical_or_line_911, __pyx_k_CNF_logical_or_line_911, sizeof(__pyx_k_CNF_logical_or_line_911), 0, 1, 0, 0},
+    {&__pyx_kp_u_CNF_logical_or_line_946, __pyx_k_CNF_logical_or_line_946, sizeof(__pyx_k_CNF_logical_or_line_946), 0, 1, 0, 0},
     {&__pyx_n_s_CNF_minimize_espresso, __pyx_k_CNF_minimize_espresso, sizeof(__pyx_k_CNF_minimize_espresso), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_minimize_lingeling, __pyx_k_CNF_minimize_lingeling, sizeof(__pyx_k_CNF_minimize_lingeling), 0, 0, 1, 1},
     {&__pyx_kp_u_CNF_must_not_contain_xor_clauses, __pyx_k_CNF_must_not_contain_xor_clauses, sizeof(__pyx_k_CNF_must_not_contain_xor_clauses), 0, 1, 0, 0},
     {&__pyx_kp_u_CNF_over, __pyx_k_CNF_over, sizeof(__pyx_k_CNF_over), 0, 1, 0, 0},
     {&__pyx_n_s_CNF_solve_dimacs, __pyx_k_CNF_solve_dimacs, sizeof(__pyx_k_CNF_solve_dimacs), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_to_dimacs, __pyx_k_CNF_to_dimacs, sizeof(__pyx_k_CNF_to_dimacs), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_to_espresso, __pyx_k_CNF_to_espresso, sizeof(__pyx_k_CNF_to_espresso), 0, 0, 1, 1},
     {&__pyx_n_s_CNF_to_truthtable, __pyx_k_CNF_to_truthtable, sizeof(__pyx_k_CNF_to_truthtable), 0, 0, 1, 1},
-    {&__pyx_n_s_CNF_translate, __pyx_k_CNF_translate, sizeof(__pyx_k_CNF_translate), 0, 0, 1, 1},
     {&__pyx_n_s_CalledProcessError, __pyx_k_CalledProcessError, sizeof(__pyx_k_CalledProcessError), 0, 0, 1, 1},
     {&__pyx_kp_s_Can_only_create_a_buffer_that_is, __pyx_k_Can_only_create_a_buffer_that_is, sizeof(__pyx_k_Can_only_create_a_buffer_that_is), 0, 0, 1, 0},
     {&__pyx_kp_s_Cannot_assign_to_read_only_memor, __pyx_k_Cannot_assign_to_read_only_memor, sizeof(__pyx_k_Cannot_assign_to_read_only_memor), 0, 0, 1, 0},
     {&__pyx_kp_s_Cannot_create_writable_memory_vi, __pyx_k_Cannot_create_writable_memory_vi, sizeof(__pyx_k_Cannot_create_writable_memory_vi), 0, 0, 1, 0},
     {&__pyx_kp_u_Cannot_index_with_type, __pyx_k_Cannot_index_with_type, sizeof(__pyx_k_Cannot_index_with_type), 0, 1, 0, 0},
     {&__pyx_kp_s_Cannot_transpose_memoryview_with, __pyx_k_Cannot_transpose_memoryview_with, sizeof(__pyx_k_Cannot_transpose_memoryview_with), 0, 0, 1, 0},
     {&__pyx_n_s_Clause, __pyx_k_Clause, sizeof(__pyx_k_Clause), 0, 0, 1, 1},
@@ -59790,14 +59805,15 @@
     {&__pyx_n_s_ClauseList_add_clause, __pyx_k_ClauseList_add_clause, sizeof(__pyx_k_ClauseList_add_clause), 0, 0, 1, 1},
     {&__pyx_n_s_ClauseList_add_clauses, __pyx_k_ClauseList_add_clauses, sizeof(__pyx_k_ClauseList_add_clauses), 0, 0, 1, 1},
     {&__pyx_n_s_ClauseList_clear, __pyx_k_ClauseList_clear, sizeof(__pyx_k_ClauseList_clear), 0, 0, 1, 1},
     {&__pyx_n_s_ClauseList_count, __pyx_k_ClauseList_count, sizeof(__pyx_k_ClauseList_count), 0, 0, 1, 1},
     {&__pyx_n_s_ClauseList_get_vars, __pyx_k_ClauseList_get_vars, sizeof(__pyx_k_ClauseList_get_vars), 0, 0, 1, 1},
     {&__pyx_n_s_ClauseList_index, __pyx_k_ClauseList_index, sizeof(__pyx_k_ClauseList_index), 0, 0, 1, 1},
     {&__pyx_n_s_ClauseList_partition, __pyx_k_ClauseList_partition, sizeof(__pyx_k_ClauseList_partition), 0, 0, 1, 1},
+    {&__pyx_n_s_ClauseList_translate, __pyx_k_ClauseList_translate, sizeof(__pyx_k_ClauseList_translate), 0, 0, 1, 1},
     {&__pyx_n_s_Clause___reduce_cython, __pyx_k_Clause___reduce_cython, sizeof(__pyx_k_Clause___reduce_cython), 0, 0, 1, 1},
     {&__pyx_n_s_Clause___setstate_cython, __pyx_k_Clause___setstate_cython, sizeof(__pyx_k_Clause___setstate_cython), 0, 0, 1, 1},
     {&__pyx_n_s_DEVNULL, __pyx_k_DEVNULL, sizeof(__pyx_k_DEVNULL), 0, 0, 1, 1},
     {&__pyx_kp_s_Dimension_d_is_not_direct, __pyx_k_Dimension_d_is_not_direct, sizeof(__pyx_k_Dimension_d_is_not_direct), 0, 0, 1, 0},
     {&__pyx_kp_u_Dverify, __pyx_k_Dverify, sizeof(__pyx_k_Dverify), 0, 1, 0, 0},
     {&__pyx_n_s_Ellipsis, __pyx_k_Ellipsis, sizeof(__pyx_k_Ellipsis), 0, 0, 1, 1},
     {&__pyx_kp_s_Empty_shape_tuple_for_cython_arr, __pyx_k_Empty_shape_tuple_for_cython_arr, sizeof(__pyx_k_Empty_shape_tuple_for_cython_arr), 0, 0, 1, 0},
@@ -59825,14 +59841,15 @@
     {&__pyx_kp_s_Optional_np_ndarray, __pyx_k_Optional_np_ndarray, sizeof(__pyx_k_Optional_np_ndarray), 0, 0, 1, 0},
     {&__pyx_kp_u_Out_of_bounds_on_buffer_access_a, __pyx_k_Out_of_bounds_on_buffer_access_a, sizeof(__pyx_k_Out_of_bounds_on_buffer_access_a), 0, 1, 0, 0},
     {&__pyx_n_s_PIPE, __pyx_k_PIPE, sizeof(__pyx_k_PIPE), 0, 0, 1, 1},
     {&__pyx_n_s_PickleError, __pyx_k_PickleError, sizeof(__pyx_k_PickleError), 0, 0, 1, 1},
     {&__pyx_n_s_Popen, __pyx_k_Popen, sizeof(__pyx_k_Popen), 0, 0, 1, 1},
     {&__pyx_kp_u_Returns_all_unit_clauses_in_the, __pyx_k_Returns_all_unit_clauses_in_the, sizeof(__pyx_k_Returns_all_unit_clauses_in_the), 0, 1, 0, 0},
     {&__pyx_n_u_SATISFIABLE, __pyx_k_SATISFIABLE, sizeof(__pyx_k_SATISFIABLE), 0, 1, 0, 1},
+    {&__pyx_n_s_Self, __pyx_k_Self, sizeof(__pyx_k_Self), 0, 0, 1, 1},
     {&__pyx_n_s_Sequence, __pyx_k_Sequence, sizeof(__pyx_k_Sequence), 0, 0, 1, 1},
     {&__pyx_kp_s_Step_may_not_be_zero_axis_d, __pyx_k_Step_may_not_be_zero_axis_d, sizeof(__pyx_k_Step_may_not_be_zero_axis_d), 0, 0, 1, 0},
     {&__pyx_n_s_StringIO, __pyx_k_StringIO, sizeof(__pyx_k_StringIO), 0, 0, 1, 1},
     {&__pyx_kp_b_T, __pyx_k_T, sizeof(__pyx_k_T), 0, 0, 0, 0},
     {&__pyx_kp_u_T_2, __pyx_k_T_2, sizeof(__pyx_k_T_2), 0, 1, 0, 0},
     {&__pyx_n_u_Truthtable, __pyx_k_Truthtable, sizeof(__pyx_k_Truthtable), 0, 1, 0, 1},
     {&__pyx_n_s_Truthtable_2, __pyx_k_Truthtable_2, sizeof(__pyx_k_Truthtable_2), 0, 0, 1, 1},
@@ -59865,25 +59882,25 @@
     {&__pyx_n_s_XorClause, __pyx_k_XorClause, sizeof(__pyx_k_XorClause), 0, 0, 1, 1},
     {&__pyx_n_u_XorClause, __pyx_k_XorClause, sizeof(__pyx_k_XorClause), 0, 1, 0, 1},
     {&__pyx_n_s_XorClauseList, __pyx_k_XorClauseList, sizeof(__pyx_k_XorClauseList), 0, 0, 1, 1},
     {&__pyx_n_s_XorClause___reduce_cython, __pyx_k_XorClause___reduce_cython, sizeof(__pyx_k_XorClause___reduce_cython), 0, 0, 1, 1},
     {&__pyx_n_s_XorClause___setstate_cython, __pyx_k_XorClause___setstate_cython, sizeof(__pyx_k_XorClause___setstate_cython), 0, 0, 1, 1},
     {&__pyx_kp_b__10, __pyx_k__10, sizeof(__pyx_k__10), 0, 0, 0, 0},
     {&__pyx_kp_u__10, __pyx_k__10, sizeof(__pyx_k__10), 0, 1, 0, 0},
-    {&__pyx_n_s__107, __pyx_k__107, sizeof(__pyx_k__107), 0, 0, 1, 1},
+    {&__pyx_n_s__109, __pyx_k__109, sizeof(__pyx_k__109), 0, 0, 1, 1},
     {&__pyx_kp_b__11, __pyx_k__11, sizeof(__pyx_k__11), 0, 0, 0, 0},
     {&__pyx_kp_b__12, __pyx_k__12, sizeof(__pyx_k__12), 0, 0, 0, 0},
     {&__pyx_kp_u__13, __pyx_k__13, sizeof(__pyx_k__13), 0, 1, 0, 0},
     {&__pyx_kp_u__14, __pyx_k__14, sizeof(__pyx_k__14), 0, 1, 0, 0},
     {&__pyx_n_s__181, __pyx_k__181, sizeof(__pyx_k__181), 0, 0, 1, 1},
     {&__pyx_kp_u__19, __pyx_k__19, sizeof(__pyx_k__19), 0, 1, 0, 0},
     {&__pyx_kp_u__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 1, 0, 0},
     {&__pyx_n_s__3, __pyx_k__3, sizeof(__pyx_k__3), 0, 0, 1, 1},
-    {&__pyx_kp_u__32, __pyx_k__32, sizeof(__pyx_k__32), 0, 1, 0, 0},
-    {&__pyx_kp_u__33, __pyx_k__33, sizeof(__pyx_k__33), 0, 1, 0, 0},
+    {&__pyx_kp_u__34, __pyx_k__34, sizeof(__pyx_k__34), 0, 1, 0, 0},
+    {&__pyx_kp_u__35, __pyx_k__35, sizeof(__pyx_k__35), 0, 1, 0, 0},
     {&__pyx_kp_u__59, __pyx_k__59, sizeof(__pyx_k__59), 0, 1, 0, 0},
     {&__pyx_kp_u__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 1, 0, 0},
     {&__pyx_kp_u__7, __pyx_k__7, sizeof(__pyx_k__7), 0, 1, 0, 0},
     {&__pyx_kp_b__9, __pyx_k__9, sizeof(__pyx_k__9), 0, 0, 0, 0},
     {&__pyx_n_s_a, __pyx_k_a, sizeof(__pyx_k_a), 0, 0, 1, 1},
     {&__pyx_n_s_abc, __pyx_k_abc, sizeof(__pyx_k_abc), 0, 0, 1, 1},
     {&__pyx_n_s_add_clause, __pyx_k_add_clause, sizeof(__pyx_k_add_clause), 0, 0, 1, 1},
@@ -60262,26 +60279,26 @@
     {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
     {0, 0, 0, 0, 0, 0, 0}
   };
   return __Pyx_InitStrings(__pyx_string_tab);
 }
 /* #### Code section: cached_builtins ### */
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_staticmethod = __Pyx_GetBuiltinName(__pyx_n_s_staticmethod); if (!__pyx_builtin_staticmethod) __PYX_ERR(0, 691, __pyx_L1_error)
-  __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object); if (!__pyx_builtin_object) __PYX_ERR(0, 1677, __pyx_L1_error)
+  __pyx_builtin_staticmethod = __Pyx_GetBuiltinName(__pyx_n_s_staticmethod); if (!__pyx_builtin_staticmethod) __PYX_ERR(0, 726, __pyx_L1_error)
+  __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object); if (!__pyx_builtin_object) __PYX_ERR(0, 1678, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(0, 70, __pyx_L1_error)
   __pyx_builtin_IndexError = __Pyx_GetBuiltinName(__pyx_n_s_IndexError); if (!__pyx_builtin_IndexError) __PYX_ERR(0, 91, __pyx_L1_error)
   __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 93, __pyx_L1_error)
   __pyx_builtin_reversed = __Pyx_GetBuiltinName(__pyx_n_s_reversed); if (!__pyx_builtin_reversed) __PYX_ERR(0, 160, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(0, 205, __pyx_L1_error)
   __pyx_builtin_AssertionError = __Pyx_GetBuiltinName(__pyx_n_s_AssertionError); if (!__pyx_builtin_AssertionError) __PYX_ERR(0, 351, __pyx_L1_error)
-  __pyx_builtin_NotImplementedError = __Pyx_GetBuiltinName(__pyx_n_s_NotImplementedError); if (!__pyx_builtin_NotImplementedError) __PYX_ERR(0, 511, __pyx_L1_error)
-  __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(0, 902, __pyx_L1_error)
-  __pyx_builtin_open = __Pyx_GetBuiltinName(__pyx_n_s_open); if (!__pyx_builtin_open) __PYX_ERR(0, 1119, __pyx_L1_error)
-  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __pyx_builtin_NotImplementedError = __Pyx_GetBuiltinName(__pyx_n_s_NotImplementedError); if (!__pyx_builtin_NotImplementedError) __PYX_ERR(0, 546, __pyx_L1_error)
+  __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_builtin_open = __Pyx_GetBuiltinName(__pyx_n_s_open); if (!__pyx_builtin_open) __PYX_ERR(0, 1154, __pyx_L1_error)
+  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 1212, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 68, __pyx_L1_error)
   __pyx_builtin___import__ = __Pyx_GetBuiltinName(__pyx_n_s_import); if (!__pyx_builtin___import__) __PYX_ERR(1, 100, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 408, __pyx_L1_error)
   __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(1, 618, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
@@ -60368,353 +60385,353 @@
  * 
  *         if val >= self.nvars:
  */
   __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_u_nvars_must_be_nonnegative); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 271, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__20);
   __Pyx_GIVEREF(__pyx_tuple__20);
 
-  /* "sat_toolkit/formula.pyx":382
+  /* "sat_toolkit/formula.pyx":394
+ *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
+ *         if var_view[0] != 0:
+ *             raise ValueError('variable 0 must map to 0 again')             # <<<<<<<<<<<<<<
+ * 
+ *         for i in range(1, <size_t> var_view.shape[0]):
+ */
+  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_u_variable_0_must_map_to_0_again); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 394, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__21);
+  __Pyx_GIVEREF(__pyx_tuple__21);
+
+  /* "sat_toolkit/formula.pyx":398
+ *         for i in range(1, <size_t> var_view.shape[0]):
+ *             if var_view[i] == 0:
+ *                 raise ValueError('variable must not be mapped to 0')             # <<<<<<<<<<<<<<
+ * 
+ *         cdef vector[int] new_clauses
+ */
+  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_u_variable_must_not_be_mapped_to_0); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 398, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__22);
+  __Pyx_GIVEREF(__pyx_tuple__22);
+
+  /* "sat_toolkit/formula.pyx":417
  * 
  *         if self.view_count > 0:
  *             raise ValueError('cannot alter while referenced by buffer')             # <<<<<<<<<<<<<<
  * 
  *         if length > 0 and clauses[length - 1] != 0:
  */
-  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_u_cannot_alter_while_referenced_by); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 382, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__21);
-  __Pyx_GIVEREF(__pyx_tuple__21);
+  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_u_cannot_alter_while_referenced_by); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 417, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__23);
+  __Pyx_GIVEREF(__pyx_tuple__23);
 
-  /* "sat_toolkit/formula.pyx":385
+  /* "sat_toolkit/formula.pyx":420
  * 
  *         if length > 0 and clauses[length - 1] != 0:
  *             raise ValueError('last clause not terminated with 0')             # <<<<<<<<<<<<<<
  * 
  *         old_len = self._clauses.size()
  */
-  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_u_last_clause_not_terminated_with); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 385, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__22);
-  __Pyx_GIVEREF(__pyx_tuple__22);
+  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_u_last_clause_not_terminated_with); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 420, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__24);
+  __Pyx_GIVEREF(__pyx_tuple__24);
 
-  /* "sat_toolkit/formula.pyx":480
+  /* "sat_toolkit/formula.pyx":515
  *         np_clause[:clause_len] = clause
  *         if np.count_nonzero(np_clause) != clause_len:
  *             raise ValueError('cannot use 0 in clause')             # <<<<<<<<<<<<<<
  *         self._add_clauses(np_clause)
  * 
  */
-  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_u_cannot_use_0_in_clause); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 480, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__23);
-  __Pyx_GIVEREF(__pyx_tuple__23);
+  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_u_cannot_use_0_in_clause); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 515, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
 
-  /* "sat_toolkit/formula.pyx":511
+  /* "sat_toolkit/formula.pyx":546
  * 
  *     cdef _BaseClause get_clause(self, ssize_t idx):
  *         raise NotImplementedError('should be implemented by subclass')             # <<<<<<<<<<<<<<
  * 
  *     def __getitem__(self, ssize_t idx) -> Clause:
  */
-  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_u_should_be_implemented_by_subclas); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 511, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__24);
-  __Pyx_GIVEREF(__pyx_tuple__24);
+  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_u_should_be_implemented_by_subclas); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 546, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__26);
+  __Pyx_GIVEREF(__pyx_tuple__26);
 
-  /* "sat_toolkit/formula.pyx":695
+  /* "sat_toolkit/formula.pyx":730
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  *         if len(tmp._xor_clauses) > 0:
  *             raise ValueError('CNF must not contain xor clauses')             # <<<<<<<<<<<<<<
  * 
  *         return tmp._clauses
  */
-  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_u_CNF_must_not_contain_xor_clauses); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 695, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__26);
-  __Pyx_GIVEREF(__pyx_tuple__26);
+  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_u_CNF_must_not_contain_xor_clauses); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 730, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__28);
+  __Pyx_GIVEREF(__pyx_tuple__28);
 
-  /* "sat_toolkit/formula.pyx":723
+  /* "sat_toolkit/formula.pyx":758
  *             val = line[line.shape[0] - 1]
  *             if line.shape[0] != numbits + 2 or line[line.shape[0] - 2] != b' ':
  *                 raise ValueError('file format error')             # <<<<<<<<<<<<<<
  * 
  *             #espresso_mask, val = line.split()
  */
-  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_u_file_format_error); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 723, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__27);
-  __Pyx_GIVEREF(__pyx_tuple__27);
+  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_u_file_format_error); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 758, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__29);
+  __Pyx_GIVEREF(__pyx_tuple__29);
 
-  /* "sat_toolkit/formula.pyx":772
+  /* "sat_toolkit/formula.pyx":807
  *             val = indices[i]
  *             if val == 0:
  *                 raise ValueError('all indices must be nonzero')             # <<<<<<<<<<<<<<
  *             clauses[2*i] = -val
  * 
  */
-  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_u_all_indices_must_be_nonzero); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 772, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__28);
-  __Pyx_GIVEREF(__pyx_tuple__28);
+  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_u_all_indices_must_be_nonzero); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 807, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__30);
+  __Pyx_GIVEREF(__pyx_tuple__30);
 
-  /* "sat_toolkit/formula.pyx":796
+  /* "sat_toolkit/formula.pyx":831
  *         length = lhs.shape[0]
  *         if rhs.shape[0] != length:
  *             raise ValueError('lhs and rhs must have the same length')             # <<<<<<<<<<<<<<
  * 
  *         clauses.resize(length * 6)
  */
-  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_u_lhs_and_rhs_must_have_the_same_l); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 796, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__29);
-  __Pyx_GIVEREF(__pyx_tuple__29);
+  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_u_lhs_and_rhs_must_have_the_same_l); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__31);
+  __Pyx_GIVEREF(__pyx_tuple__31);
 
-  /* "sat_toolkit/formula.pyx":896
+  /* "sat_toolkit/formula.pyx":931
  * 
  *         if num_args < 1:
  *             raise ValueError('must provide at least one argument')             # <<<<<<<<<<<<<<
  * 
  *         num_xors = len(args[0])
  */
-  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_u_must_provide_at_least_one_argume); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 896, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__30);
-  __Pyx_GIVEREF(__pyx_tuple__30);
+  __pyx_tuple__32 = PyTuple_Pack(1, __pyx_kp_u_must_provide_at_least_one_argume); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 931, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__32);
+  __Pyx_GIVEREF(__pyx_tuple__32);
 
-  /* "sat_toolkit/formula.pyx":930
+  /* "sat_toolkit/formula.pyx":965
  *         """
  *         if var == 0:
  *             raise ValueError("var must not be zero")             # <<<<<<<<<<<<<<
  * 
  *         cdef vector[int] new_clauses
  */
-  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_u_var_must_not_be_zero); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 930, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__31);
-  __Pyx_GIVEREF(__pyx_tuple__31);
+  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_kp_u_var_must_not_be_zero); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 965, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__33);
+  __Pyx_GIVEREF(__pyx_tuple__33);
 
-  /* "sat_toolkit/formula.pyx":1087
+  /* "sat_toolkit/formula.pyx":1122
  *         cdef int ret_code
  * 
  *         with sp.Popen(['espresso'] + espresso_args, stdin=sp.PIPE, stdout=sp.PIPE, text=True) as espresso:             # <<<<<<<<<<<<<<
  *             espresso.stdin.write(self.to_espresso())
  *             espresso.stdin.close()
  */
-  __pyx_tuple__35 = PyTuple_Pack(3, Py_None, Py_None, Py_None); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 1087, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__35);
-  __Pyx_GIVEREF(__pyx_tuple__35);
+  __pyx_tuple__37 = PyTuple_Pack(3, Py_None, Py_None, Py_None); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 1122, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__37);
+  __Pyx_GIVEREF(__pyx_tuple__37);
 
-  /* "sat_toolkit/formula.pyx":1168
+  /* "sat_toolkit/formula.pyx":1203
  * 
  * 
  *         with NamedTemporaryFile('w', prefix='sat_toolkit_', suffix='.cnf') as f:             # <<<<<<<<<<<<<<
  *             f.write(self.to_dimacs())
  *             f.flush()
  */
-  __pyx_tuple__37 = PyTuple_Pack(1, __pyx_n_u_w); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 1168, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__37);
-  __Pyx_GIVEREF(__pyx_tuple__37);
+  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_n_u_w); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 1203, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
 
-  /* "sat_toolkit/formula.pyx":1183
+  /* "sat_toolkit/formula.pyx":1218
  * 
  *                     if line.startswith('s '):
  *                         line = line[2:].strip()             # <<<<<<<<<<<<<<
  *                         if line == 'SATISFIABLE':
  *                             is_sat = True
  */
-  __pyx_slice__38 = PySlice_New(__pyx_int_2, Py_None, Py_None); if (unlikely(!__pyx_slice__38)) __PYX_ERR(0, 1183, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__38);
-  __Pyx_GIVEREF(__pyx_slice__38);
+  __pyx_slice__40 = PySlice_New(__pyx_int_2, Py_None, Py_None); if (unlikely(!__pyx_slice__40)) __PYX_ERR(0, 1218, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__40);
+  __Pyx_GIVEREF(__pyx_slice__40);
 
-  /* "sat_toolkit/formula.pyx":1196
+  /* "sat_toolkit/formula.pyx":1231
  *                             lit = buf[i]
  *                             if abs(lit) >= result_view.shape[0]:
  *                                 raise IndexError('solver returned model index that is out of bounds')             # <<<<<<<<<<<<<<
  *                             result_view[abs(lit)] = lit > 0
  * 
  */
-  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_kp_u_solver_returned_model_index_that); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 1196, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__39);
-  __Pyx_GIVEREF(__pyx_tuple__39);
+  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_kp_u_solver_returned_model_index_that); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1231, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
 
-  /* "sat_toolkit/formula.pyx":1212
+  /* "sat_toolkit/formula.pyx":1247
  *                 return True, result
  *             else:
  *                 return False, None             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__40 = PyTuple_Pack(2, Py_False, Py_None); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 1212, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__40);
-  __Pyx_GIVEREF(__pyx_tuple__40);
+  __pyx_tuple__42 = PyTuple_Pack(2, Py_False, Py_None); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 1247, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
 
-  /* "sat_toolkit/formula.pyx":1220
+  /* "sat_toolkit/formula.pyx":1255
  *         for i in range(solution.shape[0]):
  *            if solution[i] not in [0, 1]:
  *                raise ValueError(f'all elements in solution must be in [0, 1]')             # <<<<<<<<<<<<<<
  * 
  *         return self._check_solution(solution)
  */
-  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_kp_u_all_elements_in_solution_must_be); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1220, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__41);
-  __Pyx_GIVEREF(__pyx_tuple__41);
+  __pyx_tuple__43 = PyTuple_Pack(1, __pyx_kp_u_all_elements_in_solution_must_be); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1255, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
 
-  /* "sat_toolkit/formula.pyx":1267
+  /* "sat_toolkit/formula.pyx":1302
  * 
  *         if self.nvars > 32:
  *             raise ValueError('cannot find all solutions for CNF with more than 32 variables')             # <<<<<<<<<<<<<<
  * 
  *         truthtable = np.empty((<uint64_t> 1) << self.nvars, np.uint8)
  */
-  __pyx_tuple__42 = PyTuple_Pack(1, __pyx_kp_u_cannot_find_all_solutions_for_CN); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 1267, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__42);
-  __Pyx_GIVEREF(__pyx_tuple__42);
-
-  /* "sat_toolkit/formula.pyx":1336
- *             raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
- *         if var_view[0] != 0:
- *             raise ValueError('variable 0 must map to 0 again')             # <<<<<<<<<<<<<<
- * 
- *         for i in range(1, <size_t> var_view.shape[0]):
- */
-  __pyx_tuple__43 = PyTuple_Pack(1, __pyx_kp_u_variable_0_must_map_to_0_again); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1336, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__43);
-  __Pyx_GIVEREF(__pyx_tuple__43);
-
-  /* "sat_toolkit/formula.pyx":1340
- *         for i in range(1, <size_t> var_view.shape[0]):
- *             if var_view[i] == 0:
- *                 raise ValueError('variable must not be mapped to 0')             # <<<<<<<<<<<<<<
- * 
- *         cdef vector[int] new_clauses
- */
-  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_kp_u_variable_must_not_be_mapped_to_0); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 1340, __pyx_L1_error)
+  __pyx_tuple__44 = PyTuple_Pack(1, __pyx_kp_u_cannot_find_all_solutions_for_CN); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 1302, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__44);
   __Pyx_GIVEREF(__pyx_tuple__44);
 
-  /* "sat_toolkit/formula.pyx":1401
+  /* "sat_toolkit/formula.pyx":1402
  *             if line.startswith('p cnf '):
  *                 if nvars != -1:
  *                     raise ValueError('multiple p cnf lines in dimacs')             # <<<<<<<<<<<<<<
  * 
  *                 tmp_nvars, tmp_nclauses = line[len('p cnf '):].split()
  */
-  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_u_multiple_p_cnf_lines_in_dimacs); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1401, __pyx_L1_error)
+  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_u_multiple_p_cnf_lines_in_dimacs); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1402, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__45);
   __Pyx_GIVEREF(__pyx_tuple__45);
 
-  /* "sat_toolkit/formula.pyx":1408
+  /* "sat_toolkit/formula.pyx":1409
  * 
  *             elif line.startswith('x'):
  *                 xors.add_clauses([int(x) for x in line[1:].split()])             # <<<<<<<<<<<<<<
  *             else:
  *                 clauses.add_clauses([int(x) for x in line.split()])
  */
-  __pyx_slice__46 = PySlice_New(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__46)) __PYX_ERR(0, 1408, __pyx_L1_error)
+  __pyx_slice__46 = PySlice_New(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__46)) __PYX_ERR(0, 1409, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__46);
   __Pyx_GIVEREF(__pyx_slice__46);
 
-  /* "sat_toolkit/formula.pyx":1413
+  /* "sat_toolkit/formula.pyx":1414
  * 
  *         if nvars == -1:
  *             raise ValueError('no \'p cnf ...\' line in dimacs')             # <<<<<<<<<<<<<<
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):
  */
-  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_u_no_p_cnf_line_in_dimacs); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1413, __pyx_L1_error)
+  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_u_no_p_cnf_line_in_dimacs); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1414, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__47);
   __Pyx_GIVEREF(__pyx_tuple__47);
 
-  /* "sat_toolkit/formula.pyx":1416
+  /* "sat_toolkit/formula.pyx":1417
  * 
  *         if nvars < max(clauses.nvars, xors.nvars):
  *             raise ValueError('nvars in p cnf line is smaller than the biggest encountered variable')             # <<<<<<<<<<<<<<
  * 
  *         clauses.nvars = nvars
  */
-  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_u_nvars_in_p_cnf_line_is_smaller_t); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 1416, __pyx_L1_error)
+  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_u_nvars_in_p_cnf_line_is_smaller_t); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 1417, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__48);
   __Pyx_GIVEREF(__pyx_tuple__48);
 
-  /* "sat_toolkit/formula.pyx":1451
+  /* "sat_toolkit/formula.pyx":1452
  * 
  *         if rhs_view is not None and len(rhs_view) != num_xors:
  *             raise ValueError('rhs must have the same length as the arguments')             # <<<<<<<<<<<<<<
  * 
  *         packed_args = np.zeros((num_xors, num_args + 1), np.int32)
  */
-  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_kp_u_rhs_must_have_the_same_length_as); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1451, __pyx_L1_error)
+  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_kp_u_rhs_must_have_the_same_length_as); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1452, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__49);
   __Pyx_GIVEREF(__pyx_tuple__49);
 
-  /* "sat_toolkit/formula.pyx":1681
+  /* "sat_toolkit/formula.pyx":1682
  *     def __init__(self, init_key, numbits, on_set, dc_set):
  *         if init_key is not self.INIT_INDEX_SET:
  *             raise ValueError('use .from_lut or .from_indices')             # <<<<<<<<<<<<<<
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):
  */
-  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_kp_u_use_from_lut_or_from_indices); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 1681, __pyx_L1_error)
+  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_kp_u_use_from_lut_or_from_indices); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 1682, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__51);
   __Pyx_GIVEREF(__pyx_tuple__51);
 
-  /* "sat_toolkit/formula.pyx":1684
+  /* "sat_toolkit/formula.pyx":1685
  * 
  *         if len(on_set.shape) != 1 or (dc_set is not None and len(dc_set.shape) != 1):
  *             raise ValueError('parameters must be one dimensional')             # <<<<<<<<<<<<<<
  * 
  *         self.numbits = numbits
  */
-  __pyx_tuple__52 = PyTuple_Pack(1, __pyx_kp_u_parameters_must_be_one_dimension); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 1684, __pyx_L1_error)
+  __pyx_tuple__52 = PyTuple_Pack(1, __pyx_kp_u_parameters_must_be_one_dimension); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 1685, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__52);
   __Pyx_GIVEREF(__pyx_tuple__52);
 
-  /* "sat_toolkit/formula.pyx":1706
+  /* "sat_toolkit/formula.pyx":1707
  * 
  *         if dc_lut is not None and on_lut.shape != dc_lut.shape:
  *             raise ValueError('parameters must have the same shape')             # <<<<<<<<<<<<<<
  * 
  *         numvals = on_lut.shape[0]
  */
-  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_kp_u_parameters_must_have_the_same_sh); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 1706, __pyx_L1_error)
+  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_kp_u_parameters_must_have_the_same_sh); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 1707, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__53);
   __Pyx_GIVEREF(__pyx_tuple__53);
 
-  /* "sat_toolkit/formula.pyx":1710
+  /* "sat_toolkit/formula.pyx":1711
  *         numvals = on_lut.shape[0]
  *         if (numvals & (numvals - 1)) != 0 or numvals == 0:
  *             raise ValueError('length parameter must be a power of 2')             # <<<<<<<<<<<<<<
  * 
  *         numbits = numvals.bit_length() - 1
  */
-  __pyx_tuple__54 = PyTuple_Pack(1, __pyx_kp_u_length_parameter_must_be_a_power); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 1710, __pyx_L1_error)
+  __pyx_tuple__54 = PyTuple_Pack(1, __pyx_kp_u_length_parameter_must_be_a_power); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 1711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__54);
   __Pyx_GIVEREF(__pyx_tuple__54);
 
-  /* "sat_toolkit/formula.pyx":1715
+  /* "sat_toolkit/formula.pyx":1716
  * 
  *         if dc_lut is not None and np.any(on_lut & dc_lut):
  *             raise ValueError('on_lut and dc_lut must be distinct')             # <<<<<<<<<<<<<<
  * 
  *         on_set, = np.where(on_lut)
  */
-  __pyx_tuple__55 = PyTuple_Pack(1, __pyx_kp_u_on_lut_and_dc_lut_must_be_distin); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 1715, __pyx_L1_error)
+  __pyx_tuple__55 = PyTuple_Pack(1, __pyx_kp_u_on_lut_and_dc_lut_must_be_distin); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 1716, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__55);
   __Pyx_GIVEREF(__pyx_tuple__55);
 
-  /* "sat_toolkit/formula.pyx":1749
+  /* "sat_toolkit/formula.pyx":1750
  *             io.write(f'.phase {not invert:b}\n')
  * 
  *         def sorted_contains(a, v):             # <<<<<<<<<<<<<<
  *             idx = np.searchsorted(a, v)
  *             return idx < len(a) and a[idx] == v
  */
-  __pyx_tuple__57 = PyTuple_Pack(3, __pyx_n_s_a, __pyx_n_s_v_2, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 1749, __pyx_L1_error)
+  __pyx_tuple__57 = PyTuple_Pack(3, __pyx_n_s_a, __pyx_n_s_v_2, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 1750, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__57);
   __Pyx_GIVEREF(__pyx_tuple__57);
-  __pyx_codeobj__58 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__57, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_sorted_contains, 1749, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__58)) __PYX_ERR(0, 1749, __pyx_L1_error)
+  __pyx_codeobj__58 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__57, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_sorted_contains, 1750, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__58)) __PYX_ERR(0, 1750, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1779
+  /* "sat_toolkit/formula.pyx":1780
  *             invert = False
  *         else:
  *             raise ValueError('invalid value for `phase`')             # <<<<<<<<<<<<<<
  * 
  *         res = io.StringIO()
  */
-  __pyx_tuple__60 = PyTuple_Pack(1, __pyx_kp_u_invalid_value_for_phase); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 1779, __pyx_L1_error)
+  __pyx_tuple__60 = PyTuple_Pack(1, __pyx_kp_u_invalid_value_for_phase); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 1780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__60);
   __Pyx_GIVEREF(__pyx_tuple__60);
 
   /* "(tree fragment)":4
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xa84091e, 0x12d81c9, 0xbecc035):             # <<<<<<<<<<<<<<
@@ -60960,490 +60977,490 @@
  *         partition the CNF/XorClauseList into a list of CNF/XorClauseLists with disjoints variables.
  */
   __pyx_tuple__94 = PyTuple_Pack(10, __pyx_n_s_self, __pyx_n_s_res, __pyx_n_s_vars_to_update, __pyx_n_s_clause, __pyx_n_s_dst, __pyx_n_s_tmp, __pyx_n_s_var, __pyx_n_s_result_list, __pyx_n_s_seen_keys, __pyx_n_s_val); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(0, 309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__94);
   __Pyx_GIVEREF(__pyx_tuple__94);
   __pyx_codeobj__95 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__94, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_partition, 309, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__95)) __PYX_ERR(0, 309, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":445
+  /* "sat_toolkit/formula.pyx":378
+ *         return result_list
+ * 
+ *     def translate(self, mapping) -> Self:             # <<<<<<<<<<<<<<
+ *         """
+ *         Translate all variables in the CNF/XorClauseList to a new index.
+ */
+  __pyx_tuple__96 = PyTuple_Pack(8, __pyx_n_s_self, __pyx_n_s_mapping, __pyx_n_s_np_vars, __pyx_n_s_var_view, __pyx_n_s_i_2, __pyx_n_s_new_clauses, __pyx_n_s_var, __pyx_n_s_res); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 378, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__96);
+  __Pyx_GIVEREF(__pyx_tuple__96);
+  __pyx_codeobj__97 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__96, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_translate, 378, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__97)) __PYX_ERR(0, 378, __pyx_L1_error)
+
+  /* "sat_toolkit/formula.pyx":480
  * 
  * 
  *     def add_clauses(self, clauses) -> None:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList c_clauses = None
  * 
  */
-  __pyx_tuple__96 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_clauses, __pyx_n_s_c_clauses, __pyx_n_s_clauses_view, __pyx_n_s_np_clauses); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 445, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__96);
-  __Pyx_GIVEREF(__pyx_tuple__96);
-  __pyx_codeobj__97 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__96, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clauses, 445, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__97)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_tuple__98 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_clauses, __pyx_n_s_c_clauses, __pyx_n_s_clauses_view, __pyx_n_s_np_clauses); if (unlikely(!__pyx_tuple__98)) __PYX_ERR(0, 480, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__98);
+  __Pyx_GIVEREF(__pyx_tuple__98);
+  __pyx_codeobj__99 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__98, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clauses, 480, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__99)) __PYX_ERR(0, 480, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":470
+  /* "sat_toolkit/formula.pyx":505
  *                 self.nvars = c_clauses.nvars
  * 
  *     def add_clause(self, clause) -> None:             # <<<<<<<<<<<<<<
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  */
-  __pyx_tuple__98 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_clause, __pyx_n_s_clause_len, __pyx_n_s_np_clause); if (unlikely(!__pyx_tuple__98)) __PYX_ERR(0, 470, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__98);
-  __Pyx_GIVEREF(__pyx_tuple__98);
-  __pyx_codeobj__99 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__98, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clause, 470, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__99)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_tuple__100 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_clause, __pyx_n_s_clause_len, __pyx_n_s_np_clause); if (unlikely(!__pyx_tuple__100)) __PYX_ERR(0, 505, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__100);
+  __Pyx_GIVEREF(__pyx_tuple__100);
+  __pyx_codeobj__101 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__100, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clause, 505, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__101)) __PYX_ERR(0, 505, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":526
+  /* "sat_toolkit/formula.pyx":561
  * 
  * 
  *     def __reversed__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  */
-  __pyx_codeobj__25 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_GENERATOR, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__77, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reversed_2, 526, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 526, __pyx_L1_error)
+  __pyx_codeobj__27 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_GENERATOR, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__77, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reversed_2, 561, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 561, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":583
+  /* "sat_toolkit/formula.pyx":618
  *                     return True
  * 
  *     def count(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
-  __pyx_tuple__100 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_needle, __pyx_n_s_i_2, __pyx_n_s_count, __pyx_n_s_c_needle); if (unlikely(!__pyx_tuple__100)) __PYX_ERR(0, 583, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__100);
-  __Pyx_GIVEREF(__pyx_tuple__100);
-  __pyx_codeobj__101 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__100, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_count, 583, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__101)) __PYX_ERR(0, 583, __pyx_L1_error)
+  __pyx_tuple__102 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_needle, __pyx_n_s_i_2, __pyx_n_s_count, __pyx_n_s_c_needle); if (unlikely(!__pyx_tuple__102)) __PYX_ERR(0, 618, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__102);
+  __Pyx_GIVEREF(__pyx_tuple__102);
+  __pyx_codeobj__103 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__102, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_count, 618, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__103)) __PYX_ERR(0, 618, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":607
+  /* "sat_toolkit/formula.pyx":642
  *         return <size_t> idx
  * 
  *     def index(self, needle, start=None, end=None) -> int:             # <<<<<<<<<<<<<<
  *         """
  *         Return zero-based index in the list of the first item whose value is
  */
-  __pyx_tuple__102 = PyTuple_Pack(8, __pyx_n_s_self, __pyx_n_s_needle, __pyx_n_s_start, __pyx_n_s_end, __pyx_n_s_i_2, __pyx_n_s_start_idx, __pyx_n_s_end_idx, __pyx_n_s_c_needle); if (unlikely(!__pyx_tuple__102)) __PYX_ERR(0, 607, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__102);
-  __Pyx_GIVEREF(__pyx_tuple__102);
-  __pyx_codeobj__103 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__102, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_index, 607, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__103)) __PYX_ERR(0, 607, __pyx_L1_error)
+  __pyx_tuple__104 = PyTuple_Pack(8, __pyx_n_s_self, __pyx_n_s_needle, __pyx_n_s_start, __pyx_n_s_end, __pyx_n_s_i_2, __pyx_n_s_start_idx, __pyx_n_s_end_idx, __pyx_n_s_c_needle); if (unlikely(!__pyx_tuple__104)) __PYX_ERR(0, 642, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__104);
+  __Pyx_GIVEREF(__pyx_tuple__104);
+  __pyx_codeobj__105 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__104, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_index, 642, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__105)) __PYX_ERR(0, 642, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":635
+  /* "sat_toolkit/formula.pyx":670
  * 
  *     # pickle support
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (np.array(self), self.nvars)
  * 
  */
-  __pyx_codeobj__104 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reduce, 635, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__104)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_codeobj__106 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reduce, 670, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__106)) __PYX_ERR(0, 670, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":691
+  /* "sat_toolkit/formula.pyx":726
  *     """
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  */
-  __pyx_tuple__105 = PyTuple_Pack(2, __pyx_n_s_dimacs, __pyx_n_s_tmp); if (unlikely(!__pyx_tuple__105)) __PYX_ERR(0, 691, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__105);
-  __Pyx_GIVEREF(__pyx_tuple__105);
-  __pyx_codeobj__106 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__105, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_dimacs, 691, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__106)) __PYX_ERR(0, 691, __pyx_L1_error)
+  __pyx_tuple__107 = PyTuple_Pack(2, __pyx_n_s_dimacs, __pyx_n_s_tmp); if (unlikely(!__pyx_tuple__107)) __PYX_ERR(0, 726, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__107);
+  __Pyx_GIVEREF(__pyx_tuple__107);
+  __pyx_codeobj__108 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__107, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_dimacs, 726, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__108)) __PYX_ERR(0, 726, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":699
+  /* "sat_toolkit/formula.pyx":734
  *         return tmp._clauses
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_espresso(espresso: str) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_tuple__108 = PyTuple_Pack(14, __pyx_n_s_espresso, __pyx_n_s_clauses, __pyx_n_s_start_indices, __pyx_n_s_line, __pyx_n_s_val, __pyx_n_s_mask, __pyx_n_s_sign, __pyx_n_s_numbits, __pyx_n_s_i_2, __pyx_n_s_f, __pyx_n_s_line_py, __pyx_n_s__107, __pyx_n_s_bits, __pyx_n_s_res); if (unlikely(!__pyx_tuple__108)) __PYX_ERR(0, 699, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__108);
-  __Pyx_GIVEREF(__pyx_tuple__108);
-  __pyx_codeobj__109 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__108, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_espresso, 699, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__109)) __PYX_ERR(0, 699, __pyx_L1_error)
+  __pyx_tuple__110 = PyTuple_Pack(14, __pyx_n_s_espresso, __pyx_n_s_clauses, __pyx_n_s_start_indices, __pyx_n_s_line, __pyx_n_s_val, __pyx_n_s_mask, __pyx_n_s_sign, __pyx_n_s_numbits, __pyx_n_s_i_2, __pyx_n_s_f, __pyx_n_s_line_py, __pyx_n_s__109, __pyx_n_s_bits, __pyx_n_s_res); if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__110);
+  __Pyx_GIVEREF(__pyx_tuple__110);
+  __pyx_codeobj__111 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__110, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_espresso, 734, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__111)) __PYX_ERR(0, 734, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":751
+  /* "sat_toolkit/formula.pyx":786
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_zero(indices) -> CNF:
  *         """
  */
-  __pyx_tuple__110 = PyTuple_Pack(1, __pyx_n_s_indices); if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 751, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__110);
-  __Pyx_GIVEREF(__pyx_tuple__110);
-  __pyx_codeobj__111 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__110, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_zero_2, 751, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__111)) __PYX_ERR(0, 751, __pyx_L1_error)
+  __pyx_tuple__112 = PyTuple_Pack(1, __pyx_n_s_indices); if (unlikely(!__pyx_tuple__112)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__112);
+  __Pyx_GIVEREF(__pyx_tuple__112);
+  __pyx_codeobj__113 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__112, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_zero_2, 786, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__113)) __PYX_ERR(0, 786, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":760
+  /* "sat_toolkit/formula.pyx":795
  *         return CNF._create_all_zero(indices)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_zero(const int[:] indices not None) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_tuple__112 = PyTuple_Pack(6, __pyx_n_s_indices, __pyx_n_s_clauses, __pyx_n_s_i_2, __pyx_n_s_l, __pyx_n_s_val, __pyx_n_s_res); if (unlikely(!__pyx_tuple__112)) __PYX_ERR(0, 760, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__112);
-  __Pyx_GIVEREF(__pyx_tuple__112);
-  __pyx_codeobj__113 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__112, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_zero, 760, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__113)) __PYX_ERR(0, 760, __pyx_L1_error)
+  __pyx_tuple__114 = PyTuple_Pack(6, __pyx_n_s_indices, __pyx_n_s_clauses, __pyx_n_s_i_2, __pyx_n_s_l, __pyx_n_s_val, __pyx_n_s_res); if (unlikely(!__pyx_tuple__114)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__114);
+  __Pyx_GIVEREF(__pyx_tuple__114);
+  __pyx_codeobj__115 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__114, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_zero, 795, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__115)) __PYX_ERR(0, 795, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":781
+  /* "sat_toolkit/formula.pyx":816
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_equal(lhs, rhs) -> CNF:
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  */
-  __pyx_tuple__114 = PyTuple_Pack(2, __pyx_n_s_lhs, __pyx_n_s_rhs); if (unlikely(!__pyx_tuple__114)) __PYX_ERR(0, 781, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__114);
-  __Pyx_GIVEREF(__pyx_tuple__114);
-  __pyx_codeobj__115 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__114, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_equal_2, 781, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__115)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_tuple__116 = PyTuple_Pack(2, __pyx_n_s_lhs, __pyx_n_s_rhs); if (unlikely(!__pyx_tuple__116)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__116);
+  __Pyx_GIVEREF(__pyx_tuple__116);
+  __pyx_codeobj__117 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__116, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_equal_2, 816, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__117)) __PYX_ERR(0, 816, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":788
+  /* "sat_toolkit/formula.pyx":823
  *         return CNF._create_all_equal(lhs, rhs)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_equal(const int[:] lhs not None, const int[:] rhs not None) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_tuple__116 = PyTuple_Pack(8, __pyx_n_s_lhs, __pyx_n_s_rhs, __pyx_n_s_clauses, __pyx_n_s_i_2, __pyx_n_s_length, __pyx_n_s_l, __pyx_n_s_r, __pyx_n_s_res); if (unlikely(!__pyx_tuple__116)) __PYX_ERR(0, 788, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__116);
-  __Pyx_GIVEREF(__pyx_tuple__116);
-  __pyx_codeobj__117 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__116, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_equal, 788, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__117)) __PYX_ERR(0, 788, __pyx_L1_error)
+  __pyx_tuple__118 = PyTuple_Pack(8, __pyx_n_s_lhs, __pyx_n_s_rhs, __pyx_n_s_clauses, __pyx_n_s_i_2, __pyx_n_s_length, __pyx_n_s_l, __pyx_n_s_r, __pyx_n_s_res); if (unlikely(!__pyx_tuple__118)) __PYX_ERR(0, 823, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__118);
+  __Pyx_GIVEREF(__pyx_tuple__118);
+  __pyx_codeobj__119 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__118, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_all_equal, 823, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__119)) __PYX_ERR(0, 823, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":880
+  /* "sat_toolkit/formula.pyx":915
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
-  __pyx_tuple__118 = PyTuple_Pack(7, __pyx_n_s_rhs, __pyx_n_s_args, __pyx_n_s_num_args, __pyx_n_s_num_xors, __pyx_n_s_i_2, __pyx_n_s_packed_args, __pyx_n_s_arg); if (unlikely(!__pyx_tuple__118)) __PYX_ERR(0, 880, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__118);
-  __Pyx_GIVEREF(__pyx_tuple__118);
-  __pyx_codeobj__119 = (PyObject*)__Pyx_PyCode_New(0, 0, 1, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__118, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_xor, 880, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__119)) __PYX_ERR(0, 880, __pyx_L1_error)
+  __pyx_tuple__120 = PyTuple_Pack(7, __pyx_n_s_rhs, __pyx_n_s_args, __pyx_n_s_num_args, __pyx_n_s_num_xors, __pyx_n_s_i_2, __pyx_n_s_packed_args, __pyx_n_s_arg); if (unlikely(!__pyx_tuple__120)) __PYX_ERR(0, 915, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__120);
+  __Pyx_GIVEREF(__pyx_tuple__120);
+  __pyx_codeobj__121 = (PyObject*)__Pyx_PyCode_New(0, 0, 1, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__120, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_xor, 915, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__121)) __PYX_ERR(0, 915, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":911
+  /* "sat_toolkit/formula.pyx":946
  * 
  * 
  *     def logical_or(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var or self). I.e., the new CNF is
  */
-  __pyx_tuple__120 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_var, __pyx_n_s_new_clauses, __pyx_n_s_src, __pyx_n_s_dst, __pyx_n_s_res); if (unlikely(!__pyx_tuple__120)) __PYX_ERR(0, 911, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__120);
-  __Pyx_GIVEREF(__pyx_tuple__120);
-  __pyx_codeobj__121 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__120, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_logical_or, 911, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__121)) __PYX_ERR(0, 911, __pyx_L1_error)
+  __pyx_tuple__122 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_var, __pyx_n_s_new_clauses, __pyx_n_s_src, __pyx_n_s_dst, __pyx_n_s_res); if (unlikely(!__pyx_tuple__122)) __PYX_ERR(0, 946, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__122);
+  __Pyx_GIVEREF(__pyx_tuple__122);
+  __pyx_codeobj__123 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__122, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_logical_or, 946, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__123)) __PYX_ERR(0, 946, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":947
+  /* "sat_toolkit/formula.pyx":982
  *         return res
  * 
  *     def implied_by(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var -> self). I.e., the new CNF is
  */
-  __pyx_tuple__122 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_var); if (unlikely(!__pyx_tuple__122)) __PYX_ERR(0, 947, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__122);
-  __Pyx_GIVEREF(__pyx_tuple__122);
-  __pyx_codeobj__123 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__122, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_implied_by, 947, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__123)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_tuple__124 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_var); if (unlikely(!__pyx_tuple__124)) __PYX_ERR(0, 982, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__124);
+  __Pyx_GIVEREF(__pyx_tuple__124);
+  __pyx_codeobj__125 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__124, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_implied_by, 982, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__125)) __PYX_ERR(0, 982, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":974
+  /* "sat_toolkit/formula.pyx":1009
  *         return units
  * 
  *     def get_units(self) -> np.ndarray:             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
-  __pyx_tuple__124 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_vec_result, __pyx_n_s_result_view, __pyx_n_s_idx, __pyx_n_s_result); if (unlikely(!__pyx_tuple__124)) __PYX_ERR(0, 974, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__124);
-  __Pyx_GIVEREF(__pyx_tuple__124);
-  __pyx_codeobj__125 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__124, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_get_units, 974, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__125)) __PYX_ERR(0, 974, __pyx_L1_error)
+  __pyx_tuple__126 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_vec_result, __pyx_n_s_result_view, __pyx_n_s_idx, __pyx_n_s_result); if (unlikely(!__pyx_tuple__126)) __PYX_ERR(0, 1009, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__126);
+  __Pyx_GIVEREF(__pyx_tuple__126);
+  __pyx_codeobj__127 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__126, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_get_units, 1009, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__127)) __PYX_ERR(0, 1009, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":997
+  /* "sat_toolkit/formula.pyx":1032
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the DIMACS file format
  */
-  __pyx_tuple__126 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_max_len, __pyx_n_s_nclauses, __pyx_n_s_buf_size, __pyx_n_s_buf, __pyx_n_s_buf_idx, __pyx_n_s_written, __pyx_n_s_i_2, __pyx_n_s_py_str); if (unlikely(!__pyx_tuple__126)) __PYX_ERR(0, 997, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__126);
-  __Pyx_GIVEREF(__pyx_tuple__126);
-  __pyx_codeobj__127 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__126, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_dimacs, 997, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__127)) __PYX_ERR(0, 997, __pyx_L1_error)
+  __pyx_tuple__128 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_max_len, __pyx_n_s_nclauses, __pyx_n_s_buf_size, __pyx_n_s_buf, __pyx_n_s_buf_idx, __pyx_n_s_written, __pyx_n_s_i_2, __pyx_n_s_py_str); if (unlikely(!__pyx_tuple__128)) __PYX_ERR(0, 1032, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__128);
+  __Pyx_GIVEREF(__pyx_tuple__128);
+  __pyx_codeobj__129 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__128, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_dimacs, 1032, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__129)) __PYX_ERR(0, 1032, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1028
+  /* "sat_toolkit/formula.pyx":1063
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()
  * 
  *     def to_espresso(self, print_numvars: bool = True) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the espresso file format
  */
-  __pyx_tuple__128 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_print_numvars, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_lit, __pyx_n_s_target_char, __pyx_n_s_line_buf, __pyx_n_s_buf, __pyx_n_s_py_bytes); if (unlikely(!__pyx_tuple__128)) __PYX_ERR(0, 1028, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__128);
-  __Pyx_GIVEREF(__pyx_tuple__128);
-  __pyx_codeobj__129 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__128, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_espresso, 1028, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__129)) __PYX_ERR(0, 1028, __pyx_L1_error)
-  __pyx_tuple__130 = PyTuple_Pack(1, Py_True); if (unlikely(!__pyx_tuple__130)) __PYX_ERR(0, 1028, __pyx_L1_error)
+  __pyx_tuple__130 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_print_numvars, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_lit, __pyx_n_s_target_char, __pyx_n_s_line_buf, __pyx_n_s_buf, __pyx_n_s_py_bytes); if (unlikely(!__pyx_tuple__130)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__130);
   __Pyx_GIVEREF(__pyx_tuple__130);
+  __pyx_codeobj__131 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__130, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_espresso, 1063, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__131)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __pyx_tuple__132 = PyTuple_Pack(1, Py_True); if (unlikely(!__pyx_tuple__132)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__132);
+  __Pyx_GIVEREF(__pyx_tuple__132);
 
-  /* "sat_toolkit/formula.pyx":1076
+  /* "sat_toolkit/formula.pyx":1111
  *         return py_bytes.decode()
  * 
  *     def minimize_espresso(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to minimize the given CNF.
  */
-  __pyx_tuple__131 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_espresso_args, __pyx_n_s_ret_code, __pyx_n_s_espresso, __pyx_n_s_cnf_2); if (unlikely(!__pyx_tuple__131)) __PYX_ERR(0, 1076, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__131);
-  __Pyx_GIVEREF(__pyx_tuple__131);
-  __pyx_codeobj__132 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__131, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_espresso, 1076, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__132)) __PYX_ERR(0, 1076, __pyx_L1_error)
+  __pyx_tuple__133 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_espresso_args, __pyx_n_s_ret_code, __pyx_n_s_espresso, __pyx_n_s_cnf_2); if (unlikely(!__pyx_tuple__133)) __PYX_ERR(0, 1111, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__133);
+  __Pyx_GIVEREF(__pyx_tuple__133);
+  __pyx_codeobj__134 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__133, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_espresso, 1111, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__134)) __PYX_ERR(0, 1111, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1099
+  /* "sat_toolkit/formula.pyx":1134
  *             return cnf
  * 
  *     def _minimize_dimacs(self, args: List[str], outfile: str) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         calls args with self.to_dimacs() as stdin, waits for the command to
  */
-  __pyx_tuple__133 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_args, __pyx_n_s_outfile, __pyx_n_s_ret_code, __pyx_n_s_minimizer, __pyx_n_s_f); if (unlikely(!__pyx_tuple__133)) __PYX_ERR(0, 1099, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__133);
-  __Pyx_GIVEREF(__pyx_tuple__133);
-  __pyx_codeobj__134 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__133, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_dimacs, 1099, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__134)) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __pyx_tuple__135 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_args, __pyx_n_s_outfile, __pyx_n_s_ret_code, __pyx_n_s_minimizer, __pyx_n_s_f); if (unlikely(!__pyx_tuple__135)) __PYX_ERR(0, 1134, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__135);
+  __Pyx_GIVEREF(__pyx_tuple__135);
+  __pyx_codeobj__136 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__135, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_dimacs, 1134, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__136)) __PYX_ERR(0, 1134, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1122
+  /* "sat_toolkit/formula.pyx":1157
  *             return CNF.from_dimacs(f.read())
  * 
  *     def minimize_lingeling(self, optlevel=None, timeout=0, extra_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses Lingeling to minimize the given CNF.
  */
-  __pyx_tuple__135 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_optlevel, __pyx_n_s_timeout, __pyx_n_s_extra_args, __pyx_n_s_ret_code, __pyx_n_s_args, __pyx_n_s_f); if (unlikely(!__pyx_tuple__135)) __PYX_ERR(0, 1122, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__135);
-  __Pyx_GIVEREF(__pyx_tuple__135);
-  __pyx_codeobj__136 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__135, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_lingeling, 1122, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__136)) __PYX_ERR(0, 1122, __pyx_L1_error)
+  __pyx_tuple__137 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_optlevel, __pyx_n_s_timeout, __pyx_n_s_extra_args, __pyx_n_s_ret_code, __pyx_n_s_args, __pyx_n_s_f); if (unlikely(!__pyx_tuple__137)) __PYX_ERR(0, 1157, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__137);
+  __Pyx_GIVEREF(__pyx_tuple__137);
+  __pyx_codeobj__138 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__137, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_minimize_lingeling, 1157, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__138)) __PYX_ERR(0, 1157, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1148
+  /* "sat_toolkit/formula.pyx":1183
  * 
  * 
  *     def solve_dimacs(self, command: List[str], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS the compliant sat solver given by command.
  */
-  __pyx_tuple__137 = PyTuple_Pack(15, __pyx_n_s_self, __pyx_n_s_command, __pyx_n_s_verbose, __pyx_n_s_echo_comments, __pyx_n_s_ret_code, __pyx_n_s_result_view, __pyx_n_s_result, __pyx_n_s_buf, __pyx_n_s_lit, __pyx_n_s_i_2, __pyx_n_s_is_sat, __pyx_n_s_f, __pyx_n_s_args, __pyx_n_s_solver, __pyx_n_s_line); if (unlikely(!__pyx_tuple__137)) __PYX_ERR(0, 1148, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__137);
-  __Pyx_GIVEREF(__pyx_tuple__137);
-  __pyx_codeobj__138 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__137, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_solve_dimacs, 1148, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__138)) __PYX_ERR(0, 1148, __pyx_L1_error)
-  __pyx_tuple__139 = PyTuple_Pack(1, Py_False); if (unlikely(!__pyx_tuple__139)) __PYX_ERR(0, 1148, __pyx_L1_error)
+  __pyx_tuple__139 = PyTuple_Pack(15, __pyx_n_s_self, __pyx_n_s_command, __pyx_n_s_verbose, __pyx_n_s_echo_comments, __pyx_n_s_ret_code, __pyx_n_s_result_view, __pyx_n_s_result, __pyx_n_s_buf, __pyx_n_s_lit, __pyx_n_s_i_2, __pyx_n_s_is_sat, __pyx_n_s_f, __pyx_n_s_args, __pyx_n_s_solver, __pyx_n_s_line); if (unlikely(!__pyx_tuple__139)) __PYX_ERR(0, 1183, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__139);
   __Pyx_GIVEREF(__pyx_tuple__139);
+  __pyx_codeobj__140 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__139, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_solve_dimacs, 1183, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__140)) __PYX_ERR(0, 1183, __pyx_L1_error)
+  __pyx_tuple__141 = PyTuple_Pack(1, Py_False); if (unlikely(!__pyx_tuple__141)) __PYX_ERR(0, 1183, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__141);
+  __Pyx_GIVEREF(__pyx_tuple__141);
 
-  /* "sat_toolkit/formula.pyx":1216
+  /* "sat_toolkit/formula.pyx":1251
  * 
  * 
  *     def check_solution(self, uint8_t[:] solution) -> bool:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  */
-  __pyx_tuple__140 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_solution, __pyx_n_s_i_2); if (unlikely(!__pyx_tuple__140)) __PYX_ERR(0, 1216, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__140);
-  __Pyx_GIVEREF(__pyx_tuple__140);
-  __pyx_codeobj__141 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__140, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_check_solution, 1216, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__141)) __PYX_ERR(0, 1216, __pyx_L1_error)
+  __pyx_tuple__142 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_solution, __pyx_n_s_i_2); if (unlikely(!__pyx_tuple__142)) __PYX_ERR(0, 1251, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__142);
+  __Pyx_GIVEREF(__pyx_tuple__142);
+  __pyx_codeobj__143 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__142, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_check_solution, 1251, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__143)) __PYX_ERR(0, 1251, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1257
+  /* "sat_toolkit/formula.pyx":1292
  *         return False
  * 
  *     def to_truthtable(self) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Return the current CNF as a Truthtable by iterating over all possible
  */
-  __pyx_tuple__142 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_truthtable_view, __pyx_n_s_current_sol_view, __pyx_n_s_truthtable, __pyx_n_s_current_sol); if (unlikely(!__pyx_tuple__142)) __PYX_ERR(0, 1257, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__142);
-  __Pyx_GIVEREF(__pyx_tuple__142);
-  __pyx_codeobj__143 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__142, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_truthtable, 1257, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__143)) __PYX_ERR(0, 1257, __pyx_L1_error)
+  __pyx_tuple__144 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_truthtable_view, __pyx_n_s_current_sol_view, __pyx_n_s_truthtable, __pyx_n_s_current_sol); if (unlikely(!__pyx_tuple__144)) __PYX_ERR(0, 1292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__144);
+  __Pyx_GIVEREF(__pyx_tuple__144);
+  __pyx_codeobj__145 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__144, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_truthtable, 1292, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__145)) __PYX_ERR(0, 1292, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1299
+  /* "sat_toolkit/formula.pyx":1334
  *         return self.to_dimacs().rstrip()
  * 
  *     def equiv(self, CNF other) -> bool:             # <<<<<<<<<<<<<<
  *         """
  *         Check for logical eqivalence between self and other.
  */
-  __pyx_tuple__144 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_other, __pyx_n_s_ret_code, __pyx_n_s_espresso); if (unlikely(!__pyx_tuple__144)) __PYX_ERR(0, 1299, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__144);
-  __Pyx_GIVEREF(__pyx_tuple__144);
-  __pyx_codeobj__145 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__144, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_equiv, 1299, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__145)) __PYX_ERR(0, 1299, __pyx_L1_error)
-
-  /* "sat_toolkit/formula.pyx":1320
- *             return ret_code == 0
- * 
- *     def translate(self, mapping) -> CNF:             # <<<<<<<<<<<<<<
- *         """
- *         Translate all variables in the CNF to a new index.
- */
-  __pyx_tuple__146 = PyTuple_Pack(8, __pyx_n_s_self, __pyx_n_s_mapping, __pyx_n_s_np_vars, __pyx_n_s_var_view, __pyx_n_s_i_2, __pyx_n_s_new_clauses, __pyx_n_s_var, __pyx_n_s_res); if (unlikely(!__pyx_tuple__146)) __PYX_ERR(0, 1320, __pyx_L1_error)
+  __pyx_tuple__146 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_other, __pyx_n_s_ret_code, __pyx_n_s_espresso); if (unlikely(!__pyx_tuple__146)) __PYX_ERR(0, 1334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__146);
   __Pyx_GIVEREF(__pyx_tuple__146);
-  __pyx_codeobj__147 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__146, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_translate, 1320, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__147)) __PYX_ERR(0, 1320, __pyx_L1_error)
+  __pyx_codeobj__147 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__146, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_equiv, 1334, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__147)) __PYX_ERR(0, 1334, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1386
+  /* "sat_toolkit/formula.pyx":1387
  * 
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)
  */
-  __pyx_tuple__148 = PyTuple_Pack(12, __pyx_n_s_dimacs, __pyx_n_s_clauses, __pyx_n_s_xors, __pyx_n_s_nvars, __pyx_n_s_nclauses, __pyx_n_s_lines, __pyx_n_s_line, __pyx_n_s_tmp_nvars, __pyx_n_s_tmp_nclauses, __pyx_n_s_nclaues, __pyx_n_s_x, __pyx_n_s_x); if (unlikely(!__pyx_tuple__148)) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __pyx_tuple__148 = PyTuple_Pack(12, __pyx_n_s_dimacs, __pyx_n_s_clauses, __pyx_n_s_xors, __pyx_n_s_nvars, __pyx_n_s_nclauses, __pyx_n_s_lines, __pyx_n_s_line, __pyx_n_s_tmp_nvars, __pyx_n_s_tmp_nclauses, __pyx_n_s_nclaues, __pyx_n_s_x, __pyx_n_s_x); if (unlikely(!__pyx_tuple__148)) __PYX_ERR(0, 1387, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__148);
   __Pyx_GIVEREF(__pyx_tuple__148);
-  __pyx_codeobj__149 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__148, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_dimacs, 1386, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__149)) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __pyx_codeobj__149 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__148, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_dimacs, 1387, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__149)) __PYX_ERR(0, 1387, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1423
+  /* "sat_toolkit/formula.pyx":1424
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
-  __pyx_tuple__150 = PyTuple_Pack(11, __pyx_n_s_rhs, __pyx_n_s_args, __pyx_n_s_num_args, __pyx_n_s_num_xors, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_rhs_view, __pyx_n_s_packed_args, __pyx_n_s_arg, __pyx_n_s_packed_args_view, __pyx_n_s_res); if (unlikely(!__pyx_tuple__150)) __PYX_ERR(0, 1423, __pyx_L1_error)
+  __pyx_tuple__150 = PyTuple_Pack(11, __pyx_n_s_rhs, __pyx_n_s_args, __pyx_n_s_num_args, __pyx_n_s_num_xors, __pyx_n_s_i_2, __pyx_n_s_j, __pyx_n_s_rhs_view, __pyx_n_s_packed_args, __pyx_n_s_arg, __pyx_n_s_packed_args_view, __pyx_n_s_res); if (unlikely(!__pyx_tuple__150)) __PYX_ERR(0, 1424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__150);
   __Pyx_GIVEREF(__pyx_tuple__150);
-  __pyx_codeobj__151 = (PyObject*)__Pyx_PyCode_New(0, 0, 1, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__150, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_xor, 1423, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__151)) __PYX_ERR(0, 1423, __pyx_L1_error)
+  __pyx_codeobj__151 = (PyObject*)__Pyx_PyCode_New(0, 0, 1, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__150, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_create_xor, 1424, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__151)) __PYX_ERR(0, 1424, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1479
+  /* "sat_toolkit/formula.pyx":1480
  *         return res
  * 
  *     def partition(self) -> tuple[list[CNF], list[XorClauseList]]:             # <<<<<<<<<<<<<<
  *         """
  *         Separately partition the CNF and XorClauseList into a lists of CNFs and
  */
-  __pyx_codeobj__152 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_partition, 1479, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__152)) __PYX_ERR(0, 1479, __pyx_L1_error)
+  __pyx_codeobj__152 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_partition, 1480, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__152)) __PYX_ERR(0, 1480, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1489
+  /* "sat_toolkit/formula.pyx":1490
  *         return (self._clauses.partition(), self._xor_clauses.partition())
  * 
  *     def to_cnf(self) -> CNF:             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  *         cdef size_t idx
  */
-  __pyx_tuple__153 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_res, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__153)) __PYX_ERR(0, 1489, __pyx_L1_error)
+  __pyx_tuple__153 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_res, __pyx_n_s_idx); if (unlikely(!__pyx_tuple__153)) __PYX_ERR(0, 1490, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__153);
   __Pyx_GIVEREF(__pyx_tuple__153);
-  __pyx_codeobj__154 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__153, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_cnf, 1489, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__154)) __PYX_ERR(0, 1489, __pyx_L1_error)
+  __pyx_codeobj__154 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__153, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_cnf, 1490, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__154)) __PYX_ERR(0, 1490, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1501
+  /* "sat_toolkit/formula.pyx":1502
  *         return res
  * 
  *     def add_clauses(self, clauses):             # <<<<<<<<<<<<<<
  *         self._clauses.add_clauses(clauses)
  * 
  */
-  __pyx_tuple__155 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_clauses); if (unlikely(!__pyx_tuple__155)) __PYX_ERR(0, 1501, __pyx_L1_error)
+  __pyx_tuple__155 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_clauses); if (unlikely(!__pyx_tuple__155)) __PYX_ERR(0, 1502, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__155);
   __Pyx_GIVEREF(__pyx_tuple__155);
-  __pyx_codeobj__156 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__155, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clauses, 1501, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__156)) __PYX_ERR(0, 1501, __pyx_L1_error)
+  __pyx_codeobj__156 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__155, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_clauses, 1502, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__156)) __PYX_ERR(0, 1502, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1504
+  /* "sat_toolkit/formula.pyx":1505
  *         self._clauses.add_clauses(clauses)
  * 
  *     def add_xor_clauses(self, xor_clauses):             # <<<<<<<<<<<<<<
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
-  __pyx_tuple__157 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_xor_clauses); if (unlikely(!__pyx_tuple__157)) __PYX_ERR(0, 1504, __pyx_L1_error)
+  __pyx_tuple__157 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_xor_clauses); if (unlikely(!__pyx_tuple__157)) __PYX_ERR(0, 1505, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__157);
   __Pyx_GIVEREF(__pyx_tuple__157);
-  __pyx_codeobj__158 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__157, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_xor_clauses, 1504, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__158)) __PYX_ERR(0, 1504, __pyx_L1_error)
+  __pyx_codeobj__158 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__157, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_add_xor_clauses, 1505, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__158)) __PYX_ERR(0, 1505, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1572
+  /* "sat_toolkit/formula.pyx":1573
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the XorCNF formatted in the extended DIMACS file format
  */
-  __pyx_codeobj__159 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_dimacs, 1572, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__159)) __PYX_ERR(0, 1572, __pyx_L1_error)
+  __pyx_codeobj__159 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_dimacs, 1573, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__159)) __PYX_ERR(0, 1573, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1578
+  /* "sat_toolkit/formula.pyx":1579
  *         return f'p cnf {self._nvars()} {len(self._clauses) + len(self._xor_clauses)}\n{self._clauses._to_dimacs("")}{self._xor_clauses._to_dimacs("x")}'
  * 
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  */
-  __pyx_codeobj__160 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reduce, 1578, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__160)) __PYX_ERR(0, 1578, __pyx_L1_error)
+  __pyx_codeobj__160 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_reduce, 1579, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__160)) __PYX_ERR(0, 1579, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1594
+  /* "sat_toolkit/formula.pyx":1595
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses
  * 
  *     def solve_dimacs(self, command: List[str]=['cryptominisat5'], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS compliant sat solver that also
  */
-  __pyx_codeobj__161 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__137, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_solve_dimacs, 1594, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__161)) __PYX_ERR(0, 1594, __pyx_L1_error)
+  __pyx_codeobj__161 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__139, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_solve_dimacs, 1595, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__161)) __PYX_ERR(0, 1595, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1691
+  /* "sat_toolkit/formula.pyx":1692
  * 
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:
  *         """
  */
-  __pyx_tuple__162 = PyTuple_Pack(7, __pyx_n_s_cls, __pyx_n_s_on_lut, __pyx_n_s_dc_lut, __pyx_n_s_numvals, __pyx_n_s_numbits, __pyx_n_s_on_set, __pyx_n_s_dc_set); if (unlikely(!__pyx_tuple__162)) __PYX_ERR(0, 1691, __pyx_L1_error)
+  __pyx_tuple__162 = PyTuple_Pack(7, __pyx_n_s_cls, __pyx_n_s_on_lut, __pyx_n_s_dc_lut, __pyx_n_s_numvals, __pyx_n_s_numbits, __pyx_n_s_on_set, __pyx_n_s_dc_set); if (unlikely(!__pyx_tuple__162)) __PYX_ERR(0, 1692, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__162);
   __Pyx_GIVEREF(__pyx_tuple__162);
-  __pyx_codeobj__163 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__162, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_lut, 1691, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__163)) __PYX_ERR(0, 1691, __pyx_L1_error)
-  __pyx_tuple__164 = PyTuple_Pack(1, Py_None); if (unlikely(!__pyx_tuple__164)) __PYX_ERR(0, 1691, __pyx_L1_error)
+  __pyx_codeobj__163 = (PyObject*)__Pyx_PyCode_New(3, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__162, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_lut, 1692, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__163)) __PYX_ERR(0, 1692, __pyx_L1_error)
+  __pyx_tuple__164 = PyTuple_Pack(1, Py_None); if (unlikely(!__pyx_tuple__164)) __PYX_ERR(0, 1692, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__164);
   __Pyx_GIVEREF(__pyx_tuple__164);
 
-  /* "sat_toolkit/formula.pyx":1721
+  /* "sat_toolkit/formula.pyx":1722
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:
  *         """
  */
-  __pyx_tuple__165 = PyTuple_Pack(4, __pyx_n_s_cls, __pyx_n_s_numbits, __pyx_n_s_on_indices, __pyx_n_s_dc_indices); if (unlikely(!__pyx_tuple__165)) __PYX_ERR(0, 1721, __pyx_L1_error)
+  __pyx_tuple__165 = PyTuple_Pack(4, __pyx_n_s_cls, __pyx_n_s_numbits, __pyx_n_s_on_indices, __pyx_n_s_dc_indices); if (unlikely(!__pyx_tuple__165)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__165);
   __Pyx_GIVEREF(__pyx_tuple__165);
-  __pyx_codeobj__166 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__165, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_indices, 1721, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__166)) __PYX_ERR(0, 1721, __pyx_L1_error)
+  __pyx_codeobj__166 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__165, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_from_indices, 1722, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__166)) __PYX_ERR(0, 1722, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1736
+  /* "sat_toolkit/formula.pyx":1737
  * 
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:             # <<<<<<<<<<<<<<
  *         i_list = range(1 << self.numbits)
  * 
  */
-  __pyx_tuple__167 = PyTuple_Pack(11, __pyx_n_s_self, __pyx_n_s_io, __pyx_n_s_espresso, __pyx_n_s_invert, __pyx_n_s_i_list, __pyx_n_s_sorted_contains, __pyx_n_s_sorted_contains, __pyx_n_s_i_2, __pyx_n_s_on, __pyx_n_s_dc, __pyx_n_s_desc); if (unlikely(!__pyx_tuple__167)) __PYX_ERR(0, 1736, __pyx_L1_error)
+  __pyx_tuple__167 = PyTuple_Pack(11, __pyx_n_s_self, __pyx_n_s_io, __pyx_n_s_espresso, __pyx_n_s_invert, __pyx_n_s_i_list, __pyx_n_s_sorted_contains, __pyx_n_s_sorted_contains, __pyx_n_s_i_2, __pyx_n_s_on, __pyx_n_s_dc, __pyx_n_s_desc); if (unlikely(!__pyx_tuple__167)) __PYX_ERR(0, 1737, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__167);
   __Pyx_GIVEREF(__pyx_tuple__167);
-  __pyx_codeobj__168 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__167, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_write_2, 1736, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__168)) __PYX_ERR(0, 1736, __pyx_L1_error)
-  __pyx_tuple__169 = PyTuple_Pack(2, Py_False, Py_False); if (unlikely(!__pyx_tuple__169)) __PYX_ERR(0, 1736, __pyx_L1_error)
+  __pyx_codeobj__168 = (PyObject*)__Pyx_PyCode_New(4, 0, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__167, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_write_2, 1737, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__168)) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __pyx_tuple__169 = PyTuple_Pack(2, Py_False, Py_False); if (unlikely(!__pyx_tuple__169)) __PYX_ERR(0, 1737, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__169);
   __Pyx_GIVEREF(__pyx_tuple__169);
 
-  /* "sat_toolkit/formula.pyx":1765
+  /* "sat_toolkit/formula.pyx":1766
  *             io.write(f'.end\n')
  * 
  *     def to_espresso(self, phase='cnf') -> str:             # <<<<<<<<<<<<<<
  *         """
  *         return the truthtable in espresso format
  */
-  __pyx_tuple__170 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_phase_2, __pyx_n_s_invert, __pyx_n_s_res); if (unlikely(!__pyx_tuple__170)) __PYX_ERR(0, 1765, __pyx_L1_error)
+  __pyx_tuple__170 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_phase_2, __pyx_n_s_invert, __pyx_n_s_res); if (unlikely(!__pyx_tuple__170)) __PYX_ERR(0, 1766, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__170);
   __Pyx_GIVEREF(__pyx_tuple__170);
-  __pyx_codeobj__171 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__170, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_espresso, 1765, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__171)) __PYX_ERR(0, 1765, __pyx_L1_error)
-  __pyx_tuple__172 = PyTuple_Pack(1, __pyx_n_u_cnf_2); if (unlikely(!__pyx_tuple__172)) __PYX_ERR(0, 1765, __pyx_L1_error)
+  __pyx_codeobj__171 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__170, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_espresso, 1766, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__171)) __PYX_ERR(0, 1766, __pyx_L1_error)
+  __pyx_tuple__172 = PyTuple_Pack(1, __pyx_n_u_cnf_2); if (unlikely(!__pyx_tuple__172)) __PYX_ERR(0, 1766, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__172);
   __Pyx_GIVEREF(__pyx_tuple__172);
 
-  /* "sat_toolkit/formula.pyx":1804
+  /* "sat_toolkit/formula.pyx":1805
  *         return True
  * 
  *     def to_cnf(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to convert the Truthtable to a minimized CNF.
  */
-  __pyx_tuple__173 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_espresso_args, __pyx_n_s_espresso, __pyx_n_s_cnf_2, __pyx_n_s_ret_code); if (unlikely(!__pyx_tuple__173)) __PYX_ERR(0, 1804, __pyx_L1_error)
+  __pyx_tuple__173 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_espresso_args, __pyx_n_s_espresso, __pyx_n_s_cnf_2, __pyx_n_s_ret_code); if (unlikely(!__pyx_tuple__173)) __PYX_ERR(0, 1805, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__173);
   __Pyx_GIVEREF(__pyx_tuple__173);
-  __pyx_codeobj__174 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__173, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_cnf, 1804, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__174)) __PYX_ERR(0, 1804, __pyx_L1_error)
+  __pyx_codeobj__174 = (PyObject*)__Pyx_PyCode_New(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__173, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sat_toolkit_formula_pyx, __pyx_n_s_to_cnf, 1805, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__174)) __PYX_ERR(0, 1805, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     cdef tuple state
  *     cdef object _dict
  */
   __pyx_codeobj__175 = (PyObject*)__Pyx_PyCode_New(1, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_reduce_cython, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__175)) __PYX_ERR(1, 1, __pyx_L1_error)
@@ -61707,124 +61724,124 @@
   __pyx_vtable_11sat_toolkit_7formula_CNF._add_xor_clause = (int (*)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, __Pyx_memviewslice, struct __pyx_opt_args_11sat_toolkit_7formula_3CNF__add_xor_clause *__pyx_optional_args))__pyx_f_11sat_toolkit_7formula_3CNF__add_xor_clause;
   __pyx_vtable_11sat_toolkit_7formula_CNF._create_xor = (struct __pyx_obj_11sat_toolkit_7formula_CNF *(*)(__Pyx_memviewslice))__pyx_f_11sat_toolkit_7formula_3CNF__create_xor;
   __pyx_vtable_11sat_toolkit_7formula_CNF._get_units = (std::vector<int>  (*)(struct __pyx_obj_11sat_toolkit_7formula_CNF *))__pyx_f_11sat_toolkit_7formula_3CNF__get_units;
   __pyx_vtable_11sat_toolkit_7formula_CNF._check_solution = (int (*)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, __Pyx_memviewslice))__pyx_f_11sat_toolkit_7formula_3CNF__check_solution;
   __pyx_vtable_11sat_toolkit_7formula_CNF._check_solution_for_single_clause = (int (*)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, size_t, __Pyx_memviewslice))__pyx_f_11sat_toolkit_7formula_3CNF__check_solution_for_single_clause;
   __pyx_vtable_11sat_toolkit_7formula_CNF.get_clause = (struct __pyx_obj_11sat_toolkit_7formula_Clause *(*)(struct __pyx_obj_11sat_toolkit_7formula_CNF *, Py_ssize_t))__pyx_f_11sat_toolkit_7formula_3CNF_get_clause;
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_t_1 = PyTuple_Pack(1, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 676, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_Pack(1, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_ptype_11sat_toolkit_7formula_CNF = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_CNF_spec, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_CNF)) __PYX_ERR(0, 676, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_CNF_spec, __pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
+  if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_CNF)) __PYX_ERR(0, 711, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_CNF_spec, __pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 711, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula_CNF = &__pyx_type_11sat_toolkit_7formula_CNF;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   __pyx_ptype_11sat_toolkit_7formula_CNF->tp_base = __pyx_ptype_11sat_toolkit_7formula__ClauseList;
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 711, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula_CNF->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula_CNF->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula_CNF->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula_CNF->tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
   #endif
-  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_vtabptr_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_vtabptr_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 711, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
+  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 711, __pyx_L1_error)
   #endif
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_CNF, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 676, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_CNF, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_CNF) < 0) __PYX_ERR(0, 711, __pyx_L1_error)
   __pyx_vtabptr_11sat_toolkit_7formula_XorClauseList = &__pyx_vtable_11sat_toolkit_7formula_XorClauseList;
   __pyx_vtable_11sat_toolkit_7formula_XorClauseList.__pyx_base = *__pyx_vtabptr_11sat_toolkit_7formula__ClauseList;
   __pyx_vtable_11sat_toolkit_7formula_XorClauseList.__pyx_base.get_clause = (struct __pyx_obj_11sat_toolkit_7formula__BaseClause *(*)(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *, Py_ssize_t))__pyx_f_11sat_toolkit_7formula_13XorClauseList_get_clause__pyx_wrap_1;
   __pyx_vtable_11sat_toolkit_7formula_XorClauseList.__pyx_base._check_clause_type = (int (*)(struct __pyx_obj_11sat_toolkit_7formula__ClauseList *, struct __pyx_obj_11sat_toolkit_7formula__BaseClause *))__pyx_f_11sat_toolkit_7formula_13XorClauseList__check_clause_type;
   __pyx_vtable_11sat_toolkit_7formula_XorClauseList.get_clause = (struct __pyx_obj_11sat_toolkit_7formula_XorClause *(*)(struct __pyx_obj_11sat_toolkit_7formula_XorClauseList *, Py_ssize_t))__pyx_f_11sat_toolkit_7formula_13XorClauseList_get_clause;
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_t_1 = PyTuple_Pack(1, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1357, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_Pack(1, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1358, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_ptype_11sat_toolkit_7formula_XorClauseList = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_XorClauseList_spec, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_XorClauseList)) __PYX_ERR(0, 1357, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_XorClauseList_spec, __pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1357, __pyx_L1_error)
+  if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_XorClauseList)) __PYX_ERR(0, 1358, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_XorClauseList_spec, __pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1358, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula_XorClauseList = &__pyx_type_11sat_toolkit_7formula_XorClauseList;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   __pyx_ptype_11sat_toolkit_7formula_XorClauseList->tp_base = __pyx_ptype_11sat_toolkit_7formula__ClauseList;
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1357, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1358, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula_XorClauseList->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula_XorClauseList->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula_XorClauseList->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula_XorClauseList->tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
   #endif
-  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_XorClauseList, __pyx_vtabptr_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1357, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_XorClauseList, __pyx_vtabptr_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1358, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1357, __pyx_L1_error)
+  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1358, __pyx_L1_error)
   #endif
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_XorClauseList, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1357, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_XorClauseList, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_XorClauseList) < 0) __PYX_ERR(0, 1358, __pyx_L1_error)
   __pyx_vtabptr_11sat_toolkit_7formula_XorCNF = &__pyx_vtable_11sat_toolkit_7formula_XorCNF;
   __pyx_vtable_11sat_toolkit_7formula_XorCNF._nvars = (int (*)(struct __pyx_obj_11sat_toolkit_7formula_XorCNF *))__pyx_f_11sat_toolkit_7formula_6XorCNF__nvars;
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_ptype_11sat_toolkit_7formula_XorCNF = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_XorCNF_spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_XorCNF)) __PYX_ERR(0, 1371, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_XorCNF_spec, __pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1371, __pyx_L1_error)
+  __pyx_ptype_11sat_toolkit_7formula_XorCNF = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_XorCNF_spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_XorCNF)) __PYX_ERR(0, 1372, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_XorCNF_spec, __pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1372, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula_XorCNF = &__pyx_type_11sat_toolkit_7formula_XorCNF;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1371, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1372, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula_XorCNF->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula_XorCNF->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula_XorCNF->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula_XorCNF->tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
   #endif
-  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_vtabptr_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1371, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_vtabptr_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1372, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1371, __pyx_L1_error)
+  if (__Pyx_MergeVtables(__pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1372, __pyx_L1_error)
   #endif
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_XorCNF, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1371, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_XorCNF, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_XorCNF) < 0) __PYX_ERR(0, 1372, __pyx_L1_error)
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_ptype_11sat_toolkit_7formula_Truthtable = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_Truthtable_spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_Truthtable)) __PYX_ERR(0, 1664, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_Truthtable_spec, __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1664, __pyx_L1_error)
+  __pyx_ptype_11sat_toolkit_7formula_Truthtable = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula_Truthtable_spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula_Truthtable)) __PYX_ERR(0, 1665, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula_Truthtable_spec, __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1665, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula_Truthtable = &__pyx_type_11sat_toolkit_7formula_Truthtable;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1664, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1665, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula_Truthtable->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula_Truthtable->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula_Truthtable->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula_Truthtable->tp_getattro = __Pyx_PyObject_GenericGetAttr;
   }
   #endif
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Truthtable_2, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1664, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Truthtable_2, (PyObject *) __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1665, __pyx_L1_error)
   #if !CYTHON_COMPILING_IN_LIMITED_API
-  if (__Pyx_setup_reduce((PyObject *) __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1664, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject *) __pyx_ptype_11sat_toolkit_7formula_Truthtable) < 0) __PYX_ERR(0, 1665, __pyx_L1_error)
   #endif
   #if CYTHON_USE_TYPE_SPECS
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct____iter__ = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct____iter___spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct____iter__)) __PYX_ERR(0, 153, __pyx_L1_error)
   if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula___pyx_scope_struct____iter___spec, __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct____iter__) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct____iter__ = &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct____iter__;
   #endif
@@ -61857,42 +61874,42 @@
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_1___reversed__->tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   #endif
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_2___iter___spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__)) __PYX_ERR(0, 519, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_2___iter___spec, __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__) < 0) __PYX_ERR(0, 519, __pyx_L1_error)
+  __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_2___iter___spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__)) __PYX_ERR(0, 554, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_2___iter___spec, __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__) < 0) __PYX_ERR(0, 554, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__ = &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_2___iter__;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__) < 0) __PYX_ERR(0, 519, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__) < 0) __PYX_ERR(0, 554, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_2___iter__->tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   #endif
   #if CYTHON_USE_TYPE_SPECS
-  __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_3___reversed___spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__)) __PYX_ERR(0, 526, __pyx_L1_error)
-  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_3___reversed___spec, __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__) < 0) __PYX_ERR(0, 526, __pyx_L1_error)
+  __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ = (PyTypeObject *) __Pyx_PyType_FromModuleAndSpec(__pyx_m, &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_3___reversed___spec, NULL); if (unlikely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__)) __PYX_ERR(0, 561, __pyx_L1_error)
+  if (__Pyx_fix_up_extension_type_from_spec(&__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_3___reversed___spec, __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__) < 0) __PYX_ERR(0, 561, __pyx_L1_error)
   #else
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__ = &__pyx_type_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   #endif
   #if !CYTHON_USE_TYPE_SPECS
-  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__) < 0) __PYX_ERR(0, 526, __pyx_L1_error)
+  if (__Pyx_PyType_Ready(__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__) < 0) __PYX_ERR(0, 561, __pyx_L1_error)
   #endif
   #if PY_MAJOR_VERSION < 3
   __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__->tp_print = 0;
   #endif
   #if !CYTHON_COMPILING_IN_LIMITED_API
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__->tp_dictoffset && __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__->tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_ptype_11sat_toolkit_7formula___pyx_scope_struct_3___reversed__->tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
@@ -63197,1059 +63214,1059 @@
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_partition, __pyx_t_7) < 0) __PYX_ERR(0, 309, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":445
+  /* "sat_toolkit/formula.pyx":378
+ *         return result_list
+ * 
+ *     def translate(self, mapping) -> Self:             # <<<<<<<<<<<<<<
+ *         """
+ *         Translate all variables in the CNF/XorClauseList to a new index.
+ */
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 378, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_Self) < 0) __PYX_ERR(0, 378, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_11translate, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_translate, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 378, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_translate, __pyx_t_4) < 0) __PYX_ERR(0, 378, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
+
+  /* "sat_toolkit/formula.pyx":480
  * 
  * 
  *     def add_clauses(self, clauses) -> None:             # <<<<<<<<<<<<<<
  *         cdef _ClauseList c_clauses = None
  * 
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 445, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 445, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_11add_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_add_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 480, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clauses, __pyx_t_4) < 0) __PYX_ERR(0, 445, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 480, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_13add_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_add_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__99)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 480, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clauses, __pyx_t_7) < 0) __PYX_ERR(0, 480, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":470
+  /* "sat_toolkit/formula.pyx":505
  *                 self.nvars = c_clauses.nvars
  * 
  *     def add_clause(self, clause) -> None:             # <<<<<<<<<<<<<<
  *         """Add a single clause to CNF formula. Specify the clause without trailing 0."""
  * 
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 470, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 470, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_13add_clause, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_add_clause, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__99)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 505, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clause, __pyx_t_7) < 0) __PYX_ERR(0, 470, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 505, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_15add_clause, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_add_clause, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__101)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 505, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clause, __pyx_t_4) < 0) __PYX_ERR(0, 505, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":483
+  /* "sat_toolkit/formula.pyx":518
  *         self._add_clauses(np_clause)
  * 
  *     append = add_clause             # <<<<<<<<<<<<<<
  * 
  *     def __iadd__(self, clauses) -> Self:
  */
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clause); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 483, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_append, __pyx_t_7) < 0) __PYX_ERR(0, 483, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_add_clause); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 518, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_append, __pyx_t_4) < 0) __PYX_ERR(0, 518, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":526
+  /* "sat_toolkit/formula.pyx":561
  * 
  * 
  *     def __reversed__(self) -> Iterable[Clause]:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in reversed(range(self._start_indices.size())):
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 526, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_Iterable_Clause) < 0) __PYX_ERR(0, 526, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_26__reversed__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList___reversed, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__25)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 526, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 561, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_reversed_2, __pyx_t_4) < 0) __PYX_ERR(0, 526, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_kp_s_Iterable_Clause) < 0) __PYX_ERR(0, 561, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_28__reversed__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList___reversed, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__27)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 561, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_reversed_2, __pyx_t_7) < 0) __PYX_ERR(0, 561, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":583
+  /* "sat_toolkit/formula.pyx":618
  *                     return True
  * 
  *     def count(self, needle) -> bool:             # <<<<<<<<<<<<<<
  *         if not self._check_clause_type(needle):
  *             return False
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 583, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 583, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_33count, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_count, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__101)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 583, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_count, __pyx_t_7) < 0) __PYX_ERR(0, 583, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 618, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_35count, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_count, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__103)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 618, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_count, __pyx_t_4) < 0) __PYX_ERR(0, 618, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":607
+  /* "sat_toolkit/formula.pyx":642
  *         return <size_t> idx
  * 
  *     def index(self, needle, start=None, end=None) -> int:             # <<<<<<<<<<<<<<
  *         """
  *         Return zero-based index in the list of the first item whose value is
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 607, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_int) < 0) __PYX_ERR(0, 607, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_35index, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_index, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__103)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 607, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 642, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__82);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_index, __pyx_t_4) < 0) __PYX_ERR(0, 607, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_int) < 0) __PYX_ERR(0, 642, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_37index, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList_index, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__105)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 642, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_tuple__82);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_index, __pyx_t_7) < 0) __PYX_ERR(0, 642, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":635
+  /* "sat_toolkit/formula.pyx":670
  * 
  *     # pickle support
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (np.array(self), self.nvars)
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_37__reduce__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList___reduce, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__104)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 635, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_reduce, __pyx_t_4) < 0) __PYX_ERR(0, 635, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_11_ClauseList_39__reduce__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_ClauseList___reduce, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__106)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 670, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList, __pyx_n_s_reduce, __pyx_t_7) < 0) __PYX_ERR(0, 670, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula__ClauseList);
 
-  /* "sat_toolkit/formula.pyx":691
+  /* "sat_toolkit/formula.pyx":726
  *     """
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> CNF:
  *         cdef XorCNF tmp = XorCNF.from_dimacs(dimacs)
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dimacs, __pyx_n_s_str) < 0) __PYX_ERR(0, 691, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 691, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_1from_dimacs, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_from_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__106)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 691, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 726, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs, __pyx_t_7) < 0) __PYX_ERR(0, 691, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dimacs, __pyx_n_s_str) < 0) __PYX_ERR(0, 726, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 726, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_1from_dimacs, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_from_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__108)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 726, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs, __pyx_t_4) < 0) __PYX_ERR(0, 726, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 691, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 726, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs, __pyx_t_4) < 0) __PYX_ERR(0, 691, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 726, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_dimacs, __pyx_t_7) < 0) __PYX_ERR(0, 726, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":699
+  /* "sat_toolkit/formula.pyx":734
  *         return tmp._clauses
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_espresso(espresso: str) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 699, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_espresso, __pyx_n_s_str) < 0) __PYX_ERR(0, 699, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 699, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_3from_espresso, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_from_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__109)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 699, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 734, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso, __pyx_t_7) < 0) __PYX_ERR(0, 699, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_espresso, __pyx_n_s_str) < 0) __PYX_ERR(0, 734, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 734, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_3from_espresso, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_from_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__111)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso, __pyx_t_4) < 0) __PYX_ERR(0, 734, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 699, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 699, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 734, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso, __pyx_t_4) < 0) __PYX_ERR(0, 699, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_from_espresso, __pyx_t_7) < 0) __PYX_ERR(0, 734, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":751
+  /* "sat_toolkit/formula.pyx":786
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_zero(indices) -> CNF:
  *         """
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 751, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 751, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_5create_all_zero, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_all_zero, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__111)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 751, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2, __pyx_t_7) < 0) __PYX_ERR(0, 751, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 786, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_5create_all_zero, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_all_zero, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__113)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2, __pyx_t_4) < 0) __PYX_ERR(0, 786, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 751, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 751, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2, __pyx_t_4) < 0) __PYX_ERR(0, 751, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero_2, __pyx_t_7) < 0) __PYX_ERR(0, 786, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":760
+  /* "sat_toolkit/formula.pyx":795
  *         return CNF._create_all_zero(indices)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_zero(const int[:] indices not None) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 760, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 760, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_7_create_all_zero, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__create_all_zero, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__113)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 760, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 795, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero, __pyx_t_7) < 0) __PYX_ERR(0, 760, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 795, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_7_create_all_zero, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__create_all_zero, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__115)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero, __pyx_t_4) < 0) __PYX_ERR(0, 795, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 760, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 760, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 795, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero, __pyx_t_4) < 0) __PYX_ERR(0, 760, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_zero, __pyx_t_7) < 0) __PYX_ERR(0, 795, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":781
+  /* "sat_toolkit/formula.pyx":816
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_all_equal(lhs, rhs) -> CNF:
  *         "creates a CNF that asserts lhs[i] == rhs[i] for all i."
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_9create_all_equal, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_all_equal, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__115)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 816, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2, __pyx_t_7) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 816, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_9create_all_equal, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_all_equal, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__117)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2, __pyx_t_4) < 0) __PYX_ERR(0, 816, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 781, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2, __pyx_t_4) < 0) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal_2, __pyx_t_7) < 0) __PYX_ERR(0, 816, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":788
+  /* "sat_toolkit/formula.pyx":823
  *         return CNF._create_all_equal(lhs, rhs)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def _create_all_equal(const int[:] lhs not None, const int[:] rhs not None) -> CNF:
  *         cdef vector[int] clauses
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 788, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 788, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_11_create_all_equal, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__create_all_equal, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__117)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 788, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 823, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal, __pyx_t_7) < 0) __PYX_ERR(0, 788, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 823, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_11_create_all_equal, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__create_all_equal, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__119)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 823, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal, __pyx_t_4) < 0) __PYX_ERR(0, 823, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 788, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 788, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 823, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal, __pyx_t_4) < 0) __PYX_ERR(0, 788, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 823, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_all_equal, __pyx_t_7) < 0) __PYX_ERR(0, 823, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":880
+  /* "sat_toolkit/formula.pyx":915
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 880, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 915, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
 
-  /* "sat_toolkit/formula.pyx":881
+  /* "sat_toolkit/formula.pyx":916
  * 
  *     @staticmethod
  *     def create_xor(*args, rhs=None) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         creates a CNF specifying the xor of the arguments is equal to the right
  */
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_rhs, Py_None) < 0) __PYX_ERR(0, 880, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_rhs, Py_None) < 0) __PYX_ERR(0, 915, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":880
+  /* "sat_toolkit/formula.pyx":915
  *         return res
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> CNF:
  *         """
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 880, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 880, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_13create_xor, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_xor, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__119)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 880, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 915, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 915, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_13create_xor, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_create_xor, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__121)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 915, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_CyFunction_SetDefaultsKwDict(__pyx_t_5, __pyx_t_4);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_CyFunction_SetDefaultsKwDict(__pyx_t_5, __pyx_t_7);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor, __pyx_t_5) < 0) __PYX_ERR(0, 880, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor, __pyx_t_5) < 0) __PYX_ERR(0, 915, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-  __Pyx_GetNameInClass(__pyx_t_5, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 880, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_5, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 915, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 880, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 915, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor, __pyx_t_7) < 0) __PYX_ERR(0, 880, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_create_xor, __pyx_t_4) < 0) __PYX_ERR(0, 915, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":911
+  /* "sat_toolkit/formula.pyx":946
  * 
  * 
  *     def logical_or(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var or self). I.e., the new CNF is
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 911, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 911, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_15logical_or, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_logical_or, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__121)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 911, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 946, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 946, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_15logical_or, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_logical_or, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__123)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 946, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_logical_or, __pyx_t_5) < 0) __PYX_ERR(0, 911, __pyx_L1_error)
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_4);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_logical_or, __pyx_t_5) < 0) __PYX_ERR(0, 946, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":947
+  /* "sat_toolkit/formula.pyx":982
  *         return res
  * 
  *     def implied_by(self, int var) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         return a new CNF corresponding to (var -> self). I.e., the new CNF is
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 982, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_17implied_by, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_implied_by, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__123)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 947, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 982, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_17implied_by, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_implied_by, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__125)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 982, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_implied_by, __pyx_t_7) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_implied_by, __pyx_t_4) < 0) __PYX_ERR(0, 982, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":974
+  /* "sat_toolkit/formula.pyx":1009
  *         return units
  * 
  *     def get_units(self) -> np.ndarray:             # <<<<<<<<<<<<<<
  *         """
  *         Returns all unit clauses in the CNF. The unit clauses are returned as
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 974, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_np_ndarray) < 0) __PYX_ERR(0, 974, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_19get_units, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_get_units, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__125)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 974, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1009, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_kp_s_np_ndarray) < 0) __PYX_ERR(0, 1009, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_19get_units, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_get_units, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__127)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1009, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_get_units, __pyx_t_5) < 0) __PYX_ERR(0, 974, __pyx_L1_error)
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_4);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_get_units, __pyx_t_5) < 0) __PYX_ERR(0, 1009, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":997
+  /* "sat_toolkit/formula.pyx":1032
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the DIMACS file format
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 997, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1032, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 997, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_21to_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__127)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 997, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1032, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_21to_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__129)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1032, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_dimacs, __pyx_t_7) < 0) __PYX_ERR(0, 997, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_dimacs, __pyx_t_4) < 0) __PYX_ERR(0, 1032, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1028
+  /* "sat_toolkit/formula.pyx":1063
  *         return 'p cnf ' + str(self.nvars) + ' ' + str(nclauses) + '\n' + py_str.decode()
  * 
  *     def to_espresso(self, print_numvars: bool = True) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the CNF formatted in the espresso file format
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1028, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_print_numvars, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1028, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1028, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_23to_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__129)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1028, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_print_numvars, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1063, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_23to_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__131)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_tuple__130);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_espresso, __pyx_t_5) < 0) __PYX_ERR(0, 1028, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_tuple__132);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_4);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_espresso, __pyx_t_5) < 0) __PYX_ERR(0, 1063, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1076
+  /* "sat_toolkit/formula.pyx":1111
  *         return py_bytes.decode()
  * 
  *     def minimize_espresso(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to minimize the given CNF.
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1076, __pyx_L1_error)
+  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1111, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_k__34 = __pyx_t_5;
+  __pyx_k__36 = __pyx_t_5;
   __Pyx_GIVEREF(__pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1076, __pyx_L1_error)
+  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1111, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1076, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1111, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5)) __PYX_ERR(0, 1076, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5)) __PYX_ERR(0, 1111, __pyx_L1_error);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1076, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1111, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_espresso_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1076, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1076, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_25minimize_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_minimize_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__132)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1076, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_5);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_espresso, __pyx_t_4) < 0) __PYX_ERR(0, 1076, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_espresso_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1111, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1111, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_25minimize_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_minimize_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__134)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1111, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_espresso, __pyx_t_7) < 0) __PYX_ERR(0, 1111, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1099
+  /* "sat_toolkit/formula.pyx":1134
  *             return cnf
  * 
  *     def _minimize_dimacs(self, args: List[str], outfile: str) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         calls args with self.to_dimacs() as stdin, waits for the command to
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1099, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1099, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_outfile, __pyx_n_s_str) < 0) __PYX_ERR(0, 1099, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1099, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_27_minimize_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__minimize_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__134)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1134, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1134, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_outfile, __pyx_n_s_str) < 0) __PYX_ERR(0, 1134, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1134, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_27_minimize_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF__minimize_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__136)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_4);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1122
+  /* "sat_toolkit/formula.pyx":1157
  *             return CNF.from_dimacs(f.read())
  * 
  *     def minimize_lingeling(self, optlevel=None, timeout=0, extra_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses Lingeling to minimize the given CNF.
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1122, __pyx_L1_error)
+  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1157, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_k__36 = __pyx_t_5;
+  __pyx_k__38 = __pyx_t_5;
   __Pyx_GIVEREF(__pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1122, __pyx_L1_error)
+  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1157, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1122, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_7 = PyTuple_New(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1157, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 0, Py_None)) __PYX_ERR(0, 1122, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, Py_None)) __PYX_ERR(0, 1157, __pyx_L1_error);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_0)) __PYX_ERR(0, 1122, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_int_0)) __PYX_ERR(0, 1157, __pyx_L1_error);
   __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_5)) __PYX_ERR(0, 1122, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_5)) __PYX_ERR(0, 1157, __pyx_L1_error);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1122, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1157, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_extra_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_29minimize_lingeling, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_minimize_lingeling, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__136)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1122, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_t_4);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_lingeling, __pyx_t_7) < 0) __PYX_ERR(0, 1122, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_extra_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1157, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1157, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_29minimize_lingeling, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_minimize_lingeling, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__138)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1157, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_t_7);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_minimize_lingeling, __pyx_t_4) < 0) __PYX_ERR(0, 1157, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1148
+  /* "sat_toolkit/formula.pyx":1183
  * 
  * 
  *     def solve_dimacs(self, command: List[str], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS the compliant sat solver given by command.
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1148, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_command, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1148, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_Tuple_bool_np_array_None) < 0) __PYX_ERR(0, 1148, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_31solve_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_solve_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__138)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1148, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1183, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_command, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1183, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_kp_s_Tuple_bool_np_array_None) < 0) __PYX_ERR(0, 1183, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_31solve_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_solve_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__140)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1183, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_tuple__139);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_solve_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1148, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_tuple__141);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_4);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_solve_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1183, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1216
+  /* "sat_toolkit/formula.pyx":1251
  * 
  * 
  *     def check_solution(self, uint8_t[:] solution) -> bool:             # <<<<<<<<<<<<<<
  *         cdef size_t i
  *         for i in range(solution.shape[0]):
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1216, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1251, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1216, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_33check_solution, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_check_solution, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__141)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1216, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1251, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_33check_solution, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_check_solution, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__143)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1251, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_check_solution, __pyx_t_7) < 0) __PYX_ERR(0, 1216, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_check_solution, __pyx_t_4) < 0) __PYX_ERR(0, 1251, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1257
+  /* "sat_toolkit/formula.pyx":1292
  *         return False
  * 
  *     def to_truthtable(self) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Return the current CNF as a Truthtable by iterating over all possible
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1257, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1257, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_35to_truthtable, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_truthtable, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__143)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1257, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1292, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_35to_truthtable, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_to_truthtable, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__145)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1292, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_truthtable, __pyx_t_5) < 0) __PYX_ERR(0, 1257, __pyx_L1_error)
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_4);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_to_truthtable, __pyx_t_5) < 0) __PYX_ERR(0, 1292, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1299
+  /* "sat_toolkit/formula.pyx":1334
  *         return self.to_dimacs().rstrip()
  * 
  *     def equiv(self, CNF other) -> bool:             # <<<<<<<<<<<<<<
  *         """
  *         Check for logical eqivalence between self and other.
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1299, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1299, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_41equiv, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_equiv, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__145)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1299, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1334, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_41equiv, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_equiv, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__147)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1334, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_5);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_equiv, __pyx_t_7) < 0) __PYX_ERR(0, 1299, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_equiv, __pyx_t_4) < 0) __PYX_ERR(0, 1334, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
 
-  /* "sat_toolkit/formula.pyx":1320
+  /* "sat_toolkit/formula.pyx":1355
  *             return ret_code == 0
  * 
- *     def translate(self, mapping) -> CNF:             # <<<<<<<<<<<<<<
- *         """
- *         Translate all variables in the CNF to a new index.
- */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1320, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1320, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_3CNF_43translate, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_CNF_translate, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__147)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1320, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_CNF, __pyx_n_s_translate, __pyx_t_5) < 0) __PYX_ERR(0, 1320, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_CNF);
-
-  /* "sat_toolkit/formula.pyx":1354
- *         return res
- * 
  * collections.abc.Sequence.register(_ClauseList)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_collections); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1354, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_abc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1354, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_Sequence); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1354, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_collections); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1355, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_abc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1355, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_register); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1354, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_Sequence); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1355, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_7, ((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1354, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_register); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1355, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_5, ((PyObject *)__pyx_ptype_11sat_toolkit_7formula__ClauseList)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1355, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "sat_toolkit/formula.pyx":1386
+  /* "sat_toolkit/formula.pyx":1387
  * 
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def from_dimacs(dimacs: str) -> XorCNF:
  *         cdef CNF clauses = CNF.__new__(CNF)
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1387, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dimacs, __pyx_n_s_str) < 0) __PYX_ERR(0, 1387, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_XorCNF) < 0) __PYX_ERR(0, 1387, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_5from_dimacs, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_from_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__149)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1387, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dimacs, __pyx_n_s_str) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_XorCNF) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_5from_dimacs, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_from_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__149)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1386, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_4);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1387, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs, __pyx_t_7) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1386, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_5, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1387, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1386, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1387, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_from_dimacs, __pyx_t_4) < 0) __PYX_ERR(0, 1387, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1423
+  /* "sat_toolkit/formula.pyx":1424
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1423, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1424, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
 
-  /* "sat_toolkit/formula.pyx":1424
+  /* "sat_toolkit/formula.pyx":1425
  * 
  *     @staticmethod
  *     def create_xor(*args, rhs=None) -> XorCNF:             # <<<<<<<<<<<<<<
  *         """
  *         creates an XorCNF specifying the xor of the arguments is equal to the right
  */
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_rhs, Py_None) < 0) __PYX_ERR(0, 1423, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_rhs, Py_None) < 0) __PYX_ERR(0, 1424, __pyx_L1_error)
 
-  /* "sat_toolkit/formula.pyx":1423
+  /* "sat_toolkit/formula.pyx":1424
  *         return XorCNF(clauses=clauses, xor_clauses=xors)
  * 
  *     @staticmethod             # <<<<<<<<<<<<<<
  *     def create_xor(*args, rhs=None) -> XorCNF:
  *         """
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1423, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1424, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_XorCNF) < 0) __PYX_ERR(0, 1424, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_7create_xor, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_create_xor, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__151)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_XorCNF) < 0) __PYX_ERR(0, 1423, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_7create_xor, __Pyx_CYFUNCTION_STATICMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_create_xor, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__151)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1423, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetDefaultsKwDict(__pyx_t_4, __pyx_t_5);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
+  __Pyx_CyFunction_SetDefaultsKwDict(__pyx_t_7, __pyx_t_4);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor, __pyx_t_7) < 0) __PYX_ERR(0, 1424, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor, __pyx_t_4) < 0) __PYX_ERR(0, 1423, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
-  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1423, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1423, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor, __pyx_t_7) < 0) __PYX_ERR(0, 1423, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_staticmethod, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1424, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_create_xor, __pyx_t_5) < 0) __PYX_ERR(0, 1424, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1479
+  /* "sat_toolkit/formula.pyx":1480
  *         return res
  * 
  *     def partition(self) -> tuple[list[CNF], list[XorClauseList]]:             # <<<<<<<<<<<<<<
  *         """
  *         Separately partition the CNF and XorClauseList into a lists of CNFs and
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1479, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1480, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_kp_s_tuple_list_CNF_list_XorClauseLis) < 0) __PYX_ERR(0, 1480, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_9partition, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_partition, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__152)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1480, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_tuple_list_CNF_list_XorClauseLis) < 0) __PYX_ERR(0, 1479, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_9partition, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_partition, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__152)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1479, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_partition, __pyx_t_7) < 0) __PYX_ERR(0, 1480, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_partition, __pyx_t_4) < 0) __PYX_ERR(0, 1479, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1489
+  /* "sat_toolkit/formula.pyx":1490
  *         return (self._clauses.partition(), self._xor_clauses.partition())
  * 
  *     def to_cnf(self) -> CNF:             # <<<<<<<<<<<<<<
  *         cdef CNF res = CNF.__new__(CNF)
  *         cdef size_t idx
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1489, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1489, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_11to_cnf, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_to_cnf, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__154)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1489, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1490, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_to_cnf, __pyx_t_7) < 0) __PYX_ERR(0, 1489, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1490, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_11to_cnf, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_to_cnf, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__154)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1490, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_to_cnf, __pyx_t_5) < 0) __PYX_ERR(0, 1490, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1501
+  /* "sat_toolkit/formula.pyx":1502
  *         return res
  * 
  *     def add_clauses(self, clauses):             # <<<<<<<<<<<<<<
  *         self._clauses.add_clauses(clauses)
  * 
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_13add_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_add_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__156)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1501, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_add_clauses, __pyx_t_7) < 0) __PYX_ERR(0, 1501, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_13add_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_add_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__156)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1502, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_add_clauses, __pyx_t_5) < 0) __PYX_ERR(0, 1502, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1504
+  /* "sat_toolkit/formula.pyx":1505
  *         self._clauses.add_clauses(clauses)
  * 
  *     def add_xor_clauses(self, xor_clauses):             # <<<<<<<<<<<<<<
  *         self._xor_clauses.add_clauses(xor_clauses)
  * 
  */
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_15add_xor_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_add_xor_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__158)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1504, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_add_xor_clauses, __pyx_t_7) < 0) __PYX_ERR(0, 1504, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_15add_xor_clauses, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_add_xor_clauses, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__158)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1505, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_add_xor_clauses, __pyx_t_5) < 0) __PYX_ERR(0, 1505, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1572
+  /* "sat_toolkit/formula.pyx":1573
  * 
  * 
  *     def to_dimacs(self) -> str:             # <<<<<<<<<<<<<<
  *         '''
  *         return the XorCNF formatted in the extended DIMACS file format
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1572, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1573, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1573, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_25to_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_to_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__159)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1573, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1572, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_25to_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_to_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__159)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1572, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_to_dimacs, __pyx_t_7) < 0) __PYX_ERR(0, 1573, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_to_dimacs, __pyx_t_4) < 0) __PYX_ERR(0, 1572, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1578
+  /* "sat_toolkit/formula.pyx":1579
  *         return f'p cnf {self._nvars()} {len(self._clauses) + len(self._xor_clauses)}\n{self._clauses._to_dimacs("")}{self._xor_clauses._to_dimacs("x")}'
  * 
  *     def __reduce__(self):             # <<<<<<<<<<<<<<
  *         return type(self), (self._clauses, self._xor_clauses)
  * 
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_27__reduce__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF___reduce, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__160)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1578, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_reduce, __pyx_t_4) < 0) __PYX_ERR(0, 1578, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_27__reduce__, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF___reduce, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__160)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1579, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_reduce, __pyx_t_7) < 0) __PYX_ERR(0, 1579, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1594
+  /* "sat_toolkit/formula.pyx":1595
  *         return self._clauses._clauses == c_other._clauses._clauses and self._xor_clauses._clauses == c_other._xor_clauses._clauses
  * 
  *     def solve_dimacs(self, command: List[str]=['cryptominisat5'], verbose=False) -> Tuple[bool, np.array|None]:             # <<<<<<<<<<<<<<
  *         """
  *         solves the SAT by calling a DIMACS compliant sat solver that also
  */
-  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1594, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1595, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_INCREF(__pyx_n_u_cryptominisat5);
   __Pyx_GIVEREF(__pyx_n_u_cryptominisat5);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_u_cryptominisat5)) __PYX_ERR(0, 1594, __pyx_L1_error);
-  __pyx_k__50 = __pyx_t_4;
-  __Pyx_GIVEREF(__pyx_t_4);
-  __pyx_t_4 = 0;
-  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1594, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  if (__Pyx_PyList_SET_ITEM(__pyx_t_7, 0, __pyx_n_u_cryptominisat5)) __PYX_ERR(0, 1595, __pyx_L1_error);
+  __pyx_k__50 = __pyx_t_7;
+  __Pyx_GIVEREF(__pyx_t_7);
+  __pyx_t_7 = 0;
+  __pyx_t_7 = PyList_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1595, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
   __Pyx_INCREF(__pyx_n_u_cryptominisat5);
   __Pyx_GIVEREF(__pyx_n_u_cryptominisat5);
-  if (__Pyx_PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_u_cryptominisat5)) __PYX_ERR(0, 1594, __pyx_L1_error);
-  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1594, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4)) __PYX_ERR(0, 1594, __pyx_L1_error);
+  if (__Pyx_PyList_SET_ITEM(__pyx_t_7, 0, __pyx_n_u_cryptominisat5)) __PYX_ERR(0, 1595, __pyx_L1_error);
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1595, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_7);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7)) __PYX_ERR(0, 1595, __pyx_L1_error);
   __Pyx_INCREF(Py_False);
   __Pyx_GIVEREF(Py_False);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 1, Py_False)) __PYX_ERR(0, 1594, __pyx_L1_error);
-  __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1594, __pyx_L1_error)
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 1, Py_False)) __PYX_ERR(0, 1595, __pyx_L1_error);
+  __pyx_t_7 = 0;
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1595, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_command, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1595, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_kp_s_Tuple_bool_np_array_None) < 0) __PYX_ERR(0, 1595, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_31solve_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_solve_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__161)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1595, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_command, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1594, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_kp_s_Tuple_bool_np_array_None) < 0) __PYX_ERR(0, 1594, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_6XorCNF_31solve_dimacs, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_XorCNF_solve_dimacs, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__161)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1594, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_4);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_t_5);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_solve_dimacs, __pyx_t_4) < 0) __PYX_ERR(0, 1595, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_XorCNF, __pyx_n_s_solve_dimacs, __pyx_t_5) < 0) __PYX_ERR(0, 1594, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_XorCNF);
 
-  /* "sat_toolkit/formula.pyx":1677
+  /* "sat_toolkit/formula.pyx":1678
  *     cdef public uint64_t numbits
  * 
  *     INIT_INDEX_SET = object()             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, init_key, numbits, on_set, dc_set):
  */
-  __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_builtin_object); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1677, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_INIT_INDEX_SET, __pyx_t_5) < 0) __PYX_ERR(0, 1677, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __pyx_t_4 = __Pyx_PyObject_CallNoArg(__pyx_builtin_object); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1678, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_INIT_INDEX_SET, __pyx_t_4) < 0) __PYX_ERR(0, 1678, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
-  /* "sat_toolkit/formula.pyx":1691
+  /* "sat_toolkit/formula.pyx":1692
  * 
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_lut(cls, on_lut: np.ndarray, dc_lut: Optional[np.ndarray] = None) -> Truthtable:
  *         """
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1691, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_on_lut, __pyx_kp_s_np_ndarray) < 0) __PYX_ERR(0, 1691, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dc_lut, __pyx_kp_s_Optional_np_ndarray) < 0) __PYX_ERR(0, 1691, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1691, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_3from_lut, __Pyx_CYFUNCTION_CLASSMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_from_lut, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__163)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1691, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1692, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__164);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_5);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut, __pyx_t_4) < 0) __PYX_ERR(0, 1691, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_on_lut, __pyx_kp_s_np_ndarray) < 0) __PYX_ERR(0, 1692, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dc_lut, __pyx_kp_s_Optional_np_ndarray) < 0) __PYX_ERR(0, 1692, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1692, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_3from_lut, __Pyx_CYFUNCTION_CLASSMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_from_lut, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__163)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1692, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_tuple__164);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut, __pyx_t_7) < 0) __PYX_ERR(0, 1692, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
-  __Pyx_GetNameInClass(__pyx_t_4, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1691, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1692, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_4 = __Pyx_Method_ClassMethod(__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1692, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_Method_ClassMethod(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1691, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut, __pyx_t_4) < 0) __PYX_ERR(0, 1692, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_lut, __pyx_t_5) < 0) __PYX_ERR(0, 1691, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
-  /* "sat_toolkit/formula.pyx":1722
+  /* "sat_toolkit/formula.pyx":1723
  * 
  *     @classmethod
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Creates a Truthtable from the set of indices with value 1 and optionally indices where the value can be ignored.
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GIVEREF(__pyx_t_5);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error);
-  __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1723, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 1722, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_4);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4)) __PYX_ERR(0, 1723, __pyx_L1_error);
+  __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1723, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 1723, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_k__56 = __pyx_t_9;
   __Pyx_GIVEREF(__pyx_t_9);
   __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":1721
+  /* "sat_toolkit/formula.pyx":1722
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:
  *         """
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
 
-  /* "sat_toolkit/formula.pyx":1722
+  /* "sat_toolkit/formula.pyx":1723
  * 
  *     @classmethod
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:             # <<<<<<<<<<<<<<
  *         """
  *         Creates a Truthtable from the set of indices with value 1 and optionally indices where the value can be ignored.
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1723, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1722, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1723, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_9);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_9)) __PYX_ERR(0, 1722, __pyx_L1_error);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_9)) __PYX_ERR(0, 1723, __pyx_L1_error);
   __pyx_t_9 = 0;
-  __pyx_t_9 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1723, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 1722, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1722, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 1723, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, __pyx_t_9); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1723, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-  /* "sat_toolkit/formula.pyx":1721
+  /* "sat_toolkit/formula.pyx":1722
  *         return cls(cls.INIT_INDEX_SET, numbits, on_set, dc_set)
  * 
  *     @classmethod             # <<<<<<<<<<<<<<
  *     def from_indices(cls, numbits: int, on_indices: np.array, dc_indices = np.array([], dtype=int)) -> Truthtable:
  *         """
  */
-  __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1721, __pyx_L1_error)
+  __pyx_t_9 = PyTuple_New(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4)) __PYX_ERR(0, 1721, __pyx_L1_error);
-  __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1721, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_numbits, __pyx_n_s_int) < 0) __PYX_ERR(0, 1721, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_on_indices, __pyx_kp_s_np_array) < 0) __PYX_ERR(0, 1721, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1721, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_5from_indices, __Pyx_CYFUNCTION_CLASSMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_from_indices, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__166)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1721, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_7);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7)) __PYX_ERR(0, 1722, __pyx_L1_error);
+  __pyx_t_7 = 0;
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_t_9);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_numbits, __pyx_n_s_int) < 0) __PYX_ERR(0, 1722, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_on_indices, __pyx_kp_s_np_array) < 0) __PYX_ERR(0, 1722, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_Truthtable_2) < 0) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_5from_indices, __Pyx_CYFUNCTION_CLASSMETHOD | __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_from_indices, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__166)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_t_9);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices, __pyx_t_7) < 0) __PYX_ERR(0, 1721, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices, __pyx_t_5) < 0) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
-  __Pyx_GetNameInClass(__pyx_t_7, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1721, __pyx_L1_error)
+  __Pyx_GetNameInClass(__pyx_t_5, (PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1722, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_7 = __Pyx_Method_ClassMethod(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_Method_ClassMethod(__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1721, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices, __pyx_t_7) < 0) __PYX_ERR(0, 1722, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_from_indices, __pyx_t_4) < 0) __PYX_ERR(0, 1721, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
-  /* "sat_toolkit/formula.pyx":1736
+  /* "sat_toolkit/formula.pyx":1737
  * 
  * 
  *     def _write(self, io: io.TextIOBase, espresso: bool = False, invert: bool = False) -> None:             # <<<<<<<<<<<<<<
  *         i_list = range(1 << self.numbits)
  * 
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1736, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_io, __pyx_kp_s_io_TextIOBase) < 0) __PYX_ERR(0, 1736, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_espresso, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1736, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_invert, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1736, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 1736, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_7_write, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable__write, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__168)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1736, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1737, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_tuple__169);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_4);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_write_2, __pyx_t_7) < 0) __PYX_ERR(0, 1736, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_io, __pyx_kp_s_io_TextIOBase) < 0) __PYX_ERR(0, 1737, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_espresso, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1737, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_invert, __pyx_n_s_bool) < 0) __PYX_ERR(0, 1737, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_None) < 0) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_7_write, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable__write, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__168)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_tuple__169);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_5, __pyx_t_7);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_write_2, __pyx_t_5) < 0) __PYX_ERR(0, 1737, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
-  /* "sat_toolkit/formula.pyx":1765
+  /* "sat_toolkit/formula.pyx":1766
  *             io.write(f'.end\n')
  * 
  *     def to_espresso(self, phase='cnf') -> str:             # <<<<<<<<<<<<<<
  *         """
  *         return the truthtable in espresso format
  */
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1765, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1766, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1766, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_9to_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_to_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__171)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1766, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_str) < 0) __PYX_ERR(0, 1765, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_9to_espresso, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_to_espresso, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__171)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1765, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_4, __pyx_tuple__172);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_4, __pyx_t_7);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_7, __pyx_tuple__172);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_7, __pyx_t_5);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_to_espresso, __pyx_t_7) < 0) __PYX_ERR(0, 1766, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_to_espresso, __pyx_t_4) < 0) __PYX_ERR(0, 1765, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
-  /* "sat_toolkit/formula.pyx":1804
+  /* "sat_toolkit/formula.pyx":1805
  *         return True
  * 
  *     def to_cnf(self, espresso_args: List[str] = []) -> CNF:             # <<<<<<<<<<<<<<
  *         """
  *         Uses espresso to convert the Truthtable to a minimized CNF.
  */
-  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1804, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_k__61 = __pyx_t_4;
-  __Pyx_GIVEREF(__pyx_t_4);
-  __pyx_t_4 = 0;
-  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1804, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1804, __pyx_L1_error)
+  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1805, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GIVEREF(__pyx_t_4);
-  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4)) __PYX_ERR(0, 1804, __pyx_L1_error);
-  __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1804, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_espresso_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1804, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1804, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_15to_cnf, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_to_cnf, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__174)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1804, __pyx_L1_error)
+  __pyx_k__61 = __pyx_t_7;
+  __Pyx_GIVEREF(__pyx_t_7);
+  __pyx_t_7 = 0;
+  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1805, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1805, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_7);
+  if (__Pyx_PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7)) __PYX_ERR(0, 1805, __pyx_L1_error);
+  __pyx_t_7 = 0;
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1805, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_espresso_args, __pyx_kp_s_List_str) < 0) __PYX_ERR(0, 1805, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_return, __pyx_n_s_CNF) < 0) __PYX_ERR(0, 1805, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_CyFunction_New(&__pyx_mdef_11sat_toolkit_7formula_10Truthtable_15to_cnf, __Pyx_CYFUNCTION_CCLASS, __pyx_n_s_Truthtable_to_cnf, NULL, __pyx_n_s_sat_toolkit_formula, __pyx_d, ((PyObject *)__pyx_codeobj__174)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1805, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_9, __pyx_t_7);
-  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_9, __pyx_t_4);
+  __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_9, __pyx_t_5);
+  __Pyx_CyFunction_SetAnnotationsDict(__pyx_t_9, __pyx_t_7);
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_to_cnf, __pyx_t_9) < 0) __PYX_ERR(0, 1804, __pyx_L1_error)
+  if (__Pyx_SetItemOnTypeDict((PyObject *)__pyx_ptype_11sat_toolkit_7formula_Truthtable, __pyx_n_s_to_cnf, __pyx_t_9) < 0) __PYX_ERR(0, 1805, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   PyType_Modified(__pyx_ptype_11sat_toolkit_7formula_Truthtable);
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
  *     cdef tuple state
  *     cdef object _dict
@@ -64319,16 +64336,16 @@
   /* "sat_toolkit/formula.pyx":1
  * #cython: language_level=3, annotation_typing=True, embedsignature=True, boundscheck=False, wraparound=False, cdivision=True             # <<<<<<<<<<<<<<
  * #distutils: language = c++
  * cimport cython
  */
   __pyx_t_9 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_kp_u_CNF_logical_or_line_911, __pyx_kp_u_return_a_new_CNF_corresponding) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_9, __pyx_kp_u_CNF_get_units_line_974, __pyx_kp_u_Returns_all_unit_clauses_in_the) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_kp_u_CNF_logical_or_line_946, __pyx_kp_u_return_a_new_CNF_corresponding) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_kp_u_CNF_get_units_line_1009, __pyx_kp_u_Returns_all_unit_clauses_in_the) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_9) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
@@ -70489,15 +70506,15 @@
 }
 #endif
 
 #if PY_MAJOR_VERSION < 3
 static int __Pyx_GetBuffer(PyObject *obj, Py_buffer *view, int flags) {
     __Pyx_TypeName obj_type_name;
     if (PyObject_CheckBuffer(obj)) return PyObject_GetBuffer(obj, view, flags);
-        if (__Pyx_TypeCheck(obj, __pyx_ptype_11sat_toolkit_7formula__ClauseList)) return __pyx_pw_11sat_toolkit_7formula_11_ClauseList_39__getbuffer__(obj, view, flags);
+        if (__Pyx_TypeCheck(obj, __pyx_ptype_11sat_toolkit_7formula__ClauseList)) return __pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__getbuffer__(obj, view, flags);
         if (__Pyx_TypeCheck(obj, __pyx_array_type)) return __pyx_array_getbuffer(obj, view, flags);
         if (__Pyx_TypeCheck(obj, __pyx_memoryview_type)) return __pyx_memoryview_getbuffer(obj, view, flags);
     obj_type_name = __Pyx_PyType_GetName(Py_TYPE(obj));
     PyErr_Format(PyExc_TypeError,
                  "'" __Pyx_FMT_TYPENAME "' does not have the buffer interface",
                  obj_type_name);
     __Pyx_DECREF_TypeName(obj_type_name);
@@ -70507,15 +70524,15 @@
     PyObject *obj = view->obj;
     if (!obj) return;
     if (PyObject_CheckBuffer(obj)) {
         PyBuffer_Release(view);
         return;
     }
     if ((0)) {}
-        else if (__Pyx_TypeCheck(obj, __pyx_ptype_11sat_toolkit_7formula__ClauseList)) __pyx_pw_11sat_toolkit_7formula_11_ClauseList_41__releasebuffer__(obj, view);
+        else if (__Pyx_TypeCheck(obj, __pyx_ptype_11sat_toolkit_7formula__ClauseList)) __pyx_pw_11sat_toolkit_7formula_11_ClauseList_43__releasebuffer__(obj, view);
     view->obj = NULL;
     Py_DECREF(obj);
 }
 #endif
 
 
 /* MemviewSliceIsContig */
@@ -71384,26 +71401,14 @@
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
-/* MemviewDtypeToObject */
-  static CYTHON_INLINE PyObject *__pyx_memview_get_int(const char *itemp) {
-    return (PyObject *) __Pyx_PyInt_From_int(*(int *) itemp);
-}
-static CYTHON_INLINE int __pyx_memview_set_int(const char *itemp, PyObject *obj) {
-    int value = __Pyx_PyInt_As_int(obj);
-    if (unlikely((value == (int)-1) && PyErr_Occurred()))
-        return 0;
-    *(int *) itemp = value;
-    return 1;
-}
-
 /* ObjectToMemviewSlice */
   static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dc_int(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
     int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_CONTIG) };
     int retcode;
     if (obj == Py_None) {
@@ -71419,14 +71424,26 @@
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
+/* MemviewDtypeToObject */
+  static CYTHON_INLINE PyObject *__pyx_memview_get_int(const char *itemp) {
+    return (PyObject *) __Pyx_PyInt_From_int(*(int *) itemp);
+}
+static CYTHON_INLINE int __pyx_memview_set_int(const char *itemp, PyObject *obj) {
+    int value = __Pyx_PyInt_As_int(obj);
+    if (unlikely((value == (int)-1) && PyErr_Occurred()))
+        return 0;
+    *(int *) itemp = value;
+    return 1;
+}
+
 /* ObjectToMemviewSlice */
   static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_char__const__(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
     int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
```

### Comparing `sat-toolkit-0.4.2/sat_toolkit/formula.pyx` & `sat-toolkit-0.4.3/sat_toolkit/formula.pyx`

 * *Files 0% similar despite different names*

```diff
@@ -371,14 +371,49 @@
                 continue
             seen_keys.insert(<void *> val)
             if len(val) > 0:
                 result_list.append(val)
 
         return result_list
 
+    def translate(self, mapping) -> Self:
+        """
+        Translate all variables in the CNF/XorClauseList to a new index.
+        The translation mapping is given by the mapping paramter.
+
+        Index 0 must always map to index 0 again.
+
+        :return: a new CNF with variables changed according to mapping parameter
+        """
+        cdef np_vars = np.array(mapping, copy=False, dtype=np.int32)
+        cdef int [::1] var_view = np_vars
+        cdef size_t i
+
+        if var_view.shape[0] != self.nvars + 1:
+            raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
+        if var_view[0] != 0:
+            raise ValueError('variable 0 must map to 0 again')
+
+        for i in range(1, <size_t> var_view.shape[0]):
+            if var_view[i] == 0:
+                raise ValueError('variable must not be mapped to 0')
+
+        cdef vector[int] new_clauses
+        new_clauses.resize(self._clauses.size())
+
+        cdef int var
+        for i in range(self._clauses.size()):
+            var = self._clauses[i]
+            new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)
+
+        cdef _ClauseList res = type(self).__new__(type(self))
+        res.nvars = self.nvars
+        res._add_clauses_raw(new_clauses.data(), new_clauses.size())
+        return res
+
     cdef int _add_clauses_raw(self, const int *clauses, size_t length) except -1 nogil:
         cdef size_t old_len, i
 
         if self.view_count > 0:
             raise ValueError('cannot alter while referenced by buffer')
 
         if length > 0 and clauses[length - 1] != 0:
@@ -1313,48 +1348,14 @@
 
             ret_code = espresso.wait()
             if ret_code not in [0, 1]:
                 raise sp.CalledProcessError(ret_code, ' '.join(espresso.args))
 
             return ret_code == 0
 
-    def translate(self, mapping) -> CNF:
-        """
-        Translate all variables in the CNF to a new index.
-        The translation mapping is given by the mapping paramter.
-
-        Index 0 must always map to index 0 again.
-
-        :return: a new CNF with variables changed according to mapping parameter
-        """
-        cdef np_vars = np.array(mapping, copy=False, dtype=np.int32)
-        cdef int [::1] var_view = np_vars
-        cdef size_t i
-
-        if var_view.shape[0] != self.nvars + 1:
-            raise ValueError(f'need to provide translation for all 1+{self.nvars} variables')
-        if var_view[0] != 0:
-            raise ValueError('variable 0 must map to 0 again')
-
-        for i in range(1, <size_t> var_view.shape[0]):
-            if var_view[i] == 0:
-                raise ValueError('variable must not be mapped to 0')
-
-        cdef vector[int] new_clauses
-        new_clauses.resize(self._clauses.size())
-
-        cdef int var
-        for i in range(self._clauses.size()):
-            var = self._clauses[i]
-            new_clauses[i] = var_view[abs(var)] * (1 if var > 0 else -1)
-
-        cdef CNF res = CNF.__new__(CNF)
-        res._add_clauses(<int[:new_clauses.size()]> new_clauses.data())
-        return res
-
 collections.abc.Sequence.register(_ClauseList)
 
 
 cdef class XorClauseList(_ClauseList):
     """
     Class for storing and manipulating a list of xor clauses.
     """
```

### Comparing `sat-toolkit-0.4.2/sat_toolkit/util.py` & `sat-toolkit-0.4.3/sat_toolkit/util.py`

 * *Files identical despite different names*

### Comparing `sat-toolkit-0.4.2/sat_toolkit.egg-info/PKG-INFO` & `sat-toolkit-0.4.3/sat_toolkit.egg-info/PKG-INFO`

 * *Files 18% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: sat-toolkit
-Version: 0.4.2
+Version: 0.4.3
 Summary: Tool for manipulating CNF formulas
 Home-page: https://github.com/fanosta/sat_toolkit
 Author: Marcel Nageler
 Author-email: marcel.nageler@iaik.tugraz.at
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: POSIX :: Linux
```

### Comparing `sat-toolkit-0.4.2/setup.py` & `sat-toolkit-0.4.3/setup.py`

 * *Files 0% similar despite different names*

```diff
@@ -17,15 +17,15 @@
 ]
 
 if USE_CYTHON:
     extensions = cythonize(extensions)
 
 setup(
     name="sat-toolkit",
-    version="0.4.2",
+    version="0.4.3",
     author="Marcel Nageler",
     author_email="marcel.nageler@iaik.tugraz.at",
     description="Tool for manipulating CNF formulas",
     long_description=long_description,
     long_description_content_type="text/markdown",
     url="https://github.com/fanosta/sat_toolkit",
     packages=find_packages(),
```

### Comparing `sat-toolkit-0.4.2/tests/test_cnf.py` & `sat-toolkit-0.4.3/tests/test_cnf.py`

 * *Files 1% similar despite different names*

```diff
@@ -177,14 +177,15 @@
     cnf = CNF([-1, 2, 3, 0, -4, -5, 6, 0])
 
     mapping = np.zeros(7, dtype=np.int32)
     mapping[1:4] = [4, -5, -6]
     mapping[4:7] = [1, -2, 3]
 
     cnf2 = cnf.translate(mapping)
+    assert isinstance(cnf2, CNF)
 
     assert cnf2.nvars == 6
     assert len(cnf2) == 2
     assert cnf2[0] == Clause([-4, -5, -6])
     assert cnf2[1] == Clause([-1, 2, 3])
     assert cnf2 == CNF([-4, -5, -6, 0, -1, 2, 3, 0])
```

### Comparing `sat-toolkit-0.4.2/tests/test_partition.py` & `sat-toolkit-0.4.3/tests/test_partition.py`

 * *Files identical despite different names*

### Comparing `sat-toolkit-0.4.2/tests/test_xor_cnf.py` & `sat-toolkit-0.4.3/tests/test_xor_cnf.py`

 * *Files 4% similar despite different names*

```diff
@@ -127,14 +127,30 @@
     assert a._xor_clauses.nvars == 6
 
     assert b._clauses.nvars == 3
     assert b._xor_clauses.nvars == 6
 
     assert a == b
 
+def test_translate():
+    xors = XorClauseList([-1, 2, 3, 0, -4, -5, 6, 0])
+
+    mapping = np.zeros(7, dtype=np.int32)
+    mapping[1:4] = [4, -5, -6]
+    mapping[4:7] = [1, -2, 3]
+
+    xors2 = xors.translate(mapping)
+    assert isinstance(xors2, XorClauseList)
+
+    assert xors2.nvars == 6
+    assert len(xors2) == 2
+    assert xors2[0] == XorClause([-4, -5, -6])
+    assert xors2[1] == XorClause([-1, 2, 3])
+    assert xors2 == XorClauseList([-4, -5, -6, 0, -1, 2, 3, 0])
+
 
 def test_dimacs():
     xor_cnf = XorCNF()
     xor_cnf += CNF([1, -2, 3, 0, -4, 5, -6, 0])
 
     xor_cnf += XorClauseList([1, 3, 6, 0, -2, 4, 5, 0])
```

